/* module-key = 'com.atlassian.bonfire.plugin:bonfire-jquery-ui', location = 'includes/js/lib/jquery-ui-1.8.16.js' */
var bfjQueryoverride=jQuery.noConflict();
/*
 * jQuery UI 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(A,D){A.uibonfire=A.uibonfire||{};
A.extend(A.uibonfire,{version:"1.8.16",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});
A.fn.extend({propAttr:A.fn.prop||A.fn.attr,_focus:A.fn._focus||A.fn.focus,focus:function(E,F){return typeof E==="number"?this.each(function(){var G=this;
setTimeout(function(){A(G).focus();
if(F){F.call(G)
}},E)
}):this._focus.apply(this,arguments)
},scrollParent:function(){var E;
if((A.browser.msie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){E=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(A.curCSS(this,"position",1))&&(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1))
}).eq(0)
}else{E=this.parents().filter(function(){return(/(auto|scroll)/).test(A.curCSS(this,"overflow",1)+A.curCSS(this,"overflow-y",1)+A.curCSS(this,"overflow-x",1))
}).eq(0)
}return(/fixed/).test(this.css("position"))||!E.length?A(document):E
},zIndex:function(H){if(H!==D){return this.css("zIndex",H)
}if(this.length){var F=A(this[0]),E,G;
while(F.length&&F[0]!==document){E=F.css("position");
if(E==="absolute"||E==="relative"||E==="fixed"){G=parseInt(F.css("zIndex"),10);
if(!isNaN(G)&&G!==0){return G
}}F=F.parent()
}}return 0
},disableSelection:function(){return this.bind((A.support.selectstart?"selectstart":"mousedown")+".uibonfire-disableSelection",function(E){E.preventDefault()
})
},enableSelection:function(){return this.unbind(".uibonfire-disableSelection")
}});
A.each(["Width","Height"],function(G,E){var F=E==="Width"?["Left","Right"]:["Top","Bottom"],H=E.toLowerCase(),J={innerWidth:A.fn.innerWidth,innerHeight:A.fn.innerHeight,outerWidth:A.fn.outerWidth,outerHeight:A.fn.outerHeight};
function I(M,L,K,N){A.each(F,function(){L-=parseFloat(A.curCSS(M,"padding"+this,true))||0;
if(K){L-=parseFloat(A.curCSS(M,"border"+this+"Width",true))||0
}if(N){L-=parseFloat(A.curCSS(M,"margin"+this,true))||0
}});
return L
}A.fn["inner"+E]=function(K){if(K===D){return J["inner"+E].call(this)
}return this.each(function(){A(this).css(H,I(this,K)+"px")
})
};
A.fn["outer"+E]=function(K,L){if(typeof K!=="number"){return J["outer"+E].call(this,K)
}return this.each(function(){A(this).css(H,I(this,K,true,L)+"px")
})
}
});
function C(G,E){var J=G.nodeName.toLowerCase();
if("area"===J){var I=G.parentNode,H=I.name,F;
if(!G.href||!H||I.nodeName.toLowerCase()!=="map"){return false
}F=A("img[usemap=#"+H+"]")[0];
return !!F&&B(F)
}return(/input|select|textarea|button|object/.test(J)?!G.disabled:"a"==J?G.href||E:E)&&B(G)
}function B(E){return !A(E).parents().andSelf().filter(function(){return A.curCSS(this,"visibility")==="hidden"||A.expr.filters.hidden(this)
}).length
}A.extend(A.expr[":"],{data:function(G,F,E){return !!A.data(G,E[3])
},focusable:function(E){return C(E,!isNaN(A.attr(E,"tabindex")))
},tabbable:function(G){var E=A.attr(G,"tabindex"),F=isNaN(E);
return(F||E>=0)&&C(G,!F)
}});
A(function(){var E=document.body,F=E.appendChild(F=document.createElement("div"));
A.extend(F.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});
A.support.minHeight=F.offsetHeight===100;
A.support.selectstart="onselectstart" in F;
E.removeChild(F).style.display="none"
});
A.extend(A.uibonfire,{plugin:{add:function(F,G,I){var H=A.uibonfire[F].prototype;
for(var E in I){H.plugins[E]=H.plugins[E]||[];
H.plugins[E].push([G,I[E]])
}},call:function(E,G,F){var I=E.plugins[G];
if(!I||!E.element[0].parentNode){return 
}for(var H=0;
H<I.length;
H++){if(E.options[I[H][0]]){I[H][1].apply(E.element,F)
}}}},contains:function(F,E){return document.compareDocumentPosition?F.compareDocumentPosition(E)&16:F!==E&&F.contains(E)
},hasScroll:function(H,F){if(A(H).css("overflow")==="hidden"){return false
}var E=(F&&F==="left")?"scrollLeft":"scrollTop",G=false;
if(H[E]>0){return true
}H[E]=1;
G=(H[E]>0);
H[E]=0;
return G
},isOverAxis:function(F,E,G){return(F>E)&&(F<(E+G))
},isOver:function(J,F,I,H,E,G){return A.uibonfire.isOverAxis(J,I,E)&&A.uibonfire.isOverAxis(F,H,G)
}})
})(bfjQueryoverride);
/*
 * jQuery UI Widget 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(B,D){if(B.cleanData){var C=B.cleanData;
B.cleanData=function(E){for(var F=0,G;
(G=E[F])!=null;
F++){try{B(G).triggerHandler("remove")
}catch(H){}}C(E)
}
}else{var A=B.fn.remove;
B.fn.remove=function(E,F){return this.each(function(){if(!F){if(!E||B.filter(E,[this]).length){B("*",this).add([this]).each(function(){try{B(this).triggerHandler("remove")
}catch(G){}})
}}return A.call(B(this),E,F)
})
}
}B.widget=function(F,H,E){var G=F.split(".")[0],J;
F=F.split(".")[1];
J=G+"-"+F;
if(!E){E=H;
H=B.Widget
}B.expr[":"][J]=function(K){return !!B.data(K,F)
};
B[G]=B[G]||{};
B[G][F]=function(K,L){if(arguments.length){this._createWidget(K,L)
}};
var I=new H();
I.options=B.extend(true,{},I.options);
B[G][F].prototype=B.extend(true,I,{namespace:G,widgetName:F,widgetEventPrefix:B[G][F].prototype.widgetEventPrefix||F,widgetBaseClass:J},E);
B.widget.bridge(F,B[G][F])
};
B.widget.bridge=function(F,E){B.fn[F]=function(I){var G=typeof I==="string",H=Array.prototype.slice.call(arguments,1),J=this;
I=!G&&H.length?B.extend.apply(null,[true,I].concat(H)):I;
if(G&&I.charAt(0)==="_"){return J
}if(G){this.each(function(){var K=B.data(this,F),L=K&&B.isFunction(K[I])?K[I].apply(K,H):K;
if(L!==K&&L!==D){J=L;
return false
}})
}else{this.each(function(){var K=B.data(this,F);
if(K){K.option(I||{})._init()
}else{B.data(this,F,new E(I,this))
}})
}return J
}
};
B.Widget=function(E,F){if(arguments.length){this._createWidget(E,F)
}};
B.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(F,G){B.data(G,this.widgetName,this);
this.element=B(G);
this.options=B.extend(true,{},this.options,this._getCreateOptions(),F);
var E=this;
this.element.bind("remove."+this.widgetName,function(){E.destroy()
});
this._create();
this._trigger("create");
this._init()
},_getCreateOptions:function(){return B.metadata&&B.metadata.get(this.element[0])[this.widgetName]
},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);
this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled uibonfire-state-disabled")
},widget:function(){return this.element
},option:function(F,G){var E=F;
if(arguments.length===0){return B.extend({},this.options)
}if(typeof F==="string"){if(G===D){return this.options[F]
}E={};
E[F]=G
}this._setOptions(E);
return this
},_setOptions:function(F){var E=this;
B.each(F,function(G,H){E._setOption(G,H)
});
return this
},_setOption:function(E,F){this.options[E]=F;
if(E==="disabled"){this.widget()[F?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",F)
}return this
},enable:function(){return this._setOption("disabled",false)
},disable:function(){return this._setOption("disabled",true)
},_trigger:function(F,G,H){var J=this.options[F];
G=B.Event(G);
G.type=(F===this.widgetEventPrefix?F:this.widgetEventPrefix+F).toLowerCase();
H=H||{};
if(G.originalEvent){for(var E=B.event.props.length,I;
E;
){I=B.event.props[--E];
G[I]=G.originalEvent[I]
}}this.element.trigger(G,H);
return !(B.isFunction(J)&&J.call(this.element[0],G,H)===false||G.isDefaultPrevented())
}}
})(bfjQueryoverride);
(function(A,B){var C=0;
A.widget("uibonfire.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var D=this,F=this.element[0].ownerDocument,E;
this.element.addClass("uibonfire-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(G){if(D.options.disabled||D.element.propAttr("readOnly")){return 
}E=false;
var H=A.uibonfire.keyCode;
switch(G.keyCode){case H.PAGE_UP:D._move("previousPage",G);
break;
case H.PAGE_DOWN:D._move("nextPage",G);
break;
case H.UP:D._move("previous",G);
G.preventDefault();
break;
case H.DOWN:D._move("next",G);
G.preventDefault();
break;
case H.ENTER:case H.NUMPAD_ENTER:if(D.menu.active){E=true;
G.preventDefault()
}case H.TAB:if(!D.menu.active){return 
}D.menu.select(G);
break;
case H.ESCAPE:D.element.val(D.term);
D.close(G);
break;
default:clearTimeout(D.searching);
D.searching=setTimeout(function(){if(D.term!=D.element.val()){D.selectedItem=null;
D.search(null,G)
}},D.options.delay);
break
}}).bind("keypress.autocomplete",function(G){if(E){E=false;
G.preventDefault()
}}).bind("focus.autocomplete",function(){if(D.options.disabled){return 
}D.selectedItem=null;
D.previous=D.element.val()
}).bind("blur.autocomplete",function(G){if(D.options.disabled){return 
}clearTimeout(D.searching);
D.closing=setTimeout(function(){D.close(G);
D._change(G)
},150)
});
this._initSource();
this.response=function(){return D._response.apply(D,arguments)
};
this.menu=A("<ul></ul>").addClass("uibonfire-autocomplete").appendTo(A(this.options.appendTo||"body",F)[0]).mousedown(function(G){var H=D.menu.element[0];
if(!A(G.target).closest(".uibonfire-menu-item").length){setTimeout(function(){A(document).one("mousedown",function(I){if(I.target!==D.element[0]&&I.target!==H&&!A.uibonfire.contains(H,I.target)){D.close()
}})
},1)
}setTimeout(function(){clearTimeout(D.closing)
},13)
}).menu({focus:function(H,I){var G=I.item.data("item.autocomplete");
if(false!==D._trigger("focus",H,{item:G})){if(/^key/.test(H.originalEvent.type)){D.element.val(G.value)
}}},selected:function(I,J){var H=J.item.data("item.autocomplete"),G=D.previous;
if(D.element[0]!==F.activeElement){D.element.focus();
D.previous=G;
setTimeout(function(){D.previous=G;
D.selectedItem=H
},1)
}if(false!==D._trigger("select",I,{item:H})){D.element.val(H.value)
}D.term=D.element.val();
D.close(I);
D.selectedItem=H
},blur:function(G,H){if(D.menu.element.is(":visible")&&(D.element.val()!==D.term)){D.element.val(D.term)
}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");
if(A.fn.bgiframe){this.menu.element.bgiframe()
}},destroy:function(){this.element.removeClass("uibonfire-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();
A.Widget.prototype.destroy.call(this)
},_setOption:function(D,E){A.Widget.prototype._setOption.apply(this,arguments);
if(D==="source"){this._initSource()
}if(D==="appendTo"){this.menu.element.appendTo(A(E||"body",this.element[0].ownerDocument)[0])
}if(D==="disabled"&&E&&this.xhr){this.xhr.abort()
}},_initSource:function(){var D=this,F,E;
if(A.isArray(this.options.source)){F=this.options.source;
this.source=function(H,G){G(A.uibonfire.autocomplete.filter(F,H.term))
}
}else{if(typeof this.options.source==="string"){E=this.options.source;
this.source=function(H,G){if(D.xhr){D.xhr.abort()
}D.xhr=A.ajax({url:E,data:H,dataType:"json",autocompleteRequest:++C,contentType:"application/json",success:function(J,I){if(this.autocompleteRequest===C){G(J)
}},error:function(){if(this.autocompleteRequest===C){G([])
}}})
}
}else{this.source=this.options.source
}}},search:function(E,D){E=E!=null?E:this.element.val();
this.term=this.element.val();
if(E.length<this.options.minLength){return this.close(D)
}clearTimeout(this.closing);
if(this._trigger("search",D)===false){return 
}return this._search(E)
},_search:function(D){this.pending++;
this.element.addClass("uibonfire-autocomplete-loading");
this.source({term:D},this.response)
},_response:function(D){if(!this.options.disabled&&D&&D.length){D=this._normalize(D);
this._suggest(D);
this._trigger("open")
}else{this.close()
}this.pending--;
if(!this.pending){this.element.removeClass("uibonfire-autocomplete-loading")
}},close:function(D){clearTimeout(this.closing);
if(this.menu.element.is(":visible")){this.menu.element.hide();
this.menu.deactivate();
this._trigger("close",D)
}},_change:function(D){if(this.previous!==this.element.val()){this._trigger("change",D,{item:this.selectedItem})
}},_normalize:function(D){if(D.length&&D[0].label&&D[0].value){return D
}return A.map(D,function(E){if(typeof E==="string"){return{label:E,value:E}
}return A.extend({label:E.label||E.value,value:E.value||E.label},E)
})
},_suggest:function(D){var E=this.menu.element.empty().zIndex(this.element.zIndex()+1);
this._renderMenu(E,D);
this.menu.deactivate();
this.menu.refresh();
E.show();
E.width(this.element.outerWidth());
E.position(A.extend({of:this.element},this.options.position));
if(this.options.autoFocus){this.menu.next(new A.Event("mouseover"))
}},_resizeMenu:function(){var D=this.menu.element;
D.outerWidth(Math.max(D.width("").outerWidth(),this.element.outerWidth()))
},_renderMenu:function(F,E){var D=this;
A.each(E,function(G,H){D._renderItem(F,H)
})
},_renderItem:function(D,E){return A("<li></li>").data("item.autocomplete",E).append(A("<a></a>").text(E.label)).appendTo(D)
},_move:function(E,D){if(!this.menu.element.is(":visible")){this.search(null,D);
return 
}if(this.menu.first()&&/^previous/.test(E)||this.menu.last()&&/^next/.test(E)){this.element.val(this.term);
this.menu.deactivate();
return 
}this.menu[E](D)
},widget:function(){return this.menu.element
}})
}(bfjQueryoverride));
(function(F,G){F.uibonfire=F.uibonfire||{};
var D=/left|center|right/,E=/top|center|bottom/,A="center",B=F.fn.position,C=F.fn.offset;
F.fn.position=function(I){if(!I||!I.of){return B.apply(this,arguments)
}I=F.extend({},I);
var M=F(I.of),L=M[0],O=(I.collision||"flip").split(" "),N=I.offset?I.offset.split(" "):[0,0],K,H,J;
if(L.nodeType===9){K=M.width();
H=M.height();
J={top:0,left:0}
}else{if(L.setTimeout){K=M.width();
H=M.height();
J={top:M.scrollTop(),left:M.scrollLeft()}
}else{if(L.preventDefault){I.at="left top";
K=H=0;
J={top:I.of.pageY,left:I.of.pageX}
}else{K=M.outerWidth();
H=M.outerHeight();
J=M.offset()
}}}F.each(["my","at"],function(){var P=(I[this]||"").split(" ");
if(P.length===1){P=D.test(P[0])?P.concat([A]):E.test(P[0])?[A].concat(P):[A,A]
}P[0]=D.test(P[0])?P[0]:A;
P[1]=E.test(P[1])?P[1]:A;
I[this]=P
});
if(O.length===1){O[1]=O[0]
}N[0]=parseInt(N[0],10)||0;
if(N.length===1){N[1]=N[0]
}N[1]=parseInt(N[1],10)||0;
if(I.at[0]==="right"){J.left+=K
}else{if(I.at[0]===A){J.left+=K/2
}}if(I.at[1]==="bottom"){J.top+=H
}else{if(I.at[1]===A){J.top+=H/2
}}J.left+=N[0];
J.top+=N[1];
return this.each(function(){var S=F(this),U=S.outerWidth(),R=S.outerHeight(),T=parseInt(F.curCSS(this,"marginLeft",true))||0,Q=parseInt(F.curCSS(this,"marginTop",true))||0,W=U+T+(parseInt(F.curCSS(this,"marginRight",true))||0),X=R+Q+(parseInt(F.curCSS(this,"marginBottom",true))||0),V=F.extend({},J),P;
if(I.my[0]==="right"){V.left-=U
}else{if(I.my[0]===A){V.left-=U/2
}}if(I.my[1]==="bottom"){V.top-=R
}else{if(I.my[1]===A){V.top-=R/2
}}V.left=Math.round(V.left);
V.top=Math.round(V.top);
P={left:V.left-T,top:V.top-Q};
F.each(["left","top"],function(Z,Y){if(F.uibonfire.position[O[Z]]){F.uibonfire.position[O[Z]][Y](V,{targetWidth:K,targetHeight:H,elemWidth:U,elemHeight:R,collisionPosition:P,collisionWidth:W,collisionHeight:X,offset:N,my:I.my,at:I.at})
}});
if(F.fn.bgiframe){S.bgiframe()
}S.offset(F.extend(V,{using:I.using}))
})
};
F.uibonfire.position={fit:{left:function(H,I){var K=F(window),J=I.collisionPosition.left+I.collisionWidth-K.width()-K.scrollLeft();
H.left=J>0?H.left-J:Math.max(H.left-I.collisionPosition.left,H.left)
},top:function(H,I){var K=F(window),J=I.collisionPosition.top+I.collisionHeight-K.height()-K.scrollTop();
H.top=J>0?H.top-J:Math.max(H.top-I.collisionPosition.top,H.top)
}},flip:{left:function(I,K){if(K.at[0]===A){return 
}var M=F(window),L=K.collisionPosition.left+K.collisionWidth-M.width()-M.scrollLeft(),H=K.my[0]==="left"?-K.elemWidth:K.my[0]==="right"?K.elemWidth:0,J=K.at[0]==="left"?K.targetWidth:-K.targetWidth,N=-2*K.offset[0];
I.left+=K.collisionPosition.left<0?H+J+N:L>0?H+J+N:0
},top:function(I,K){if(K.at[1]===A){return 
}var M=F(window),L=K.collisionPosition.top+K.collisionHeight-M.height()-M.scrollTop(),H=K.my[1]==="top"?-K.elemHeight:K.my[1]==="bottom"?K.elemHeight:0,J=K.at[1]==="top"?K.targetHeight:-K.targetHeight,N=-2*K.offset[1];
I.top+=K.collisionPosition.top<0?H+J+N:L>0?H+J+N:0
}}};
if(!F.offset.setOffset){F.offset.setOffset=function(L,I){if(/static/.test(F.curCSS(L,"position"))){L.style.position="relative"
}var K=F(L),N=K.offset(),H=parseInt(F.curCSS(L,"top",true),10)||0,M=parseInt(F.curCSS(L,"left",true),10)||0,J={top:(I.top-N.top)+H,left:(I.left-N.left)+M};
if("using" in I){I.using.call(L,J)
}else{K.css(J)
}};
F.fn.offset=function(H){var I=this[0];
if(!I||!I.ownerDocument){return null
}if(H){return this.each(function(){F.offset.setOffset(this,H)
})
}return C.call(this)
}
}}(bfjQueryoverride));
(function(A){A.widget("uibonfire.menu",{_create:function(){var B=this;
this.element.addClass("uibonfire-menu uibonfire-widget uibonfire-widget-content uibonfire-corner-all").attr({role:"listbox","aria-activedescendant":"uibonfire-active-menuitem"}).click(function(C){if(!A(C.target).closest(".uibonfire-menu-item a").length){return 
}C.preventDefault();
B.select(C)
});
this.refresh()
},refresh:function(){var C=this;
var B=this.element.children("li:not(.uibonfire-menu-item):has(a)").addClass("uibonfire-menu-item").attr("role","menuitem");
B.children("a").addClass("uibonfire-corner-all").attr("tabindex",-1).mouseenter(function(D){C.activate(D,A(this).parent())
}).mouseleave(function(){C.deactivate()
})
},activate:function(E,D){this.deactivate();
if(this.hasScroll()){var F=D.offset().top-this.element.offset().top,B=this.element.scrollTop(),C=this.element.height();
if(F<0){this.element.scrollTop(B+F)
}else{if(F>=C){this.element.scrollTop(B+F-C+D.height())
}}}this.active=D.eq(0).children("a").addClass("uibonfire-state-hover").attr("id","uibonfire-active-menuitem").end();
this._trigger("focus",E,{item:D})
},deactivate:function(){if(!this.active){return 
}this.active.children("a").removeClass("uibonfire-state-hover").removeAttr("id");
this._trigger("blur");
this.active=null
},next:function(B){this.move("next",".uibonfire-menu-item:first",B)
},previous:function(B){this.move("prev",".uibonfire-menu-item:last",B)
},first:function(){return this.active&&!this.active.prevAll(".uibonfire-menu-item").length
},last:function(){return this.active&&!this.active.nextAll(".uibonfire-menu-item").length
},move:function(E,D,C){if(!this.active){this.activate(C,this.element.children(D));
return 
}var B=this.active[E+"All"](".uibonfire-menu-item").eq(0);
if(B.length){this.activate(C,B)
}else{this.activate(C,this.element.children(D))
}},nextPage:function(D){if(this.hasScroll()){if(!this.active||this.last()){this.activate(D,this.element.children(".uibonfire-menu-item:first"));
return 
}var E=this.active.offset().top,C=this.element.height(),B=this.element.children(".uibonfire-menu-item").filter(function(){var F=A(this).offset().top-E-C+A(this).height();
return F<10&&F>-10
});
if(!B.length){B=this.element.children(".uibonfire-menu-item:last")
}this.activate(D,B)
}else{this.activate(D,this.element.children(".uibonfire-menu-item").filter(!this.active||this.last()?":first":":last"))
}},previousPage:function(C){if(this.hasScroll()){if(!this.active||this.first()){this.activate(C,this.element.children(".uibonfire-menu-item:last"));
return 
}var D=this.active.offset().top,B=this.element.height();
result=this.element.children(".uibonfire-menu-item").filter(function(){var E=A(this).offset().top-D+B-A(this).height();
return E<10&&E>-10
});
if(!result.length){result=this.element.children(".uibonfire-menu-item:first")
}this.activate(C,result)
}else{this.activate(C,this.element.children(".uibonfire-menu-item").filter(!this.active||this.first()?":last":":first"))
}},hasScroll:function(){return this.element.height()<this.element[A.fn.prop?"prop":"attr"]("scrollHeight")
},select:function(B){this._trigger("selected",B,{item:this.active})
}})
}(bfjQueryoverride));
/* module-key = 'com.atlassian.bonfire.plugin:complete-session-resource', location = 'includes/js/sessions/complete-session.js' */
if(typeof BF=="undefined"){var BF={}
}AJS.$(function(){BF.bindCompleteSessionCommon=function(A,B){if(B&&B.$form){B.$form.find("input[type=text]").keypress(function(C){if(C.keyCode==13||C.keyCode==10){jQuery("#bonfire-complete-button").click()
}})
}};
BF.bindCompleteSubmit=function(K,G,E){K.preventDefault();
var F=G.closest("form");
var J=F.find("[name=testSessionId]").val();
var C=contextPath+"/rest/bonfire/1.0/sessions/"+J+"/complete";
var L=F.find("#bf-time-spent").val();
var A=F.find("#bf-log-time-issue");
var O="";
if(A.length!==0){O=A.val()
}var M=F.find(".bfcom-select");
var B=[];
for(var I=0,N=M.length;
I<N;
I++){var D=jQuery(M[I]).data("raised-id");
var P=M[I].value;
B.push({raisedId:D,relatedId:P})
}var H={timeSpent:L,logTimeIssueId:O,issueLinks:B};
jQuery("#error-complete-session").empty();
G[0].disabled=true;
JIRA.SmartAjax.makeRequest({url:C,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(H),contentType:"application/json",complete:function(S,T,R){if(R.successful){F.find(".cancel").click();
E()
}else{G[0].disabled=false;
var Q=JSON.parse(R.data).errors;
for(error in Q){jQuery("#error-complete-session").append("<span>"+Q[error].errorMessage+"</span><br/>")
}}}})
}
});
/* module-key = 'com.atlassian.bonfire.plugin:bonfire-common-resources', location = 'includes/js/utils/utils.js' */
if(typeof BF=="undefined"){var BF={}
}if(typeof BF.utils=="undefined"){BF.utils={}
}BF.utils.bonJSONStringify=function(B){var A=JSON.stringify(B);
if(A&&typeof (A)==="string"){if(/\?\?/.test(A)){var C="\\u003F";
A=A.replace(/\?\?/g,C+C)
}}return A
};
BF.utils.bonGetProp=function(A,B){if(!!A.prop){return A.prop(B)
}else{return A.attr(B)
}};
BF.utils.bonSetProp=function(A,C,B){if(!!A.prop){A.prop(C,B)
}else{A.attr(C,B)
}};
/* module-key = 'com.atlassian.bonfire.plugin:quick-session-dialog-resources', location = 'includes/js/quicksession/quick-session.js' */
if(typeof BF=="undefined"){var BF={}
}AJS.$(function(){var O=150;
var G=0;
var D=jQuery(window);
var H={width:430,hideDelay:null,getArrowPath:function(P){return"M0,0L11,8,0,16"
},calculatePositions:function(P,R,U,Q){var T=R.target.offset();
var S=D.scrollTop();
return{displayAbove:false,popupCss:{position:"fixed",top:T.top-O-S,left:T.left-P.width()-11,right:"auto"},arrowCss:{position:"absolute",left:P.width()-1,right:"auto",top:O}}
}};
BF.quickSessionCreate=function(R,Q){Q=Q+G;
var P=function(W){var V=D.scrollTop();
var T=jQuery("#inline-dialog-"+Q);
var S=R.offset();
var X=S.top-O-V;
var U=S.left-T.width()-11;
T.css({top:X,left:U})
};
jQuery.extend(H,{initCallback:function(){D.bind("scroll resize",P)
},hideCallback:function(){D.unbind("scroll resize",P)
},});
new AJS.InlineDialog(R,Q,function(U,T,W){var V=jQuery(T).attr("data-session-id");
var S=contextPath+"/rest/bonfire/1.0/quick-session/"+V;
JIRA.SmartAjax.makeRequest({url:S,type:"GET",dataType:"json",contentType:"application/json",complete:function(a,b,Y){var X=jQuery(U);
X.empty();
if(Y.successful){var Z={session:Y.data,contextPath:contextPath};
jQuery(BF.template.quicksession(Z)).appendTo(U);
F(U)
}else{jQuery(BF.template.quicksessionError()).appendTo(U)
}W()
}})
},H);
jQuery(document).bind("showLayer",function(U,S,T){if(S&&S==="inlineDialog"&&T&&T.id&&T.id===Q){T._validateClickToClose=function(V){if(jQuery(V.target).parents("#inline-dialog-"+T.id).length>0){return false
}return true
};
jQuery("body").unbind("click."+T.id+".inline-dialog-check")
}});
G++
};
var F=function(R){var Q=document.createElement("input");
if(!("placeholder" in Q)){var P=R.find(".bfq-placeholder");
P.each(function(){var T=jQuery(this),S=jQuery("<label/>",{"class":"bfq-placeholder-label","for":this.id,text:T.attr("placeholder"),css:{fontFamily:T.css("fontFamily"),fontSize:T.css("fontSize")}}).insertBefore(T);
T.focus(function(){S.hide()
}).bind("blur change",function(){S.toggle(!jQuery(this).val().length)
})
})
}Q=null
};
var E=function(P){jQuery(".bfq-button").addClass("bfq-not-selected");
jQuery(P).removeClass("bfq-not-selected")
};
var I=function(P){P.animate({scrollTop:P.scrollTop()+P.height()},500)
};
var M=function(P){P.find(".bfq-addinfo-edit").addClass("hidden");
P.find(".bfq-addinfo-wiki").removeClass("hidden");
P.find(".bfq-error").empty();
P.find(".bfq-info-textarea").unbind("blur",B)
};
var L=function(R){var Q=R.find(".bfq-note-display-container");
var P=R.find(".bfq-note-edit");
Q.removeClass("hidden");
P.addClass("hidden");
R.find(".bfq-edit-error").empty();
R.find(".bfq-note-textarea").unbind("blur",C);
jQuery(".bfq-edit-note").live("click",N)
};
var N=function(T){T.preventDefault();
var U=jQuery(this).closest(".bfq-note-container");
var S=U.find(".bfq-note-display-container");
var P=U.find(".bfq-note-edit");
var R=U.find(".bfq-original-note").val();
var Q=U.find(".bfq-note-textarea");
Q.val(R);
S.addClass("hidden");
P.removeClass("hidden");
Q.focus();
Q.bind("blur",C);
jQuery(".bfq-edit-note").die("click",N)
};
var J=function(Q){var R=jQuery(this).closest(".bfq-additionalInfo");
var P=R.data("blurTimeout");
if(typeof P!="undefined"){clearTimeout(P);
R.find(".bfq-info-textarea").focus()
}};
var K=function(Q){var R=jQuery(this).closest(".bfq-note-container");
var P=R.data("blurTimeout");
if(typeof P!="undefined"){clearTimeout(P);
R.find(".bfq-note-textarea").focus()
}};
var C=function(Q){var R=jQuery(this).closest(".bfq-note-container");
var P=setTimeout(function(){R.find(".bfq-note-edit-actions .bfq-submit").click()
},100);
R.data("blurTimeout",P)
};
var B=function(Q){var R=jQuery(this).closest(".bfq-additionalInfo");
var P=setTimeout(function(){R.find(".bfq-add-info-actions .bfq-submit").click()
},100);
R.data("blurTimeout",P)
};
var A=function(R,S){var Q=JSON.parse(R.data).errors;
for(error in Q){var P=Q[error].errorMessage;
if(typeof P!=="undefined"){S.append("<span>"+P+"</span><br/>")
}}};
jQuery(".bfq-addinfo-tab").live("click",function(P){jQuery(".bfq-swappable-content").addClass("hidden");
jQuery(".bfq-additionalInfo").removeClass("hidden");
E(this)
});
jQuery(".bfq-notes-tab").live("click",function(P){jQuery(".bfq-swappable-content").addClass("hidden");
jQuery(".bfq-notes").removeClass("hidden");
E(this)
});
jQuery(".bfq-addinfo-wiki.bfq-editable").live("click",function(T){var P=jQuery(this);
var U=P.closest(".bfq-additionalInfo");
P.addClass("hidden");
var Q=U.find(".bfq-addinfo-edit");
Q.removeClass("hidden");
var S=U.find(".bfq-original-addinfo").val();
var R=Q.find(".bfq-info-textarea");
R.val(S);
R.focus();
U.find(".bfq-info-textarea").bind("blur",B)
});
jQuery(".bfq-add-info-actions .bfq-cancel").live("click",function(P){P.preventDefault();
var Q=jQuery(this).closest(".bfq-additionalInfo");
M(Q)
});
jQuery(".bfq-add-info-container").live("keydown",function(P){if(P.keyCode==27){P.preventDefault();
var Q=jQuery(this).closest(".bfq-additionalInfo");
M(Q)
}if(P.ctrlKey&&(P.keyCode==13||P.keyCode==10)){P.preventDefault();
var Q=jQuery(this).closest(".bfq-additionalInfo");
Q.find(".bfq-add-info-actions .bfq-submit").click()
}});
jQuery(".bfq-add-info-actions").live("click",J);
jQuery(".bfq-add-info-container").live("click",J);
jQuery(".bfq-add-info-actions .bfq-submit").live("click",function(W){var X=jQuery(this).closest(".bfq-additionalInfo");
var V=X.find(".bfq-original-addinfo");
var Q=X.find(".bfq-addinfo-wiki");
var S=X.find(".bfq-error");
var R=X.find(".bfq-waiting-icon");
var U=X.find(".bfq-session-id").val();
var P=contextPath+"/rest/bonfire/1.0/sessions/"+U+"/additionalInfo";
var Y=X.find(".bfq-info-textarea").val();
var T={additionalInfo:Y};
S.empty();
R.removeClass("hidden");
JIRA.SmartAjax.makeRequest({url:P,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(T),contentType:"application/json",complete:function(a,b,Z){R.addClass("hidden");
if(Z.successful){if(Z.data.isEmpty){Q.html(BF.template.getNoAddInfoMsg())
}else{Q.html(Z.data.additionalInfoDisplay)
}V.text(Z.data.additionalInfoRaw);
M(X)
}else{A(Z,S)
}}})
});
jQuery(".bfq-add-note-textarea").live("focus",function(){var P=jQuery(this).closest(".bfq-notes");
P.find(".bfq-note-button").removeClass("hidden");
I(P)
});
jQuery(".bfq-add-note-textarea").live("keydown",function(P){if(P.ctrlKey&&(P.keyCode==13||P.keyCode==10)){P.preventDefault();
var Q=jQuery(this).closest(".bfq-notes");
Q.find(".bfq-note-button").click()
}});
jQuery(".bfq-note-button").live("click",function(){var U=jQuery(this).closest(".bfq-notes");
var T=U.find(".bfq-session-id").val();
var W=U.find(".bfq-add-note-textarea");
var Q=W.val();
var V=U.find(".bfq-error.bfq-addnote-error");
var R=U.find(".bfq-allnotes");
var P=contextPath+"/rest/bonfire/1.0/sessions/"+T+"/note";
var S={note:Q};
V.empty();
JIRA.SmartAjax.makeRequest({url:P,type:"POST",dataType:"json",data:BF.utils.bonJSONStringify(S),contentType:"application/json",complete:function(Y,Z,X){if(X.successful){W.val("");
R.find("em").remove();
R.append(BF.template.drawnote({note:X.data}))
}else{A(X,V)
}I(U)
}})
});
jQuery(".bfq-delete-note").live("click",function(T){T.preventDefault();
if(confirm("Are you sure you want to delete this session note?")){var U=jQuery(this).closest(".bfq-note-container");
var S=U.closest(".bfq-allnotes");
var R=U.find(".bfq-note-id").val();
var P=U.find(".bfq-error");
var Q=contextPath+"/rest/bonfire/1.0/notes/"+R;
P.empty();
JIRA.SmartAjax.makeRequest({url:Q,type:"DELETE",dataType:"json",contentType:"application/json",complete:function(X,Y,W){if(W.successful){U.remove();
var V=S.find(".bfq-note-container").size();
if(!V){S.html(BF.template.getNoNoteMsg())
}}else{A(W,P)
}}})
}});
jQuery(".bfq-note-data").live("click",function(P){var Q=jQuery(this).closest(".bfq-note-container");
Q.find(".bfq-edit-note").click()
});
jQuery(".bfq-edit-note").live("click",N);
jQuery(".bfq-note-edit-actions").live("click",K);
jQuery(".bfq-note-edit-container").live("click",K);
jQuery(".bfq-note-edit-actions .bfq-cancel").live("click",function(P){var Q=jQuery(this).closest(".bfq-note-container");
L(Q)
});
jQuery(".bfq-note-edit-container").live("keydown",function(P){if(P.keyCode==27){P.preventDefault();
var Q=jQuery(this).closest(".bfq-note-container");
L(Q)
}if(P.ctrlKey&&(P.keyCode==13||P.keyCode==10)){P.preventDefault();
var Q=jQuery(this).closest(".bfq-note-container");
Q.find(".bfq-note-edit-actions .bfq-submit").click()
}});
jQuery(".bfq-note-edit-actions .bfq-submit").live("click",function(T){var W=jQuery(this).closest(".bfq-note-container");
var P=W.find(".bfq-note-id").val();
var Q=contextPath+"/rest/bonfire/1.0/notes/"+P;
var U=W.find(".bfq-edit-error");
var X=W.find(".bfq-note-textarea").val();
var Y=W.find(".bfq-note-data");
var V=W.find(".bfq-original-note");
var R=W.find(".bfq-waiting-icon");
var S={noteData:X};
U.empty();
R.removeClass("hidden");
JIRA.SmartAjax.makeRequest({url:Q,type:"PUT",dataType:"json",data:BF.utils.bonJSONStringify(S),contentType:"application/json",complete:function(a,b,Z){R.addClass("hidden");
if(Z.successful){Y.html(Z.data.noteData);
V.text(Z.data.rawNoteData);
L(W)
}else{A(Z,U)
}}})
})
});
/* module-key = 'com.atlassian.bonfire.plugin:quick-session-dialog-resources', location = 'includes/soy/quicksession/quick-session.soy' */
// This file was automatically generated from quick-session.soy.
// Please don't edit this file by hand.

if (typeof BF == 'undefined') { var BF = {}; }
if (typeof BF.template == 'undefined') { BF.template = {}; }


BF.template.quicksession = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-main-container"><div class="bfq-header"><div class="bfq-name-container"><a href="', soy.$$escapeHtml(opt_data.contextPath), '/secure/ViewSession.jspa?testSessionId=', soy.$$escapeHtml(opt_data.session.id), '" class="bfq-session-name" title="', soy.$$escapeHtml(opt_data.session.name), '">', soy.$$escapeHtml(opt_data.session.name), '</a></div><div class="bfq-button-container"><span class="bfq-button bfq-first bfq-addinfo-tab">', soy.$$escapeHtml("Additional Information"), '</span><span class="bfq-button bfq-last bfq-not-selected bfq-notes-tab">', soy.$$escapeHtml("Notes"), '</span></div></div><div class="bfq-main-content"><div class="bfq-swappable-content bfq-additionalInfo"><div class="bfq-addinfo-wiki ', (opt_data.session.canEditSession) ? 'bfq-editable' : '', '" ', (opt_data.session.canEditSession) ? 'title="' + soy.$$escapeHtml("Click to edit") + '"' : '', '>', (opt_data.session.hasAdditionalInfo) ? opt_data.session.additionalInfo : (opt_data.session.canEditSession) ? '<em>' + soy.$$escapeHtml("Click here to add Additional Information") + '</em>' : soy.$$escapeHtml("There is no Additional Information for this session."), '</div>');
  if (opt_data.session.canEditSession) {
    output.append('<input class="bfq-session-id" type="hidden" value="', soy.$$escapeHtml(opt_data.session.id), '"/><textarea class="bfq-original-addinfo hidden">', soy.$$escapeHtml(opt_data.session.rawAdditionalInfo), '</textarea><div class="bfq-addinfo-edit hidden"><div class="bfq-error"></div><div class="bfq-add-info-container"><textarea class="bfq-info-textarea"></textarea></div><div class="bfq-inline-button-container bfq-add-info-actions">');
    BF.template.drawInlineEditButtons(null, output);
    output.append('</div></div>');
  }
  output.append('</div><div class="bfq-swappable-content bfq-notes hidden"><input class="bfq-session-id" type="hidden" value="', soy.$$escapeHtml(opt_data.session.id), '"/><div class="bfq-allnotes bfq-table">');
  if (opt_data.session.hasNotes) {
    var noteList53 = opt_data.session.notes;
    var noteListLen53 = noteList53.length;
    for (var noteIndex53 = 0; noteIndex53 < noteListLen53; noteIndex53++) {
      var noteData53 = noteList53[noteIndex53];
      BF.template.drawnote({note: noteData53}, output);
    }
  } else {
    output.append('<em>', soy.$$escapeHtml("There are no notes for this session yet."), '</em>');
  }
  output.append('</div>', (opt_data.session.canAddNote) ? '<div class="bfq-add-note-container"><textarea class="bfq-add-note-textarea bfq-placeholder" placeHolder="Add Note"></textarea></div><div class="bfq-error bfq-addnote-error"></div><div class="bfq-add-note-actions"><span class="bfq-note-button hidden">Add Note</span></div>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};


BF.template.drawnote = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-note-container"><input class="bfq-note-id" type="hidden" value="', soy.$$escapeHtml(opt_data.note.id), '"/><div class="bfq-note-left"><img src="', soy.$$escapeHtml(opt_data.note.userIconUrl), '" title="Author: ', soy.$$escapeHtml(opt_data.note.authorDisplayName), '" width="32px" height="32px"/></div><div class="bfq-note-right"><div class="bfq-note-display-container"><div class="bfq-note-data ', (opt_data.note.canEdit) ? 'bfq-editable' : '', '" ', (opt_data.note.canEdit) ? 'title="' + soy.$$escapeHtml("Click to edit") + '"' : '', '>', opt_data.note.noteData, '</div><div class="bfq-error"></div><div class="bfq-note-ops"><span class="bfq-timestamp">', soy.$$escapeHtml(opt_data.note.createdDate), ' ', soy.$$escapeHtml(opt_data.note.createdTime), '</span>', (opt_data.note.canEdit) ? '<a href="#" class="bfq-note-op bfq-edit-note" title="' + soy.$$escapeHtml("Click to edit") + '">edit</a><a href="#" class="bfq-note-op bfq-delete-note" title="' + soy.$$escapeHtml("Click to delete") + '">delete</a>' : '', '</div></div>');
  if (opt_data.note.canEdit) {
    output.append('<textarea class="bfq-original-note hidden">', soy.$$escapeHtml(opt_data.note.rawNoteData), '</textarea><div class="bfq-note-edit hidden"><div class="bfq-edit-error"></div><div class="bfq-note-edit-container"><textarea class="bfq-note-textarea"></textarea></div><div class="bfq-inline-button-container bfq-note-edit-actions">');
    BF.template.drawInlineEditButtons(null, output);
    output.append('</div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


BF.template.getNoAddInfoMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<em>', soy.$$escapeHtml("Click here to add Additional Information"), '</em>');
  return opt_sb ? '' : output.toString();
};


BF.template.getNoNoteMsg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<em>', soy.$$escapeHtml("There are no notes for this session yet."), '</em>');
  return opt_sb ? '' : output.toString();
};


BF.template.drawInlineEditButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bfq-waiting-icon hidden"></span><button class="bfq-inline-edit-buttons bfq-submit" type="submit"><span class="bfq-inline-edit-button-icons bfq-tick-icon"></span></button><button class="bfq-inline-edit-buttons bfq-cancel" type="cancel" class="cancel" href="#"><span class="bfq-inline-edit-button-icons bfq-cross-icon"></span></button>');
  return opt_sb ? '' : output.toString();
};


BF.template.quicksessionError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="bfq-main-container bfq-error-main"><div class="bfq-error-container"><div class="aui-message error shadowed"><span class="aui-icon icon-error"></span><p>', soy.$$escapeHtml("Session was not found. The session or the project it belonged to may have been deleted. Please check that the session still exists on the server. "), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.bonfire.plugin:bonfire-test-session-dialog', location = 'includes/js/sessions/test-session-dialog.js' */
AJS.$(function(){if(!AJS.FormPopup){AJS.FormPopup=JIRA.FormDialog
}var F=function(){AJS.reloadViaWindowLocation(window.location.href)
};
var C={data:{inline:true,decorator:"dialog"}};
var G=function(L,K){var I={preMsg:L.getResponseHeader("X-Atlassian-Dialog-Msg-Html-Pre"),postMsg:L.getResponseHeader("X-Atlassian-Dialog-Msg-Html-Post")};
if(I.preMsg){I.msg=I.preMsg+K+I.postMsg;
var J=L.getResponseHeader("X-Atlassian-Dialog-Msg-Type");
I.type=J?J.toUpperCase():J;
I.closeable=(L.getResponseHeader("X-Atlassian-Dialog-Msg-Closeable")==="true");
I.target=L.getResponseHeader("X-Atlassian-Dialog-Msg-Target");
return I
}};
var D=function(){if(JIRA.SessionStorage){var L="jira.messages.reloadMessageMsg",I="jira.messages.reloadMessageType",K="jira.messages.reloadMessageCloseable",J="jira.messages.reloadMessageTarget";
JIRA.SessionStorage.removeItem(L);
JIRA.SessionStorage.removeItem(I);
JIRA.SessionStorage.removeItem(K);
JIRA.SessionStorage.removeItem(J)
}};
var B=function(L,M,N,J){if(this.options.bonfireStayOnPage){var K=AJS.escapeHtml(jQuery(this.$form).find("#ex-session-name").val());
var I=G(M,K);
if(I){if(JIRA.Messages===undefined){Bonfire.Messages.showMsg(I)
}else{JIRA.Messages.showMsg(I.msg,{type:JIRA.Messages.Types[I.type],closeable:I.closeable,target:I.target});
D()
}}}};
var E=function(J,K,L,I){if(this.options.bonfireStayOnPage){return 
}F()
};
new AJS.FormPopup({trigger:"#create-test-session.no-refresh",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:".bf-create-session.no-refresh",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#create-test-session:not(.no-refresh)",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:".issueaction-create-test-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#clone-test-session",autoClose:true,bonfireStayOnPage:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#assign-test-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#edit-test-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#delete-test-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#pause-test-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#unshare-test-session-confirm",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:"#add-raised-to-session",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:".bf-add-raised-issues-link",autoClose:true,onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
new AJS.FormPopup({trigger:'a[title="Create Test Session"][class="aui-list-item-link"]',onSuccessfulSubmit:B,onDialogFinished:E,ajaxOptions:C});
jQuery(document).bind("dialogContentReady",function(J,K){var I=bfjQueryoverride("#ex-assignee");
I.autocomplete({source:function(M,L){jQuery.getJSON(contextPath+"/rest/bonfire/latest/userSearch",M,function(N){L(N.searchResult)
})
},minLength:1});
AJS.$(document.body).find(".bonfire-issuepicker").each(function(){var M=AJS.$(this);
var L=274;
new JIRA.IssuePicker({element:M,width:L,uppercaseUserEnteredOnSelect:true});
AJS.$("#"+M.attr("id")+"-textarea").attr("tabindex",M.attr("tabindex"))
});
BF.bindCompleteSessionCommon(J,K);
jQuery("#bonfire-complete-button").bind("click",function(M){var L=jQuery(this);
BF.bindCompleteSubmit(M,L,F)
})
});
jQuery(".bf-twixy").live("click",function(J){var I=jQuery(this);
I.toggleClass("bf-twix-open")
});
var A=function(J,I){JIRA.SmartAjax.makeRequest({url:J,type:I,dataType:"json",contentType:"application/json",complete:function(L,M,K){F()
}})
};
jQuery(".bf-delete-raised-in").live("click",function(J){J.preventDefault();
if(confirm("Are you sure you want to remove this issue from this Test Session's list of raised issues?")){var I=this.href;
A(I,"DELETE")
}});
jQuery(".gf-post-trigger").live("click",function(J){J.preventDefault();
var I=this.href;
A(I,"POST")
});
jQuery(".gf-delete-trigger").live("click",function(J){J.preventDefault();
var I=this.href;
A(I,"DELETE")
});
new AJS.FormPopup({trigger:".gf-dialog-link-trigger",autoClose:true,onDialogFinished:E,ajaxOptions:C});
CompleteDialog=AJS.FormPopup.extend({_submitForm:function(I){I.preventDefault()
}});
new CompleteDialog({trigger:"#gf-complete-dialog",autoClose:true,onSuccessfulSubmit:E,onUnSuccessfulSubmit:E,onDialogFinished:E,ajaxOptions:C,width:"100%"});
var H=function(){jQuery.each(jQuery(".bf-view-session-button"),function(){var J="bf-dialog";
var K=jQuery(this);
BF.quickSessionCreate(K,J)
});
try{AJS.Dropdown.create({trigger:jQuery(".bf-more-button .bf-more-trigger"),content:jQuery(".bf-more-button .aui-list"),alignment:AJS.RIGHT})
}catch(I){}};
H();
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(K,I,J){H()
})
});
/* module-key = 'com.atlassian.bonfire.plugin:bonfire-test-session-dialog', location = 'includes/js/msg/bonfire-client-msg.js' */
jQuery.namespace("Bonfire.Messages");
Bonfire.Messages.showMsg=function(B){var D=function(I){var F=jQuery("body").width();
var G=jQuery("#header");
var H=G.offset().top+G.outerHeight()+10;
I.width("auto");
I.css({width:"auto",left:(F-I.width())/2,top:H,margin:0,padding:"1em"})
};
var A=jQuery(B.target||"#session-top-bar");
var E=jQuery("<div>");
E.addClass("bonfire-msg aui-message "+B.type.toLowerCase());
E.html(B.msg);
E.prependTo(A);
D(E);
var C={opacity:0.2};
E.delay(700).animate(C,2000,function(){E.remove()
})
};
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'templates/share-dialog.soy' */
// This file was automatically generated from share-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.Share == 'undefined') { JIRA.Templates.Dialogs.Share = {}; }


JIRA.Templates.Dialogs.Share.contentPopup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form share-content-popup ', (opt_data.shareData.issue) ? ' viewissue ' : (opt_data.shareData.filter) ? ' issuenav ' : '', '">');
  JIRA.Templates.Dialogs.Share.shareLink(opt_data, output);
  output.append('<fieldset class="padding">');
  if (opt_data.showForm) {
    JIRA.Templates.Dialogs.Share.shareForm(opt_data, output);
  } else {
    JIRA.Templates.Dialogs.Share.disabledMailMessage(soy.$$augmentData(opt_data.isAdmin, {isAdmin: opt_data.isAdmin}), output);
  }
  output.append('</fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label for="sharenames-multi-select">', soy.$$escapeHtml("User name or email"), '</label><div class="autocomplete-user-target"><select id="sharenames" name="sharenames" class="share-user-picker hidden" multiple="multiple"></select></div><ol class="recipients"></ol><div><label for="note">', soy.$$escapeHtml("Note"), '</label></div><textarea class="textarea long-field" id="note" placeholder="', soy.$$escapeHtml("Add an optional note"), '"/><div class="button-panel"><div class="status"><div class="icon"></div><div class="progress-messages"></div></div><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" id="submitShare" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button submit" type="submit" value="', soy.$$escapeHtml("Share"), '" disabled/> <a accesskey="', soy.$$escapeHtml("`"), '" id="cancelShare" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="close-dialog" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.disabledMailMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (! opt_data.isAdmin) {
    aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. Please contact your JIRA administrator to enable sharing.") + '</p>', extraClasses: 'disabled-mail-message'}, output);
  } else {
    aui.message.generic({content: '<p>' + soy.$$escapeHtml("Outgoing mail is not configured. You can configure it here") + '<a class="aui-list-item-link" id="configure_mail_server" href="' + soy.$$escapeHtml("") + '/secure/admin/OutgoingMailServers.jspa"><em> ' + soy.$$escapeHtml("Outgoing mail") + '</em></a>.</p>', extraClasses: 'disabled-mail-message'}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.Share.shareLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.shareData.permlink) ? '<div class="issuenav-permalink padding"><label>' + ((opt_data.shareData.issue) ? soy.$$escapeHtml("Link to Issue") : (opt_data.shareData.filter) ? soy.$$escapeHtml("Link to Filter") : '') + '</label><input class="permalink text long-field" value="' + soy.$$escapeHtml(opt_data.shareData.permlink) + '" readonly></div>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-user-multi-select.js' */
(function($){function createShareUserPicker(ctx){$(".share-user-picker",ctx).each(function(){var control=new JIRA.MultiUserListPicker({layerId:$(this).attr("id")+"-layer",element:$(this),freeEmailInput:true});$(document).trigger("ready.multi-select.share-user",control)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createShareUserPicker(context)}})}(AJS.$));
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources', location = 'js/share-dialog.js' */
JIRA.JiraSharePlugin={};JIRA.JiraSharePlugin.SharePluginDialog=function($){var shareDialog,currentShareLink,dialogContents,allowDialogHide=true;this.resetAndHide=function resetAndHide(){$(document).one("hideLayer",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){$(document).unbind(".share-dialog");dialogContents.empty();dialogContents=undefined;currentShareLink=undefined}});return this.hideDialog()};this.hideDialog=function hideDialog(){shareDialog.hide();return false};function getUsernameValue(){return $(this).attr("data-username")}function getEmailValue(){return $(this).attr("data-email")}this._buildSendShareUrl=function buildSendShareUrl(options,data){var url=AJS.contextPath()+"/rest/share/1.0";if(options.issue){url+="/issue/"+options.issueKey}else{if(options.filter){if(options.filterId){url+="/filter/"+options.filterId}else{data.jql=options.jql;url+="/search"}}}return url};this._successShareHandler=function successShareHandler(){var icon=dialogContents.find(".button-panel .icon");icon.removeClass("throbber loading").addClass("icon-tick");var messages=dialogContents.find(".progress-messages");messages.removeClass("sending").addClass("success").text("Sent");setTimeout(_.bind(this.resetAndHide,this),1000)};this._errorShareHandler=function errorShareHandler(){var icon=dialogContents.find(".button-panel .icon");icon.removeClass("throbber loading").addClass("icon-cross");var messages=dialogContents.find(".progress-messages");messages.removeClass("sending").addClass("error").text("Error while sending")};this._sendShare=function sendShare(data,options){$("button,input,textarea",this).attr("disabled","disabled");var icon=dialogContents.find(".button-panel .icon");icon.addClass("throbber loading");var messages=dialogContents.find(".progress-messages");messages.text("Sending");messages.addClass("sending");var url=this._buildSendShareUrl(options,data);JIRA.trace("jira.plugins.share.send",_.defaults({url:url},data));var requestOptions={type:"POST",contentType:"application/json",dataType:"json",url:url,data:JSON.stringify(data),success:_.bind(this._successShareHandler,this),error:_.bind(this._errorShareHandler,this)};JIRA.SmartAjax.makeRequest(requestOptions)};this._collectMailData=function collectMailData(){var recipients=dialogContents.find(".recipients");var users=recipients.find("li[data-username]").map(getUsernameValue).toArray();var emails=recipients.find("li[data-email]").map(getEmailValue).toArray();if(!(users.length||emails.length)){return false}var message=dialogContents.find("#note").val();var data={usernames:users,emails:emails,message:message};return data};this.submit=function submit(shareData){var mailData=this._collectMailData();if(mailData){this._sendShare(mailData,shareData)}return false};this._enableSubmit=function enableSubmit(enabled){dialogContents.find(".submit").prop("disabled",!enabled)};this.enableAccessKeys=function enableAccessKeys(shareDialogForm){$(shareDialogForm).handleAccessKeys({selective:false})};this._getShareData=function getShareData(trigger){var $trigger=jQuery(trigger),shareTarget,permlinkFull;if($trigger.hasClass("viewissue-share")){shareTarget="issue";permlinkFull=AJS.Meta.get("viewissue-permlink")}else{if($trigger.hasClass("issuenav-share")){shareTarget="filter";permlinkFull=AJS.Meta.get("issuenav-permlink")}}var shareData={issueKey:JIRA.Meta.getIssueKey(),filterId:AJS.Meta.get("filter-id"),jql:AJS.Meta.get("filter-jql"),permlink:permlinkFull};shareData[shareTarget]=true;return shareData};this._enableSubmitWhenIsRecipient=function enableSubmitWhenIsRecipient(){var shareNames=dialogContents.find("#sharenames").val();var isUserProvided=(shareNames!=null)&&(shareNames.length>0);this._enableSubmit(isUserProvided)};this._addInteractionHandlersToDialog=function addInteractionHandlersToDialog(shareData){dialogContents.find("#sharenames").bind("change unselect",_.bind(this._enableSubmitWhenIsRecipient,this));dialogContents.find(".close-dialog").click(_.bind(this.resetAndHide,this));dialogContents.find("form").submit(_.bind(this.submit,this,shareData));dialogContents.find(".issuenav-permalink .text").click(function(e){e.target.select();return false});$(document).bind("keyup.share-dialog",_.bind(function(e){if(e.keyCode===$.ui.keyCode.ESCAPE){return this.hideDialog()}return true},this));$(document).bind("showLayer.share-dialog",function(e,type,dialog){if(type==="inlineDialog"&&dialog.popup===shareDialog){dialogContents.find("#sharenames-textarea").focus()}})};this._renderDialogContent=function renderDialogContent(shareData){dialogContents.html(JIRA.Templates.Dialogs.Share.contentPopup({shareData:shareData,modifierKey:AJS.Meta.get("keyboard-accesskey-modifier"),showForm:AJS.Meta.get("outgoing-mail-enabled"),isAdmin:AJS.Meta.get("is-admin")}))};this._generatePopup=function generatePopup(contents,trigger,doShowPopup){var shareData=this._getShareData(trigger);if(dialogContents&&currentShareLink===shareData.permlink){dialogContents=contents;doShowPopup();return }currentShareLink=shareData.permlink;dialogContents=contents;this._renderDialogContent(shareData);if($.browser.msie){dialogContents.find("form").ieImitationPlaceholder()}this._enableSubmit(false);this._addInteractionHandlersToDialog.call(this,shareData);this.enableAccessKeys($("form",dialogContents));doShowPopup();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[dialogContents,JIRA.CONTENT_ADDED_REASON.shareDialogOpened])};this._scrollIntoViewForAuto=function _scrollIntoViewForAuto(){var self=this;var $context=$(this.context);$context.scrollIntoViewForAuto({complete:function(){var scrollers=$(this).add(window);_.delay(function(){scrollers.one("scroll",function(){AJS.$(document.activeElement).blur();self.hideDialog()})},20)}})};this._createDialogOptions=function _createDialogOptions(dialogId){var offsetX=(dialogId.indexOf("issuenav")!==-1)?-110:-170;var dialogOptions={preHideCallback:function(){return allowDialogHide},hideCallback:function(){$(".dashboard-actions .explanation").hide()},offsetY:17,offsetX:offsetX,hideDelay:3600000,useLiveEvents:true,initCallback:_.bind(this._scrollIntoViewForAuto,this)};return dialogOptions};this._addAJSInlineLayerEventHandlers=function _addAJSInlineLayerEventHandlers(){JIRA.bind(AJS.InlineLayer.EVENTS.beforeShow,function(e,layer,id){if(id==="sharenames-layer"){allowDialogHide=false}});JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(e,layer,reason,id){if(id==="sharenames-layer"){setTimeout(function(){allowDialogHide=true},0)}})};this._initShareDialog=function _initShareDialog(dialogId,context){var self=this;this.context=context;this._addAJSInlineLayerEventHandlers();var dialogOptions=this._createDialogOptions(dialogId);shareDialog=AJS.InlineDialog($(context),dialogId,_.bind(self._generatePopup,self),dialogOptions);shareDialog[0].popup._validateClickToClose=function(event){return validationResult=shareDialog.has(event.target).length===0};$(context).live("click",function(){if(shareDialog.find(".contents:visible").length){shareDialog.find("a.close-dialog").click()}});$(document).bind("keydown",function(e){if(e.keyCode===$.ui.keyCode.ESCAPE&&AJS.InlineDialog.current!==shareDialog&&shareDialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}shareDialog.hide()}})};this._overrideContents=function overrideContents(newContents){dialogContents=newContents};this._getCurrentDialogContent=function getCurrentDialogContent(){return dialogContents};this._getAllowDialogHide=function _getAllowDialogHide(){return allowDialogHide}};
/* module-key = 'com.atlassian.jira.jira-share-plugin:share-resources-init', location = 'js/share-dialog-init.js' */
JIRA.JiraSharePlugin.viewIssueDialog=new JIRA.JiraSharePlugin.SharePluginDialog(AJS.$);JIRA.JiraSharePlugin.issueNavDialog=new JIRA.JiraSharePlugin.SharePluginDialog(AJS.$);AJS.toInit(_.bind(JIRA.JiraSharePlugin.viewIssueDialog._initShareDialog,JIRA.JiraSharePlugin.viewIssueDialog,"share-entity-popup-viewissue","#jira-share-trigger.viewissue-share"));AJS.toInit(_.bind(JIRA.JiraSharePlugin.issueNavDialog._initShareDialog,JIRA.JiraSharePlugin.issueNavDialog,"share-entity-popup-issuenav","#jira-share-trigger.issuenav-share"));
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;
/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){params=params||{};function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var i,item;var unwrap=["context","inputField","button","displayArea"];for(i in unwrap){item=unwrap[i];if(params[item] instanceof jQuery){params[item]=params[item][0]}}var tmp=["inputField","displayArea","button"];for(i in tmp){item=tmp[i];if(typeof params[item]==="string"){var escapedSelector="#"+params[item].escapejQuerySelector();var el=jQuery(params.context||document.body).find(escapedSelector);params[item]=el[0]}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
define("jira/autocomplete/autocomplete",["jira/ajs/ajax/smart-ajax","jira/util/objects","jquery"],function(SmartAjax,Objects,jQuery){return function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=Objects.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){callback.call(this)}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}()});AJS.namespace("jira.widget.autocomplete",null,require("jira/autocomplete/autocomplete"));AJS.namespace("JIRA.AutoComplete",null,require("jira/autocomplete/autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
define("jira/autocomplete/rest-autocomplete",["jira/autocomplete/autocomplete","jira/util/objects"],function(AutoComplete,Objects){return function(){var that=Objects.begetObject(AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}()});AJS.namespace("jira.widget.autocomplete.REST",null,require("jira/autocomplete/rest-autocomplete"));AJS.namespace("JIRA.RESTAutoComplete",null,require("jira/autocomplete/rest-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
define("jira/autocomplete/issue-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var IssueAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/issues/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.sections).each(function(){var section=this;var subSection=jQuery("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(jQuery("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(jQuery("<li/>").append(subSection).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}));if(section.msg){var msg=jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(jQuery("<li/>").append(msg).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=jQuery("<li/>").append(jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(jQuery("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(jQuery("<tr/>").append(jQuery("<td/>").append(jQuery("<img/>").attr("src",imgUrl))).append(jQuery("<td/>").append(jQuery("<div/>").addClass("yak").html(this.keyHtml))).append(jQuery("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};IssueAutoComplete.init=function(){jQuery("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(jQuery(this)),$container=jQuery("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=jQuery("#"+params.fieldId);if($formElement){jQuery.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};return IssueAutoComplete});AJS.namespace("jira.widget.autocomplete.Issues",null,require("jira/autocomplete/issue-autocomplete"));AJS.namespace("JIRA.IssueAutoComplete",null,require("jira/autocomplete/issue-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
define("jira/autocomplete/user-autocomplete",["jira/autocomplete/rest-autocomplete","jira/data/parse-options-from-fieldset","jira/util/browser","jira/util/elements","jira/util/objects","jquery"],function(RESTAutoComplete,parseOptionsFromFieldset,Browser,Elements,Objects,jQuery){var UserAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!Browser.isSelenium()&&!Elements.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);jQuery(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};UserAutoComplete.init=function(parent){jQuery("fieldset.user-picker-params",parent).each(function(){var params=parseOptionsFromFieldset(jQuery(this)),field=(params.fieldId||params.fieldName),$container=jQuery("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(jQuery.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};return UserAutoComplete});AJS.namespace("jira.widget.autocomplete.Users",null,require("jira/autocomplete/user-autocomplete"));AJS.namespace("JIRA.UserAutoComplete",null,require("jira/autocomplete/user-autocomplete"));
/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};
/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});
/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();
/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<span class="remove-recipient item-delete"/>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){var IssuePicker=MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){jQuery(response.sections).each(function(i,section){var groupDescriptor=new GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){groupDescriptor.addItem(new ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=jQuery.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return jQuery("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});IssuePicker.callback=null;return IssuePicker});AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker"));AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker"));AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
define("jira/field/label-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){return MultiSelect.extend({_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(jQuery.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(jQuery.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){jQuery.each(data.suggestions,function(){optgroup.addItem(new ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=jQuery.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}})});AJS.namespace("AJS.LabelPicker",null,require("jira/field/label-picker"));AJS.namespace("JIRA.LabelPicker",null,require("jira/field/label-picker"));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){JIRA.ComponentPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Component"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingDescriptor=_.find(allExistingDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingDescriptor){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Component.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.ComponentPicker({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){var IssuePicker=require("jira/field/issue-picker");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");function initIssuePicker(el){$(el||document.body).find(".aui-field-issuepicker").each(function(){new IssuePicker({element:$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){initIssuePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
define("jira/field/label-picker-factory",["jira/field/label-picker","jira/data/parse-options-from-fieldset","jquery","exports"],function(LabelPicker,parseOptionsFromFieldset,$,exports){exports.createPicker=function($fieldset,context){var opts=parseOptionsFromFieldset($fieldset),$select=$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}});(function(){var LabelPickerFactory=require("jira/field/label-picker-factory");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");var FIELDSET_SELECTOR="fieldset.labelpicker-params";function locateFieldset(parent){var $parent=$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){LabelPickerFactory.createPicker($fieldset,context)}})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){JIRA.VersionPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Version"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingVersionDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingVersion=_.find(allExistingVersionDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingVersion){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Version.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.VersionPicker({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.backgroundImages=this.removeBackgroundImages(options.issueTypeSelect);this.$refIssueTypeSelect=jQuery(options.issueTypeSelect).clone(true,true);this.$issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=this.getProjectIssueTypeSchemesFromDom();this.issueTypesSchemeDefaults=this.getIssueTypeSchemeIssueDefaults();if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));if(this.$project.is("select")){this.$project.change(function(){var val=instance.$project.val();instance.lastIssueType=instance.$issueTypeSelect.find(":selected:first").val();instance.$refIssueTypeSelect.val("");instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));instance.$issueTypeSelect.trigger("reset")})}}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},removeBackgroundImages:function(issueTypeSelect){var map={};jQuery(issueTypeSelect).find("option[style]").each(function(){map[jQuery(this).attr("id")]=jQuery(this).css("background-image");jQuery(this).attr("style","");jQuery(this).removeAttr("style")});return map},addBackgroundImages:function(){var that=this;this.$issueTypeSelect.find("option").each(function(){jQuery(this).css("background-image",that.backgroundImages[jQuery(this).attr("id")])})},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType,instance=this,$toSelect,$placeholder=jQuery("<span class='hidden' />"),$optgroups=this.$refIssueTypeSelect.find("optgroup");$placeholder.insertAfter(this.$issueTypeSelect);this.$issueTypeSelect.detach().empty();if($optgroups.length){$optgroups.each(function(){var $optgroup=jQuery(this);if($optgroup.is("[data-scheme-id='"+issueTypeSchemeId+"']")){instance.$issueTypeSelect.append($optgroup.clone(true).children());return false}})}else{this.$issueTypeSelect.append(this.$refIssueTypeSelect.children())}selectedIssueType=this.$issueTypeSelect.find("option[data-selected]").val()||"";if(instance.lastIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+instance.lastIssueType+"']")}else{if(selectedIssueType){$toSelect=this.$issueTypeSelect.find("option[value='"+selectedIssueType+"']")}}if($toSelect&&$toSelect.length!==0){$toSelect.attr("selected","selected");this.$issueTypeSelect.val($toSelect.val())}else{this.setDefaultIssueType(issueTypeSchemeId)}this.$issueTypeSelect.insertAfter($placeholder);this.addBackgroundImages();this.$issueTypeSelect.attr("data-project",this.$project.val());$placeholder.remove()},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId);if(defaultIssueType!==""){this.$issueTypeSelect.find("option[value='"+defaultIssueType+"']").attr("selected","selected")}else{this.$issueTypeSelect.find("option").each(function(i,option){if(this.value&&this.value!==""){jQuery(option).attr("selected","selected");return false}})}},getProjectIssueTypeSchemesFromDom:function(){var projectIssueTypes={};this.$projectIssueTypesSchemes.find("input").each(function(i,input){var $input=jQuery(input),project=$input.attr("title"),issueTypes=$input.val();projectIssueTypes[project]=issueTypes});return projectIssueTypes},getIssueTypeSchemeIssueDefaults:function(){var issueTypesSchemeDefaults={};this.$issueTypeSchemeIssueDefaults.find("input").each(function(i,input){var $input=jQuery(input),issueTypeScheme=$input.attr("title"),defaultIssueType=$input.val();issueTypesSchemeDefaults[issueTypeScheme]=defaultIssueType});return issueTypesSchemeDefaults}});
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body"),$project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=$ctx.find(".issuetype-field"),$projectIssueTypes=$ctx.find(".project-issue-types"),$defaultProjectIssueTypes=$ctx.find(".default-project-issue-type");$project.each(function(i){new JIRA.ProjectIssueTypeSelect({project:jQuery(this),issueTypeSelect:$issueTypeSelect.eq(i),projectIssueTypesSchemes:$projectIssueTypes.eq(i),issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes.eq(i)})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createissueTypePicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){function createProjectPicker(context){context.find(".project-field").each(function(){new AJS.SingleSelect({element:this,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);
/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");require("jira/jquery/plugins/attachment/inline-attach");function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){createInlineAttach(context)}})})();
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(C,A,B){jQuery(this).trigger(C,A);
if(B&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(E,D){jQuery(AJS).trigger(D+"."+C,A)
})
}return this
};
Class.prototype.bind=function(A,B){jQuery(this).bind(A,B);
return this
};
JIRA.makePropertyFunc=function(A){if(jQuery.isFunction(A)){return A
}else{return function(){return A
}
}};
JIRA.Dialog.getAttrFromActiveTrigger=function(B){var C=JIRA.Dialog.current,A=C.$activeTrigger;
if(A){return A.attr(B)
}};
JIRA.Dialog.getIssueActionTitle=function(B){var A=JIRA.Dialog.getActionIssueKey();
if(!A){return B
}return B+" : "+A
};
JIRA.Dialog.getActionIssueKey=function(){var A=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");
if(!A&&JIRA.Issue){A=JIRA.Issue.getIssueKey()
}if(!A&&JIRA.IssueNavigator){A=JIRA.IssueNavigator.getSelectedIssueKey()
}if(!A&&JIRA.Issues){A=JIRA.Issues.Api.getSelectedIssueKey()
}return A
};
JIRA.activateTabWithChild=function(E){var C,B,A,D=E.closest(".tabs-pane");
if(D.length){B=D.closest(".aui-tabs");
C=D.attr("id");
A=B.find("a[href='#"+C+"']");
A.click()
}};
JIRA.applyErrorsToForm=function(C,D){var B,A=[];
jQuery.each(D,function(F,I){var H,E,G=C.find(":input[name='"+F+"']").last();
if(G.length===1){if(!B){B=G
}E=jQuery("<div class='error' />").attr("data-field",F).text(I);
H=G.closest(".field-group, .group");
H.find(".error").remove();
H.append(E)
}else{if(G.length===0){A.push(I)
}}});
if(A.length>0){JIRA.applyErrorMessageToForm(C,JIRA.Templates.Issue.undealtErrors({errors:A}))
}JIRA.activateTabWithChild(C.find(".error:first"));
if(B){B.focus()
}};
JIRA.extractScripts=function(B){var A=jQuery(B);
return{html:A.not("script"),scripts:A.filter("script")}
};
JIRA.applyMessageToForm=function(A,C,B,E){var D=C.find(".aui-message-context");
if(!D.length){D=jQuery("<div class='aui-message-context' />");
if(JIRA.useLegacyDecorator()){D.prependTo(C.find(".content-body"))
}else{D.prependTo(C.find(".form-body"))
}}D.empty();
AJS.messages[A](D,{shadowed:false,closeable:E,body:B})
};
JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")
};
JIRA.applyErrorMessageToForm=function(B,A){return JIRA.applyMessageToForm("error",B,A,false)
};
JIRA.applySuccessMessageToForm=function(B,A){return JIRA.applyMessageToForm("success",B,A,true)
};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(A){this.userFieldsResource=A.userFieldsResource;
this.fieldsResource=A.fieldsResource;
this.retainedFields=[];
this._hasRetainFeature=false;
this._hasVisibilityFeature=true
},getFieldsResource:function(){return this.fieldsResource
},getAtlToken:function(){return this.atlToken
},getFormToken:function(){return this.formToken
},getActiveFieldIds:function(){return this.getUserFields()
},addFieldToRetainValue:function(A){if(this._hasRetainFeature){this.removeFieldToRetainValue(A);
this.retainedFields.push(A)
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},clearRetainedFields:function(){this.retainedFields=[]
},removeFieldToRetainValue:function(B){if(this._hasRetainFeature){var A=jQuery.inArray(B,this.retainedFields);
if(A!=-1){this.retainedFields.splice(A,1)
}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields
}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},hasRetainedValue:function(A){if(this._hasRetainFeature){return jQuery.inArray(A.id,this.retainedFields)!==-1
}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")
}},refresh:function(C){var A=this,B=jQuery.Deferred(),D;
if(C){D=C+"&retainValues=true"
}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:D,success:function(E){A.atlToken=E.atl_token;
A.formToken=E.formToken;
A.fields=E.fields;
A.sortedTabs=E.sortedTabs;
A.userPreferences=E.userPreferences
},complete:function(F,G,E){if(E.successful){B.resolveWith(A,arguments)
}else{A.triggerEvent("serverError",[E]);
B.rejectWith(A,[E])
}}});
return B.promise()
},setFields:function(A){this.fields=A
},getConfigurableFields:function(){return this.getFields()
},getFields:function(){var A=this,B=jQuery.Deferred();
if(!this.fields){this.refresh().done(function(){B.resolve(A.fields)
})
}else{B.resolve(A.fields)
}return B.promise()
},_mungeTabs:function(B){var A=0,C=[];
jQuery.each(B,function(D,E){A++;
if(E.tab){if(!C[E.tab.position]){C[E.tab.position]=AJS.copyObject(E.tab)
}if(E.tab.position===0){C[E.tab.position].isFirst=true
}if(!C[E.tab.position].fields){C[E.tab.position].fields=[]
}C[E.tab.position].fields.push(AJS.copyObject(E))
}});
return C
},getTabs:function(){var A=this,B=jQuery.Deferred();
this.getFields().done(function(C){var D=A._mungeTabs(C);
B.resolve(D)
});
return B.promise()
},getSortedTabs:function(){var A=jQuery.Deferred();
if(!this.sortedTabs){this.refresh().done(function(){A.resolve(this.sortedTabs)
})
}else{A.resolve(this.sortedTabs)
}return A.promise()
},getUserFields:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.fields)
})
}else{B.resolve(A.userPreferences.fields)
}return B.promise()
},setUserFields:function(A){var B={};
B.fields=A;
return this.updateUserPrefs(B)
},hasRetainFeature:function(){return !!this._hasRetainFeature
},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature
},getUseConfigurableForm:function(){var A=this,B=jQuery.Deferred();
if(!this.userPreferences){this.refresh().done(function(){B.resolve(A.userPreferences.useQuickForm)
}).fail(function(){B.reject()
})
}else{B.resolve(A.userPreferences.useQuickForm)
}return B.promise()
},setUseConfigurableForm:function(A){var B={};
B.useQuickForm=A;
return this.updateUserPrefs(B)
},updateUserPrefs:function(C){var B=jQuery.Deferred(),A=this;
if(AJS.Meta.get("remote-user")===""){B.done();
return B.promise()
}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");
B.reject();
return B.promise()
}if(!C.fields){C.fields=this.userPreferences.fields
}if(typeof C.showWelcomeScreen==="undefined"){C.showWelcomeScreen=this.userPreferences.showWelcomeScreen
}if(typeof C.useQuickForm==="undefined"){C.useQuickForm=this.userPreferences.useQuickForm
}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(C),dataType:"json",contentType:"application/json",complete:function(E,F,D){if(D.successful){A.userPreferences=C
}else{A.triggerEvent("serverError",[D])
}}})
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error"><span class="aui-icon icon-error"></span>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(A){this.descriptor=A;
this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())
},focus:function(){this.$element.find(":input:first").focus()
},highlight:function(){var A=this;
this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){A.$element.animate({backgroundColor:"#fff"},function(){A.$element.css("backgroundColor","")
})
})
},getLabel:function(){return this.descriptor.label
},getId:function(){return this.descriptor.id
},activate:function(B){var A;
this.active=true;
this.$element.addClass("qf-field-active").show();
this.$element.find("textarea").trigger("refreshInputHeight");
if(!B){A=this.render();
this.$element.append(A.scripts);
this.focus();
JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);
this.$element.scrollIntoView();
this.triggerEvent("activated")
}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature
},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature
},isActive:function(){return this.active
},disable:function(A){this.render();
this.active=false;
this.$element.removeClass("qf-field-active").hide();
if(!A){this.triggerEvent("disabled")
}},render:function(){var B=JIRA.Templates.QuickForm.field(this.descriptor),A=JIRA.extractScripts(B);
this.$element.html(A.html).addClass("qf-field").data("model",this);
return{element:this.$element,scripts:A.scripts}
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]
},switchToAll:function(A){this.isConfigurable=false;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToAll")
}},setForm:function(A){this.form=A
},switchToCustom:function(A){this.isConfigurable=true;
if(A!==true){this.hideCallback=function(){this.remove()
};
this.inlineDialog.hide();
this.triggerEvent("switchedToCustom")
}},hideCallback:function(){},bindInlineDialog:function(){var B=this,A=this.getInlineDialogTrigger();
function C(F,D,E){B.render().done(function(G){if(F.find(".qf-picker").length===0){F.html(G);
F.click(function(K){K.stopPropagation()
})
}var J=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),I=jQuery(window).height(),H=I-J-110;
F.find(".qf-picker-content").css("maxHeight",H);
E()
})
}if(this.inlineDialog){this.inlineDialog.remove()
}this.inlineDialog=AJS.InlineDialog(A,this.INLINE_DIALOG_ID,C,{width:450,upfrontCallback:function(){A.parent().addClass("active")
},hideCallback:function(){A.parent().removeClass("active")
},nobind:true});
A.click(function(D){if(jQuery("#inline-dialog-"+B.INLINE_DIALOG_ID).is(":visible")){B.inlineDialog.hide()
}else{B.inlineDialog.show()
}});
return this.inlineDialog
},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")
},renderButtons:function(B){var A=this,C=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);
jQuery.each(B,function(E,F){var G,D;
if(A.isConfigurable){A.form.getFieldById(F.id).done(function(I){if(I&&I.hasVisibilityFeature()){var J=jQuery("<li />").appendTo(C);
var H=new JIRA.Forms.FieldPicker.ConfigurableButton({field:I});
H.render().appendTo(J);
A.buttons.push(H)
}})
}else{D=new JIRA.Forms.FieldPicker.UnconfigurableButton(F);
G=jQuery("<li />").appendTo(C);
D.render().appendTo(G)
}});
if(C.children().length===0){C.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")
}},renderContents:function(){var A=this,B=jQuery.Deferred();
this.form.model.getSortedTabs().done(function(C){if(C.length===1){A.renderButtons(C[0].fields)
}else{jQuery.each(C,function(D,E){if(E.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(A.$content).find("span").text(E.label);
A.renderButtons(E.fields)
}})
}B.resolveWith(A,[A.$element])
});
return B.promise()
},show:function(){this.inlineDialog.show()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));
this.$content=this.$element.find(".qf-picker-content");
this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));
this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));
return this.renderContents()
},_events:{switchToCustom:{click:function(A){this.switchToCustom();
A.preventDefault()
}},switchToAll:{click:function(A){this.switchToAll();
A.preventDefault()
}}}});
JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(A){this.descriptor=A
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));
return this.$element
}});
JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(B){var A=this;
this.field=B.field;
this.field.bind("disabled",function(){A.$element.removeClass("qf-active")
}).bind("activated",function(){A.$element.addClass("qf-active")
})
},toggle:function(){if(this.field.isActive()){this.field.disable()
}else{this.field.activate()
}},getId:function(){return this.field.getId()
},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));
this._assignEvents("button",this.$element);
return this.$element
},_events:{button:{click:function(A){this.toggle();
A.preventDefault()
}}}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var A=this;
A.getForm().addClass("submitting");
this.triggerEvent("submitting",[],true);
return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){A.disable()
},data:this.serialize(),complete:function(G,H,C){var E=C.data;
A.getForm().find(".aui-message-context").remove();
A.enable();
A.getForm().find(".error").remove();
if(C.successful){A.performAnalytics();
if(E&&E.fields){A.invalidateFieldsCache();
A.model.setFields(E.fields)
}if(typeof E==="string"){var F=AJS.$(AJS.extractBodyFromResponse(E));
var D=F.find("#atl_token").val();
if(D){A.model.atlToken=D;
A.getForm().find('input[name="atl_token"]').val(D)
}var B=new JIRA.FormDialog({offsetTarget:"body",content:F});
B._handleServerSuccess=function(){if(B.prev){B.prev._removeStackState();
B.prev._resetWindowTitle();
B._removeStackState()
}B.hide();
A.triggerEvent("sessionComplete",[],true);
A.handleSubmitSuccess()
};
B._handleServerError=function(I){B.hide();
A.handleSubmitError(I)
};
B.show()
}else{A.handleSubmitSuccess(C.data)
}}else{A.handleSubmitError(G)
}A.getForm().removeClass("submitting")
}})
},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");
this.getForm().find(":submit").attr("disabled","disabled")
},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");
this.getForm().find(":submit").removeAttr("disabled")
},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")
},serialize:function(C){var A=this,B=this.getForm().serialize();
if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){B=B+"&multipleMode=true"
}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();
jQuery.each(this.getActiveFieldIds(),function(E,D){A.model.addFieldToRetainValue(D,C)
});
jQuery.each(this.model.getFieldsWithRetainedValues(),function(D,E){B=B+"&fieldsToRetain="+E
})
}return B
},invalidateFieldsCache:function(){delete this.fields
},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()
},handleSubmitSuccess:function(){this.triggerEvent("submitted");
AJS.reloadViaWindowLocation()
},performAnalytics:function(){var A=function(D,E){var C="***** Analytics log ["+D+"]";
if(E){C+="["+JSON.stringify(E)+"]"
}AJS.log(C);
if(AJS.EventQueue){AJS.EventQueue.push({name:D,properties:E||{}})
}};
var B=function(E){var C={};
var F=_.filter(E,function(G){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],G.name)
});
var D=_.filter(F,function(G){return G.value!=""
});
_.each(D,function(H){var G=H.name;
if(!_.has(C,G)){C[G]=[]
}C[G].push(H.value)
});
return C
};
this.previousAnalytics=(function(K,O){var F=B(K);
var M=_.keys(F);
var G=_.keys(O.data);
var J=_.difference(M,G);
var N=_.difference(G,M);
var L=_.intersection(G,M);
var D=_.filter(L,function(P){return _.isEqual(O.data[P],F[P])
});
var C=_.difference(L,D);
var I=O.count+1;
var H=(JIRA.Dialog.current.options.id==="edit-issue-dialog");
var E={"atlassian.numCreates":I,"edit.form":H};
_.each(J,function(P){E[P]="added"
});
_.each(N,function(P){E[P]="removed"
});
_.each(D,function(P){E[P]="same"
});
_.each(C,function(P){E[P]="changed"
});
A("quick.create.fields",E);
return{data:F,count:I}
})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})
},handleSubmitError:function(D){var A=this;
var E;
try{E=JSON.parse(D.responseText)
}catch(C){}if(E){if(E.errorMessages&&E.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),E.errorMessages[0])
}if(E&&E.errors&&D.status===400){if(this.getFieldById){jQuery.each(E.errors,function(F){if(/^timetracking/.test(F)){A.getFieldById("timetracking").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{if(/^worklog/.test(F)){A.getFieldById("worklog").done(function(G){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[A.$element]);
G.activate(true)
})
}else{A.getFieldById(F).done(function(G){G.activate(true)
})
}}})
}JIRA.applyErrorsToForm(this.getForm(),E.errors);
this.triggerEvent("validationError",[this,E.errors],true)
}var B=A.$element.find(".error");
if(B.length){B[0].scrollIntoView(false)
}}},getAction:function(){return this.action
},getFormContent:function(){return this.$element.find("div.content")
},getForm:function(){return this.$element.find("form")
},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")
},_getActiveAttachments:function(A){var B=[];
if(!A){return B
}var D=A.split("&");
for(var C=0;
C<D.length;
C++){var E=D[C].split("=");
if(E[0]=="filetoconvert"){B.push(E[1])
}}return B
},_setActiveAttachments:function(B){var A=this.$element.find("input[name=filetoconvert]");
A.each(function(){var D=jQuery(this);
var C=_.contains(B,D.attr("value"));
D.prop("checked",C)
})
},render:function(C){var B=jQuery.Deferred(),A=this;
var D=A._getActiveAttachments(C);
if(C){this.invalidateFieldsCache();
this.model.refresh(C).done(function(){A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
})
}else{A._render().done(function(F,E){A.triggerEvent("rendered",[A.$element]);
B.resolveWith(A,[A.$element,E])
})
}B.always(function(){A._setActiveAttachments(D)
});
return B.promise()
}});
JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getConfigurableFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
},getActiveFieldIds:function(){var B=[],A=this.$element.find(".qf-field.qf-field-active:not(.qf-required)");
jQuery.each(A,function(D,E){var C=jQuery(E);
var F=C.data("model").getId();
B.push(F);
if(F==="attachment"){C.find(":checked").each(function(){B.push(this.id)
})
}});
return B
},createField:function(C){C.hasVisibilityFeature=this.model.hasVisibilityFeature(C);
if(this.model.hasRetainFeature(C)){C.hasRetainFeature=true;
C.retainValue=this.model.hasRetainedValue(C)
}var A=this,B=new JIRA.Forms.ConfigurableField(C);
if(C.hasVisibilityFeature){B.bind("activated",function(){A.model.setUserFields(A.getActiveFieldIds());
B.highlight();
A.triggerEvent("QuickForm.fieldAdded",[B])
}).bind("disabled",function(){A.model.setUserFields(A.getActiveFieldIds());
A.triggerEvent("QuickForm.fieldRemoved",[B])
})
}return B
},getFieldById:function(C){var A=this,B=jQuery.Deferred();
this.getFields().done(function(D){jQuery.each(D,function(E,F){if(F.getId()===C){B.resolveWith(A,[F])
}});
B.rejectWith(A,[])
});
return B.promise()
},hasNoVisibleFields:function(){var A=jQuery.Deferred();
A.resolve(this.getActiveFieldIds().length===0);
return A.promise()
},renderFormContents:function(){var C=jQuery.Deferred(),B=jQuery(),A=this;
A.getFields().done(function(D){A.model.getActiveFieldIds().done(function(E){jQuery.each(D,function(){var F=this.render();
B=B.add(F.scripts);
A.getFormContent().append(F.element)
});
jQuery.each(E,function(G,F){jQuery.each(D,function(){if(this.getId()===F){this.activate(true)
}})
});
jQuery.each(D,function(){if(!this.isActive()){this.disable(true)
}});
A.hasNoVisibleFields().done(function(G){if(G===true){for(var F=0;
F<3;
F++){if(D[F]){D[F].activate(true)
}}}C.resolveWith(this,[A.$element,B])
})
})
});
return C.promise()
}});
JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},getActiveFieldIds:function(){var A=[];
this.model.getFields().done(function(B){jQuery.each(B,function(C,D){A.push(D.id)
})
});
return A
},getFields:function(){var B=jQuery.Deferred(),A=this;
if(!this.fields){this.fields=[];
this.model.getFields().done(function(C){jQuery.each(C,function(D,F){var E=A.createField(F);
A.fields.push(E)
});
B.resolveWith(A,[A.fields])
})
}else{B.resolveWith(this,[this.fields])
}return B.promise()
}});
JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(A){var B,C;
if(A.hasData&&A.status!==401){try{C=JSON.parse(A.data);
if(C.errorMessages&&C.errorMessages.length>0){B=JIRA.Templates.QuickForm.errorMessage({message:C.errorMessages[0]})
}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}catch(D){B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}}else{B=JIRA.SmartAjax.buildDialogErrorContent(A,true).html()
}return B
},render:function(B){var A=this.getErrorMessageFromSmartAjax(B);
return this._render(A)
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(A){this.$element=jQuery("<div />").addClass("qf-container");
this.options=JIRA.makePropertyFunc(A);
this.fieldPicker=new JIRA.Forms.FieldPicker();
this.successData=[]
},decorateRenderers:function(){var A=this;
if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){A.unconfigurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.bind("switchedToCustom",function(){A.configurableForm.render(A.currentView.serialize(true)).done(function(){A.fieldPicker.show()
})
});
this.fieldPicker.decorated=true
}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(C,B){A.currentView=A.configurableForm;
A.fieldPicker.switchToCustom(true);
A.fieldPicker.setForm(A.configurableForm);
A.fieldPicker.bindInlineDialog();
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(true);
A.triggerEvent("configurableFormRendered")
});
this.configurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("configurableFormSubmitted")
});
this.configurableForm.decorated=true
}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(C,B){A.fieldPicker.switchToAll(true);
A.fieldPicker.setForm(A.unconfigurableForm);
A.fieldPicker.bindInlineDialog();
A.currentView=A.unconfigurableForm;
A.applyGlobalDecorator(B);
A.model.setUseConfigurableForm(false);
A.triggerEvent("unconfigurableFormRendered")
});
this.unconfigurableForm.bind("submitted",function(C,B){A.successData.push(B);
A.triggerEvent("unconfigurableFormSubmitted")
});
this.unconfigurableForm.decorated=true
}},applyGlobalDecorator:function(C){function B(){if(A.currentView.setInitialFocus){A.currentView.setInitialFocus()
}}var A=this;
C.detach();
this.$element.html(C);
this.triggerEvent("contentRefreshed",[this.$element]);
if(jQuery.browser.msie){window.setTimeout(B,0)
}else{B()
}},asDialog:function(B){var A=this,C;
this.dialog=C=new JIRA.FormDialog({id:B.id,trigger:B.trigger,windowTitle:B.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(D){A.render().done(function(){D(A.$element)
});
A.triggerEvent("dialogShown")
},submitHandler:function(E,D){E.preventDefault();
A.currentView.submit().then(D,D)
},stacked:true});
if(B.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(D){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){D.preventDefault()
}})
}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])
};
this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){C.hide()
});
this.configurableForm.bind("sessionComplete",function(){C.hide()
})
}).bind("contentRefreshed",function(){C.notifyOfNewContent()
});
C.bind("Dialog.hide",function(){if(A.successData.length){A.triggerEvent("sessionComplete",[A.successData],true);
A.successData=[]
}});
A.$element.ajaxStart(function(){C.showFooterLoadingIndicator()
}).ajaxStop(function(){C.hideFooterLoadingIndicator()
});
C.getQuickForm=function(){return A
};
C.dirtyFormWarning();
return C
},lazyInit:function(){var A=this,B=this.options.call(this);
this.model=B.model;
this.errorHandler=B.errorHandler;
this.globalEventNamespaces=B.globalEventNamespaces;
this.configurableForm=B.configurableForm;
this.unconfigurableForm=B.unconfigurableForm;
this.sessionComplete=B.sessionComplete;
this.model.clearRetainedFields();
this.configurableForm.invalidateFieldsCache();
this.model.bind("serverError",function(D,C){A.$element.html(A.errorHandler.render(C));
A.triggerEvent("contentRefreshed",[this.$element])
});
this.triggerEvent("initialized");
this.decorateRenderers()
},render:function(){var A=this,B=jQuery.Deferred();
this.lazyInit();
A.model.getUseConfigurableForm().done(function(C){if(C===true){A.configurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element]);
A.$element.append(D)
})
}else{A.unconfigurableForm.render().done(function(E,D){B.resolveWith(A,[A.$element,D]);
A.$element.append(D)
})
}}).fail(function(){B.resolveWith(A,[A.$element])
});
return B.promise()
}});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/edit.js' */
JIRA.Forms.EditIssueModel=JIRA.Forms.Model.extend({getUnconfigurableTabs:function(){var A=this,B=jQuery.Deferred();
A.getTabs().done(function(D){var C=D.slice(0);
C[0].fields=C[0].fields.slice(0);
jQuery.each(C[0].fields,function(E,F){if(F.id==="comment"){C[0].fields.splice(E,1);
return false
}});
B.resolve(C)
});
return B.promise()
},getCommentField:function(){var A=jQuery.Deferred();
this.getFields().done(function(B){jQuery.each(B,function(C,D){if(D.id==="comment"){A.resolve(D)
}});
A.reject()
});
return A.promise()
}});
JIRA.Forms.EditIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.editIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableEditIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},getFieldsHtml:function(){var A=this,B=jQuery.Deferred(),C={};
this.model.getUnconfigurableTabs().done(function(D){if(D.length===1){C.fields=D[0].fields
}else{C.tabs=D;
C.hasTabs=true
}B.resolveWith(A,[JIRA.Templates.Issue.issueFields(C)])
});
return B.promise()
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A],true);
this.triggerEvent("sessionComplete")
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){var D={fieldsHtml:C,title:A.title,issueId:A.issueId,atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()};
this.model.getCommentField().then(function(G){var F,E;
D.commentField=G;
F=JIRA.Templates.Issue.editIssueForm(D);
E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
},function(){var F=JIRA.Templates.Issue.editIssueForm(D),E=JIRA.extractScripts(F);
A.$element.html(E.html);
B.resolveWith(A,[A.$element,E.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableEditIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this.action=contextPath+"/secure/QuickEditIssue.jspa?issueId="+A.issueId+"&decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){this.triggerEvent("submitted",[A]);
this.triggerEvent("issueEdited",[A],true);
this.triggerEvent("sessionComplete")
},hasNoVisibleFields:function(){var A=jQuery.Deferred(),B=this.getActiveFieldIds();
this.model.getUserFields().done(function(C){if(C.length===1&&C[0]==="comment"){A.resolve(false)
}else{if(B.length===0||(B.length===1&&B[0]==="comment")){A.resolve(true)
}else{A.resolve(false)
}}});
return A.promise()
},_render:function(){var B=jQuery.Deferred(),A=this,C=JIRA.Templates.Issue.editIssueForm({issueId:this.issueId,title:this.title,atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),isConfigurable:true,useLegacyDecorator:JIRA.useLegacyDecorator(),modifierKey:AJS.Navigator.modifierKey(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous()});
this.$element.html(C);
A.renderFormContents().done(function(E,D){A.getFieldById("comment").done(function(F){A.getFormContent().append(F.$element)
});
B.resolveWith(A,[A.$element,D])
});
return B.promise()
}});
JIRA.Forms.Model.createQuickEditIssueModel=function(A){return new JIRA.Forms.EditIssueModel({fieldsResource:contextPath+"/secure/QuickEditIssue!default.jspa?issueId="+A+"&decorator=none",userFieldsResource:contextPath+"/rest/quickedit/1.0/userpreferences/edit"})
};
JIRA.Dialog.shouldShowIssueKeyInTitle=function(){return JIRA.Issues||JIRA.IssueNavigator.isNavigator()||JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey")
};
JIRA.Forms.createEditIssueForm=function(){function A(C){var D=JIRA.Dialog.getAttrFromActiveTrigger("data-issueId");
if(jQuery.isFunction(C.issueId)){return C.issueId(C)
}else{if(C.issueId){return C.issueId
}else{if(D){return D
}else{return JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
}}}}function B(){var C="Edit Issue";
if(JIRA.Dialog.shouldShowIssueKeyInTitle()){return JIRA.Dialog.getIssueActionTitle(C)
}else{return C
}}return function(C){C=C||{};
return new JIRA.Forms.Container(function(){var H=A(C),G=B(),D=JIRA.Forms.Model.createQuickEditIssueModel(H),F=new JIRA.Forms.ConfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]}),E=new JIRA.Forms.UnconfigurableEditIssueForm({title:G,model:D,issueId:H,globalEventNamespaces:["QuickEdit"]});
return{globalEventNamespaces:["QuickEdit"],model:D,errorHandler:new JIRA.Forms.EditIssueError(),configurableForm:F,unconfigurableForm:E}
})
}
}();
jQuery(function(){JIRA.Forms.createEditIssueForm().asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Edit Issue")
},trigger:".issueaction-edit-issue",id:"edit-issue-dialog"});
jQuery(document).bind("dialogContentReady",function(){AJS.tabs.setup()
})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-edit-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList68 = opt_data.tabs;
    var tabListLen68 = tabList68.length;
    for (var tabIndex68 = 0; tabIndex68 < tabListLen68; tabIndex68++) {
      var tabData68 = tabList68[tabIndex68];
      output.append((tabData68) ? '<li class="menu-item ' + ((tabData68.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData68.position) + '" ><strong>' + soy.$$escapeHtml(tabData68.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      if (tabData82) {
        output.append('<div class="tabs-pane ', (tabData82.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData82.position), '">');
        var fieldList92 = tabData82.fields;
        var fieldListLen92 = fieldList92.length;
        for (var fieldIndex92 = 0; fieldIndex92 < fieldListLen92; fieldIndex92++) {
          var fieldData92 = fieldList92[fieldIndex92];
          output.append((fieldData92.editHtml) ? fieldData92.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList102 = opt_data.fields;
    var fieldListLen102 = fieldList102.length;
    for (var fieldIndex102 = 0; fieldIndex102 < fieldListLen102; fieldIndex102++) {
      var fieldData102 = fieldList102[fieldIndex102];
      output.append((fieldData102.editHtml) ? fieldData102.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList126 = opt_data.issueSetupFields;
    var fieldListLen126 = fieldList126.length;
    for (var fieldIndex126 = 0; fieldIndex126 < fieldListLen126; fieldIndex126++) {
      var fieldData126 = fieldList126[fieldIndex126];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData126.id), ' qf-required">', fieldData126.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList191 = opt_data.errors;
  var errorListLen191 = errorList191.length;
  for (var errorIndex191 = 0; errorIndex191 < errorListLen191; errorIndex191++) {
    var errorData191 = errorList191[errorIndex191];
    output.append('<li>', soy.$$escapeHtml(errorData191), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.global.js' */
var tempo=(function(x){var E="%e/%b/%y";var s="%e/%b/%y %H:%M";var n="Period is invalid";var d="You must be logged in to JIRA to perform this action. Session might have timed out!";var f="(|.*?(\\s+|\\())({0})(.*)";x.extend(x.expr[":"],{focus:function(M){return M==document.activeElement}});x.fn.fixDirtyForm=function(){x(this).addClass("ajs-dirty-warning-exempt");if(AJS.DIRTY_FORM_VALUE){return this.data(AJS.DIRTY_FORM_VALUE,null)}return this};x.fn.cleanFormValidation=function(){var M=x(this);var N=M.find("ul.error-list");M.find(":input:visible").removeClass("error-field").removeClass("valid");N.empty();return this};x.fn.resetFormFields=function(){var M=x(this);M.find(".resetable :checkbox").attr("checked",false);M.find(".resetable select, .resetable textarea, .resetable input[type=text]").val("");M.find(".enddate").hide();M.find("select.tempoDynamicDropDown").empty();M.find("select.tempoDynamicDropDown").attr("selectedValue","");return this};var C=AJS.SingleSelect.extend({submitForm:function(){if(!this.suggestionsVisible){this.handleFreeInput();if(this.options.submitHandler){this.options.submitHandler()}}},setFieldWidth:function(N,M){M=M||N;this.$container.css({width:N,minWidth:N});this.$field.width(N);this.dropdownController.$layer.css({width:M,minWidth:M})},setDropdownWidthForTimesheet:function(M){if(M&&M.timesheet&&this.$container){this.setFieldWidth(205,500)}}});x.fn.tempoFormatAccountPicker=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-account-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.type+"-"+this.key,label:this.name,html:this.html,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoAccountPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/accounts/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAccountPicker}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFilterPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/filters/picker",query:true,minQueryLength:1,data:O,formatResponse:function(R){var S=[];if(N&&N.timesheet){M.setDropdownWidthForTimesheet(N);var Q=new AJS.GroupDescriptor({weight:0,id:"tempo-default-suggested",replace:true});Q.addItem(new AJS.ItemDescriptor({value:"-1001",label:"User Timesheet",allowDuplicate:false}))}x(R).each(function(U,T){var V=new AJS.GroupDescriptor({weight:U+1,id:"tempo-report-filter-suggested-"+1,replace:true,label:"Filters"});x(T.filters).each(function(){var W=this.name;if(this.description){W+=" ("+this.description+")"}V.addItem(new AJS.ItemDescriptor({value:""+this.id,label:W,allowDuplicate:false}))});S.push(Q);S.push(V)});return S}}})};x.fn.tempoFormatAdvancedSearchResponse=function(M){var N=[];x(M).each(function(O,P){x(P.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){var T=new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false});S.addItem(T)});N.push(S)})});return N};x.fn.tempoAdvancedTimesheetPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/search/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAdvancedSearchResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatIssueResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-issue-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.key,label:this.key+" - "+this.name,allowDuplicate:false,title:this.name,icon:contextPath+this.icon}))});N.push(S)})});return N};x.fn.tempoIssuePicker=function(O){var M;if(O!=null&&O.type!=null){M=O.type}else{M=""}var Q=x(this);var P={};var N=new C({submitHandler:O?O.submitHandler:null,element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/issues/picker/"+M,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatIssueResponse}});N.setDropdownWidthForTimesheet(O)};x.fn.tempoFormatProjectResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-project-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.id+"",label:this.name+" ("+this.key+")",html:this.html,icon:contextPath+this.icon,title:this.name,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoSingleProjectPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/projects/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatProjectResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatUserResponse=function(M){return[new AJS.GroupDescriptor({items:_.map(_.sortBy(M.users,"label"),function(N){return new AJS.ItemDescriptor({highlighted:true,html:N.html,label:N.displayName,value:""+N.name,title:N.displayName,icon:N.avatarUrl})})})]};x.fn.tempoSingleUserPicker=function(M){var N;if(M!=null&&M.type!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new C({submitHandler:M?M.submitHandler:null,element:Q,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/users/picker/"+N,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatUserResponse}});O.setDropdownWidthForTimesheet(M);Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoFormatTeamResponse=function(M){var N=[];x(M).each(function(P,O){var Q=new AJS.GroupDescriptor({weight:P,id:"tempo-report-team-search",replace:true});x(O.teams).each(function(){Q.addItem(new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false}))});N.push(Q)});return N};x.fn.tempoSingleTeamPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/teams/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatTeamResponse}})};x.fn.tempoSingleActivityPicker=function(N){var P=x(this);var O={projectId:function(){return x("#tempo-report-project").val()}};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/activities/picker",query:true,minQueryLength:1,data:O,formatResponse:function(Q){var R=[];x(Q).each(function(S,T){x(T.group).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,id:"tempo-report-activity-search"+V,replace:true,label:U.title});x(U.item).each(function(){var X=new AJS.ItemDescriptor({value:this.type+"-"+this.id,label:this.name,html:this.html,allowDuplicate:false});W.addItem(X)});R.push(W);M.setDropdownWidthForTimesheet(N)})});return R}}})};x.fn.tempoMultiUserPicker=function(M){var N;if(M!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new AJS.MultiSelect({element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker"+N,query:true,minQueryLength:3,data:P,formatResponse:function(T){var S=[];x(T).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,label:U.footer});x(U.users).each(function(){W.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});S.push(W)});return S}}});Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoDatePicker=function(M){x(this).each(function(){var W=x(this);var S=W.find("input");var Q=W.find("img,span.icon-date");var V=S.attr("id");var R=Q.attr("id");var T=W.hasClass("ISO8061WeekNumbers");var U=W.hasClass("showStartTime");var O=E;if(U){O=s}Calendar.setup({context:W,firstDay:0,inputField:V,button:R,align:"Tl",singleClick:true,ifFormat:O,daFormat:O,showsTime:U,timeFormat:"24",useISO8601WeekNumbers:T,electric:false});if(M.validate){var N=S.closest(".tempo-datepicker");var P=N.closest("form");Q.bind("click",function(){Q.data("cal",window.calendar)}).closest("a").bind("keyup",function(X){if(X.keyCode==32){Q.trigger("click")}});S.bind("blur",function(){var X=Q.data("cal");if(X){X.callCloseHandler()}}).bind("change",function(){P.cleanFormValidation();var Y=P.find("input[name=planning]").val()=="true";var X=P.find(":input[name=user]").val();if(!X){X=P.find("select.dialog-user-picker").val()}var Z=i(S,X,Y);var ab=N.find(":checkbox").is(":checked");if(Z){var ad=N.find("input[name=date]");var ac=N.find("input[name=enddate]");var aa=P.find("input.availability");if(ab){if(this.name=="date"){if(ac.val()==""){return}Z=i(ac,X,Y)}else{Z=i(ad,X,Y)}if(Z){Z=u(ad.val(),ac.val(),P.find("input[name=startTimeEnabled]").val()==="true");if(!Z){P.find("ul.error-list").append(x("<li/>").text(n))}else{P.find("input[name=time]").trigger("change");g(P,X,ad,ac)}}}else{g(P,X,ad,ac)}}return true})}});return this};function g(O,M,S,R){if(!M){return}var Q=O.find("input.availability");if(Q.length===1){var N=contextPath+"/rest/tempo-rest/2.0/user/getUser";if(!O.find(".showperiod").is(":checked")||R.val()==""){R=S}var P={from:S.val(),to:R.val(),username:M};x.ajax({url:N,cache:false,data:P,success:function(T){O.find("input.availability").val(T.availableString);O.find("input.workingdays").val(T.workDaysString)},error:function(U,T,V){alert(T)}})}}function j(O,S,P){if(P!=""){var M=O.find(":input[name=issue]");if(M.val()!=""){var R=O.find("input[name=date]");var Q=O.find("input[name=enddate]");var N=O.find("input[name=user]").val();if(!N){N=O.find("select.dialog-user-picker").val()}if(!Q.is(":visible")){Q=R}x.ajax({data:{username:N},async:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/remainingEstimate/calculate/"+M.val()+"/"+J(R.val())+"/"+J(Q.val())+"/"+P,cache:false,success:function(T){S.val(T);if(S.is(":focus")){S.select()}},error:function(U,T,V){if(V=="Unauthorized"){alert(d)}else{alert(T)}}})}}}x.fn.tempoTimePicker=function(){x.each(x(this),function(){var M=x(this);var P=M.closest("form");var N=P.find(":input[name=issue]");var Q=M.find(":input[name=time]");var S=M.find("input[name=remainingEstimate]");var R=M.find("input[name=billedTime]");var O=P.find("div.tempo-datepicker");Q.bind("blur",function(U){if(N.find("option").val()&&N.val()==null){var T=N.find("option").val();N.val(T);x("select.tempo-issue-picker").trigger("change")}if(S.length>0||R.length>0){if(R.length>0){R.val(this.value)}if(S.length>0){j(P,S,this.value)}}});O.bind("change",function(){if(O.find("div.enddate").is(":visible")){Q.trigger("blur")}})});return this};function p(Q,P,M){if(P.error!=undefined&&P.error!=null&&P.error!=""){alert("Error in TDD query: "+P.error);return}Q.empty();var N=Q.attr("selectedValue");var O=N;x.each(P.values,function(R,S){x("<option/>").val(S.key).text(S.value).appendTo(Q);if(S.key==N&&S.key!=""){O=S.value}});if(N){Q.val(N)}if(N&&Q.val()!=N){O=N+" - "+"Unknown account";x("<option/>").val(N).text(O).appendTo(Q);Q.val(N)}if(O!=""){Q.siblings("span.edit-select").text(O)}}var w={};var B={};function m(P,N){var O=B[N];if(O==null){var M=!tempo.isEmptyString(P.attr("issueKey"));O=x.ajax({async:M,url:encodeURI(N),dataType:"jsonp",success:function(Q){w[N]=Q},error:function(R,Q,S){alert("Got error in TDD query: "+R+", status: "+Q+", error: "+S+", element: "+P.attr("id")+", URL:"+N)}});B[N]=O}return O}function G(M,P){var N=w[M];if(N==null){var O=m(P,M);O.done(function(Q){p(P,Q,M)})}else{p(P,N,M)}}var b={};var h={};function o(M,P){var N=M+":"+P;var O=h[N];if(O==null){O=x.ajax({async:true,cache:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/customFieldValue/"+M+"/"+P,success:function(Q){b[N]=Q}});h[N]=O}return O}function D(N,O,M){return N.replace("{"+O+"}",M)}function a(N,R,M,Q){var O=b[N];if(O==null){var P=o(M,Q);P.done(function(S){if(!tempo.isEmptyString(S)){G(D(N,Q,S),R)}})}else{if(!tempo.isEmptyString(O)){G(D(N,Q,O),R)}}}x.fn.populateDynamicDropdown=function(M){x(this).each(function(){var W=x(this);var P=M;if(P==null){P=W.attr("issueKey")}var O=W.attr("externalURL");if(tempo.isEmptyString(O)){return}if(O.indexOf("{")>0){if(tempo.isEmptyString(P)){return}var T=O.indexOf("{")+1;var R=O.indexOf("}");var N=O.substr(T,(R-T));var S=W.attr("id");var V=S.substr(0,S.indexOf("_"));var U=P;var Q=x("#"+V+N);if(Q.length>0){U=Q.val()}else{if(N!="IssueKey"){a(O,W,P,N);return}}if(tempo.isEmptyString(U)){return}O=D(O,N,U)}G(O,W)});return this};function J(M){return M.replace(/\//g,"-")}var F={};function i(N,M,O){var P=false;var Q=M+"_"+N.val()+"_"+O;if(F[Q]){P=F[Q]}else{x.ajax({type:"POST",url:contextPath+"/rest/tempo-rest/1.0/worklogs/validation/date/full",async:false,data:{date:N.val(),formFieldId:N.attr("name"),user:M,planning:O},success:function(R){P=H(R,N.closest("form"))}});F[Q]=P}return P}function u(O,N,M){var Q=Date.parseDate(O,E);if(M){Q=Date.parseDate(O,s)}var P=Date.parseDate(N,E);return Q.getTime()<=P.getTime()}function H(M,N){var P=N.find("ul.error-list");var O=true;x(M).find("submit-result").each(function(){var Q=x(this);if(Q.attr("valid")=="false"){Q.find("errors").each(function(){var R=x(this);P.append(x("<li/>").text(R.find("errorMessage").text()))});O=false}});return O}function v(N,M){tb_show(this.innerHTML,"#TB_inline?height="+M+"&amp;width=780&amp;inlineId="+N+"&amp;modal=true")}var L={dirty:false,locked:false,popup_title:{}};var c=x('<div id="tempo-blanket"/>').css("z-index","2000").css("height","100%").hide();var z={show:function(M){c.addClass("aui-blanket").css("z-index",M||"2000").show();if(x.fancybox){x.fancybox.showActivity()}else{x("div.aui-loading").show()}},hide:function(){c.removeClass("aui-blanket").css("z-index","2000").hide();x("div.aui-loading").hide();if(x.fancybox){x.fancybox.hideActivity()}}};var K=function(M){z.show();if(M){window.location=M}else{window.location.reload()}return this};function q(){x("#submitSearch").addClass("refresh-required")}function r(P){if(tempo.state.locked){return}tempo.spinner.show("9000");tempo.state.locked=true;x(":button").attr("disabled",true);var O=x(this).find("form");var R=O.find("ul.error-list");var M=O.find("input[name=user]").val();if(!M){M=x(O.find("select.dialog-user-picker").val()).get(0)}var Q=O.serialize();var N=O.attr("action");N=N.replace("{issueKey}",O.find(":input[name=issue]").val());N=N.replace("{id}",O.find("input[name=id]").val());N=N.replace("{type}",O.find("input[name=type]").val());x.ajax({async:true,type:"POST",url:N,data:Q,success:function(S){O.cleanFormValidation();x(S).find("submit-result").each(function(){var T=x(this);if(T.attr("valid")=="false"){T.find("errors").each(function(){var W=x(this);var X=W.find("formFieldId").text();x('[name="'+X+'"]',O).addClass("error-field");R.append(x("<li/>").text(W.find("errorMessage").text()))})}else{tempo.state.dirty=true;O.fixDirtyForm();if(O.find("input[name=tracker]").val()=="true"){tempobar.stopTracker()}if(P.type=="add-close"||P.type=="update"||P.type=="move"||P.type=="split"){tempo.reload();return}else{O.resetFormFields();if(O.find(":input[name=planning]").val()=="true"){var V=O.find("input[name=date]");var U=O.find("input[name=enddate]");g(O,M,V,U)}else{tempo.issue.get(O.find(":input[name=issue]").val(),O)}O.find("select.tempoDynamicDropDown").populateDynamicDropdown(O.find(":input[name=issue]").val())}}});x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},error:function(S,U,T){if(T=="Unauthorized"){alert(d)}else{if(U=="timeout"){alert("Add hours failed - Service timed out - Please try again")}else{alert(tempo.extractErrorMessage(S.responseText))}}x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},dataType:"xml"})}function k(M){return M==undefined||M==null||M.length==0}function t(M){return M.match(/(.*)\((.*)\).*/)}var I=function(){};var y=AJS||JIRA?{Dropdown:AJS.Dropdown?AJS.Dropdown:AJS.DropDown,formatSuccess:jira.app.fragments?jira.app.fragments.issueActionsFragment:JIRA.FRAGMENTS.issueActionsFragment,FormPopup:AJS.FormPopup||(JIRA?JIRA.FormDialog:I),containDropdown:AJS.containDropdown||(JIRA?JIRA.containDropdown:I),sessionStorage:(jira.app.session?jira.app.session.storage:JIRA.SessionStorage)}:{};function A(N){var M=AJS.$(N).find("message").text();if(M){return M}return N}function l(){var P=x(this).closest("form");P.find(".enddate").toggle(this.checked);P.find("input[name=date]").trigger("change");var N=P.find("label.timepicker-label");var O=N.attr("tmp");var M=N.text();N.attr("tmp",M);N.text(O)}function e(O){var Q=x("#timesheet-mlink");if(Q.length>0){if(jira.app.issue.getIssueKey()){var M=(O.planning==true)?"TempoAllocateTime!default.jspa?type=issue&id=":"TempoAddHours!default.jspa?id=";var N=contextPath+"/secure/"+M+jira.app.issue.getIssueId();var R=x("<a>").attr("href",N).addClass("issueaction-tempo-add-hours-on-issue hidden");x("header").first().append(R);R.click().remove()}else{var P=(O.planning==true)?x("#tempo-plan-button"):x("#tempo-add-button");if(P.length===1){P.click()}else{window.location=Q.attr("href")}}}}return{$:x,DATE_FORMAT:E,DATE_TIME_FORMAT:s,MATCHING_STRATEGY:f,spinner:z,reload:K,requireReload:q,state:L,submit:r,changeDateFormatForRest:J,calculateRemainingEstimate:j,widget:y,isEmptyString:k,extractUser:t,blanket:c,extractErrorMessage:A,processValidationResult:H,thickbox:{open:v,close:function(){tb_removeNoRefresh()}},shortcutOpenDialog:e,showHoursLabel:l}})(AJS.$);tempo.$(function(h){h("a#log-work-link").bind("click",function(m){j(m)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(n,m){h(m).find("a#log-work-link").bind("click",function(o){j(o)})});function j(o){var m=h("a#issue-view-tempo-panel-log-work");if(m.length===1){o.preventDefault();o.stopPropagation();var n=contextPath+"/secure/TempoAddHours!default.jspa?id="+jira.app.issue.getIssueId();h(this).attr("href",n).addClass("issueaction-tempo-add-hours-on-issue");m.trigger("click")}}f();function f(){var n=h("span.more-license-details").last();var m=n.parent().find("ul.license-details");m.hide();n.bind("click",function(){m.toggle();n.toggleClass("active")})}var d=new tempo.widget.FormPopup({id:"tempo-medium-form",trigger:"a.tempoaction-open-medium-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent()}});var a=new tempo.widget.FormPopup({id:"tempo-small-form",trigger:"a.tempoaction-open-small-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"small",onContentRefresh:function(){var m=this.get$popupContent()}});var b=new tempo.widget.FormPopup({id:"tempo-large-form",trigger:"a.tempoaction-open-large-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},width:750,onContentRefresh:function(){var m=this.get$popupContent();f()}});var l=new tempo.widget.FormPopup({id:"tempo-add-hours-issue-dialog",trigger:"a.issueaction-tempo-add-hours-on-issue",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=n.find("form").attr("data-form-type");h(n).siblings().first().addClass(m);i(h(n[0]));this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")}}});new tempo.widget.FormPopup({id:"tempo-grace-form",trigger:"a.tempoaction-open-dialog-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent();h("div.datepicker",m).tempoDatePicker({validate:true})}});new tempo.widget.FormPopup({id:"tempo-planning-create-team",trigger:"a.tempo-planning-create-team",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=this;h("div.datepicker",n).tempoDatePicker({validate:false});h("input.button",n).bind("click",function(){var o=h(this).closest("form");h("form",n).each(function(){if(this.id!=o.attr("id")){h(this).find("input:hidden").remove()}})});this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")};i(h(n[0]))}});function i(o){h("select.tempoDynamicDropDown",o).bind("change",function(){});h("select.tempo-issue-picker-logwork",o).tempoIssuePicker();h("select.plan-user-picker",o).tempoSingleUserPicker();h("div.datepicker",o).tempoDatePicker({validate:true});h("div.tempo-timepicker",o).tempoTimePicker();h("#tempo-logwork-issue-cancel",o).bind("click",function(){if(tempo.state.dirty){tempo.reload()}});h("div.dialog-panel-form",o).attr("title","");var n=h("input.tempo-show-period",o);if(n.attr("checked")){tempo.showHoursLabel.apply(n[0])}n.bind("click",tempo.showHoursLabel);h(o).bind("add-close",tempo.submit).bind("add",tempo.submit);h(o).bind("before-submit",function(p){p.preventDefault()});h(o).submit(function(p){p.preventDefault();h("#issue-add-button").click();return false});h("#issue-add-button",o).bind("click",function(q){var p=h(o).find("form *:input#issue-add-another");if(p.attr("checked")){h(o).trigger("add");h(o).find("form:first *:input[type!=hidden]:first").focus()}else{h(o).trigger("add-close")}return false});var m=h("#tempo-log-work input.tempoIssueKey",o).val();if(m){h("#tempo-log-work form select.tempoDynamicDropDown",o).populateDynamicDropdown(m)}}var g=h('#gh_column_contents a.item-link[href*="/TempoAllocateTime!default.jspa"]');if(g.length>0){var k=h("<a/>").addClass("issueaction-tempo-add-hours-on-issue");k.appendTo("body");g.bind("click",function(m){k.attr("href",this.href);k.trigger("click");return false})}var c=h("<a/>").addClass("tempo-planning-create-team");c.appendTo("body");var e=h('#gh_column_contents a.item-link[href*="/AllocateTeam!default.jspa"]');e.bind("click",function(m){c.attr("href",this.href);c.trigger("click");return false});h("select.tempo-user-picker-admin").tempoSingleUserPicker({type:"admins"});h("select.tempo-user-picker-user").tempoSingleUserPicker();h("select.tempo-worklog-validation-picker").tempoIssuePicker();AJS.$("select.tempoDynamicDropDown").bind("change",function(){});AJS.$("select.issue-select").bind("change",function(){});tempo.blanket.appendTo("body")});
/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.issue.js' */
tempo.issue=(function(f){function a(k,h,i){k.find("select.tempoDynamicDropDown").populateDynamicDropdown(h);var m=i.attr("issue-internal")==="true";if(m){k.find("div.remaining-and-billed-hours-container").hide()}else{k.find("div.remaining-and-billed-hours-container").show();var j=k.find("input.remaining");j.val(i.attr("remaining_estimate"));k.find("span.originalEstimate").text(i.attr("original_estimate"));k.find("span.remainingEstimate").text(i.attr("remaining_estimate"));k.find("span.totalSpent").text(i.attr("hours_spent"));var l=k.find(":input[name=time]");if(l.length>0&&l.val()!==""){tempo.calculateRemainingEstimate(k,j,l.val())}}}function g(h,j,m){j.cleanFormValidation();var l=j.find("input[name=user]").val();if(j.find("select.dialog-user-picker").val()){l=f(j.find("select.dialog-user-picker").val()).get(0)}var k=j.find("ul.error-list");if(l!==""){var i=contextPath+"/rest/tempo-rest/2.0/issue/"+h+"/"+true;f.ajax({url:i,data:{username:l},cache:false,success:function(n){f(n).find("issue").each(function(){var o=f(this);if(o.attr("issue-valid")==="false"){var p=f(this).find("error");k.append(f("<li/>").text(p.attr("message")))}else{if(!m){a(j,h,o)}}})}})}}function d(i,l){var m=l.find(".tempo-subtask-container");var h=l.find("select.tempo-subtask-picker");m.addClass("hidden");h.empty();h.append(f("<option>",{value:i}).text("Select Sub-task"));var k=contextPath+"/rest/tempo-rest/2.0/issues/picker/subTasks/"+i;var j=parseInt(l.find("select.tempo-subtask-picker").attr("data-counter"),10);f.ajax({url:k,cache:false,success:function(n){f(n).find("item").each(function(){var o=f(this);h.append(f("<option>",{value:o.attr("key")}).text(o.attr("key")+" "+o.attr("name")))});if(f(n).find("item").size()===0){m.addClass("hidden");l.find(".tempo-issue-container").removeClass("highlighted")}else{if(j===3){m.removeClass("hidden");l.find(".tempo-issue-container").addClass("highlighted");l.find(".tempo-subtask-container").removeClass("highlighted")}}}})}function c(h){return h!==undefined&&h!==""&&h.match(/^\w+-\d+$/)}function b(j){var i=f(this).closest("form").cleanFormValidation();var h;if(i.find("select.tempo-issue-picker").val()!==null){h=f(i.find("select.tempo-issue-picker").val()).get(0)}var k=f(j.currentTarget).hasClass("dialog-user-picker");if(c(h)){if(i.find("select.tempo-subtask-picker").length!==0&&!k){d(h,i);f("select.tempo-subtask-picker").trigger("change")}else{g(h,i,k)}}}function e(k){var j=f(this).closest("form").cleanFormValidation();var h=f(j.find("select.tempo-issue-picker").val()).get(0);var i=parseInt(j.find("select.tempo-subtask-picker").attr("data-counter"),10);if(f(this).children().length>1){if(i===3&&(this.value===j.find("select.tempo-issue-picker").val()[0])){j.find(".tempo-issue-container").addClass("highlighted");j.find(".tempo-subtask-container").removeClass("highlighted")}else{j.find(".tempo-issue-container").removeClass("highlighted");j.find(".tempo-subtask-container").addClass("highlighted");h=j.find("select.tempo-subtask-picker").val()}}var l=f(k.currentTarget).hasClass("dialog-user-picker");if(c(h)){g(h,j,l)}}f("select.tempo-issue-picker").live("change",b);f("select.sub-issue-select").live("change",e);f("select.dialog-user-picker").live("change",b);f("select.tempo-filter-dropdown").live("change",function(i){var h=i.target.value;f(this).closest("form").find("select.tempo-issue-picker-filter").parent().html("<label for='tempo-issue-picker-filter'>"+"Issue"+"</label><select id='tempo-issue-picker' class='tempo-issue-picker tempo-issue-picker-filter' name='issue'/>");f("select.tempo-issue-picker-filter").tempoIssuePicker({type:"filter/"+h})});return{get:g,select:b,valid:c}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-ads-plugin:jira-ads-plugin-resources', location = '/js/jira-ads-plugin.js' */
AJS.toInit(function(c){var d=Class.extend({init:function(f){var h=f.find(".ads"),g=this;this._fireShowEvent=_.debounce(_.bind(this._fireShowEvent,this),2500);this._bindShowEvent();this._fireShowEvent(h);f.on("click",".click-ad-analytics",i);f.on("click",".adContainer .icon-close",e);function e(){var k=c(this).closest(".adContainer"),j=k.attr("data-id");g._dismissForUserForGood(j);k.remove()}function i(){var l=c(this),m=l.data("link-id"),j=l.closest(".adContainer").attr("data-id"),k=l.closest(".ads").data("issuetypeid");g._raiseAnalyticsEvent(j,k,m)}},_bindShowEvent:function(){var e=this;JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,f){if(f.hasClass("ads")){e._fireShowEvent(f)}})},_fireShowEvent:function(g){var f=g.data("issuetypeid"),e=this;g.find(".adContainer").each(function(){var h=c(this).attr("data-id");e._raiseAnalyticsEvent(h,f,"show")})},_raiseAnalyticsEvent:function(e,f,h){var g={name:"jiraads."+e+"."+h,data:{issueTypeId:f,adLocation:"viewIssue"}};AJS.trigger("analyticsEvent",g)},_dismissForUserForGood:function(e){c.ajax({url:AJS.contextPath()+"/rest/recommendations/latest/configuration/"+encodeURIComponent(e)+"/dismiss",type:"PUT"})}});var b=Class.extend({init:function(e){this._attachContactDetailsPopup(e)},_attachContactDetailsPopup:function(e){AJS.InlineDialog(".adContainer #contactLicensee","contactLicensee",function(i,g,j){var f=c(g),h=f.closest(".adContainer");i.html(h.find(".contactLicenseePopup").html());j()},{container:e,closeOthers:false,useLiveEvents:true})}});var a=c("#page");new d(a);new b(a)});
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/backbone/backbone.js' */
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports}else{z=u.Backbone={}}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("underscore")}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments)});P._callback=Q;return this.on(N,P,O)},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this}if(!M&&!V&&!N){this._events={};return this}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U)}}}if(!T.length){delete this._events[M]}}}return this},trigger:function(O){if(!this._events){return this}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this}var P=this._events[O];var M=this._events.all;if(P){b(P,N)}if(M){b(M,arguments)}return this},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this}var O=!M&&!R;if(typeof M==="object"){R=this}if(P){(N={})[P._listenerId]=P}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q]}}return this}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q))}return false}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q))}return false}return true};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx)}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N)}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M)}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T)}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P)}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this}Q[M](O,S,this);return this}});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{}}if(P=L.result(this,"defaults")){N=L.defaults({},N,P)}this.set(N,O);this.changed={};this.initialize.apply(this,arguments)};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes)},sync:function(){return z.sync.apply(this,arguments)},get:function(M){return this.attributes[M]},escape:function(M){return L.escape(this.get(M))},has:function(M){return this.get(M)!=null},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this}if(typeof U==="object"){V=U;Y=M}else{(V={})[U]=M}Y||(Y={});if(!this._validate(V,Y)){return false}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={}}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute]}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S)}if(!L.isEqual(O[S],M)){this.changed[S]=M}else{delete this.changed[S]}W?delete Q[S]:Q[S]=M}if(!R){if(T.length){this._pending=true}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y)}}if(X){return this}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y)}}this._pending=false;this._changing=false;return this},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}))},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0}return this.set(M,L.extend({},N,{unset:true}))},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed)}return L.has(this.changed,M)},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue}(P||(P={}))[M]=Q}return P},previous:function(M){if(M==null||!this._previousAttributes){return null}return this._previousAttributes[M]},previousAttributes:function(){return L.clone(this._previousAttributes)},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false}if(O){O(M,P,N)}M.trigger("sync",M,P,N)};H(this,N);return this.sync("read",this,N)},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N}else{(R={})[Q]=N}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false}if(R&&U.wait){this.attributes=L.extend({},O,R)}if(U.parse===void 0){U.parse=true}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V)}if(L.isObject(V)&&!P.set(V,U)){return false}if(S){S(P,W,U)}P.trigger("sync",P,W,U)};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O}return T},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N)};N.success=function(R){if(N.wait||M.isNew()){O()}if(Q){Q(M,R,N)}if(!M.isNew()){M.trigger("sync",M,R,N)}};if(this.isNew()){N.success();return false}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O()}return P},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(N,M){return N},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}))},_validate:function(O,N){if(!N.validate||!this.validate){return true}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N)}});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url}if(M.model){this.model=M.model}if(M.comparator!==void 0){this.comparator=M.comparator}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M))}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M)})},sync:function(){return z.sync.apply(this,arguments)},add:function(N,M){return this.set(N,L.defaults(M||{},K))},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P)}this._removeReference(N)}return this},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z)}if(!L.isArray(N)){N=N?[N]:[]}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue}if(O=this.get(W)){if(Z.remove){S[O.cid]=true}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W)}}if(M.length){this.remove(M,Z)}}if(Y.length){if(T){V=true}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y))}else{D.apply(this.models,Y)}}if(V){this.sort({silent:true})}if(Z.silent){return this}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z)}if(V){this.trigger("sort",this,Z)}return this},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O])}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N)}return this},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N},shift:function(N){var M=this.at(0);this.remove(M,N);return M},slice:function(N,M){return this.models.slice(N,M)},get:function(M){if(M==null){return void 0}return this._byId[M.id!=null?M.id:M.cid||M]},at:function(M){return this.models[M]},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[]}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false}}return true})},findWhere:function(M){return this.where(M,true)},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(L.bind(this.comparator,this))}if(!M.silent){this.trigger("sort",this,M)}return this},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L.sortedIndex(this.models,M,O,N)},pluck:function(M){return L.invoke(this.models,"get",M)},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M)}N.trigger("sync",N,P,M)};H(this,M);return this.sync("read",this,M)},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false}if(!M.wait){this.add(N,M)}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M)}if(O){O(N,Q,M)}};N.save(null,M);return N},parse:function(N,M){return N},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this}return O}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false}return M},_removeReference:function(M){if(this===M.collection){delete M.collection}M.off("all",this._onModelEvent,this)},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return}if(O==="destroy"){this.remove(N,M)}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N}}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N)}});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L[M](this.models,O,N)}});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(M,N){if(this.$el){this.undelegateEvents()}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents()}return this},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]]}if(!R){continue}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R)}else{this.$el.on(N,M,R)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M)}L.extend(this,L.pick(M,e));this.options=M},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id")}if(this.className){M["class"]=L.result(this,"className")}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false)}else{this.setElement(L.result(this,"el"),false)}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r()}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M))}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{}}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments)}}}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments)};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N)}if(L.isFunction(O)){P=O;O=""}if(!P){P=this[O]}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q)});return this},navigate:function(N,M){z.history.navigate(N,M);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N])}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)"}).replace(d,"(.*?)");return new RegExp("^"+M+"$")},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null})}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:""},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length)}}else{O=this.getHash()}}return O.replace(A,"")},start:function(O){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N)}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false},route:function(M,N){this.handlers.unshift({route:M,callback:N})},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe))}if(M===this.fragment){return false}if(this.iframe){this.navigate(M)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true}});return M},navigate:function(O,N){if(!i.started){return false}if(!N||N===true){N={trigger:N}}O=this.getFragment(O||"");if(this.fragment===O){return}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M)}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,O,N.replace)}}else{return this.location.assign(M)}}if(N.trigger){this.loadUrl(O)}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O)}else{M.hash="#"+O}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor}else{Q=function(){return N.apply(this,arguments)}}L.extend(Q,N,O);var P=function(){this.constructor=Q};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M)}Q.__super__=N.prototype;return Q};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified')};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N)}O.trigger("error",O,P,N)}}}).call(this);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/marionettejs/backbone.marionette-1.6.1.js' */
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(d,c){var a=function(e){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();c.each(e,this.add,this)};c.extend(a.prototype,{add:function(e,g){var f=e.cid;this._views[f]=e;if(e.model){this._indexByModel[e.model.cid]=f}if(g){this._indexByCustom[g]=f}this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var f=this._indexByModel[e];return this.findByCid(f)},findByCustom:function(f){var e=this._indexByCustom[f];return this.findByCid(e)},findByIndex:function(e){return c.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var f=e.cid;if(e.model){delete this._indexByModel[e.model.cid]}c.any(this._indexByCustom,function(h,g){if(h===f){delete this._indexByCustom[g];return true}},this);delete this._views[f];this._updateLength()},call:function(e){this.apply(e,c.tail(arguments))},apply:function(f,e){c.each(this._views,function(g){if(c.isFunction(g[f])){g[f].apply(g,e||[])}})},_updateLength:function(){this.length=c.size(this._views)}});var b=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];c.each(b,function(e){a.prototype[e]=function(){var f=c.values(this._views);var g=[f].concat(c.toArray(arguments));return c[e].apply(c,g)}});return a})(Backbone,_);Backbone.Wreqr=(function(d,c,a){var b={};b.Handlers=(function(g,f){var e=function(h){this.options=h;this._wreqrHandlers={};if(f.isFunction(this.initialize)){this.initialize(h)}};e.extend=g.Model.extend;f.extend(e.prototype,g.Events,{setHandlers:function(h){f.each(h,function(k,i){var j=null;if(f.isObject(k)&&!f.isFunction(k)){j=k.context;k=k.callback}this.setHandler(i,k,j)},this)},setHandler:function(i,k,j){var h={callback:k,context:j};this._wreqrHandlers[i]=h;this.trigger("handler:add",i,k,j)},hasHandler:function(h){return !!this._wreqrHandlers[h]},getHandler:function(i){var h=this._wreqrHandlers[i];if(!h){throw new Error("Handler not found for '"+i+"'")}return function(){var j=Array.prototype.slice.apply(arguments);return h.callback.apply(h.context,j)}},removeHandler:function(h){delete this._wreqrHandlers[h]},removeAllHandlers:function(){this._wreqrHandlers={}}});return e})(d,a);b.CommandStorage=(function(){var e=function(f){this.options=f;this._commands={};if(a.isFunction(this.initialize)){this.initialize(f)}};a.extend(e.prototype,d.Events,{getCommands:function(g){var f=this._commands[g];if(!f){f={command:g,instances:[]};this._commands[g]=f}return f},addCommand:function(g,f){var h=this.getCommands(g);h.instances.push(f)},clearCommands:function(f){var g=this.getCommands(f);g.instances=[]}});return e})();b.Commands=(function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(g){this.options=g||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var f=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,f)},execute:function(g,f){g=arguments[0];f=Array.prototype.slice.call(arguments,1);if(this.hasHandler(g)){this.getHandler(g).apply(this,f)}else{this.storage.addCommand(g,f)}},_executeCommands:function(f,h,g){var i=this.storage.getCommands(f);a.each(i.instances,function(j){h.apply(g,j)});this.storage.clearCommands(f)},_initializeStorage:function(f){var h;var g=f.storageType||this.storageType;if(a.isFunction(g)){h=new g()}else{h=g}this.storage=h}})})(b);b.RequestResponse=(function(e){return e.Handlers.extend({request:function(){var g=arguments[0];var f=Array.prototype.slice.call(arguments,1);return this.getHandler(g).apply(this,f)}})})(b);b.EventAggregator=(function(g,e){var f=function(){};f.extend=g.Model.extend;e.extend(f.prototype,g.Events);return f})(d,a);return b})(Backbone,Backbone.Marionette,_);var Marionette=(function(b,g,a){var f={};g.Marionette=f;f.$=g.$;var c=Array.prototype.slice;function d(h){return c.call(h)}function e(j,i){var h=new Error(j);h.name=i||"Error";throw h}f.extend=g.Model.extend;f.getOption=function(j,h){if(!j||!h){return}var i;if(j.options&&(h in j.options)&&(j.options[h]!==undefined)){i=j.options[h]}else{i=j[h]}return i};f.triggerMethod=(function(){var i=/(^|:)(\w)/gi;function j(l,m,k){return k.toUpperCase()}var h=function(l){var k="on"+l.replace(i,j);var m=this[k];if(a.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(a.isFunction(m)){return m.apply(this,a.tail(arguments))}};return h})();f.MonitorDOMRefresh=(function(i){function l(m){m._isShown=true;j(m)}function k(m){m._isRendered=true;j(m)}function j(m){if(m._isShown&&m._isRendered&&h(m)){if(a.isFunction(m.triggerMethod)){m.triggerMethod("dom:refresh")}}}function h(m){return i.contains(m.el)}return function(m){m.listenTo(m,"show",function(){l(m)});m.listenTo(m,"render",function(){k(m)})}})(document.documentElement);(function(m){function l(r,p,n,o){var q=o.split(/\s+/);a.each(q,function(s){var t=r[s];if(!t){e("Method '"+s+"' was configured as an event handler, but does not exist.")}r.listenTo(p,n,t,r)})}function h(p,o,n,q){p.listenTo(o,n,q,p)}function j(r,p,n,o){var q=o.split(/\s+/);a.each(q,function(s){var t=r[s];r.stopListening(p,n,t,r)})}function i(p,o,n,q){p.stopListening(o,n,q,p)}function k(q,n,r,p,o){if(!n||!r){return}if(a.isFunction(r)){r=r.call(q)}a.each(r,function(t,s){if(a.isFunction(t)){p(q,n,s,t)}else{o(q,n,s,t)}})}m.bindEntityEvents=function(o,n,p){k(o,n,p,h,l)};m.unbindEntityEvents=function(o,n,p){k(o,n,p,i,j)}})(f);f.Callbacks=function(){this._deferred=f.$.Deferred();this._callbacks=[]};a.extend(f.Callbacks.prototype,{add:function(i,h){this._callbacks.push({cb:i,ctx:h});this._deferred.done(function(k,j){if(h){k=h}i.call(k,j)})},run:function(h,i){this._deferred.resolve(i,h)},reset:function(){var h=this._callbacks;this._deferred=f.$.Deferred();this._callbacks=[];a.each(h,function(i){this.add(i.cb,i.ctx)},this)}});f.Controller=function(h){this.triggerMethod=f.triggerMethod;this.options=h||{};if(a.isFunction(this.initialize)){this.initialize(this.options)}};f.Controller.extend=f.extend;a.extend(f.Controller.prototype,g.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});f.Region=function(i){this.options=i||{};this.el=f.getOption(this,"el");if(!this.el){var j=new Error("An 'el' must be specified for a region.");j.name="NoElError";throw j}if(this.initialize){var h=Array.prototype.slice.apply(arguments);this.initialize.apply(this,h)}};a.extend(f.Region,{buildRegion:function(i,o){var m=(typeof i==="string");var l=(typeof i.selector==="string");var p=(typeof i.regionType==="undefined");var j=(typeof i==="function");if(!j&&!m&&!l){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var h,k;if(m){h=i}if(i.selector){h=i.selector;delete i.selector}if(j){k=i}if(!j&&p){k=o}if(i.regionType){k=i.regionType;delete i.regionType}if(m||j){i={}}i.el=h;var n=new k(i);if(i.parentEl){n.getEl=function(q){var r=i.parentEl;if(a.isFunction(r)){r=r()}return r.find(q)}}return n}});a.extend(f.Region.prototype,g.Events,{show:function(j){this.ensureEl();var h=j.isClosed||a.isUndefined(j.$el);var i=j!==this.currentView;if(i){this.close()}j.render();if(i||h){this.open(j)}this.currentView=j;f.triggerMethod.call(this,"show",j);f.triggerMethod.call(j,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(h){return f.$(h)},open:function(h){this.$el.empty().append(h.el)},close:function(){var h=this.currentView;if(!h||h.isClosed){return}if(h.close){h.close()}else{if(h.remove){h.remove()}}f.triggerMethod.call(this,"close",h);delete this.currentView},attachView:function(h){this.currentView=h},reset:function(){this.close();delete this.$el}});f.Region.extend=f.extend;f.RegionManager=(function(j){var i=j.Controller.extend({constructor:function(k){this._regions={};j.Controller.prototype.constructor.call(this,k)},addRegions:function(k,l){var m={};a.each(k,function(o,n){if(typeof o==="string"){o={selector:o}}if(o.selector){o=a.defaults({},o,l)}var p=this.addRegion(n,o);m[n]=p},this);return m},addRegion:function(m,n){var p;var l=a.isObject(n);var k=a.isString(n);var o=!!n.selector;if(k||(l&&o)){p=j.Region.buildRegion(n,j.Region)}else{if(a.isFunction(n)){p=j.Region.buildRegion(n,j.Region)}else{p=n}}this._store(m,p);this.triggerMethod("region:add",m,p);return p},get:function(k){return this._regions[k]},removeRegion:function(k){var l=this._regions[k];this._remove(k,l)},removeRegions:function(){a.each(this._regions,function(l,k){this._remove(k,l)},this)},closeRegions:function(){a.each(this._regions,function(l,k){l.close()},this)},close:function(){this.removeRegions();var k=Array.prototype.slice.call(arguments);j.Controller.prototype.close.apply(this,k)},_store:function(k,l){this._regions[k]=l;this._setLength()},_remove:function(k,l){l.close();delete this._regions[k];this._setLength();this.triggerMethod("region:remove",k,l)},_setLength:function(){this.length=a.size(this._regions)}});var h=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];a.each(h,function(k){i.prototype[k]=function(){var m=a.values(this._regions);var l=[m].concat(a.toArray(arguments));return a[k].apply(a,l)}});return i})(f);f.TemplateCache=function(h){this.templateId=h};a.extend(f.TemplateCache,{templateCaches:{},get:function(h){var i=this.templateCaches[h];if(!i){i=new f.TemplateCache(h);this.templateCaches[h]=i}return i.load()},clear:function(){var j;var h=d(arguments);var k=h.length;if(k>0){for(j=0;j<k;j++){delete this.templateCaches[h[j]]}}else{this.templateCaches={}}}});a.extend(f.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var h=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(h);return this.compiledTemplate},loadTemplate:function(h){var i=f.$(h).html();if(!i||i.length===0){e("Could not find template: '"+h+"'","NoTemplateError")}return i},compileTemplate:function(h){return a.template(h)}});f.Renderer={render:function(j,k){if(!j){var h=new Error("Cannot render the template since it's false, null or undefined.");h.name="TemplateNotFoundError";throw h}var i;if(typeof j==="function"){i=j}else{i=f.TemplateCache.get(j)}return i(k)}};f.View=g.View.extend({constructor:function(i){a.bindAll(this,"render");var h=Array.prototype.slice.apply(arguments);this.options=a.extend({},a.result(this,"options"),a.isFunction(i)?i.call(this):i);this.events=this.normalizeUIKeys(a.result(this,"events"));g.View.prototype.constructor.apply(this,h);f.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:f.triggerMethod,getTemplate:function(){return f.getOption(this,"template")},mixinTemplateHelpers:function(h){h=h||{};var i=f.getOption(this,"templateHelpers");if(a.isFunction(i)){i=i.call(this)}return a.extend(h,i)},normalizeUIKeys:function(h){if(typeof(h)==="undefined"){return}a.each(a.keys(h),function(i){var j=i.split("@ui.");if(j.length===2){h[j[0]+this.ui[j[1]]]=h[i];delete h[i]}},this);return h},configureTriggers:function(){if(!this.triggers){return}var i={};var h=this.normalizeUIKeys(a.result(this,"triggers"));a.each(h,function(l,k){var m=a.isObject(l);var j=m?l.event:l;i[k]=function(s){if(s){var n=s.preventDefault;var r=s.stopPropagation;var q=m?l.preventDefault:n;var p=m?l.stopPropagation:r;if(q&&n){n.apply(s)}if(p&&r){r.apply(s)}}var o={view:this,model:this.model,collection:this.collection};this.triggerMethod(j,o)}},this);return i},delegateEvents:function(h){this._delegateDOMEvents(h);f.bindEntityEvents(this,this.model,f.getOption(this,"modelEvents"));f.bindEntityEvents(this,this.collection,f.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(h){h=h||this.events;if(a.isFunction(h)){h=h.call(this)}var j={};var i=this.configureTriggers();a.extend(j,h,i);g.View.prototype.delegateEvents.call(this,j)},undelegateEvents:function(){var h=Array.prototype.slice.call(arguments);g.View.prototype.undelegateEvents.apply(this,h);f.unbindEntityEvents(this,this.model,f.getOption(this,"modelEvents"));f.unbindEntityEvents(this,this.collection,f.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return}var h=this.triggerMethod("before:close");if(h===false){return}this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return}if(!this._uiBindings){this._uiBindings=this.ui}var h=a.result(this,"_uiBindings");this.ui={};a.each(a.keys(h),function(j){var i=h[j];this.ui[j]=this.$(i)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return}a.each(this.ui,function(i,h){delete this.ui[h]},this);this.ui=this._uiBindings;delete this._uiBindings}});f.ItemView=f.View.extend({constructor:function(){f.View.prototype.constructor.apply(this,d(arguments))},serializeData:function(){var h={};if(this.model){h=this.model.toJSON()}else{if(this.collection){h={items:this.collection.toJSON()}}}return h},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var j=this.serializeData();j=this.mixinTemplateHelpers(j);var i=this.getTemplate();var h=f.Renderer.render(i,j);this.$el.html(h);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return}this.triggerMethod("item:before:close");f.View.prototype.close.apply(this,d(arguments));this.triggerMethod("item:closed")}});f.CollectionView=f.View.extend({itemViewEventPrefix:"itemview",constructor:function(h){this._initChildViewStorage();f.View.prototype.constructor.apply(this,d(arguments));this._initialEvents();this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment();this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){this.isBuffering=false;this.appendBuffer(this,this.elBuffer);this._triggerShowBufferedChildren();this.initRenderBuffer()},_triggerShowBufferedChildren:function(){if(this._isShown){a.each(this._bufferedChildren,function(h){f.triggerMethod.call(h,"show")});this._bufferedChildren=[]}},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(k,l,i){this.closeEmptyView();var j=this.getItemView(k);var h=this.collection.indexOf(k);this.addItemView(k,j,h)},onShowCalled:function(){this.children.each(function(h){f.triggerMethod.call(h,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.startBuffering();this.closeEmptyView();this.closeChildren();if(!this.isEmpty(this.collection)){this.showCollection()}else{this.showEmptyView()}this.endBuffering()},showCollection:function(){var h;this.collection.each(function(j,i){h=this.getItemView(j);this.addItemView(j,h,i)},this)},showEmptyView:function(){var i=this.getEmptyView();if(i&&!this._showingEmptyView){this._showingEmptyView=true;var h=new g.Model();this.addItemView(h,i,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getEmptyView:function(){return f.getOption(this,"emptyView")},getItemView:function(i){var h=f.getOption(this,"itemView");if(!h){e("An `itemView` must be specified","NoItemViewError")}return h},addItemView:function(k,j,i){var l=f.getOption(this,"itemViewOptions");if(a.isFunction(l)){l=l.call(this,k,i)}var h=this.buildItemView(k,j,l);this.addChildViewEventForwarding(h);this.triggerMethod("before:item:added",h);this.children.add(h);this.renderItemView(h,i);if(this._isShown&&!this.isBuffering){f.triggerMethod.call(h,"show")}this.triggerMethod("after:item:added",h);return h},addChildViewEventForwarding:function(h){var i=f.getOption(this,"itemViewEventPrefix");this.listenTo(h,"all",function(){var k=d(arguments);var l=k[0];var j=this.getItemEvents();k[0]=i+":"+l;k.splice(1,0,h);if(typeof j!=="undefined"&&a.isFunction(j[l])){j[l].apply(this,k)}f.triggerMethod.apply(this,k)},this)},getItemEvents:function(){if(a.isFunction(this.itemEvents)){return this.itemEvents.call(this)}return this.itemEvents},renderItemView:function(h,i){h.render();this.appendHtml(this,h,i)},buildItemView:function(j,h,k){var i=a.extend({model:j},k);return new h(i)},removeItemView:function(i){var h=this.children.findByModel(i);this.removeChildView(h);this.checkEmpty()},removeChildView:function(h){if(h){this.stopListening(h);if(h.close){h.close()}else{if(h.remove){h.remove()}}this.children.remove(h)}this.triggerMethod("item:removed",h)},isEmpty:function(h){return !this.collection||this.collection.length===0},checkEmpty:function(){if(this.isEmpty(this.collection)){this.showEmptyView()}},appendBuffer:function(i,h){i.$el.append(h)},appendHtml:function(h,j,i){if(h.isBuffering){h.elBuffer.appendChild(j.el);h._bufferedChildren.push(j)}else{h.$el.append(j.el)}},_initChildViewStorage:function(){this.children=new g.ChildViewContainer()},close:function(){if(this.isClosed){return}this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");f.View.prototype.close.apply(this,d(arguments))},closeChildren:function(){this.children.each(function(h){this.removeChildView(h)},this);this.checkEmpty()}});f.CompositeView=f.CollectionView.extend({constructor:function(){f.CollectionView.prototype.constructor.apply(this,d(arguments))},_initialEvents:function(){this.once("render",function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}})},getItemView:function(i){var h=f.getOption(this,"itemView")||this.constructor;if(!h){e("An `itemView` must be specified","NoItemViewError")}return h},serializeData:function(){var h={};if(this.model){h=this.model.toJSON()}return h},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var h=this.renderModel();this.$el.html(h);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){this.triggerMethod("composite:collection:before:render");f.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var i={};i=this.serializeData();i=this.mixinTemplateHelpers(i);var h=this.getTemplate();return f.Renderer.render(h,i)},appendBuffer:function(i,h){var j=this.getItemViewContainer(i);j.append(h)},appendHtml:function(h,j,i){if(h.isBuffering){h.elBuffer.appendChild(j.el);h._bufferedChildren.push(j)}else{var k=this.getItemViewContainer(h);k.append(j.el)}},getItemViewContainer:function(k){if("$itemViewContainer" in k){return k.$itemViewContainer}var i;var j=f.getOption(k,"itemViewContainer");if(j){var h=a.isFunction(j)?j.call(this):j;i=k.$(h);if(i.length<=0){e("The specified `itemViewContainer` was not found: "+k.itemViewContainer,"ItemViewContainerMissingError")}}else{i=k.$el}k.$itemViewContainer=i;return i},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});f.Layout=f.ItemView.extend({regionType:f.Region,constructor:function(h){h=h||{};this._firstRender=true;this._initializeRegions(h);f.ItemView.prototype.constructor.call(this,h)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var i=Array.prototype.slice.apply(arguments);var h=f.ItemView.prototype.render.apply(this,i);return h},close:function(){if(this.isClosed){return}this.regionManager.close();var h=Array.prototype.slice.apply(arguments);f.ItemView.prototype.close.apply(this,h)},addRegion:function(h,i){var j={};j[h]=i;return this._buildRegions(j)[h]},addRegions:function(h){this.regions=a.extend({},this.regions,h);return this._buildRegions(h)},removeRegion:function(h){delete this.regions[h];return this.regionManager.removeRegion(h)},_buildRegions:function(j){var h=this;var i={regionType:f.getOption(this,"regionType"),parentEl:function(){return h.$el}};return this.regionManager.addRegions(j,i)},_initializeRegions:function(h){var i;this._initRegionManager();if(a.isFunction(this.regions)){i=this.regions(h)}else{i=this.regions||{}}this.addRegions(i)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(h){h.reset()})},_initRegionManager:function(){this.regionManager=new f.RegionManager();this.listenTo(this.regionManager,"region:add",function(h,i){this[h]=i;this.trigger("region:add",h,i)});this.listenTo(this.regionManager,"region:remove",function(h,i){delete this[h];this.trigger("region:remove",h,i)})}});f.AppRouter=g.Router.extend({constructor:function(i){g.Router.prototype.constructor.apply(this,d(arguments));this.options=i||{};var j=f.getOption(this,"appRoutes");var h=this._getController();this.processAppRoutes(h,j)},appRoute:function(j,i){var h=this._getController();this._addAppRoute(h,j,i)},processAppRoutes:function(h,j){if(!j){return}var i=a.keys(j).reverse();a.each(i,function(k){this._addAppRoute(h,k,j[k])},this)},_getController:function(){return f.getOption(this,"controller")},_addAppRoute:function(h,j,i){var k=h[i];if(!k){throw new Error("Method '"+i+"' was not found on the controller")}this.route(j,i,a.bind(k,h))}});f.Application=function(h){this._initRegionManager();this._initCallbacks=new f.Callbacks();this.vent=new g.Wreqr.EventAggregator();this.commands=new g.Wreqr.Commands();this.reqres=new g.Wreqr.RequestResponse();this.submodules={};a.extend(this,h);this.triggerMethod=f.triggerMethod};a.extend(f.Application.prototype,g.Events,{execute:function(){var h=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,h)},request:function(){var h=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,h)},addInitializer:function(h){this._initCallbacks.add(h)},start:function(h){this.triggerMethod("initialize:before",h);this._initCallbacks.run(h,this);this.triggerMethod("initialize:after",h);this.triggerMethod("start",h)},addRegions:function(h){return this._regionManager.addRegions(h)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(h){this._regionManager.removeRegion(h)},getRegion:function(h){return this._regionManager.get(h)},module:function(h,k){var j=f.Module;if(k){j=k.moduleClass||j}var i=d(arguments);i.unshift(this);return j.create.apply(j,i)},_initRegionManager:function(){this._regionManager=new f.RegionManager();this.listenTo(this._regionManager,"region:add",function(h,i){this[h]=i});this.listenTo(this._regionManager,"region:remove",function(h,i){delete this[h]})}});f.Application.extend=f.extend;f.Module=function(i,j,h){this.moduleName=i;this.options=a.extend({},this.options,h);this.initialize=h.initialize||this.initialize;this.submodules={};this._setupInitializersAndFinalizers();this.app=j;this.startWithParent=true;this.triggerMethod=f.triggerMethod;if(a.isFunction(this.initialize)){this.initialize(this.options)}};f.Module.extend=f.extend;a.extend(f.Module.prototype,g.Events,{initialize:function(){},addInitializer:function(h){this._initializerCallbacks.add(h)},addFinalizer:function(h){this._finalizerCallbacks.add(h)},start:function(h){if(this._isInitialized){return}a.each(this.submodules,function(i){if(i.startWithParent){i.start(h)}});this.triggerMethod("before:start",h);this._initializerCallbacks.run(h,this);this._isInitialized=true;this.triggerMethod("start",h)},stop:function(){if(!this._isInitialized){return}this._isInitialized=false;f.triggerMethod.call(this,"before:stop");a.each(this.submodules,function(h){h.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();f.triggerMethod.call(this,"stop")},addDefinition:function(h,i){this._runModuleDefinition(h,i)},_runModuleDefinition:function(i,j){if(!i){return}var h=a.flatten([this,this.app,g,f,f.$,a,j]);i.apply(this,h)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new f.Callbacks();this._finalizerCallbacks=new f.Callbacks()}});a.extend(f.Module,{create:function(n,h,i){var j=n;var l=d(arguments);l.splice(0,3);h=h.split(".");var k=h.length;var m=[];m[k-1]=i;a.each(h,function(o,p){var q=j;j=this._getModule(q,o,n,i);this._addModuleDefinition(q,j,m[p],l)},this);return j},_getModule:function(n,k,o,m,j){var i=f.Module;var h=a.extend({},m);if(m){i=m.moduleClass||i}var l=n[k];if(!l){l=new i(k,o,h);n[k]=l;n.submodules[k]=l}return l},_addModuleDefinition:function(m,i,l,h){var k;var j;if(a.isFunction(l)){k=l;j=true}else{if(a.isObject(l)){k=l.define;j=(typeof l.startWithParent!=="undefined")?l.startWithParent:true}else{j=true}}if(k){i.addDefinition(k,h)}i.startWithParent=i.startWithParent&&j;if(i.startWithParent&&!i.startWithParentIsConfigured){i.startWithParentIsConfigured=true;m.addInitializer(function(n){if(i.startWithParent){i.start(n)}})}}});return f})(this,Backbone,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:backbone-marionette', location = 'lib/namespace.js' */
JIRA.ProjectConfig||(JIRA.ProjectConfig={});JIRA.ProjectConfig.Backbone=Backbone.noConflict();
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/lib/jquery-scrollintoview/jquery.scrollintoview.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(f){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var e=/^(?:html)$/i;var g=function(k,j){j=j||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var i=document.defaultView&&document.defaultView.getComputedStyle?true:false;var h={top:(parseFloat(i?j.borderTopWidth:f.css(k,"borderTopWidth"))||0),left:(parseFloat(i?j.borderLeftWidth:f.css(k,"borderLeftWidth"))||0),bottom:(parseFloat(i?j.borderBottomWidth:f.css(k,"borderBottomWidth"))||0),right:(parseFloat(i?j.borderRightWidth:f.css(k,"borderRightWidth"))||0)};return{top:h.top,left:h.left,bottom:h.bottom,right:h.right,vertical:h.top+h.bottom,horizontal:h.left+h.right}};var d=function(h){var j=f(window);var i=e.test(h[0].nodeName);return{border:i?{top:0,left:0,bottom:0,right:0}:g(h[0]),scroll:{top:(i?j:h).scrollTop(),left:(i?j:h).scrollLeft()},scrollbar:{right:i?0:h.innerWidth()-h[0].clientWidth,bottom:i?0:h.innerHeight()-h[0].clientHeight},rect:(function(){var k=h[0].getBoundingClientRect();return{top:i?0:k.top,left:i?0:k.left,bottom:i?h[0].clientHeight:k.bottom,right:i?h[0].clientWidth:k.right}})()}};f.fn.extend({scrollIntoViewForAuto:function(j){j=f.extend({},b,j);j.direction=c[typeof(j.direction)==="string"&&j.direction.toLowerCase()]||c.both;var n="";if(j.direction.x===true){n="horizontal"}if(j.direction.y===true){n=n?"both":"vertical"}var l=this.eq(0);var i=l.closest(":scrollable("+n+")");if(i.length>0){i=i.eq(0);var m={e:d(l),s:d(i)};var h={top:m.e.rect.top-(m.s.rect.top+m.s.border.top),bottom:m.s.rect.bottom-m.s.border.bottom-m.s.scrollbar.bottom-m.e.rect.bottom,left:m.e.rect.left-(m.s.rect.left+m.s.border.left),right:m.s.rect.right-m.s.border.right-m.s.scrollbar.right-m.e.rect.right};var k={};if(j.direction.y===true){if(h.top<0){k.scrollTop=m.s.scroll.top+h.top-30}else{if(h.top>0&&h.bottom<0){k.scrollTop=m.s.scroll.top+Math.min(h.top,-h.bottom)+30}}}if(j.direction.x===true){if(h.left<0){k.scrollLeft=m.s.scroll.left+h.left}else{if(h.left>0&&h.right<0){k.scrollLeft=m.s.scroll.left+Math.min(h.left,-h.right)}}}if(!f.isEmptyObject(k)){if(e.test(i[0].nodeName)){i=f("html,body")}i.animate(k,j.duration).eq(0).queue(function(o){f.isFunction(j.complete)&&j.complete.call(i[0]);o()})}else{f.isFunction(j.complete)&&j.complete.call(i[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};f.extend(f.expr[":"],{scrollable:function(k,i,n,h){var m=c[typeof(n[3])==="string"&&n[3].toLowerCase()]||c.both;var l=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(k,null):k.currentStyle);var o={x:a[l.overflowX.toLowerCase()]||false,y:a[l.overflowY.toLowerCase()]||false,isRoot:e.test(k.nodeName)};if(!o.x&&!o.y&&!o.isRoot){return false}var j={height:{scroll:k.scrollHeight,client:k.clientHeight},width:{scroll:k.scrollWidth,client:k.clientWidth},scrollableX:function(){return(o.x||o.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(o.y||o.isRoot)&&this.height.scroll>this.height.client}};return m.y&&j.scrollableY()||m.x&&j.scrollableX()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/namespace.js' */
AJS.namespace("JIRA.Admin.CustomFields");
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'global/templates/messages.soy' */
// This file was automatically generated from messages.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Messages == 'undefined') { JIRA.Templates.Messages = {}; }


JIRA.Templates.Messages.msg = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), '"><p class="title"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.type), '"></span>', (opt_data.title) ? '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', '</p>', soy.$$escapeHtml(opt_data.message), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Messages.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.msg(soy.$$augmentData(opt_data, {type: 'error'}), output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/customfields.soy' */
// This file was automatically generated from customfields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }


JIRA.Templates.CustomFields.types = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="customfields-types"></ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.type = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type.previewImageUrl) ? '<img class="field-preview" src="' + soy.$$escapeHtml(opt_data.type.previewImageUrl) + '" alt="' + soy.$$escapeHtml(opt_data.type.name) + '" width="120" height="60" />' : '<span class="field-preview-empty"><span class="field-preview-empty-message">' + soy.$$escapeHtml("No field preview") + '</span></span>', (opt_data.type.isManaged) ? '<span class="aui-lozenge aui-lozenge-subtle field-is-managed" title="' + soy.$$escapeHtml(opt_data.type.managedDescription) + '">' + soy.$$escapeHtml("Managed") + '</span>' : '', '<h3 class="field-name">', soy.$$escapeHtml(opt_data.type.name), '</h3>', (opt_data.type.description) ? '<p class="field-description">' + soy.$$escapeHtml(opt_data.type.description) + '</p>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "Your search did not match any custom field types."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeMarketplace = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy35 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.contextPath), '/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&amp;source=custom_fields_create">');
  open__soy35 = open__soy35.toString();
  var close__soy39 = new soy.StringBuilder('</a>');
  close__soy39 = close__soy39.toString();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("Try searching the {0}Atlassian Marketplace{1} for other custom field types.",open__soy35,close__soy39)}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.emptyTypeOtherTab = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({titleContent: "Your search did not match any custom field types.", content: AJS.format("{0}Custom field types{1} have been found in other categories.",'<a href="#" class="customfields-all-category-link">','</a>')}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.quickSearch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input class="jira-field-search" type="text" title="', soy.$$escapeHtml("Search"), '" placeholder="', soy.$$escapeHtml("Search"), '">');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotification = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-notification"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogNotificationWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.warningMsg({msg: '<div class="jira-dialog-notification-content"></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.dialogHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'dialog-title\'><div class=\'jira-dialog-title-actions\'></div><div class=\'jira-dialog-title-main\'></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.errorDialogTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsComponent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="text" class="text custom-field-options-input" id="custom-field-options-input" maxlength="255"/><button type="button" class="aui-button custom-field-options-add" id="custom-field-options-add">', soy.$$escapeHtml("Add"), '</button><div id="custom-field-options-list-container" class="custom-field-options"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.singleSelectOptionsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="aui-icon aui-icon-small aui-iconfont-remove-label custom-field-options-delete" href="#"></a><div class="icon-draghandle custom-field-option-handle"></div><div title="', soy.$$escapeHtml(opt_data.name), '" class="custom-field-option-value">', soy.$$escapeHtml(opt_data.name), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.submitHack = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input tabIndex="-1" type="submit" class="custom-field-trigger" value="submit"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.addCompleteError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml(opt_data.message));
  if (opt_data.failedSteps.length > 0) {
    output.append('<ul>');
    var failList85 = opt_data.failedSteps;
    var failListLen85 = failList85.length;
    for (var failIndex85 = 0; failIndex85 < failListLen85; failIndex85++) {
      var failData85 = failList85[failIndex85];
      output.append('<li>', soy.$$escapeHtml(failData85), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.sharedByCreate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var open__soy92 = new soy.StringBuilder('<a>');
  open__soy92 = open__soy92.toString();
  var close__soy94 = new soy.StringBuilder('</a>');
  close__soy94 = close__soy94.toString();
  output.append((opt_data.projects.length > 1) ? '<span>' + AJS.format("This custom field will also be visible in {0}{1} other projects{2}.",open__soy92,opt_data.projects.length,close__soy94) + '</span>' : '<span>' + AJS.format("This custom field will also be visible in {0}1 other project{1}.",open__soy92,close__soy94) + '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.shareByInline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="shared-item-content"><h3>', soy.$$escapeHtml("Other projects where the field will be visible"), ':</h3><ul class="shared-project-list">');
  var projectList111 = opt_data.projects;
  var projectListLen111 = projectList111.length;
  for (var projectIndex111 = 0; projectIndex111 < projectListLen111; projectIndex111++) {
    var projectData111 = projectList111[projectIndex111];
    output.append('<li><a class="shared-project-name" href="', soy.$$escapeHtml(contextPath), '/plugins/servlet/project-config/', soy.$$escapeHtml(projectData111.key), '"><img class="shared-project-icon" width="16" height="16" alt="" src="', soy.$$escapeHtml(contextPath), '/secure/projectavatar?size=small&amp;pid=', soy.$$escapeHtml(projectData111.id), '" /> ', soy.$$escapeHtml(projectData111.name), '</a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/FieldWisherStep.soy' */
// This file was automatically generated from FieldWisherStep.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.FieldWisherStep == 'undefined') { JIRA.Templates.CustomFields.FieldWisherStep = {}; }


JIRA.Templates.CustomFields.FieldWisherStep.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui"><div class="field-group"><label for="field-name">', soy.$$escapeHtml("Name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("(required)"), '</span></label><select name="field-name" id="field-name"><option data-placeholder="empty"></option>');
  var fieldList8 = opt_data.fields;
  var fieldListLen8 = fieldList8.length;
  for (var fieldIndex8 = 0; fieldIndex8 < fieldListLen8; fieldIndex8++) {
    var fieldData8 = fieldList8[fieldIndex8];
    output.append('<option value="', soy.$$escapeHtml(fieldData8.id), '">', soy.$$escapeHtml(fieldData8.name), '</option>');
  }
  output.append('</select><div class="description">', soy.$$escapeHtml("Search for an existing field, or name a new one."), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/templates/ErrorDialog.soy' */
// This file was automatically generated from ErrorDialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.CustomFields == 'undefined') { JIRA.Templates.CustomFields = {}; }
if (typeof JIRA.Templates.CustomFields.ErrorDialog == 'undefined') { JIRA.Templates.CustomFields.ErrorDialog = {}; }


JIRA.Templates.CustomFields.ErrorDialog.header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml(opt_data.text), '</h2>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.CustomFields.ErrorDialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Messages.errorMessage({message: opt_data.text}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/ErrorDialog/ErrorDialog.js' */
(function(b,a,c,d){b.ErrorDialog=function(e){var g,f,h;e||(e={});a.defaults(e,{heading:"",message:""});g=new d.Marionette.View({el:c(JIRA.Templates.CustomFields.ErrorDialog.content({text:e.message}))});f=this.dialog=new b.Dialog();this.$el=f.$el;h=JIRA.Templates.CustomFields.ErrorDialog.header({text:e.heading});f.addHeaderMain(h);f.addPanel("",g);f.addLink({label:"Cancel",click:a.bind(this.cancel,this)});this.listenTo(f,"close",this.cancel)};a.extend(b.ErrorDialog.prototype,d.Events,{show:function(){this.dialog.show()},hide:function(){this.dialog&&this.dialog.hide()},cancel:function(){this.trigger("cancel")},destroy:function(){if(this.dialog){this.dialog.destroy();delete this.dialog}},hideLoading:function(){return this},showLoading:function(){return this},isDirty:function(){return false}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/util.js' */
(function(b,c,a){function d(e){return e===undefined||e===null}b.lowerCaseLocaleComparator=function(e){return function(g,f){var i=g.get(e),h=f.get(e);if(d(i)&&d(h)){return 0}else{if(d(i)){return -1}else{if(d(h)){return 1}}}return i.toLocaleLowerCase().localeCompare(h.toLocaleLowerCase())}};b.url=function(h,j){if(a.isArray(h)){var g="";for(var f=0;f<h.length;f++){g=g+"/"+encodeURIComponent(""+h[f])}h=g}var e="";if(j){e="?"+c.param(j,true)}return AJS.contextPath()+h+e}})(JIRA.Admin.CustomFields,AJS.$,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/util/FilteredCollection.js' */
(function(a,b){a.FilteredCollection=b.Collection.extend({initialize:function(){this.filteredModels=[]},filter:function(f){var c=this,e={};var d=_.groupBy(this.filteredModels,function(g){return c.matcher(g,f,e)?"show":"hide"});this.filteredModels=d.hide||[];_.each(d.show,function(g){c.add(g)});_.chain(this.models).filter(function(g){return !c.matcher(g,f,e)}).each(function(g){c.remove(g);c.filteredModels.push(g)})}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Dialog.js' */
(function(b,f,e,a,c){b.Dialog=function(g){g||(g={});a.defaults(g,{width:840,height:530});g.keypressListener=a.bind(this.onKeydown,this);this._dialog=new AJS.Dialog(g);this._page=this._dialog.getPage(0);this._currentPanel=null;this._notification=null;this._isShown=false;this.$el=this._dialog.popup.element;this._page.header=JIRA.Templates.CustomFields.dialogHeader();this.$el.prepend(this._page.header);this.$el.addClass("jira-customfields-wizard")};a.extend(b.Dialog.prototype,f.Events,{_recalcPageSize:function(){if(this.$notification){var h=null;for(var k=0;k<this._page.panel.length;k++){var j=this._page.panel[k];if(!j.isSizeRecalculated){h=h||j.body.outerHeight()-this.$notification.outerHeight();var g=j.body;g.css("height",h);j.isSizeRecalculated=true;if(!this._page.menu.isSizeRecalculated){this._page.menu.css("height",h);this._page.menu.isSizeRecalculated=true}}}}return this},onKeydown:function(g){if(g.keyCode===c.ui.keyCode.ESCAPE){this.trigger("close")}},triggerMethod:e.triggerMethod,_lastButtonElement:function(){var g=a.last(this._page.button);return g.item},_setNotification:function(h,g){if(this._notification&&this._isShown){this._notification._triggerHide()}if(!this.$notification){this.$notification=c(JIRA.Templates.CustomFields.dialogNotification());this.$notification.append(h);this.$el.find(".dialog-components").prepend(this.$notification)}else{this.$notification.html(h)}this._recalcPageSize();this._notification=new d(g);if(this._isShown){this._notification._triggerShow()}return this},setWarningNotification:function(g){var h=c(JIRA.Templates.CustomFields.dialogNotificationWarning());h.find(".jira-dialog-notification-content").html(g.render().$el);return this._setNotification(h,g)},addHeaderMain:function(g){this.$el.find(".jira-dialog-title-main").append(g);this._page.recalcSize();return this},addOrSetHeaderMainText:function(h){var g=this.$el.find(".jira-dialog-title-main .jira-dialog-title-text");if(g.length>0){g.text(h);return this}else{return this.addHeaderMain(c("<h2 class='jira-dialog-title-text'/>").text(h))}},addHeaderAction:function(g){var h=this.$el.find(".jira-dialog-title-actions");h.append(g.render().$el);this._page.recalcSize();return this},showLoading:function(){if(!this.$loading){var g=this.$el.find(".dialog-button-panel button").eq(0);this.$loading=c("<span>").addClass("icon dialog-spinner");this.$loading.insertBefore(g)}this.$loading.spin()},hideLoading:function(){if(this.$loading){this.$loading.spin(false)}},addButton:function(h){var g=h.secondary?" aui-button-secondary":" aui-button-primary";this._dialog.addButton(h.label,h.click,"aui-button"+g);var i=this._lastButtonElement();i.removeClass("button-panel-button");h.id&&i.attr("id",h.id);if(h.submitAccessKey){this._addSubmitKey(i)}return new b.Dialog.Button(i)},addLeftLink:function(g){var h;this._dialog.addLink(g.label,g.click,"secondary",g.url);h=this._lastButtonElement();h=h.removeClass("button-panel-button");if(g.iconClass){c('<span class="icon"/>').addClass(g.iconClass).prependTo(h)}return this},addLink:function(g){this._dialog.addLink(g.label,g.click);var h=this._lastButtonElement();if(g.cancelAccessKey){this._addCancelKey(h)}return this},addPanel:function(i,h){this._dialog.addPanel(i,h.render().el);var j=this._page.getCurrentPanel();var g=new b.Dialog.Panel(this,i,h,j);j.button.click(a.bind(function(){this._onShowPanel(g)},this));this._onShowPanel(g);return g},show:function(){if(!this._isShown){this._dialog.show();this._recalcPageSize();this._isShown=true;this._currentPanel&&this._currentPanel._triggerShow();this._notification&&this._notification._triggerShow()}return this},hide:function(){this.hideLoading();if(this._isShown){this._currentPanel&&this._currentPanel._triggerHide();this._notification&&this._notification._triggerHide();this._dialog&&this._dialog.hide();this._isShown=false}},destroy:function(){this.hide();this._dialog&&this._dialog.remove();delete this._dialog},_addSubmitKey:function(h){var g="s";h.prop("accessKey",g);h.attr("title",AJS.format("Press {1}+{0} to submit this form",g,AJS.Navigator.modifierKey()));return this},_addCancelKey:function(h){var g="`";h.prop("accessKey",g);h.attr("title",AJS.format("Press {1}+{0} to cancel",g,AJS.Navigator.modifierKey()));return this},_onShowPanel:function(g){if(!this._isShown){this._currentPanel=g;return}if(this._currentPanel){if(this._currentPanel!==g){this._currentPanel._triggerHide();this._currentPanel=g;this._currentPanel._triggerShow()}}else{this._currentPanel=g;this._currentPanel._triggerShow()}},currentPanel:function(){return this._currentPanel},showErrors:function(j){if(j&&j.length){var h=c(JIRA.Templates.Messages.errorMessage({message:j.join(" ")}));if(this.$error){this.$error.replaceWith(h)}else{var i=this.$el.find(".dialog-panel-body").filter(":visible");var g=i.find("form").filter(":first");if(g.length){i=g}i.prepend(h)}this.$error=h}else{if(this.$error){this.$error.remove();delete this.$error}}return this},hideErrors:function(){this.$el.find(".dialog-panel-body .error").hide()}});b.Dialog.Panel=function(j,i,h,g){this.dialog=j;this.name=i;this.view=h;this.panel=g};a.extend(b.Dialog.Panel.prototype,f.Events,{_triggerHide:function(){return this.triggerMethod("dialog:panel:hide")},_triggerShow:function(){return this.triggerMethod("dialog:panel:show")},triggerMethod:function(g){e.triggerMethod.call(this,g);this.view.triggerMethod(g);return this},show:function(){this.panel.select();return this}});b.Dialog.Button=function(g){this.element=g};a.extend(b.Dialog.Button.prototype,{disable:function(){this.element.prop("disabled",true);return this},enable:function(){this.element.prop("disabled",false);return this},click:function(){this.element.click.apply(this.element,arguments);return this},setLabel:function(g){this.element.text(g);return this}});var d=function(g){this.view=g};a.extend(d.prototype,{_triggerHide:function(){return this.triggerMethod("dialog:notification:hide")},_triggerShow:function(){return this.triggerMethod("dialog:notification:show")},triggerMethod:function(g){this.view.triggerMethod(g);return this}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,_,AJS.$);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/Forms.js' */
(function(c,h,d,j,k){var f=c.Form=h.View.extend({initialize:function(m){var n=this.$form=d(aui.form.form(j.defaults(j.pick(m,"id","action"),{action:"",content:"",extraClasses:k.ClassNames.EXEMPT})));this.setElement(n);this.fields={};this.fieldOrder=[];j.each(m.fields,function(o){this.addField(o)},this);this.$form.submit(j.bind(this._submit,this));if(d.browser.msie){this.$form.bind("keypress",function(o){if(o.keyCode===d.ui.keyCode.ENTER&&d(o.target).is("input")){o.preventDefault();d(this).submit()}})}},addField:function(q){if(q.content){var o=q.content;if(j.isFunction(o)){o=o.call(this)}this.$form.append(o)}else{var n="";if(q.label){n=aui.form.label({forField:q.id,isRequired:!!q.required,content:q.label})}var p=d(aui.form.fieldGroup({content:n}));var r=new this._getField(q);var m=q.name||q.id;if(m){this.fields[m]=r}this.fieldOrder.push(r);this.$form.append(p.append(r.render().$el))}return this},setValueOfFieldWithName:function(m,n){this.fields[m].value(n)},_getField:function(o){if(o.field){return o.field}else{var m=o.type;if(j.isString(m)){m=f.DEFAULT_TYPES[m]}var n=j.extend({},o,{form:this});return new m(n)}},focus:function(){return this._focusFirstField(this.fieldOrder)},blur:function(){j.each(this.fieldOrder,function(m){m.blur()});return this},submit:function(){this.$form.submit();return this},validate:function(){var m=j.reduce(this.fieldOrder,function(o,n){if(!n.validate()){o.push(n)}return o},[],this);if(m.length){this._focusFirstField(m);return false}else{return true}},showErrors:function(m,n){m=m||{};n=n||[];var o=j.reduce(this.fieldOrder,function(q,p){if(p.showRelevantErrors(m,n)){q.push(p)}return q},[],this);if(o.length){this._focusFirstField(o);return true}else{return false}},enable:function(){j.each(this.fieldOrder,function(m){m.enable()});return this},disable:function(){j.each(this.fieldOrder,function(m){m.disable()});return this},isDirty:function(){for(var m=0;m<this.fieldOrder.length;m++){if(this.fieldOrder[m].isDirty()){return true}}return false},toJSON:function(){return j.reduce(this.fieldOrder,function(m,n){n.addValueToData(m);return m},{},this)},_submit:function(m){m.preventDefault();if(!this._interceptSubmit()){if(this.validate()){this.trigger(f.EVENTS.submit)}}},_interceptSubmit:function(){return j.reduce(this.fieldOrder,function(m,n){return n.handleSubmit()||m},false,this)},_focusFirstField:function(m){for(var n=0;n<m.length;n++){if(m[n].focus()){break}}return this}});f.Fields={};var a=f.Fields.FormField=h.View.extend({initialize:function(m){},focus:function(){return true},blur:function(){return true},validate:function(){return true},showRelevantErrors:function(m,n){return false},addValueToData:function(m){},setError:function(m){return this},clearError:function(){return this},value:function(m){return this},disable:function(){return this},enable:function(){return this},handleSubmit:function(){return false},isDirty:function(){return false}});f.Fields.FormField.extend=function(m){if(m.mixin){var n=[];m.initialize&&n.push(m.initialize);j.each(m.mixin,function(o){j.each(o,function(q,p){if(p==="initialize"){n.push(q)}else{m[p]=q}})});m=j.omit(m,"mixin");if(n.length>1){m.initialize=function(){var o=j.toArray(arguments);j.each(n,function(p){p.apply(this,o)},this)}}else{if(n.length===1){m.initialize=n[0]}}}return h.View.extend.call(this,m)};f.Fields.NamedFieldMixin={initialize:function(m){this.name=m.name||m.id},showRelevantErrors:function(m){var n=m[this.name];if(n){this.setError(n);delete m[this.name];return true}else{this.clearError();return false}},addValueToData:function(m){var n=this.value();if(!j.isUndefined(n)&&!j.isNull(n)&&n!==""){m[this.name]=n}return this}};f.Fields.ValidatorMixin={initialize:function(m){this.validator=m.validator||b.always()},validate:function(){return this.validator.call(this)}};var i=a.extend({mixin:[f.Fields.ValidatorMixin,f.Fields.NamedFieldMixin],initialize:function(){this.parent=a.prototype;this.parent.initialize.apply(this,arguments)},isDirty:function(){var m=this.$el[0];return m.value!==m.defaultValue},setError:function(m){if(this.$error){this.$error.text(m)}else{this.$error=d(aui.form.fieldError({message:m}));this.$el.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},value:function(m){if(j.isUndefined(m)){return d.trim(this.$el.val())||""}else{this.$el.val(""+m);return this}},focus:function(){if(!this.isDisabled()){this.$el.focus();return true}else{return false}},blur:function(){if(this.$el.is(":focus")){this.$el.blur();return true}else{return false}},disable:function(){this.$el.prop("disabled",true);return this},enable:function(){this.$el.prop("disabled",false);return this},isDisabled:function(){return this.$el.prop("disabled")},_getStyle:function(m){switch(m){case a.SIZE.large:return"long-field";default:return""}},_getTemplateOptions:function(n,p,m){var q=j.extend(j.pick(n,p),m);var o=this._getStyle(n.size);if(o){q.extraClasses=[o]}return q}});var e=i.extend({initialize:function(m){this.parent=i.prototype;this.parent.initialize.apply(this,arguments);var n=this._getTemplateOptions(m,["id","maxLength","value"],{type:"text"});this.setElement(d(aui.form.input(n)))}});var l=i.extend({initialize:function(m){this.parent=i.prototype;this.parent.initialize.apply(this,arguments);var n=this._getTemplateOptions(m,["id","cols"]);this.setElement(d(aui.form.textarea(n)))}});f.DEFAULT_TYPES={text:e,textarea:l};f.EVENTS={submit:"submit"};a.SIZE={large:"large"};var g=function(){return true};var b=f.Validators={notEmpty:function(m){return function(){if(!this.value()){this.setError(m);return false}else{this.clearError();return true}}},always:function(){return g}}}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,JIRA.DirtyForm));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/OptionsView.js' */
(function(d,c,e,g,b){var f=function(){};c.extend(f.prototype,g.Events);d.OptionsField=b.Fields.FormField.extend({mixin:[b.Fields.NamedFieldMixin],initialize:function(){this.bus=new f();this.options=new a.Models.Options();this.view=new a({collection:this.options,bus:this.bus});this.enabled=true;this.listenTo(this.bus,"removeOption",this._removeOption);this.listenTo(this.bus,"moveOption",this._moveOption)},focus:function(){return this.view.focus()},blur:function(){return this.view.blur()},validate:function(){if(!this.options.length){this.setError("Your custom field must have some options.");return false}else{this.clearError();return true}},setError:function(h){this.view.setError(h);return this},clearError:function(){this.view.clearError();return this},value:function(h){if(c.isUndefined(h)){return this.options.map(function(i){return i.pick("name")})}else{return this}},disable:function(){this.enabled=false;this.view.disable();return this},enable:function(){this.enabled=true;this.view.enable();return this},render:function(){this.setElement(this.view.render().$el);return this},handleSubmit:function(){return this.view.handleSubmit()},isDirty:function(){return this.view.isDirty()},_removeOption:function(h){if(this.enabled){this.options.remove(h);this.focus()}},_moveOption:function(h){if(this.enabled){var i=h.option;this.options.remove(i,{silent:true});this.options.add(i,{silent:true,at:h.newIndex});this.focus()}}});var a=g.Marionette.ItemView.extend({initialize:function(h){this.bus=h.bus;this.options=h.collection;this.optionsView=new a.Views.OptionViews({collection:this.options,bus:this.bus})},ui:{input:"#custom-field-options-input",addBtn:"#custom-field-options-add",listContainer:"#custom-field-options-list-container"},template:JIRA.Templates.CustomFields.singleSelectOptionsComponent,onRender:function(){this.ui.listContainer.append(this.optionsView.render().$el);var h=c.bind(this._addOptionFromUi,this);this.ui.addBtn.click(h);this.ui.input.keydown(function(i){if(i.keyCode===e.ui.keyCode.ENTER){i.preventDefault();h()}})},_addOptionFromUi:function(){var h=[];if(!this.addOption(this.input(),h)){this.setError(h[0])}else{this.clearError().clearInput()}this.focus();return this},handleSubmit:function(){return false},getOptions:function(){return this.options.pick("name")},addOption:function(h,j){j=j||[];h=e.trim(h);if(!h.length){j.push("Option must have a name.");return false}else{var i=this._nameToId(h);if(this.options.get(i)){j.push("This value already exists in the list.");return false}else{this.options.add({name:h,id:i});return true}}},_getFocus:function(){return this.$(":focus")},focus:function(){if(!this.ui.input.prop("disabled")){this.ui.input.focus();return true}else{return false}},blur:function(){var h=this._getFocus();if(h.length){h.blur();return true}else{return false}},clearInput:function(){this.ui.input.val("");return this},input:function(h){if(c.isUndefined(h)){return this.ui.input.val()}else{this.ui.input.val(h);return this}},setError:function(h){if(this.$error){this.$error.text(h)}else{this.$error=e(aui.form.fieldError({message:h}));this.ui.addBtn.after(this.$error)}return this},clearError:function(){if(this.$error){this.$error.remove();delete this.$error}return this},_nameToId:function(h){return h.toLowerCase()},enable:function(){this.ui.listContainer.removeClass("disabled");this._setInputState(true)},disable:function(){this.ui.listContainer.addClass("disabled");this._setInputState(false)},_setInputState:function(h){this.ui.input.prop("disabled",!h);this.ui.addBtn.prop("disabled",!h)},isDirty:function(){return this.ui.input.val()||this.options.length}});a.Models={};a.Models.Option=g.Model.extend({});a.Models.Options=g.Collection.extend({model:a.Models.Option});a.Views={};a.Views.OptionView=g.Marionette.ItemView.extend({events:{"click .custom-field-options-delete":"_delete",moveOption:"_moveOption"},tagName:"li",template:JIRA.Templates.CustomFields.singleSelectOptionsItem,initialize:function(h){this.bus=h.bus},_delete:function(h){h.preventDefault();this.bus.trigger("removeOption",this.model)},_moveOption:function(i,h){this.bus.trigger("moveOption",{option:this.model,newIndex:h})}});a.Views.OptionViews=g.Marionette.CollectionView.extend({itemView:a.Views.OptionView,tagName:"ul",id:"custom-field-options-list",initialize:function(h){this.bus=h.bus;this.$el.sortable({axis:"y",containment:"#custom-field-options-list-container",tolerance:"pointer",cursor:"move",handle:".custom-field-option-handle",update:this._handleReorder})},itemViewOptions:function(){return{bus:this.bus}},_handleReorder:function(i,h){h.item.trigger("moveOption",h.item.index())}})}(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/SharedByNotification.js' */
(function(a,b,c){a.SharedByView=c.Marionette.ItemView.extend({initialize:function(d){this.projects=d.projects},template:JIRA.Templates.CustomFields.sharedByCreate,serializeData:function(){return{projects:this.projects}},onDialogNotificationHide:function(){if(this.popup){this.popup.hide();this.popup.remove();delete this.popup}},onDialogNotificationShow:function(){var d=this.projects;this.popup=AJS.InlineDialog(this.$el.find("a"),"customfield-project-list",function(f,e,g){f.html(JIRA.Templates.CustomFields.shareByInline({projects:d}));g()},{width:240,onHover:true,hideDelay:500})}})}(JIRA.Admin.CustomFields,AJS.$,JIRA.ProjectConfig.Backbone));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/TypeItemView.js' */
(function(a,b){a.TypeItemView=b.Marionette.ItemView.extend({className:"item",submit:function(){this.select();this.triggerMethod("submit",this.getKey())},events:{click:"onClick",dblclick:"onDoubleClick"},onClick:function(c){this.triggerMethod("select");c.preventDefault()},onDoubleClick:function(c){this.submit();c.preventDefault()},reveal:function(){var c=40;this.$el.scrollIntoViewForAuto({direction:"vertical",marginBottom:c,marginTop:c})},select:function(){this.$el.toggleClass("selected",true);this.reveal()},deselect:function(){this.$el.toggleClass("selected",false)},tagName:"li",template:function(c){return JIRA.Templates.CustomFields.type({type:c})},getKey:function(){return this.model.get("key")}})})(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/EmptyTypeItemView.js' */
(function(a,b){a.EmptyTypeItemView=b.Marionette.ItemView.extend({tagName:"li",className:"empty",triggers:{"click .customfields-all-category-link":"ongotoall"},setEmptyState:function(c){this.emptyState=c;this.render()},serializeData:function(){return this.emptyState},template:function(d){var c;switch(d){case a.EmptyTypeItemView.CHANGE_TAB:c=JIRA.Templates.CustomFields.emptyTypeOtherTab();break;case a.EmptyTypeItemView.MARKETPLACE:c=JIRA.Templates.CustomFields.emptyTypeMarketplace({contextPath:AJS.contextPath()});break;default:c=JIRA.Templates.CustomFields.emptyType()}return c}});_.extend(a.EmptyTypeItemView,{CHANGE_TAB:"otherTab",MARKETPLACE:"marketplace",EMPTY:"empty"})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/FieldTypeCollectionView.js' */
(function(b,d,a,e,c){b.FieldTypeCollectionView=e.Marionette.CompositeView.extend({itemView:b.TypeItemView,emptyView:b.EmptyTypeItemView,itemViewContainer:".customfields-types",indexOf:function(f){if(!f){return -1}return this.collection.indexOf(f.model)},attach:function(){if(this.placeholder){this.placeholder.replaceWith(this.$el);this.$el.parent().scrollTop(this.scrollTopBeforeDetach);delete this.placeholder;delete this.scrollTopBeforeDetach}},detach:function(){this.placeholder=d("<div/>").insertBefore(this.$el);this.scrollTopBeforeDetach=this.$el.parent().scrollTop();this.$el.detach()},initialize:function(){this.selectedView=null;a.bindAll.apply(a,[this].concat(a.functions(this)))},onItemviewSelect:function(f){this.select(f)},onItemRemoved:function(){this.selectByIndex(0)},onAfterItemAdded:function(){this.selectByIndex(0)},onItemviewSubmit:function(f,g){this.triggerMethod("submit",g)},onItemviewOngotoall:function(){this.triggerMethod("changeToAll")},isEmpty:function(){return !this.collection.length},_getEmptyView:function(){return this.isEmpty()&&this.children.findByIndex(0)},setHasMatches:function(f){var g=this._getEmptyView(),h;if(!g){return}if(f){h=b.EmptyTypeItemView.CHANGE_TAB}else{if(JIRA.isSysadmin()){h=b.EmptyTypeItemView.MARKETPLACE}else{h=b.EmptyTypeItemView.EMPTY}}g.setEmptyState(h)},onKeydown:function(f){switch(f.keyCode){case c.UP:this.collection.length&&this.moveSelect(-1);break;case c.DOWN:this.collection.length&&this.moveSelect(1);break;case c.ENTER:this.collection.length&&this.triggerMethod("submit",this.getSelectedKey());break;default:return}f.preventDefault()},moveSelect:function(g){var f=this.indexOf(this.selectedView);if(f>=0){f=Math.min(this.children.length-1,Math.max(0,f+g));this.selectByIndex(f)}},select:function(f){if(this.selectedView){this.selectedView.deselect()}this.selectedView=f;f&&this.selectedView.select();this.triggerMethod("changedSelection",{key:this.getSelectedKey()})},selectByIndex:function(g){var f=this._viewAtIndex(g);this.select(f)},_viewAtIndex:function(g){var f=this.collection.at(g);return f&&this.children.findByModel(f)},template:function(){return JIRA.Templates.CustomFields.types()},onDialogPanelHide:function(){this.detach();d(document).unbind("keydown",this.onKeydown)},onDialogPanelShow:function(){this.attach();d(document).bind("keydown",this.onKeydown)},getSelectedKey:function(){if(this.selectedView){return this.selectedView.getKey()}else{return null}},getSelectedModel:function(){return this.selectedView&&this.selectedView.model},appendHtml:function(f,h,g){var i=this.getItemViewContainer(f);if(g===0){i.prepend(h.el)}else{i.children().eq(g-1).after(h.el)}}})})(JIRA.Admin.CustomFields,AJS.$,_,JIRA.ProjectConfig.Backbone,AJS.$.ui.keyCode);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/views/QuickSearch.js' */
(function(b,c,a){b.QuickSearch=c.Marionette.ItemView.extend({className:"search",ui:{input:"input"},initialize:function(d){d=d||{};if(d.delay){this.onInputInput=a.debounce(this.onInputInput,d.delay)}},focus:function(){this.ui.input.focus();return this},onInputInput:function(){this.triggerMethod("change",{value:this.value()})},template:function(){return JIRA.Templates.CustomFields.quickSearch()},value:function(){return this.ui.input.val()},render:function(){c.Marionette.ItemView.prototype.render.apply(this,arguments);this.ui.input.on("input",a.bind(this.onInputInput,this));return this}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Wizard.js' */
(function(b,a,e,d,c){b.Wizard=function(f){f=f||{};this.sharedStepOptions=f.sharedStepOptions||{};this._setCurrentStepWrapper(null,f.firstStep,null);this.autoClose=f.autoClose;this.dirtyMessage=f.dirtyMessage;this.result=c.Deferred();this.loadingTimer=null};a.extend(b.Wizard.prototype,e.Events,{start:function(){this._hasCompleted=false;this._showDelayedLoading(this);this._transitionTo(null,this.currentStepWrapper.step);if(this.dirtyMessage){this._addDirty()}return this.result.promise()},close:function(){this._closeWebsudoDialogIfExists();if(this.currentStepWrapper){if(this.dirtyMessage){this._removeDirty()}this.stopListening();this._applyToEachStep(function(f){this._hideDelayedLoading(f);f.stopStep()});delete this.currentStepWrapper}this._hideDelayedLoading(this)},isDirty:function(){return this._existsSomeStep(function(f){return f.isDirty()})},showLoading:function(){AJS.dim(false);JIRA.Loading.showLoadingIndicator()},hideLoading:function(){JIRA.Loading.hideLoadingIndicator()},_bindToStep:function(f){this.listenTo(f,b.Wizard.EVENTS.next,this._onNextStep);this.listenTo(f,b.Wizard.EVENTS.previous,this._onPreviousStep);this.listenTo(f,b.Wizard.EVENTS.complete,this._onComplete);this.listenTo(f,b.Wizard.EVENTS.cancel,this._onCancel)},_onNextStep:function(){var h=this.currentStepWrapper.nextStepWrapper;var i=this.currentStepWrapper;var g=h&&h.step;var f=this.currentStepWrapper.step.getNextStep(g,this.sharedStepOptions);if(f===g){this.currentStepWrapper=h}else{this._setCurrentStepWrapper(this.currentStepWrapper,f,null)}this.currentStepWrapper.step.setPreviousData(i.step.getAccumulatedData());this._transitionTo(this.currentStepWrapper.previousStepWrapper.step,this.currentStepWrapper.step)},_onPreviousStep:function(){var f=this.currentStepWrapper.previousStepWrapper;if(f){this.currentStepWrapper=f;this._transitionTo(this.currentStepWrapper.nextStepWrapper.step,this.currentStepWrapper.step)}},_transitionTo:function(h,g){var f=this,i=g.startStep();this._bindToStepProgress(i,h);i.always(function(){if(f.websudoDialog){f._closeWebsudoDialog()}else{if(h){f._hideDelayedLoading(h);h.pauseStep()}else{f._hideDelayedLoading(f)}}}).always(a.bind(this._makeStepVisible,this,g))},_bindToStepProgress:function(h,g){var f=this;g&&this.stopListening(g);g&&this._showDelayedLoading(g);h.progress(function(j){if(j===b.Wizard.EVENTS.websudoBeforeShow){if(g){f._hideDelayedLoading(g);g.pauseStep()}else{f._hideDelayedLoading(f)}}else{if(j===b.Wizard.EVENTS.websudoSuccess){var i=arguments[1];f.websudoDialog={close:i}}}})},_makeStepVisible:function(f){f.show();this._bindToStep(f)},_closeWebsudoDialogIfExists:function(){if(this.websudoDialog){this._closeWebsudoDialog()}},_closeWebsudoDialog:function(){this.websudoDialog.close();delete this.websudoDialog},_showDelayedLoading:function(g){var f=this;this._cancelTimer();this.loadingTimer=window.setTimeout(a.bind(function(){f.loadingTimer=null;g.showLoading()},this),500)},_hideDelayedLoading:function(f){this._cancelTimer();f.hideLoading()},_cancelTimer:function(){if(this.loadingTimer!==null){window.clearTimeout(this.loadingTimer)}this.loadingTimer=null},_addDirty:function(){this._unload=window.onbeforeunload;var f=this;window.onbeforeunload=function(){if(!f._hasCompleted&&f.dirtyMessage&&f.isDirty()){return f.dirtyMessage}else{if(a.isFunction(f._unload)){return f._unload.apply(this,arguments)}else{return void 0}}}},_removeDirty:function(){window.onbeforeunload=this._unload;delete this._unload},_onComplete:function(){var f=this.currentStepWrapper.step;var g=f.doComplete();this._bindToStepProgress(g,f);g.done(a.bind(this._onCompleteSuccess,this)).fail(a.bind(this._onCompleteFailure,this))},_onCompleteSuccess:function(){this._hasCompleted=true;this.result.resolve(this.currentStepWrapper.step.getAccumulatedData());if(this.autoClose){this.close()}},_onCompleteFailure:function(g){var f,h;if(g===b.Wizard.FAIL_REASON.recoverableError){f=this.currentStepWrapper.step;h=arguments[1];if(this.websudoDialog){this._closeWebsudoDialog();f.show()}else{this._hideDelayedLoading(f)}this._bindToStep(f);f.showErrors(h.fields,h.general)}else{this.result.reject(g,{data:this.currentStepWrapper.step.getAccumulatedData(),dirty:this.isDirty(),notCompletedDescriptions:arguments[1]});this.close()}},_onCancel:function(f){if(f&&!this._hasCompleted&&this.dirtyMessage&&this.isDirty()){if(!window.confirm(this.dirtyMessage)){return}}this.result.reject(b.Wizard.FAIL_REASON.cancel);this.close()},_applyToEachStep:function(f){this._forEachStep(function(g){f.call(this,g)})},_existsSomeStep:function(f){return !!this._forEachStep(function(g){return f.call(this,g)})},_forEachStep:function(h){var g,f;for(f=this.currentStepWrapper;!!f;f=f.previousStepWrapper){g=h.call(this,f.step);if(g){return g}}for(f=this.currentStepWrapper.nextStepWrapper;!!f;f=f.nextStepWrapper){g=h.call(this,f.step);if(g){return g}}},_setCurrentStepWrapper:function(g,h,f){this.currentStepWrapper={previousStepWrapper:g,step:h,nextStepWrapper:f};g&&(g.nextStepWrapper=this.currentStepWrapper)}});b.Wizard.FAIL_REASON={cancel:"cancel",abort:"abort",recoverableError:"recoverableError",error:"error"}}(JIRA.Admin.CustomFields,_,JIRA.ProjectConfig.Backbone,JIRA.ProjectConfig.Backbone.Marionette,AJS.$));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Events.js' */
(function(a){a.Wizard.EVENTS={next:"next",previous:"previous",fail:"fail",error:"error",complete:"complete",websudoBeforeShow:"websudo:before:show",websudoSuccess:"websudo:success",cancel:"cancel"}})(JIRA.Admin.CustomFields);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CustomFieldsStepHelper.js' */
(function(b,a,c){b.CustomFieldsStepHelper={genericFailHandler:function(d){var e=a.toArray(arguments);if(e[1]===b.IssueCustomFields.STATUS.abort){d.rejectWith(d,[b.Wizard.FAIL_REASON.abort].concat(e.slice(2)))}else{d.rejectWith(d,[b.Wizard.FAIL_REASON.error].concat(e.slice(2)))}},genericProgressHandler:function(e,d){if(d===b.IssueCustomFields.PROGRESS.SHOW){e.notify(b.Wizard.EVENTS.websudoBeforeShow)}else{if(d===b.IssueCustomFields.PROGRESS.SUCCESS){e.notify(b.Wizard.EVENTS.websudoSuccess,arguments[2])}}},createField:{execute:function(e){var d=c.Deferred(),g=e.data,h=g.field,f=g.type;e.api.addField({name:h.name,description:h.description,searcherKey:f.searcherKey,type:f.key}).pipe(function(i){h.id=i.id;d.resolve()},function(i){d.reject(b.Wizard.FAIL_REASON.recoverableError,i)},d.notify);return d.promise()},description:function(){return "Create field."}},addOptions:{execute:function(e){var f=e.data,d=c.Deferred(),g=f.field;e.api.setOptions(g.id,g.options).pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Set field options."}},putFieldOnIssue:{execute:function(e){var d=c.Deferred();e.api.addFieldToScreen(e.data.field.id).pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Add field to issue."}},refreshIssue:{execute:function(){var d=c.Deferred();JIRA.Issues.Api.refreshSelectedIssue().pipe(d.resolve,a.bind(b.CustomFieldsStepHelper.genericFailHandler,null,d),d.notify);return d.promise()},description:function(){return "Refresh issue."}},executeCompletes:function(e,g){var f=c.Deferred(),h=c.Deferred().resolve().promise(),d;a.each(e,function(i,j){h=h.pipe(function(){return i.execute(g)});h.fail(function(l){d=a.toArray(arguments);if(l!==b.Wizard.FAIL_REASON.recoverableError){var k=a.map(e.slice(j),function(m){return m.description()});d.push(k)}f.reject.apply(f,d)})});h.progress(a.bind(this.genericProgressHandler,this,f));h.done(f.resolve);return f.promise()}}}(JIRA.Admin.CustomFields,_,AJS.$));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/Step.js' */
(function(b,c,a,d){b.Wizard.Step=a.extend({},{fireNext:function(){this.trigger(b.Wizard.EVENTS.next)},firePrevious:function(){this.trigger(b.Wizard.EVENTS.previous)},fireCancel:function(e){this.trigger(b.Wizard.EVENTS.cancel,e||false)},fireComplete:function(){this.trigger(b.Wizard.EVENTS.complete)},startStep:function(){},stopStep:function(){},pauseStep:function(){},show:function(){},showLoading:function(){},hideLoading:function(){},doComplete:function(){return c.Deferred().resolve()},showErrors:function(e,f){},isExistingNextStepAppropriate:function(e){},getNextStep:function(e,f){},getAccumulatedData:function(){},setPreviousData:function(e){},isDirty:function(){}},d.Events)})(JIRA.Admin.CustomFields,AJS.$,_,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Wizard/AbstractStep.js' */
(function(b,a){b.Wizard.AbstractStep=a.extend({},b.Wizard.Step,{startStep:function(){if(this.hasStarted){return this.restart()}else{this.hasStarted=true;return this.start()}},getAccumulatedData:function(){return a.extend({},this._previousData,this.getStepData())},setPreviousData:function(c){this._previousData=c},start:function(){},restart:function(){return this.start()},getStepData:function(){},getPreviousData:function(){return this._previousData}})})(JIRA.Admin.CustomFields,_);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStep.js' */
(function(c,e,d,b){var a=c.FieldWisherStep=function(f){this.api=f.api;this.stepData={}};b.extend(a.prototype,c.Wizard.AbstractStep,{showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},start:function(){var f=this,g=this._getFields();g.done(function(h){var i=f.dialog=new a.Dialog({fields:h});f.listenTo(i,"cancel",function(j){f.fireCancel(j)});f.listenTo(i,"submit",function(j){f.stepData.field={};f.stepData.field.id=j.id;f.stepData.field.name=j.name;if(j.id){f.stepData.createField=false;f.stepData.addField=!j.onAllScreens;f.fireComplete()}else{f.stepData.createField=true;f.stepData.addField=true;f.fireNext()}})});g.fail(function(i,j){if(c.Wizard.FAIL_REASON.abort===i){f.fireCancel()}else{var h=f.dialog=new c.ErrorDialog({heading:a.Dialog.prototype.text.heading,message:j});f.listenTo(h,"cancel",f.fireCancel)}});return g},restart:function(){return d.Deferred().resolve().promise()},pauseStep:function(){if(this.dialog){this.dialog.resetCanSubmit();this.dialog.resetIsSubmitted();this.dialog.hide()}},stopStep:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},show:function(){this.dialog&&this.dialog.show()},doComplete:function(){var f,g=this.getAccumulatedData();f=this._resolveCompletesToExecute(g);return this.executeCompletes(f,{api:this.api,data:g})},getStepData:function(){return this.stepData},getNextStep:function(g,f){if(g instanceof c.TypeStep){return g}return new c.TypeStep({api:f.api,inIssueContext:f.inIssueContext})},isDirty:function(){var g=this.stepData.field;var f=g&&(g.id||g.name);return f||(this.dialog&&this.dialog.isDirty())},_getFields:function(){var f=d.Deferred(),g=this.api.addableFields(true);g.done(f.resolve);g.fail(b.bind(this.genericFailHandler,this,f));g.progress(b.bind(this.genericProgressHandler,this,f));return f.promise()},_resolveCompletesToExecute:function(g){var f=[];if(g.addField){f.push(this.putFieldOnIssue);f.push(this.refreshIssue)}return f}},c.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepDialog.js' */
(function(b,d,c,a){b.FieldWisherStep.Dialog=function(e){a.bindAll(this,"submit");this.text=a.clone(this.text);this.text.nextButton=a.bind(this.text.nextButton,this);this.model=new d.Model({fieldId:undefined,fieldName:undefined,fieldOnAllScreens:undefined,canSubmit:undefined,isSubmitted:undefined,isValid:undefined,fieldsOnAllScreens:undefined});this.dialog=new b.Dialog({id:"customfields-field-wisher",height:220,width:520});this.$el=this.dialog.$el;this.panel=new b.FieldWisherStep.Panel({initialValue:e.initialValue||"",fields:e.fields});this.dialog.addPanel("",this.panel);this.dialog.addOrSetHeaderMainText(this.text.heading);this.nextButton=this.dialog.addButton({label:this.text.nextButton(),id:"customfields-field-wisher-next",submitAccessKey:true,click:this.submit});this.dialog.addLink({label:this.text.cancel,click:a.bind(this.cancel,this,false),cancelAccessKey:true});this.listenTo(this.model,"change:fieldId change:fieldName",this.calculateIsValid);this.listenTo(this.model,"change:isValid change:isSubmitted",this.calculateCanSubmit);this.listenTo(this.model,"change:fieldId",this.onChangeFieldId);this.listenTo(this.model,"change:canSubmit",this.onChangeCanSubmit);this.listenTo(this.model,"change:isSubmitted",this.onChangeIsSubmitted);this.listenTo(this.panel,"change:field",this.onPanelChangeField);this.listenTo(this.panel,"request:submit",this.onPanelRequestSubmit);this.listenTo(this.dialog,"close",a.bind(this.cancel,this,true));this.calculateIsValid(this.model);this.calculateCanSubmit(this.model);this._initializeFieldsOnScreen(this.model,e.fields)};a.extend(b.FieldWisherStep.Dialog.prototype,d.Events,{text:{cancel:"Cancel",create:"Create",add:"Add",edit:"Edit",heading:"Add Field",nextButton:function(){if(!this.model.get("fieldId")){return this.text.create}else{if(this.model.get("fieldOnAllScreens")){return this.text.edit}}return this.text.add}},triggerMethod:d.Marionette.triggerMethod,show:function(){this.dialog.show();return this},hide:function(){this.dialog&&this.dialog.hide();return this},destroy:function(){this.stopListening(this.panel);this.dialog&&this.dialog.destroy();return this},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},resetCanSubmit:function(){this.model.set("canSubmit",true)},resetIsSubmitted:function(){this.model.set("isSubmitted",false)},submit:function(){var e={id:this.model.get("fieldId"),name:this.model.get("fieldName"),onAllScreens:this.model.get("fieldOnAllScreens")};if(!e.id){delete e.id}this.model.set("isSubmitted",true);this.triggerMethod("submit",e)},cancel:function(e){this.triggerMethod("cancel",e||false)},onPanelChangeField:function(e){var f=e.id;this.model.set({fieldId:f,fieldName:e.name,fieldOnAllScreens:!!this.model.get("fieldsOnAllScreens")[f]})},onPanelRequestSubmit:function(){if(this.model.get("canSubmit")){this.submit()}},onChangeFieldId:function(){this.nextButton.setLabel(this.text.nextButton())},onChangeCanSubmit:function(e){if(e.get("canSubmit")){this.nextButton.enable()}else{this.nextButton.disable()}},onChangeIsSubmitted:function(e){if(e.get("isSubmitted")){this.panel.disable()}else{this.panel.enable()}},calculateIsValid:function(e){e.set("isValid",!!e.get("fieldName"))},calculateCanSubmit:function(e){e.set("canSubmit",e.get("isValid")&&!e.get("isSubmitted"))},isDirty:function(){return !!this.model.get("fieldName")||this.panel.isDirty()},_initializeFieldsOnScreen:function(f,e){var g={};a.each(e,function(h){g[h.id]=h.onAllScreens});f.set("fieldsOnAllScreens",g)}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/FieldWisherStep/FieldWisherStepPanel.js' */
(function(b,d,c,a){b.FieldWisherStep.Panel=d.Marionette.ItemView.extend({ui:{select:"select"},initialize:function(e){this.template=a.bind(this.template,this);this.model=new d.Model({fieldId:null,fieldName:null,fields:e.fields})},template:function(){return JIRA.Templates.CustomFields.FieldWisherStep.form({fields:this.model.get("fields")})},onRender:function(){this.fieldSelect=new AJS.SingleSelect({element:this.ui.select,itemAttrDisplayed:"label",suggestionsHandler:this.ExistingOrCreateSuggester,errorMessage:""});this.bindUIElements()},events:{"selected select":"onFrotherSelected","unselect select":"onFrotherUnselect","submit form":"onSubmit"},onFrotherSelected:function(g,f){var e;e="fieldText" in f.properties?f.properties.fieldText:f.properties.label;this.model.set({fieldId:f.properties.value,fieldName:e})},onFrotherUnselect:function(){this.model.set({fieldId:null,fieldName:null})},onSubmit:function(e){e.preventDefault();this.trigger("request:submit")},enable:function(){this.fieldSelect&&this.fieldSelect.enable()},disable:function(){this.fieldSelect&&this.fieldSelect.disable()},isDirty:function(){return !!(this.fieldSelect&&(this.fieldSelect.getQueryVal()||this.fieldSelect.getSelectedDescriptor()))},modelEvents:{"change:fieldId":"onChangeField","change:fieldName":"onChangeField"},onChangeField:function(e){var f={id:e.get("fieldId"),name:e.get("fieldName")};if(!f.id){delete f.id}this.trigger("change:field",f)},ExistingOrCreateSuggester:AJS.SelectSuggestHandler.extend({formatSuggestions:function(f,g){var e;e=this.sorted(f);if(g.length>0){e.push(this.creationSuggestion(g))}return e},sorted:function(f){var e;e=AJS.SuggestHelper.extractItems(f).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});return[new AJS.GroupDescriptor({items:e})]},creationSuggestion:function(e){var f;f=new AJS.ItemDescriptor({value:"",label:AJS.format("{0} (Create new field)",e),fieldText:e,title:e,allowDuplicate:false,noExactMatch:true});return new AJS.GroupDescriptor({label:"user inputted option",showLabel:false,replace:true,items:[f]})}})})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStep.js' */
(function(b,a,d,e){var c=b.TypeStep=function(f){this.options=a.extend({initialCategory:"STANDARD",view:c.Views.TypeChoice},f);this.api=f.api;this.inIssueContext=!!f.inIssueContext;this.categories=null;this.stepData={}};a.extend(c.prototype,b.Wizard.AbstractStep,{showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},start:function(){var g=this,h=this._getCategories(),f;h.done(function(i,j){var k=j&&j.length&&new b.SharedByView({projects:j});f=g.view=new g.options.view(i,200,k,g.inIssueContext);g.listenTo(f,"submit",function(l){g.stepData.type=g._getUpdateData(l);g.fireNext()});g.listenTo(f,"previous",function(){g.firePrevious()});g.listenTo(f,"cancel",function(l){g.fireCancel(l)})});h.fail(function(j,i){if(b.Wizard.FAIL_REASON.abort===j){g.fireCancel()}else{f=g.view=new b.ErrorDialog({heading:c.Views.Text.heading,message:i});g.listenTo(f,"cancel",g.fireCancel)}});return h},restart:function(){return d.Deferred().resolve().promise()},pauseStep:function(){this.view&&this.view.hide()},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},show:function(){this.view&&this.view.show()},getStepData:function(){return this.stepData},getNextStep:function(g,f){if(g instanceof b.CreateFieldStep){return g}return new b.CreateFieldStep({api:f.api,inIssueContext:f.inIssueContext})},_getUpdateData:function(g){var h={};if(g){h.key=g.get("key");h.name=g.get("name");h.options=g.get("options");h.cascading=g.get("cascading");var f=g.get("searchers");if(f&&f.length>0){h.searcherKey=f[0]}}return h},_getCategories:function(){var g=d.Deferred(),f=this;var h=this.api.getSharedBy(this.api.getCustomFieldTypes());h.done(function(j){var i=[];a.each(j.categories,function(k){var m=a.filter(j.types,function(n){return a.contains(n.categories,k.id)});var l=new c.Models.Types(m,{parse:true});i.push({initial:k.id===f.options.initialCategory,id:k.id,name:k.name,types:l})});g.resolveWith(f,[i,j.sharedBy])});h.fail(a.bind(this.genericFailHandler,this,g));h.progress(a.bind(this.genericProgressHandler,this,g));return g.promise()}},b.CustomFieldsStepHelper);c.Models={};c.Models.Type=e.Model.extend({initialize:function(){this.get("name")||this.set("name",this.get("key"))},parse:function(f){return a.omit(f,"categories")}});c.Models.Types=b.FilteredCollection.extend({model:c.Models.Type,comparator:b.lowerCaseLocaleComparator("name"),matcher:function(f,j,i){var h=f.get("name").toLowerCase(),g=i.needles;if(!g){i.needles=g=a.filter(j.toLowerCase().split(/\s+/),function(k){return k})}return a.all(g,function(k){return h.indexOf(k)!==-1})}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/TypeStep/TypeStepDialog.js' */
(function(b,a,d,g){var e={marketplace:AJS.contextPath()+"/plugins/servlet/upm/marketplace/popular?category=Custom+Fields&source=custom_fields_create"};var c=b.TypeStep;c.Views={};var f=c.Views.Text={heading:"Select a Field Type",panel:"",cancel:"Cancel",previous:"Previous",next:"Next",marketPlace:"Find More Custom Fields"};c.Views.TypeChoice=function(h,j,i,k){this.categories=h;this.searchDelay=j||0;this.sharedBy=i;this.inIssueContext=k};a.extend(c.Views.TypeChoice.prototype,g.Events,{show:function(){if(!this.dialog){var j,l=[],o=[],k=null,i=new b.Dialog({id:"customfields-select-type",focusSelector:".dialog-title input"}),h=this,n,m=new b.QuickSearch({delay:this.searchDelay});this.listenTo(m,"change",function(q){a.each(h.categories,function(r){r.types.filter(q.value)});var p=a.any(a.pluck(h.categories,"types"),function(r){return r.length});a.each(o,function(r){r.setHasMatches(p)})});i.addOrSetHeaderMainText(f.heading);i.addHeaderAction(m);if(this.sharedBy){i.setWarningNotification(this.sharedBy)}if(JIRA.isSysadmin()){i.addLeftLink({label:f.marketPlace,url:e.marketplace,iconClass:"jira-icon-marketplace"})}if(this.inIssueContext){i.addButton({secondary:true,label:f.previous,click:function(){h._firePrevious(i.currentPanel().view.getSelectedModel())},id:"customfields-select-type-previous"})}n=i.addButton({label:f.next,submitAccessKey:true,click:function(){h._fireSubmit(i.currentPanel().view.getSelectedModel())},id:"customfields-select-type-next"});this.listenTo(i,"close",a.bind(this._fireCancel,this,true));i.addLink({label:f.cancel,click:a.bind(this._fireCancel,this,false),cancelAccessKey:true});a.each(this.categories,function(p,s){var r=new b.FieldTypeCollectionView({collection:p.types});o.push(r);h.listenTo(r,"submit",function(){h._fireSubmit(r.getSelectedModel())});h.listenTo(r,"dialog:panel:show",function(){m.focus();var t=function(u){u.key?n.enable():n.disable()};h.listenTo(r,"changedSelection",t);r.once("dialog:panel:hide",function(){h.stopListening(r,"changedSelection",t)},h);t({key:r.getSelectedKey()})});h.listenTo(r,"changeToAll",function(){j&&j.show()});l.push(function(){h._initAnalytics(p,r)});var q=i.addPanel(p.name,r);if(p.initial){k=q;h.__currentCategory=p}if(s===0){j=q}});k&&k.show();i.show();a.each(l,function(p){p()});this.dialog=i}else{this.dialog.show()}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){if(this.dialog){this.stopListening(this.dialog);this.dialog.destroy();delete this.dialog}},_initAnalytics:function(j,i){var h=this;this.listenTo(i,"dialog:panel:show",function(){h.__currentCategory=j;AJS.trigger("analytics",{name:"administration.customfields.addwizard.changecategory",data:{id:j.id,name:j.name}})})},_fireSubmit:function(h){AJS.trigger("analytics",{name:"administration.customfields.addwizard.submittype",data:{key:h.get("key"),category:this.__currentCategory.id}});this.trigger("submit",h)},_firePrevious:function(h){this.trigger("previous",h)},_fireCancel:function(h){this.trigger("cancel",h)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},isDirty:function(){return true}})})(JIRA.Admin.CustomFields,_,AJS.$,JIRA.ProjectConfig.Backbone);
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStep.js' */
(function(c,e,d,b){var a=c.CreateFieldStep=function(f){this.options=b.extend({view:a.Views.CreateDialog},f);this.api=f.api;this.inIssueContext=!!f.inIssueContext;this.stepData={}};b.extend(a.prototype,c.Wizard.AbstractStep,{start:function(){var h=this.getPreviousData();var i=h.type;this.fieldTypeName=i.name;var g=b.extend(b.pick(this.options,["nextLabel","previousLabel"]),{configureOptions:!!i.options&&!i.cascading,typeName:i.name,fieldName:(h.field&&h.field.name)||""});var f=this.view=new this.options.view(g);this.listenTo(f,"submit",function(j){this.stepData.field={};this.stepData.field.name=j.name;this.stepData.field.description=j.description;this.stepData.field.options=j.options;this.view.disable();this.fireComplete()});this.listenTo(f,"previous",function(){this.firePrevious()});this.listenTo(f,"cancel",function(j){this.fireCancel(j)});return d.Deferred().resolve().promise()},restart:function(){var f=this.getPreviousData();if(this._hasFieldTypeChanged(f.type.name)){this.stopStep();return this.start()}else{this.view.updateData({typeName:f.type.name,fieldName:(f.field&&f.field.name)||""});return d.Deferred().resolve().promise()}},stopStep:function(){if(this.view){this.stopListening(this.view);this.view.destroy();delete this.view}},pauseStep:function(){this.view&&this.view.hide()},show:function(){this.view&&this.view.show()},doComplete:function(){var f,g=this.getAccumulatedData();f=this._resolveCompletesToExecute(g);return this.executeCompletes(f,{api:this.api,data:g})},showErrors:function(f,g){this.view.enable();this.view.showErrors(f,g)},showLoading:function(){this.view&&this.view.showLoading()},hideLoading:function(){this.view&&this.view.hideLoading()},getStepData:function(){return this.stepData},isDirty:function(){var g=this.stepData.field;var f=g&&(g.name||g.options||g.description);return f||(this.view&&this.view.isDirty())},_hasFieldTypeChanged:function(f){return this.fieldTypeName!==f},_resolveCompletesToExecute:function(g){var f=[];f.push(this.createField);if(g.field.options){f.push(this.addOptions)}if(this.inIssueContext){f.push(this.putFieldOnIssue);f.push(this.refreshIssue)}return f}},c.CustomFieldsStepHelper)}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/Steps/CreateFieldStep/CreateFieldStepDialog.js' */
(function(d,g,f,c,b){var a=d.CreateFieldStep;var e=b.Fields.FormField;a.Views={};a.Views.CreateDialog=function(h){this.options=c.defaults({},h,{previousLabel:"Previous",nextLabel:"Create",cancelLabel:"Cancel",panel:a.Views.CreatePanel,fieldName:""});this.enabled=true};c.extend(a.Views.CreateDialog.prototype,g.Events,{initialize:function(h){this.options=h},show:function(){if(!this.dialog){var i=this.dialog=new d.Dialog({id:"customfields-configure-field",focusSelector:"#custom-field-name"});i.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",this.options.typeName));var j=c.defaults({},c.pick(this.options,"configureOptions"),{fieldName:this.options.fieldName});var h=this.panel=i.addPanel("",new this.options.panel(j));this.listenTo(h.view,"submit",c.bind(this._submit,this));this.previousButton=i.addButton({secondary:true,label:this.options.previousLabel,id:"customfields-configure-previous",click:c.bind(this._previous,this)});this.nextButton=i.addButton({label:this.options.nextLabel,id:"customfields-configure-next",submitAccessKey:true,click:function(){h.view.triggerSubmit()}});i.addLink({label:this.options.cancelLabel,click:c.bind(this._cancel,this,false),cancelAccessKey:true});this.listenTo(i,"close",c.bind(this._cancel,this,true))}else{this.dialog.hideErrors()}this.dialog.show();return this},updateData:function(h){this.dialog.addOrSetHeaderMainText(AJS.format("Configure \'\'{0}\'\' Field",h.typeName));this.panel.view.updateData(h)},_previous:function(){this.trigger("previous")},_submit:function(){var h=this.panel.view;if(this.enabled){this.trigger("submit",h.getData())}},hide:function(){this.dialog&&this.dialog.hide()},destroy:function(){this.stopListening(this.panel);if(this.dialog){this.dialog.destroy();delete this.dialog}return this},showErrors:function(h,j){if(!this.panel.view.showErrors(h,j)){this.panel.view.focus()}var i=c.union(j,c.values(h));this.dialog.showErrors(i)},showLoading:function(){this.dialog&&this.dialog.showLoading()},hideLoading:function(){this.dialog&&this.dialog.hideLoading()},disable:function(){this.enabled=false;this.panel.view.disable();this.nextButton.disable();this.previousButton.disable()},enable:function(){this.enabled=true;this.panel.view.enable();this.nextButton.enable();this.previousButton.enable()},isDirty:function(){return this.panel.view.isDirty()},_cancel:function(h){this.enabled&&this.trigger("cancel",h)}});a.Views.CreatePanel=g.Marionette.ItemView.extend({initialize:function(h){h=h||{};this.template=c.bind(this.template,this);this.form=h.form||this._createForm(h);this.listenTo(this.form,b.EVENTS.submit,this._submit)},template:function(){return this.form.render().$el},_submit:function(){this.triggerMethod("submit")},triggerSubmit:function(){this.form.submit();return this},updateData:function(h){this.form.setValueOfFieldWithName("name",h.fieldName)},getData:function(){return this.form.toJSON()},onDialogPanelShow:function(){this.form.blur().focus()},showErrors:function(h,i){return this.form.showErrors(h,i)},focus:function(){this.form.focus();return this},disable:function(){this.form.disable();return this},enable:function(){this.form.enable();return this},isDirty:function(){return this.form.isDirty()},setValueOfFieldWithName:function(h,i){this.form.setValueOfFieldWithName(h,i)},_createForm:function(h){return new b(this._createFormParams(h))},_createFormParams:function(i){var h=[{content:JIRA.Templates.CustomFields.submitHack},{id:"custom-field-name",label:"Name",name:"name",type:"text",maxLength:255,required:true,size:e.SIZE.large,validator:b.Validators.notEmpty("You must specify a name for this custom field."),value:i.fieldName},{id:"custom-field-description",label:"Description",name:"description",type:"textarea",rows:2,size:e.SIZE.large}];if(i.configureOptions){h.push({required:true,label:"Options",field:new d.OptionsField({name:"options"}),id:"custom-field-options-input"})}return{fields:h}}})}(JIRA.Admin.CustomFields,JIRA.ProjectConfig.Backbone,AJS.$,_,JIRA.Admin.CustomFields.Form));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/io/IssueCustomFields.js' */
(function(c,d,b){c.IssueCustomFields=function(f){f||(f={});b.extend(this,b.defaults(f,{autoCloseWebsudo:true}))};var e=function(h,g,f){if(g!=="abort"){h.reject(c.IssueCustomFields.STATUS.error,JIRA.SmartAjax.buildSimpleErrorContent(f))}else{h.reject(c.IssueCustomFields.STATUS.abort,null)}};var a=function(f){return b.bind.apply(b,[f,undefined].concat(b.toArray(arguments).slice(1)))};b.extend(c.IssueCustomFields.prototype,{getSharedBy:function(g){var f=this;var h=d.Deferred();g.done(function(l){var i=this,j;if(b.isUndefined(f.issue)){l.sharedBy=[];h.resolveWith(this,arguments)}else{j=b.toArray(arguments);var k=f._ajax({type:"GET",url:c.url(["rest","globalconfig",1,"issuecustomfields",f.issue,"affectedProjects"]),dataType:"json",contentType:"application/json"});k.done(function(m){l.sharedBy=m;h.resolveWith(i,j)});k.fail(function(){l.sharedBy=[];h.resolveWith(i,j)});k.progress(function(){h.notifyWith(i,arguments)})}});g.fail(function(){h.rejectWith(this,arguments)});g.progress(function(){h.notifyWith(this,arguments)});return h.promise()},addFieldToScreen:function(h){var f=d.Deferred();if(b.isUndefined(this.issue)){f.reject(c.IssueCustomFields.STATUS.error,"No issue provided.")}else{var g=this._ajax({type:"POST",url:c.url(["rest","globalconfig",1,"issuecustomfields",this.issue]),data:h,dataType:"json",contentType:"application/json"});g.done(f.resolve);g.progress(f.notify);g.fail(a(e,f))}return f.promise()},addField:function(i){var f=this,h=b.pick(i,"name","description","searcherKey","type");var g=this._ajax({type:"POST",url:c.url("/rest/api/2/field"),context:this,data:JSON.stringify(h),dataType:"json",contentType:"application/json"});return g.pipe(undefined,function(k,j){return f._parseErrorCollection(j,{fieldName:"name"})})},addableFields:function(g){var f=d.Deferred();if(b.isUndefined(this.issue)){f.reject(c.IssueCustomFields.STATUS.error,"No issue provided.")}else{var h=this._ajax({type:"GET",url:c.url(["rest","globalconfig",1,"issuecustomfields",this.issue,"fields"],{onAllScreensFlag:!!g}),contentType:"application/json"});h.done(f.resolve);h.progress(f.notify);h.fail(a(e,f))}return f.promise()},setOptions:function(g,h){var i=this._ajax({type:"POST",url:c.url(["rest","globalconfig","1","customfieldoptions",g]),context:this,data:JSON.stringify(h),dataType:"json",contentType:"application/json"});var f=d.Deferred();i.done(f.resolve);i.progress(f.notify);i.fail(a(e,f));return f},getCustomFieldTypes:function(){var f=this._ajax({type:"GET",url:c.url("/rest/globalconfig/1/customfieldtypes"),dataType:"json",contentType:"application/json"});var g=d.Deferred();f.done(g.resolve);f.progress(g.notify);f.fail(a(e,g));return g},_remapObject:function(h,g){var f={};b.each(h,function(k,j){var i=g[j]||j;f[i]=k});return f},_parseErrorCollection:function(h,i){var k,f;if(h.hasData){try{var g=JSON.parse(h.data);if(!b.isEmpty(g.errorMessages)){k=g.errorMessages}if(!b.isEmpty(g.errors)){f=g.errors;if(i){f=this._remapObject(f,i)}}}catch(j){}}if(!k&&!f){k=[JIRA.SmartAjax.buildSimpleErrorContent(h)]}return{fields:f||{},general:k||[]}},_ajax:function(h){var f=this;var g=d.Deferred();var i=JIRA.SmartAjax.makeWebSudoRequest(h,{beforeShow:function(){g.notify(c.IssueCustomFields.PROGRESS.SHOW)},success:function(j){g.notify(c.IssueCustomFields.PROGRESS.SUCCESS,j);f.autoCloseWebsudo&&j()},cancel:function(j){j.preventDefault();g.rejectWith(f,["abort",undefined])}});i.done(function(){g.resolveWith(this,b.toArray(arguments))});i.fail(function(m,l,k,j){g.rejectWith(this,[l,j])});return g.promise()}});c.IssueCustomFields.STATUS={abort:"abort",error:"error"};c.IssueCustomFields.PROGRESS={SHOW:"websudoShow",SUCCESS:"websudoSuccess"}}(JIRA.Admin.CustomFields,AJS.$,_));
/* module-key = 'com.atlassian.jira.jira-project-config-plugin:custom-fields', location = 'customfields/js/main.js' */
(function(c,a,b){b.addCustomField=function(){var e,d;e=new b.IssueCustomFields({autoCloseWebsudo:false});d={api:e,inIssueContext:false};return new b.Wizard({sharedStepOptions:d,firstStep:new b.TypeStep(d),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."}).start().done(function(){AJS.trigger("analytics",{name:"administration.customfields.created.from.global"})})};b.addCustomFieldToIssue=function(d){var f,e,g;f=new b.IssueCustomFields({autoCloseWebsudo:false,issue:d});e={api:f,inIssueContext:true};g=new b.Wizard({sharedStepOptions:e,firstStep:new b.FieldWisherStep(e),autoClose:false,dirtyMessage:"You started adding a custom field. Your changes will be lost if you navigate away without finishing."});return g.start().fail(b.addCustomFieldToIssue._notifyFailure).done(b.addCustomFieldToIssue._analytics).done(function(h){g.close();b.addCustomFieldToIssue.editOrNotify(h.field)})};a.extend(b.addCustomFieldToIssue,{editOrNotify:function(d){if(!b.addCustomFieldToIssue._editValue(d)){b.addCustomFieldToIssue._notifySuccess()}},_editValue:function(e){var d=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.editFieldOnSelectedIssue;return d&&d(e.id)},_notifyFailure:(function(){var d=function(g,f){e(JIRA.Templates.CustomFields.addCompleteError({message:g,failedSteps:f||[]}))};var e=function(f){JIRA.Messages.showMsg(f,{type:JIRA.Messages.Types.ERROR,closeable:true})};return function(i,f){var g=b.Wizard.FAIL_REASON,h;f=f||{};h=f.data||{};if(i===g.abort){if(f.dirty){if(h.createField){d("The field was created but the following operations were aborted:",f.notCompletedDescriptions)}else{e("Unable to add field to issue.")}}}else{if(i===g.error){if(h.createField){d("The field was created but the following operations failed:",f.notCompletedDescriptions)}else{e("Unable to add field to issue.")}}}}}()),_notifySuccess:function(){JIRA.Messages.showMsg("The field was added successfully, but you do not have edit permissions.",{type:JIRA.Messages.Types.SUCCESS,closeable:true})},_analytics:function(d){if(d.createField){AJS.trigger("analytics",{name:"administration.customfields.created.and.added.to.issue"})}else{if(d.addField){AJS.trigger("analytics",{name:"administration.customfields.existing.added.to.issue"})}else{if(b.addCustomFieldToIssue._isFieldVisible(d.field.id)){AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.value"})}else{AJS.trigger("analytics",{name:"administration.customfields.existing.on.issue.screens.edited.has.no.value"})}}}},_isFieldVisible:function(f){var g,e,d;d=JIRA&&JIRA.Issues&&JIRA.Issues.Api&&JIRA.Issues.Api.getFieldsOnSelectedIssue;e=d&&d();g=e&&e.get(f);return g&&g.matchesFieldSelector()}});c(document).on("click",".issueaction-fields-add",function(e){e.preventDefault();var d=JIRA.Issues.Api.getSelectedIssueId();JIRA.Admin.CustomFields.addCustomFieldToIssue(d)});c(document).on("click","#add_custom_fields",function(d){d.preventDefault();JIRA.Admin.CustomFields.addCustomField().done(function(f){var e=b.url("/secure/admin/AssociateFieldToScreens!default.jspa",{fieldId:f.field.id,returnUrl:"ViewCustomFields.jspa"});AJS.reloadViaWindowLocation(e)})})})(AJS.$,_,JIRA.Admin.CustomFields);
/* module-key = 'com.atlassian.jira.jira-view-issue-plugin:draggableattachment', location = 'viewissue/initDraggableAttachment.js' */
(function($) {
    $.event.props.push("dataTransfer");

    $('[draggable=true]').live("dragstart", function(evt) {
        var $this = AJS.$(this);
        var dataTransfer = evt.dataTransfer;
        dataTransfer.effectAllowed = 'copy';
        dataTransfer.dropEffect = 'copy';
        dataTransfer.setData("DownloadURL", $this.data('downloadurl'));
        if (!$this.find('img').length) {
            dataTransfer.setDragImage($this.closest('li').find('img:visible')[0], 8, 8);
        }
    });
})(AJS.$);
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.js' */
(function(undefined){var moment,VERSION="2.6.0",globalScope=typeof global!=="undefined"?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule=(typeof module!=="undefined"&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={"Milliseconds":1,"Seconds":1000,"Minutes":60000,"Hours":3600000,"Days":86400000,"Months":2592000000,"Years":31536000000},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function deprecate(msg,fn){var firstTime=true;function printMsg(){if(moment.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}return extend(function(){if(firstTime){printMsg();firstTime=false}return fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Language(){}function Moment(config){checkOverflow(config);extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1000+minutes*60000+hours*3600000;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._bubble()}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}if(b.hasOwnProperty("toString")){a.toString=b.toString}if(b.hasOwnProperty("valueOf")){a.valueOf=b.valueOf}return a}function cloneMoment(m){var result={},i;for(i in m){if(m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)){result[i]=m[i]}}return result}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength,forceSign){var output=""+Math.abs(number),sign=number>=0;while(output.length<targetLength){output="0"+output}return(sign?(forceSign?"+":""):"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding)}if(months){rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding)}if(updateOffset){moment.updateOffset(mom,days||months)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return Object.prototype.toString.call(input)==="[object Date]"||input instanceof Date}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(inputObject.hasOwnProperty(prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}function makeList(field){var count,setter;if(field.indexOf("week")===0){count=7;setter="day"}else{if(field.indexOf("month")===0){count=12;setter="month"}else{return }}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if(typeof format==="number"){index=format;format=undefined}getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")};if(index!=null){return getter(index)}else{for(i=0;i<count;i++){results.push(getter(i))}return results}}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber)}else{value=Math.ceil(coercedNumber)}}return value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0}function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}m._pf.overflow=overflow}}function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0}}return m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}extend(Language.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[]}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment.utc([2000,i]);regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return((input+"").toLowerCase().charAt(0)==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return typeof output==="function"?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==="function")?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function loadLang(key,values){values.abbr=key;if(!languages[key]){languages[key]=new Language()}languages[key].set(values);return languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var i=0,j,lang,next,split,get=function(k){if(!languages[k]&&hasModule){try{require("./lang/"+k)}catch(e){}}return languages[k]};if(!key){return moment.fn._lang}if(!isArray(key)){lang=get(key);if(lang){return lang}key=[key]}while(i<key.length){split=normalizeLanguage(key[i]).split("-");j=split.length;next=normalizeLanguage(key[i+1]);next=next?next.split("-"):null;while(j>0){lang=get(split.slice(0,j).join("-"));if(lang){return lang}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return moment.fn._lang}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i] instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.lang().invalidDate()}format=expandFormat(format,m.lang());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function expandFormat(format,lang){var i=5;function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict){return parseTokenOneDigit}case"SS":if(strict){return parseTokenTwoDigits}case"SSS":if(strict){return parseTokenThreeDigits}case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"));return a}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=(string.match(parseTokenTimezone)||[]),tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3}break;case"M":case"MM":if(input!=null){datePartArray[MONTH]=toInt(input)-1}break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input);if(a!=null){datePartArray[MONTH]=a}else{config._pf.invalidMonth=input}break;case"D":case"DD":if(input!=null){datePartArray[DATE]=toInt(input)}break;case"Do":if(input!=null){datePartArray[DATE]=toInt(parseInt(input,10))}break;case"DDD":case"DDDD":if(input!=null){config._dayOfYear=toInt(input)}break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(("0."+input)*1000);break;case"X":config._d=new Date(parseFloat(input)*1000);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":token=token.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=input}break}}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse,fixYear,w,temp,lang,weekday,week;if(config._d){return }currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){fixYear=function(val){var intVal=parseInt(val,10);return val?(val.length<3?(intVal>68?1900+intVal:2000+intVal):intVal):(config._a[YEAR]==null?moment().weekYear():config._a[YEAR])};w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){temp=dayOfYearFromWeeks(fixYear(w.GG),w.W||1,w.E,4,1)}else{lang=getLangDefinition(config._l);weekday=w.d!=null?parseWeekday(w.d,lang):(w.e!=null?parseInt(w.e,10)+lang._week.dow:0);week=parseInt(w.w,10)||1;if(w.d!=null&&weekday<lang._week.dow){week++}temp=dayOfYearFromWeeks(fixYear(w.gg),week,weekday,lang._week.doy,lang._week.dow)}config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}if(config._dayOfYear){yearToUse=config._a[YEAR]==null?currentDate[YEAR]:config._a[YEAR];if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true}date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i]}input[HOUR]+=toInt((config._tzm||0)/60);input[MINUTE]+=toInt((config._tzm||0)%60);config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input)}function dateFromObject(config){var normalizedInput;if(config._d){return }normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config)}function currentDateArray(config){var now=new Date();if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}else{return[now.getFullYear(),now.getMonth(),now.getDate()]}}function makeDateFromStringAndFormat(config){config._a=[];config._pf.empty=true;var lang=getLangDefinition(config._l),string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,lang).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false}else{config._pf.unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else{if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token)}}}config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string)}if(config._isPm&&config._a[HOUR]<12){config._a[HOUR]+=12}if(config._isPm===false&&config._a[HOUR]===12){config._a[HOUR]=0}dateFromConfig(config);checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return }for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=extend({},config);tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function makeDateFromString(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(string.match(parseTokenTimezone)){config._f+="Z"}makeDateFromStringAndFormat(config)}else{moment.createFromInputFallback(config)}}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);if(input===undefined){config._d=new Date()}else{if(matched){config._d=new Date(+matched[1])}else{if(typeof input==="string"){makeDateFromString(config)}else{if(isArray(input)){config._a=input.slice(0);dateFromConfig(config)}else{if(isDate(input)){config._d=new Date(+input)}else{if(typeof (input)==="object"){dateFromObject(config)}else{if(typeof (input)==="number"){config._d=new Date(input)}else{moment.createFromInputFallback(config)}}}}}}}}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}function parseWeekday(input,language){if(typeof input==="string"){if(!isNaN(input)){input=parseInt(input,10)}else{input=language.weekdaysParse(input);if(typeof input!=="number"){return null}}}return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&["s",seconds]||minutes===1&&["m"]||minutes<45&&["mm",minutes]||hours===1&&["h"]||hours<22&&["hh",hours]||days===1&&["d"]||days<=25&&["dd",days]||days<=45&&["M"]||days<345&&["MM",round(days/30)]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add("d",daysToDayOfWeek);return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;if(input===null||(format===undefined&&input==="")){return moment.invalid({nullInput:true})}if(typeof input==="string"){config._i=input=getLangDefinition().preparse(input)}if(moment.isMoment(input)){config=cloneMoment(input);config._d=new Date(+input._d)}else{if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}}return new Moment(config)}moment=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=lang;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c)};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)});moment.utc=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=lang;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc()};moment.unix=function(input){return moment(input*1000)};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else{if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else{if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=(match[1]==="-")?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else{if(!!(match=isoDurationRegex.exec(input))){sign=(match[1]==="-")?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}}}}}ret=new Duration(duration);if(moment.isDuration(input)&&input.hasOwnProperty("_lang")){ret._lang=input._lang}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.lang=function(key,values){var r;if(!key){return moment.fn._lang._abbr}if(values){loadLang(normalizeLanguage(key),values)}else{if(values===null){unloadLang(key);key="en"}else{if(!languages[key]){getLangDefinition(key)}}}r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key);return r._abbr};moment.langData=function(key){if(key&&key._lang&&key._lang._abbr){key=key._lang._abbr}return getLangDefinition(key)};moment.isMoment=function(obj){return obj instanceof Moment||(obj!=null&&obj.hasOwnProperty("_isAMomentObject"))};moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i){makeList(lists[i])}moment.normalizeUnits=function(units){return normalizeUnits(units)};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags)}else{m._pf.userInvalidated=true}return m};moment.parseZone=function(){return moment.apply(null,arguments).parseZone()};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000)};extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0}return false},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,1);return this},subtract:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,-1);return this},diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(this.zone()-that.zone())*60000,diff,output;units=normalizeUnits(units);if(units==="year"||units==="month"){diff=(this.daysInMonth()+that.daysInMonth())*43200000;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf("month"))-(that-moment(that).startOf("month")))/diff;output-=((this.zone()-moment(this).startOf("month").zone())-(that.zone()-moment(that).startOf("month").zone()))*60000/diff;if(units==="year"){output=output/12}}else{diff=(this-that);output=units==="second"?diff/1000:units==="minute"?diff/60000:units==="hour"?diff/3600000:units==="day"?(diff-zoneDiff)/86400000:units==="week"?(diff-zoneDiff)/604800000:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var sod=makeAs(moment(),this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.lang());return this.add({d:input-day})}else{return day}},month:makeAccessor("Month",true),startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}else{if(units==="isoWeek"){this.isoWeekday(1)}}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this},endOf:function(units){units=normalizeUnits(units);return this.startOf(units).add((units==="isoWeek"?"week":units),1).subtract("ms",1)},isAfter:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){units=units||"ms";return +this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:function(other){other=moment.apply(null,arguments);return other<this?this:other},max:function(other){other=moment.apply(null,arguments);return other>this?this:other},zone:function(input,keepTime){var offset=this._offset||0;if(input!=null){if(typeof input==="string"){input=timezoneMinutesFromString(input)}if(Math.abs(input)<16){input=input*60}this._offset=input;this._isUTC=true;if(offset!==input){if(!keepTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,false)}else{if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null}}}}else{return this._isUTC?offset:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.zone(this._tzm)}else{if(typeof this._i==="string"){this.zone(this._i)}}return this},hasAlignedHourOffset:function(input){if(!input){input=0}else{input=moment(input).zone()}return(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/86400000)+1;return input==null?dayOfYear:this.add("d",(input-dayOfYear))},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return input==null?year:this.add("y",(input-year))},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add("y",(input-year))},week:function(input){var week=this.lang().week(this);return input==null?week:this.add("d",(input-week)*7)},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add("d",(input-week)*7)},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return input==null?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){units=normalizeUnits(units);return this[units]()},set:function(units,value){units=normalizeUnits(units);if(typeof this[units]==="function"){this[units](value)}return this},lang:function(key){if(key===undefined){return this._lang}else{this._lang=getLangDefinition(key);return this}}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.lang().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){if(unit==="Month"){return rawMonthSetter(mom,value)}else{return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this}else{return rawGetter(this,unit)}}}moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",false);moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",false);moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",false);moment.fn.hour=moment.fn.hours=makeAccessor("Hours",true);moment.fn.date=makeAccessor("Date",true);moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",true));moment.fn.year=makeAccessor("FullYear",true);moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);data.days=days%30;months+=absRound(days/30);data.months=months%12;years=absRound(months/12);data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+toInt(this._months/12)*31536000000},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=this.lang().pastFuture(difference,output)}return this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){units=normalizeUnits(units);return this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return"P0D"}return(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+((hours||minutes||seconds)?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":"")}});function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return +this/factor}}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}makeDurationAsGetter("Weeks",604800000);moment.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};moment.lang("en",{ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th";return number+output}});function makeGlobal(shouldDeprecate){if(typeof ender!=="undefined"){return }oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.moment=deprecate("Accessing Moment through the global scope is "+"deprecated, and will be removed in an upcoming "+"release.",moment)}else{globalScope.moment=moment}}if(hasModule){module.exports=moment}else{if(typeof define==="function"&&define.amd){define("moment",function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===true){globalScope.moment=oldGlobalMoment}return moment});makeGlobal(true)}else{makeGlobal()}}}).call(this);
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.jira.i18n.js' */
(function(moment){var meridiem=['AM','PM'],map={d:"D",y:"Y",a:"A",E:"d",u:"d",Z:"ZZ",z:"[GMT]ZZ",XX:"ZZ",XXX:"Z"};JIRA.translateSimpleDateFormat=function(pattern){var inQuote=false,skip=false,tmpBuffer="",actuallyTranslate=function(tmpBuffer){return map[tmpBuffer]||_.reduce(tmpBuffer,function(memo,value){return memo+(map[value]||value)},"")},reduction=_.reduce(pattern,function(memo,value,index,list){if(skip){skip=false}else{if(value==="'"){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}if(list[index+1]==="'"){memo+=value;skip=true}else{memo+=!inQuote?"[":"]";inQuote=!inQuote}}else{if(inQuote){memo+=value}else{if(!/[a-zA-Z]/.test(value)){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}memo+=value}else{if(!tmpBuffer||tmpBuffer[tmpBuffer.length-1]===value){tmpBuffer+=value}else{memo+=actuallyTranslate(tmpBuffer);tmpBuffer=value}}}}}return memo},"");if(tmpBuffer){reduction+=actuallyTranslate(tmpBuffer)}return reduction};moment.lang("jira",{months:['January','February','March','April','May','June','July','August','September','October','November','December'],monthsShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],weekdays:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],weekdaysShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],weekdaysMin:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],longDateFormat:{LT:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-time")),L:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-day")),LL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-dmy")),LLL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-complete"))},meridiem:function(hours){return meridiem[+(hours>11)]},calendar:{sameDay:"LLL",nextDay:"LLL",nextWeek:"LLL",lastDay:"LLL",lastWeek:"LLL",sameElse:"LLL"},relativeTime:{future:AJS.format("in {0}","%s"),past:AJS.format("{0} ago","%s"),s:"a few seconds",m:"a minute",mm:AJS.format("{0} minutes","%d"),h:"an hour",hh:AJS.format("{0} hours","%d"),d:"a day",dd:AJS.format("{0} days","%d"),M:"a month",MM:AJS.format("{0} months","%d"),y:"a year",yy:AJS.format("{0} years","%d")}})}(moment));
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/time.js' */
(function($,moment){JIRA.Time={};function Type(str,isAge){this.key=str;this.isAge=isAge}var relativize=AJS.Meta.getBoolean("date-relativize");Type.types={};for(var a=["shortAge","longAge","fullAge","short","long","full","timestamp"],i=0,l=a.length,t;i<l;i++){t=a[i];Type.types[t]=new Type(t,t.toLowerCase().indexOf("age")!==-1)}JIRA.Time.FormatType=Type;function getTextForRelativeAge(age,type,param){switch(age){case"inAMoment":return "Now";case"inOneMinute":return "In 1 minute";case"inXMinutes":return AJS.format("In {0} minutes",param);case"inOneHour":return "In 1 hour";case"inXHours":return AJS.format("In {0} hours",param);case"inOneDay":return "Tomorrow";case"inXDays":return AJS.format("In {0} days",param);case"inOneWeek":return "In 1 week";case"aMomentAgo":return "Just now";case"oneMinuteAgo":return "1 minute ago";case"xMinutesAgo":return AJS.format("{0} minutes ago",param);case"oneHourAgo":return "1 hour ago";case"xHoursAgo":return AJS.format("{0} hours ago",param);case"oneDayAgo":return "Yesterday";case"xDaysAgo":return AJS.format("{0} days ago",param);case"oneWeekAgo":return "1 week ago";default:return null}}function getFormatString(type){switch(type.key){case"short":case"shortAge":return"ll";case"long":case"longAge":return"LL";case"full":case"fullAge":return"LLL";case"timestamp":return"LLL";default:return null}}function beginningOfDay(time){return time.clone().hours(0).minutes(0).seconds(0).milliseconds(0)}function isYesterday(now,date){var end=beginningOfDay(now);var start=end.clone().subtract("d",1);return start<=date&&date<end}function isTomorrow(now,date){var start=beginningOfDay(now).add("d",1);var end=start.clone().add("d",1);return start<=date&&date<end}function getMinutesBetween(start,end){return Math.floor(end.diff(start,"minutes",true))}function getHoursBetween(start,end){var hourDiff=end.diff(start,"hours",true);return Math.round(hourDiff)}function getDaysBetween(start,end){return Math.floor(end.diff(start,"days",true))}function formatDateWithFormatString(date,type){var formatString=getFormatString(type);return date.format(formatString)}function formatDateWithRelativeAge(date,type,now){now=now||moment();if(date<=now){if(date>now.clone().subtract("m",1)){return getTextForRelativeAge("aMomentAgo",type)}else{if(date>now.clone().subtract("m",2)){return getTextForRelativeAge("oneMinuteAgo",type)}else{if(date>now.clone().subtract("m",50)){return getTextForRelativeAge("xMinutesAgo",type,getMinutesBetween(date,now))}else{if(date>now.clone().subtract("m",90)){return getTextForRelativeAge("oneHourAgo",type)}else{if(isYesterday(now,date)&&date<now.clone().subtract("h",5)){return getTextForRelativeAge("oneDayAgo",type)}else{if(date>now.clone().subtract("d",1)){return getTextForRelativeAge("xHoursAgo",type,getHoursBetween(date,now))}else{if(date>now.clone().subtract("d",7)){return getTextForRelativeAge("xDaysAgo",type,Math.max(getDaysBetween(date,now),2))}else{if(date>now.clone().subtract("d",8)){return getTextForRelativeAge("oneWeekAgo",type)}}}}}}}}}else{if(date<now.clone().add("m",1)){return getTextForRelativeAge("inAMoment",type)}else{if(date<now.clone().add("m",2)){return getTextForRelativeAge("inOneMinute",type)}else{if(date<now.clone().add("m",50)){return getTextForRelativeAge("inXMinutes",type,getMinutesBetween(now,date))}else{if(date<now.clone().add("m",90)){return getTextForRelativeAge("inOneHour",type)}else{if(isTomorrow(now,date)&&date>now.clone().add("h",5)){return getTextForRelativeAge("inOneDay",type)}else{if(date<now.clone().add("d",1)){return getTextForRelativeAge("inXHours",type,getHoursBetween(now,date))}else{if(date<now.clone().add("d",7)){return getTextForRelativeAge("inXDays",type,Math.max(getDaysBetween(now,date),2))}else{if(date<now.clone().add("d",8)){return getTextForRelativeAge("inOneWeek",type)}}}}}}}}}return formatDateWithFormatString(date,type)}JIRA.Time.formatDate=function formatDate(momentDate,type,forceRelativize){if(momentDate&&type){if((relativize||forceRelativize)&&type.isAge){return formatDateWithRelativeAge(momentDate,type)}else{return formatDateWithFormatString(momentDate,type)}}else{return null}};JIRA.Time.formatDateWithRelativeAge=formatDateWithRelativeAge;JIRA.Time.formatDateWithFormatString=formatDateWithFormatString}(jQuery,moment));
/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/livestamp.js' */
(function($,moment){var timeout,updateInterval=6000,relativize=AJS.Meta.getBoolean("date-relativize"),livestamps=[],prep=function($el,timestamp){$el.data("livestampdata",timestamp);livestamps.push($el)},run=function(){clearTimeout(timeout);update();timeout=setTimeout(run,updateInterval)},update=function(){livestamps=$.grep(livestamps,function($el){var timestamp=$el.data("livestampdata"),forceRelativize=$el.data("relativize"),from,to;if(!moment.isMoment(timestamp)||!$el.closest("html").length){$el.removeData("livestampdata")}else{from=$el.text();var tsFormat=$el.data("datetime-format");tsFormat=tsFormat?tsFormat:"fullAge";if(!(relativize||forceRelativize)){tsFormat=tsFormat.replace("Age","")}to=JIRA.Time.formatDate(timestamp,JIRA.Time.FormatType.types[tsFormat],forceRelativize);if(from!==to){$el.text(to)}}return !!$el.data("livestampdata")})},add=function($el){$el.each(function(){var $this=$(this),timestamp=$this.attr("datetime");if(timestamp){var timestampMoment=isNaN(timestamp)?moment(timestamp).zone(timestamp):moment(parseInt(timestamp,10));prep($this,timestampMoment)}});run();return $el};$.fn.livestamp=function(){return add(this)}}(jQuery,moment));
/* module-key = 'com.atlassian.auiplugin:aui-experimental-expander', location = 'js/aui-experimental-expander.js' */
(function(D){var E=D(document),C=function(G){var F={};F.$trigger=D(G.currentTarget);F.$content=E.find("#"+F.$trigger.attr("aria-controls"));F.triggerIsParent=F.$content.parent().filter(F.$trigger).length!==0;F.$shortContent=F.triggerIsParent?F.$trigger.find(".aui-expander-short-content"):null;F.height=F.$content.css("min-height");F.isCollapsible=F.$trigger.data("collapsible")!==false;F.replaceText=F.$trigger.attr("data-replace-text");F.replaceSelector=F.$trigger.data("replace-selector");return F},B=function(G){if(G.replaceText){var F=G.replaceSelector?G.$trigger.find(G.replaceSelector):G.$trigger;G.$trigger.attr("data-replace-text",F.text());F.text(G.replaceText)}};var A={"aui-expander-invoke":function(I){var F=D(I.currentTarget);var H=E.find("#"+F.attr("aria-controls"));var G=F.data("collapsible")!==false;if(H.attr("aria-expanded")=="true"&&G){F.trigger("aui-expander-collapse")}else{F.trigger("aui-expander-expand")}},"aui-expander-expand":function(G){var F=C(G);F.$content.attr("aria-expanded","true");if(F.$content.outerHeight()>0){F.$content.attr("aria-hidden","false")}B(F);if(F.triggerIsParent){F.$shortContent.hide()}F.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(J){var H=C(J),G,I=parseInt(H.$content.css("line-height"),10),F=H.$content.children().first().height();if(H.$content.outerHeight()===0){H.$content.attr("aria-hidden","true")}B(H);H.$content.attr("aria-expanded","false");if(H.triggerIsParent){H.$shortContent.show()}H.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(G){var F=D(G.currentTarget);F.trigger("aui-expander-invoke",G.currentTarget)}};E.on(A,".aui-expander-trigger")})(jQuery);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);
/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/workflow/TriggersPluginBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};
/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/devstatus/FeedbackDialog.js' */
Backbone.define("JIRA.DevStatus.FeedbackDialog",Backbone.Model.extend({properties:["collectorId","summary"],defaults:{summary:"Tell us what you think.",collectorId:"effe8b72"},show:function(){var a=this.get("collectorId");window.ATL_JQ_PAGE_PROPS=window.ATL_JQ_PAGE_PROPS||{};window.ATL_JQ_PAGE_PROPS[a]={fieldValues:{summary:this.get("summary")},triggerFunction:function(b){_.defer(function(){b()})}};AJS.$.getScript(this._collectorUrlFor(a))},_collectorUrlFor:function(a){return"https://jira.atlassian.com/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-7m3tmj-1988229788/6307/131/1.4.8/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId="+a}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DateUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.Date");JIRA.DevStatus.Date={addTooltip:function(c){var b=c.find("time.livestamp");b.livestamp();b.each(function(){var f=a(this);var e=f.attr("datetime");var g=isNaN(e)?e:+e;var d=moment(g).zone(g);if(!d.isValid()){d=moment(g)}f.attr("title",d.format(JIRA.DevStatus.Date.format))})},format:"LLL"}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/Listeners.js' */
Backbone.define("JIRA.DevStatus.Util.Listeners",Class.extend({init:function(){this._listening=[]},startListening:function(a,c,e,b){var d={start:function(){a.on(c,e,b);return this},stop:function(){a.off(c,e,b);return this}};this._listening.push(d.start())},stopListening:function(){_.each(this._listening,function(a){a.stop()});this._listening=[]}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusURLUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.URL");JIRA.DevStatus.URL={getDetailDialogParam:function(){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);return c&&c.queryKey&&c.queryKey.devStatusDetailDialog},getUrlWithDetailDialogParam:function(d){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);c.queryKey.devStatusDetailDialog=encodeURIComponent(d);return this._createUrlFromParsedUri(c)},getCreateReviewDetailUrl:function(b){return this.getUrlWithDetailDialogParam("create-review-"+b)},isCreateReviewDetailDialogLink:function(b){return b&&b.lastIndexOf&&b.lastIndexOf("create-review-",0)===0},getCreateReviewDetailDialogApplicationType:function(b){return b.substring("create-review-".length)},_removeKickAssIHashFromUrl:function(b){return b.replace("i#","")},_createUrlFromParsedUri:function(c){var d=[];AJS.$.each(c.queryKey,function(e,f){if(_.isObject(f)){AJS.$.each(f,function(g,h){d.push(e+"="+h)})}else{d.push(e+"="+f)}});var b="";if(c.protocol){b+=c.protocol+"://"}if(c.authority){b+=c.authority}if(c.path){b+=c.path}if(d.length>0){b+="?"+d.join("&")}if(c.anchor){b+="#"+c.anchor}return b}}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/common/devstatus-common.soy' */
// This file was automatically generated from devstatus-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Common == 'undefined') { JIRA.Templates.DevStatus.Common = {}; }


JIRA.Templates.DevStatus.Common.learnMoreLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(' <a href="https://www.atlassian.com/software-development" class="learn-more-link" target="_blank">', soy.$$escapeHtml("Learn more"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-cta-dialog.soy' */
// This file was automatically generated from devstatus-cta-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Dialog == 'undefined') { JIRA.Templates.DevStatus.Dialog = {}; }


JIRA.Templates.DevStatus.Dialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading">', (opt_data.prompt) ? '<h2>' + soy.$$escapeHtml(opt_data.prompt) + '</h2>' : '', '</div><div class="jira-dialog-content"><ul class="targets">');
  var remoteAppList10 = opt_data.remoteApps;
  var remoteAppListLen10 = remoteAppList10.length;
  for (var remoteAppIndex10 = 0; remoteAppIndex10 < remoteAppListLen10; remoteAppIndex10++) {
    var remoteAppData10 = remoteAppList10[remoteAppIndex10];
    output.append('<li>');
    JIRA.Templates.DevStatus.Dialog.remoteApp(remoteAppData10, output);
    output.append('</li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><button class="aui-button aui-button-link cancel" id="aui-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Dialog.remoteApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="target ', (opt_data.primary) ? 'primary' : '', '" data-application-type="', soy.$$escapeHtml(opt_data.applicationType), '" href="', soy.$$escapeHtml(opt_data.url), '">', (opt_data.iconUrl) ? '<img class="application-icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '">' : '<span class="application-icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>', '<div class="title" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</div><div class="base-url" title="', soy.$$escapeHtml(opt_data.baseUrl), '">', soy.$$escapeHtml(opt_data.baseUrl), '</div></a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-panel.soy' */
// This file was automatically generated from devstatus-panel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }


JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param3);
  aui.message.info({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemAsWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param10 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param10);
  aui.message.warning({content: param10.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if ((! opt_data.errorInstances || opt_data.errorInstances.length == 0) && (! opt_data.notConfiguredInstances || opt_data.notConfiguredInstances.length == 0)) {
    output.append('<p class="connection-error">', "JIRA is having difficulty contacting the applications that supply development status information.", ' ');
    JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
    output.append('</p>');
  } else {
    if (opt_data.errorInstances.length > 0) {
      output.append('<p class="connection-error">');
      JIRA.Templates.DevStatus.connectionProblemMultipleInstances({instances: opt_data.errorInstances}, output);
      output.append(' ');
      JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
      output.append('</p>');
    }
    if (opt_data.notConfiguredInstances && opt_data.notConfiguredInstances.length > 0) {
      output.append('<p class="config-errors">');
      JIRA.Templates.DevStatus.configProblem(opt_data, output);
      output.append('</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.contactAdmin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="connection-error">');
  if (! opt_data.instances || opt_data.instances.length == 0) {
    output.append("JIRA is having difficulty contacting the applications that supply development status information.");
  } else {
    JIRA.Templates.DevStatus.connectionProblemMultipleInstances(opt_data, output);
  }
  output.append(' ', AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.configProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var servers__soy56 = opt_data.notConfiguredInstances;
  output.append('<span class="description">');
  var server0__soy58 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[0]}, server0__soy58);
  server0__soy58 = server0__soy58.toString();
  if (servers__soy56.length == 1) {
    output.append(AJS.format("Couldn\x27\x27t read data from {0}.",server0__soy58));
  } else {
    var server1__soy66 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[1]}, server1__soy66);
    server1__soy66 = server1__soy66.toString();
    if (servers__soy56.length == 2) {
      output.append(AJS.format("Couldn\x27\x27t read data from {0} and {1}.",server0__soy58,server1__soy66));
    } else {
      var server2__soy74 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[2]}, server2__soy74);
      server2__soy74 = server2__soy74.toString();
      output.append((servers__soy56.length == 3) ? AJS.format("Couldn\x27\x27t read data from {0}, {1}, and {2}.",server0__soy58,server1__soy66,server2__soy74) : AJS.format("Couldn\x27\x27t read data from {0}, {1}, {2}, and {3} other {3,choice,1#application|1\x3capplications}.",server0__soy58,server1__soy66,server2__soy74,servers__soy56.length - 3));
    }
  }
  output.append('</span> <span class="hints">');
  var aOpenLearnMore__soy85 = new soy.StringBuilder('<a href="https://confluence.atlassian.com/x/OQNwGg" target="_blank">');
  aOpenLearnMore__soy85 = aOpenLearnMore__soy85.toString();
  var aOpenApplinks__soy87 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(""), '/plugins/servlet/applinks/listApplicationLinks">');
  aOpenApplinks__soy87 = aOpenApplinks__soy87.toString();
  var aClose__soy91 = new soy.StringBuilder('</a>');
  aClose__soy91 = aClose__soy91.toString();
  output.append(AJS.format("Learn {0}about this issue{1} or go to {2}application links{3} to fix it.",aOpenLearnMore__soy85,aClose__soy91,aOpenApplinks__soy87,aClose__soy91), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemMultipleInstances = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instance0__soy97 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[0]}, instance0__soy97);
  instance0__soy97 = instance0__soy97.toString();
  if (opt_data.instances.length == 1) {
    output.append(AJS.format("JIRA is having difficulty contacting {0}.",instance0__soy97));
  } else {
    var instance1__soy105 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[1]}, instance1__soy105);
    instance1__soy105 = instance1__soy105.toString();
    if (opt_data.instances.length == 2) {
      output.append(AJS.format("JIRA is having difficulty contacting {0} and {1}.",instance0__soy97,instance1__soy105));
    } else {
      var instance2__soy113 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[2]}, instance2__soy113);
      instance2__soy113 = instance2__soy113.toString();
      output.append(AJS.format("JIRA is having difficulty contacting {0}, {1}, {3,choice,0#and {2}|1#{2}, and another application|1\x3c{2}, and {3} more applications}.",instance0__soy97,instance1__soy105,instance2__soy113,opt_data.instances.length - 3));
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemSingleInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="instance" data-name="', soy.$$escapeHtml(opt_data.instance.name), '"><a href="', soy.$$escapeHtml(opt_data.instance.baseUrl), '" title="', soy.$$escapeHtml(opt_data.instance.name), '">', soy.$$escapeHtml(opt_data.instance.name), '</a></span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.labsOnOff = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((! opt_data.isOptedInByAdmin && ! opt_data.isOptedIn) ? '<div class="on-off-panel aui-message closeable"><h2 class="title">' + soy.$$escapeHtml("JIRA Labs") + '</h2><p>' + soy.$$escapeHtml("The new way to see your related commits and pull requests as they occur.") + '</p><span class="aui-icon icon-close labs-close" role="button" tabindex="0" title="' + soy.$$escapeHtml("Close the JIRA Labs panel") + '"></span><div class="aui-group"><div class="aui-item"><button class="toggle-labs aui-button" title="' + soy.$$escapeHtml("Enable JIRA Labs for development panel") + '">' + soy.$$escapeHtml("Enable Labs") + '</button></div></div>' : '<div class="on-off-panel opted-in"><span class="feedback-link"><a href="#" title="' + soy.$$escapeHtml("Give Atlassian feedback about the JIRA development panel") + '">' + soy.$$escapeHtml("Feedback") + '</a></span>' + ((! opt_data.isOptedInByAdmin) ? ' | <span class="disable-labs"><a class="toggle-labs" href="#" title="' + soy.$$escapeHtml("Disable JIRA Labs for the development panel") + '">' + soy.$$escapeHtml("Disable Labs") + '</span></span>' : '') + '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.tryLabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span href="#" class="try-labs" title="', soy.$$escapeHtml("Show the JIRA Labs panel"), '">', soy.$$escapeHtml("Try Labs"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.lastUpdated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastUpdated) {
    output.append('<dd class="sub-text', (opt_data.extraClass) ? ' ' + soy.$$escapeHtml(opt_data.extraClass) : '', '">');
    JIRA.Templates.DevStatus.transitionContainer({content: '<div>' + soy.$$escapeHtml(opt_data.text) + ' <time class="livestamp date user-tz allow-future" ' + ((opt_data.datetimeFormat) ? 'data-datetime-format="' + soy.$$escapeHtml(opt_data.datetimeFormat) + '" ' : '') + 'datetime="' + soy.$$escapeHtml(opt_data.lastUpdated) + '">$' + soy.$$escapeHtml(opt_data.lastUpdated) + '</time></div>'}, output);
    output.append('</dd>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.transitionContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="rolling-container sliding-container"><div class="rolling-content">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog.soy' */
// This file was automatically generated from devstatus-detail-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.frame = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading devstatus-dialog-heading ', (opt_data.tabs.length > 1) ? 'borderless' : '', '"><h2>', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="jira-dialog-content devstatus-dialog-content">');
  JIRA.Templates.DevStatus.DetailDialog.applicationTabs(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.applicationTabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu ', (opt_data.tabs.length == 1) ? 'hidden' : '', '" >');
  var tabList18 = opt_data.tabs;
  var tabListLen18 = tabList18.length;
  for (var tabIndex18 = 0; tabIndex18 < tabListLen18; tabIndex18++) {
    var tabData18 = tabList18[tabIndex18];
    output.append('<li id="tab-menu-', soy.$$escapeHtml(tabData18.type), '" data-application-type=', soy.$$escapeHtml(tabData18.type), ' class="menu-item ', (! opt_data.initialTab && tabIndex18 == 0 || tabData18.type == opt_data.initialTab) ? ' active-tab' : '', '"><a  href="#tab-content-', soy.$$escapeHtml(tabData18.type), '"><strong>', soy.$$escapeHtml(tabData18.name), '</strong><span class="aui-badge devstatus-tab-count">', soy.$$escapeHtml(tabData18.count), '</span></a></li>');
  }
  output.append('</ul><div class="form-body">');
  var tabList36 = opt_data.tabs;
  var tabListLen36 = tabList36.length;
  for (var tabIndex36 = 0; tabIndex36 < tabListLen36; tabIndex36++) {
    var tabData36 = tabList36[tabIndex36];
    output.append('<div class="tabs-pane ', (tabIndex36 == 0) ? 'active-pane' : '', '" id="tab-content-', soy.$$escapeHtml(tabData36.type), '"><div class="status-loading"></div><div class="detail-content-container"></div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.repositoryHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="repository-header', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '"><div class="aui-group aui-group-split repository-header-group"><div class="aui-item project-space">');
  JIRA.Templates.DevStatus.DetailDialog.projectInfo(opt_data, output);
  output.append('</div>', (opt_data.extraContent) ? '<div class="aui-item action-space">' + opt_data.extraContent + '</div>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-avatar" ', (opt_data.repository.avatarDescription) ? 'title="' + soy.$$escapeHtml(opt_data.repository.avatarDescription) + '"' : '', '><span class="aui-avatar aui-avatar-small aui-avatar-project ', (opt_data.repository.avatar) ? 'fusion-avatar-project' : 'default-avatar-project', '">', (opt_data.repository.avatar) ? '<span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(opt_data.repository.avatar) + '" /></span>' : '<span class="aui-avatar-inner aui-icon aui-icon-small aui-iconfont-devtools-repository"></span>', '</span></div><div class="project-info"><a class="repository-link" href="', soy.$$escapeHtml(opt_data.repository.url), '"', (opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '', '>', soy.$$escapeHtml(opt_data.repository.name), '</a></div><div class="extra-project-info">', (opt_data.showParent && opt_data.repository.parent && opt_data.repository.parent.name && opt_data.repository.parent.url) ? '<a class="fork-off" href="' + soy.$$escapeHtml(opt_data.repository.parent.url) + '"><span class="fork-name" title="' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '">' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '</span></a>' : '', (opt_data.extraProjectInfo) ? opt_data.extraProjectInfo : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.oauthStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-info" /> ', soy.$$escapeHtml(opt_data.message), ' ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.authenticationScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="authentication-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2><p>', soy.$$escapeHtml(AJS.format("Please login to approve {0,choice,1#this application|1\x3cthese applications}:",opt_data.unauthInstances.length)), ' <span class="instances"></span></p>');
  if (opt_data.otherInstances.length > 0) {
    JIRA.Templates.DevStatus.connectionProblemAsWarning({instances: opt_data.otherInstances, showContactAdminForm: opt_data.showContactAdminForm}, output);
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="connection-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2>');
  JIRA.Templates.DevStatus.connectionProblem(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="no-permission-to-view-all"><div class="lock-image"></div><span>', soy.$$escapeHtml(opt_data.message), '</span>', (opt_data.secondaryMessage) ? ' <span>' + soy.$$escapeHtml(opt_data.secondaryMessage) + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.timestamp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.timestamp) ? '<time class="livestamp date user-tz" datetime="' + soy.$$escapeHtml(opt_data.timestamp) + '" data-datetime-format="longAge">' + soy.$$escapeHtml(opt_data.timestamp) + '</time>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.vcsUser = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span><div class="vcs-user"><span class="extra-content-in-title ', (opt_data.approved) ? 'fade' : '', '" title="', soy.$$escapeHtml(opt_data.name), '"><img class="author-avatar" src="', soy.$$escapeHtml(opt_data.avatar), '"/></span>', (opt_data.approved) ? '<span class="approved"></span>' : '', '</div></span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/build/devstatus-detail-dialog-build.soy' */
// This file was automatically generated from devstatus-detail-dialog-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.build = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.projects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.projectContent({project: projectData3, projectIndex: projectIndex3, withArtifactColumn: opt_data.hasArtifacts, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-builds-container">');
  JIRA.Templates.DevStatus.DetailDialog.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table builds-table', (opt_data.withArtifactColumn) ? ' builds-table-with-artifact-column' : '', '"><table class="aui"><thead><tr><th class="plan">', soy.$$escapeHtml("Plan"), '</th><th class="build cell-type-collapsed">', soy.$$escapeHtml("Latest build"), '</th><th class="result cell-type-collapsed">', soy.$$escapeHtml("Result"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Completed"), '</th>', (opt_data.withArtifactColumn) ? '<th class="actions cell-type-collapsed"></th>' : '', '</tr></thead><tbody>');
  var planList30 = opt_data.project.plans;
  var planListLen30 = planList30.length;
  for (var planIndex30 = 0; planIndex30 < planListLen30; planIndex30++) {
    var planData30 = planList30[planIndex30];
    var planHasArtifacts__soy31 = planData30.build.artifacts && planData30.build.artifacts.length;
    var uniqueIdSuffix__soy32 = opt_data.projectIndex + '-' + planIndex30;
    output.append('<tr class="plan-row', (planHasArtifacts__soy31) ? ' merge' : '', '"><td class="plan">');
    JIRA.Templates.DevStatus.DetailDialog.planName({plan: planData30}, output);
    output.append('</td><td class="build">');
    JIRA.Templates.DevStatus.DetailDialog.buildIcon({build: planData30.build}, output);
    output.append(' <a class="build-link" href="', soy.$$escapeHtml(planData30.build.url), '">', soy.$$escapeHtml(AJS.format("#{0}",planData30.build.buildNumber)), '</a></td><td class="result">');
    JIRA.Templates.DevStatus.DetailDialog.buildResult({build: planData30.build}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: planData30.build.finishedDate}, output);
    output.append('</td>');
    if (opt_data.withArtifactColumn) {
      output.append('<td class="actions">');
      if (planHasArtifacts__soy31) {
        aui.expander.trigger({id: 'detail-dialog-build-show-artifacts-trigger-' + uniqueIdSuffix__soy32, contentId: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, tag: 'a', content: "Show artifacts", replaceText: "Hide artifacts"}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
    if (planHasArtifacts__soy31) {
      output.append('<tr class="artifacts"><td colspan="5">');
      var param71 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.artifactsTable({build: planData30.build}, param71);
      aui.expander.content({id: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, content: param71.toString()}, output);
      output.append('</td></tr>');
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="builds-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.planName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><span class="plan-name">', (opt_data.plan.isBranch) ? '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a> &rsaquo; <span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</span><a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</a>' : '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a>', '</span>', (opt_data.plan.disabled) ? '<span class="aui-lozenge aui-lozenge-subtle disabled" title="' + soy.$$escapeHtml("This plan is disabled") + '">' + soy.$$escapeHtml("Disabled") + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.build.buildState == 'SUCCESS' || opt_data.build.buildState == 'FAILED') {
    if (opt_data.build.testSummary) {
      var duration__soy131 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.buildDuration(opt_data, duration__soy131);
      duration__soy131 = duration__soy131.toString();
      output.append('<span>', (opt_data.build.testSummary.failedTestCount > 0) ? (opt_data.build.testSummary.successfulTestCount) ? soy.$$escapeHtml(AJS.format("{0} of {1} tests failed in {2}",opt_data.build.testSummary.failedTestCount,opt_data.build.testSummary.totalTestCount,duration__soy131)) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} failed in {1}",opt_data.build.testSummary.failedTestCount,duration__soy131)) : (opt_data.build.testSummary.successfulTestCount > 0) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} passed in {1}",opt_data.build.testSummary.successfulTestCount,duration__soy131)) : (opt_data.build.buildState == 'SUCCESS') ? soy.$$escapeHtml(AJS.format("Passed in {0}",duration__soy131)) : soy.$$escapeHtml(AJS.format("Failed in {0}",duration__soy131)), '</span>');
    }
  } else {
    output.append(soy.$$escapeHtml("Build incomplete"));
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildDuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.build) ? (opt_data.build.durationInSeconds < 1) ? soy.$$escapeHtml("under 1 second") : (opt_data.build.durationInSeconds < 90) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#second|1\x3cseconds}",opt_data.build.durationInSeconds)) : (opt_data.build.durationInSeconds < 5400) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#minute|1\x3cminutes}",Math.floor(opt_data.build.durationInSeconds / 60))) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#hour|1\x3chours}",Math.floor(opt_data.build.durationInSeconds / 60 / 60))) : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy167 = new soy.StringBuilder((opt_data.build.buildState == 'SUCCESS') ? 'aui-iconfont-approve' : (opt_data.build.buildState == 'FAILED') ? 'aui-iconfont-error' : 'aui-iconfont-devtools-task-cancelled');
  iconClass__soy167 = iconClass__soy167.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy167), '">', soy.$$escapeHtml(opt_data.build.buildState), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var column1Height__soy181 = Math.ceil(opt_data.build.artifacts.length / 3);
  var column2Height__soy182 = Math.ceil((opt_data.build.artifacts.length - 1) / 3);
  var column3Height__soy183 = Math.ceil((opt_data.build.artifacts.length - 2) / 3);
  output.append('<div class="build-artifacts-table"><table class="aui"><tbody>');
  var artifactIndexLimit185 = column1Height__soy181;
  for (var artifactIndex185 = 0; artifactIndex185 < artifactIndexLimit185; artifactIndex185++) {
    output.append('<tr><td>');
    JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185]}, output);
    output.append('</td><td>');
    if (artifactIndex185 < column2Height__soy182) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181]}, output);
    }
    output.append('</td><td>');
    if (artifactIndex185 < column3Height__soy183) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181 + column2Height__soy182]}, output);
    }
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.artifact && opt_data.artifact.name) ? (opt_data.artifact.url) ? '<a class="artifact-link" href="' + soy.$$escapeHtml(opt_data.artifact.url) + '">' + soy.$$escapeHtml(opt_data.artifact.name) + '</a>' : soy.$$escapeHtml(opt_data.artifact.name) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/deployment/devstatus-detail-dialog-deployment.soy' */
// This file was automatically generated from devstatus-detail-dialog-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Deployment == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Deployment = {}; }


JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.deploymentProjects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent({project: projectData3, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-deployments-container">');
  JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table deployments-table"><table class="aui"><thead><tr><th class="environment">', soy.$$escapeHtml("Environment"), '</th><th class="status cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="release cell-type-collapsed">', soy.$$escapeHtml("Latest release"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Last deployed"), '</th></tr></thead><tbody>');
  var environmentList20 = opt_data.project.environments;
  var environmentListLen20 = environmentList20.length;
  for (var environmentIndex20 = 0; environmentIndex20 < environmentListLen20; environmentIndex20++) {
    var environmentData20 = environmentList20[environmentIndex20];
    output.append('<tr class="environment-row"><td class="environment">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName({environment: environmentData20}, output);
    output.append('</td><td class="status cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge({environment: environmentData20}, output);
    output.append('</td><td class="release">');
    if (environmentData20.deployedVersion) {
      JIRA.Templates.DevStatus.DetailDialog.Deployment.release({release: environmentData20.deployedVersion}, output);
    }
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: environmentData20.lastDeployed}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="deployments-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', (opt_data.project.description) ? soy.$$escapeHtml(opt_data.project.description) : soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2><div class="ellipsis"><strong class="commit-info">', soy.$$escapeHtml(AJS.format("Commits were in release {0}",opt_data.project.latestVersions[0].name)), '</strong></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="environment-link" href="', soy.$$escapeHtml(opt_data.environment.url), '" title="', (opt_data.environment.description) ? soy.$$escapeHtml(opt_data.environment.description) : soy.$$escapeHtml(opt_data.environment.name), '">', soy.$$escapeHtml(opt_data.environment.name), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment.status == 'DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-success">' + soy.$$escapeHtml("Deployed") + '</span>' : (opt_data.environment.status == 'FAILED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-error">' + soy.$$escapeHtml("Failed") + '</span>' : (opt_data.environment.status == 'NOT_DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle">' + soy.$$escapeHtml("Not deployed") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.release = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.release.url) ? '<a class="release-link" href="' + soy.$$escapeHtml(opt_data.release.url) + '" title="' + soy.$$escapeHtml(opt_data.release.name) + '">' + soy.$$escapeHtml(opt_data.release.name) + '</a>' : soy.$$escapeHtml(opt_data.release.name));
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-commit.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.commit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.canCreateReview) ? '<div class="aui-group aui-group-split"><div class="aui-item"></div><div class="aui-item"><div class="create-review-instance"><a href="#">' + soy.$$escapeHtml("Create review for all commits") + '</a></div></div></div>' : '');
  var repoList8 = opt_data.repositories;
  var repoListLen8 = repoList8.length;
  for (var repoIndex8 = 0; repoIndex8 < repoListLen8; repoIndex8++) {
    var repoData8 = repoList8[repoIndex8];
    JIRA.Templates.DevStatus.DetailDialog.commitContent(soy.$$augmentData(opt_data, {repository: repoData8, repositoryIndex: repoIndex8}), output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commitContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-commits-container', (opt_data.repository.showReviews) ? ' has-reviews' : '', (opt_data.repository.showBranches) ? ' has-branches' : '', (opt_data.repository.showFiles) ? ' has-files' : '', ' ', (opt_data.repository.showCreateReview) ? 'has-actions' : '', '" data-repository-index="', soy.$$escapeHtml(opt_data.repositoryIndex), '" >');
  JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {showParent: true, extraProjectInfo: (opt_data.repository.showInstance && opt_data.repository.instance) ? '<div class="repository-instance" title="' + soy.$$escapeHtml(opt_data.repository.instance.name) + '">(' + soy.$$escapeHtml(opt_data.repository.instance.name) + ')</div>' : '', extraContent: (opt_data.repository.showFiles) ? '<div class="file-expand"><a href="#">' + soy.$$escapeHtml("Show all files") + '</a></div>' : ''}), output);
  output.append('<div class="devstatus-detail-table commits-table"><table class="aui"><thead><tr><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="changeset cell-type-collapsed">', soy.$$escapeHtml("Commit"), '</th><th class="message">', soy.$$escapeHtml("Message"), '</th>', (opt_data.repository.showBranches) ? '<th class="branches"></th>' : '', (opt_data.repository.showReviews) ? '<th class="reviews">' + soy.$$escapeHtml("Reviews") + '</th>' : '', '<th class="timestamp">', soy.$$escapeHtml("Date"), '</th>', (opt_data.repository.showFiles) ? '<th class="filecount">' + soy.$$escapeHtml("Files") + '</th>' : '', (opt_data.repository.showCreateReview) ? '<th class="commit-actions">' + soy.$$escapeHtml("Actions") + '</th>' : '', '</tr></thead><tbody>');
  var commitList76 = opt_data.repository.commits;
  var commitListLen76 = commitList76.length;
  for (var commitIndex76 = 0; commitIndex76 < commitListLen76; commitIndex76++) {
    var commitData76 = commitList76[commitIndex76];
    output.append('<tr data-changesetid="', soy.$$escapeHtml(commitData76.id), '" class="commitrow', (commitData76.merge) ? ' merge' : '', '" data-commit-index="', soy.$$escapeHtml(commitIndex76), '"><td class="author">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(commitData76.author, output);
    output.append('</td><td class="changeset"><a class="changesetid" href="', soy.$$escapeHtml(commitData76.url), '">', soy.$$escapeHtml(commitData76.displayId), '</a>');
    if (commitData76.merge) {
      JIRA.Templates.DevStatus.DetailDialog.mergeLozenge(null, output);
    }
    output.append('</td><td class="message"><span class="ellipsis" title="', soy.$$escapeHtml(commitData76.message), '">', soy.$$truncate(soy.$$escapeHtml(commitData76.message), 500, true), '</span></td>');
    JIRA.Templates.DevStatus.DetailDialog.branchesColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    JIRA.Templates.DevStatus.DetailDialog.reviewColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    output.append('<td class="timestamp"><time class="livestamp" datetime="', soy.$$escapeHtml(commitData76.authorTimestamp), '" data-datetime-format="longAge"> ', soy.$$escapeHtml(commitData76.authorTimestamp), '</time></td>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesColumn({count: commitData76.fileCount}, output);
    }
    if (opt_data.repository.showCreateReview) {
      JIRA.Templates.DevStatus.DetailDialog.actionsColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    }
    output.append('</tr>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesRow(soy.$$augmentData(opt_data, {repository: opt_data.repository, commit: commitData76}), output);
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.mergeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge merge" title="', soy.$$escapeHtml("This commit is a merge"), '">', soy.$$escapeHtml("M"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.repository.showBranches) ? '<td class="branches">' + ((opt_data.commit.branches && opt_data.commit.branches.totalCount > 0) ? '<span class="branches-link aui-lozenge ref-lozenge"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">Branch</span></button>' + ((opt_data.commit.branches.totalCount > 1) ? '<span class="branch-count">' + soy.$$escapeHtml(opt_data.commit.branches.totalCount) + '</span>' : '') + '</span>' : '') + '</td>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="branch-tooltip">');
  var branchList148 = opt_data.branchData.branches;
  var branchListLen148 = branchList148.length;
  for (var branchIndex148 = 0; branchIndex148 < branchListLen148; branchIndex148++) {
    var branchData148 = branchList148[branchIndex148];
    output.append('<div class="branch-name-tooltip">', soy.$$escapeHtml(branchData148.name), '</div>');
  }
  output.append((opt_data.branchData.totalCount > opt_data.branchData.branches.length) ? '<div class="branch-tooltip-summary">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.branchData.totalCount - opt_data.branchData.branches.length)) + '</div>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.repository.showReviews) {
    output.append('<td class="reviews">');
    if (opt_data.commit.reviews && opt_data.commit.reviews.totalCount > 0) {
      output.append('<a class="reviews-link">');
      JIRA.Templates.DevStatus.Review.reviewLozenge({state: opt_data.commit.reviews.reviews[0].state, isSubtle: true}, output);
      output.append('</a>');
    }
    output.append('</td>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.actionsColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="commit-actions">', (opt_data.commit.createReviewUrl) ? '<div class="create-review-commit"><a href="' + soy.$$escapeHtml(opt_data.commit.createReviewUrl) + '">' + soy.$$escapeHtml("Create review") + '</a></div>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="filecount">', (opt_data.count > 0) ? '<a href="#" class="extra-content-in-title" title="' + soy.$$escapeHtml("Click to show files") + '">' + ((opt_data.count < 100) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#file|1\x3cfiles}",opt_data.count)) : soy.$$escapeHtml(AJS.format("{0}+ files",100))) + '</a>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="hidden ', soy.$$escapeHtml(opt_data.commit.fileCount > 0 && opt_data.commit.files ? 'filerow' : ''), '"><td colspan="5">');
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow({files: opt_data.commit.files, max: 5}, output);
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles({files: opt_data.commit.files, fileCount: opt_data.commit.fileCount, instanceName: opt_data.repository.name, moreUrl: opt_data.commit.url}, output);
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table><tbody>');
  var reviewList210 = opt_data.reviewData.reviews;
  var reviewListLen210 = reviewList210.length;
  for (var reviewIndex210 = 0; reviewIndex210 < reviewListLen210; reviewIndex210++) {
    var reviewData210 = reviewList210[reviewIndex210];
    output.append('<tr class="inline-review-row"><td class="inline-review-id"><a href="', soy.$$escapeHtml(reviewData210.url), '">', soy.$$escapeHtml(reviewData210.id), '</a></td><td class="inline-review-state">');
    JIRA.Templates.DevStatus.Review.reviewLozenge({state: reviewData210.state, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append((opt_data.reviewData.totalCount > opt_data.reviewData.reviews.length) ? '<tr><td class="inline-review-summary" colspan="2"><a href="' + soy.$$escapeHtml(opt_data.reviewData.url) + '">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.reviewData.totalCount - opt_data.reviewData.reviews.length)) + '</a></td></tr>' : '', '</tbody></table>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/commit/devstatus-detail-dialog-commit-files.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit-files.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit.Files == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit.Files = {}; }


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var fileList3 = opt_data.files;
  var fileListLen3 = fileList3.length;
  for (var fileIndex3 = 0; fileIndex3 < fileListLen3; fileIndex3++) {
    var fileData3 = fileList3[fileIndex3];
    if (fileIndex3 < opt_data.max) {
      output.append('<div class="file"><div class="change">');
      if (fileData3.linesAdded != null && fileData3.linesRemoved != null) {
        output.append('<div class="lines">', (fileData3.changeType == 'ADDED') ? '<span class="aui-lozenge added">' + soy.$$escapeHtml("Added") + '</span>' : (fileData3.changeType == 'DELETED') ? '<span class="aui-lozenge removed">' + soy.$$escapeHtml("Deleted") + '</span>' : '<span class="aui-lozenge added count">+' + soy.$$escapeHtml(fileData3.linesAdded) + '</span><span class="aui-lozenge removed count">-' + soy.$$escapeHtml(fileData3.linesRemoved) + '</span>', '</div>');
      } else {
        output.append('<div class="changetype">');
        JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge({changeType: fileData3.changeType}, output);
        output.append('</div>');
      }
      output.append('</div><div class="filename ellipsis"><a href="', soy.$$escapeHtml(fileData3.url), '" title="', soy.$$escapeHtml(fileData3.path), '">', soy.$$escapeHtml(fileData3.path), '</a></div></div>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.files.length < opt_data.fileCount) ? '<a href="' + soy.$$escapeHtml(opt_data.moreUrl) + '">' + soy.$$escapeHtml(AJS.format("See more files in {0}",opt_data.instanceName)) + '</a>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var text__soy48 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      text__soy48.append(soy.$$escapeHtml("Added"));
      break;
    case 'COPIED':
      text__soy48.append(soy.$$escapeHtml("Copied"));
      break;
    case 'DELETED':
      text__soy48.append(soy.$$escapeHtml("Deleted"));
      break;
    case 'MOVED':
      text__soy48.append(soy.$$escapeHtml("Moved"));
      break;
    default:
      text__soy48.append(soy.$$escapeHtml("Modified"));
  }
  text__soy48 = text__soy48.toString();
  var class__soy60 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      class__soy60.append('success');
      break;
    case 'COPIED':
      class__soy60.append('current');
      break;
    case 'DELETED':
      class__soy60.append('error');
      break;
    case 'MOVED':
      class__soy60.append('moved');
      break;
    default:
      class__soy60.append('complete');
  }
  class__soy60 = class__soy60.toString();
  output.append('<span class="aui-lozenge aui-lozenge-', soy.$$escapeHtml(class__soy60), ' aui-lozenge-subtle">', soy.$$escapeHtml(text__soy48), '</span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-branch-pullrequest.soy' */
// This file was automatically generated from devstatus-detail-dialog-branch-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.pullRequest = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-pullrequests-container"><div class="devstatus-detail-table pullrequests-table"><table class="aui"><thead><tr><th class="pullrequest-id">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state">', soy.$$escapeHtml("Status"), '</th><th class="author">', soy.$$escapeHtml("Author"), '</th><th class="reviewer">', soy.$$escapeHtml("Reviewer"), '</th><th class="comment cell-type-collapsed"></th><th class="last-updated">', soy.$$escapeHtml("Updated"), '</th></tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var pullRequestList19 = opt_data.pullRequests;
  var pullRequestListLen19 = pullRequestList19.length;
  for (var pullRequestIndex19 = 0; pullRequestIndex19 < pullRequestListLen19; pullRequestIndex19++) {
    var pullRequestData19 = pullRequestList19[pullRequestIndex19];
    output.append('<tr class="pullrequest-row"><td class="pullrequest-id"><a class="pullrequest-link" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.id), '</a></td><td class="title"><a class="pullrequest-link ellipsis" title="', soy.$$escapeHtml(pullRequestData19.name), '" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.name), '</a></td><td class="state">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData19.status, isSubtle: true}, output);
    output.append('</td><td class="author"><img class="author-avatar extra-content-in-title" src="', soy.$$escapeHtml(pullRequestData19.author.avatar), '" title="', soy.$$escapeHtml(pullRequestData19.author.name), '"/></td><td class="reviewer">');
    if (pullRequestData19.reviewers && pullRequestData19.reviewers.length != 0) {
      JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(pullRequestData19, {countThreshold: opt_data.reviewersThreshold}), output);
    }
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: pullRequestData19}, output);
    output.append('</td><td class="last-updated"><time class="livestamp" data-datetime-format="longAge" datetime="', soy.$$escapeHtml(pullRequestData19.lastUpdate), '">', soy.$$escapeHtml(pullRequestData19.lastUpdate), '</time></td></tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commentCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.pullRequest.commentCount) ? '<div class="comment-container"><a class="comment-link" href="' + soy.$$escapeHtml(opt_data.pullRequest.url) + '" title="' + soy.$$escapeHtml("Comments") + '"><span class="aui-icon aui-icon-small aui-iconfont-comment">Comments</span></a><span class="count">' + soy.$$escapeHtml(opt_data.pullRequest.commentCount) + '</span></div>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewersList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer-container">');
  var showThreshold__soy64 = opt_data.countThreshold + 1;
  var indexLimit65 = Math.min(opt_data.countThreshold, opt_data.reviewers.length);
  for (var index65 = 0; index65 < indexLimit65; index65++) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[index65], output);
  }
  if (opt_data.reviewers.length == showThreshold__soy64) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[opt_data.countThreshold], output);
  } else if (opt_data.reviewers.length > showThreshold__soy64) {
    output.append('<span class="aui-badge extrareviewers-tooltip reviewers-link" data-reviewers="', soy.$$escapeHtml(opt_data.extraReviewers), '">', soy.$$escapeHtml(opt_data.reviewers.length - opt_data.countThreshold), '</span>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-branches-container"><div class="devstatus-detail-table branches-table"><table class="aui"><thead><tr><th class="repository">', soy.$$escapeHtml("Repository"), '</th><th class="branch">', soy.$$escapeHtml("Branch"), '</th>', (opt_data.features.pullRequests) ? '<th class="pullrequest">' + soy.$$escapeHtml("Pull request") + '</th><th class="action">' + soy.$$escapeHtml("Action") + '</th>' : '', (opt_data.features.lastCommitId) ? '<th class="changeset cell-type-collapsed">' + soy.$$escapeHtml("Last commit") + '</th>' : '', (opt_data.features.lastCommitTimestamp) ? '<th class="last-updated cell-type-collapsed">' + soy.$$escapeHtml("Last modified") + '</th>' : '', '</tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.branchEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var branchList105 = opt_data.branches;
  var branchListLen105 = branchList105.length;
  for (var branchIndex105 = 0; branchIndex105 < branchListLen105; branchIndex105++) {
    var branchData105 = branchList105[branchIndex105];
    output.append('<tr class="branch-row"><td class="repository">');
    JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {repository: branchData105.repository, showTooltip: true}), output);
    output.append('</td><td class="branch">');
    JIRA.Templates.DevStatus.DetailDialog.branchLozenge(branchData105, output);
    output.append('</td>');
    if (opt_data.features.pullRequests) {
      output.append('<td class="pullrequest">');
      JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch(branchData105.pullRequestState, output);
      output.append('</td><td class="action">', (branchData105.createPullRequestUrl && branchData105.createPullRequestUrl.length > 0) ? '<a class="create-pullrequest-link" href="' + soy.$$escapeHtml(branchData105.createPullRequestUrl) + '">' + soy.$$escapeHtml("Create pull request") + '</a>' : '', '</td>');
    }
    output.append((opt_data.features.lastCommitId) ? '<td class="changeset cell-type-collapsed">' + ((branchData105.lastCommit && branchData105.lastCommit.displayId && branchData105.lastCommit.url) ? '<a class="changeset-link changesetid" href="' + soy.$$escapeHtml(branchData105.lastCommit.url) + '">' + soy.$$escapeHtml(branchData105.lastCommit.displayId) + '</a>' : '') + '</td>' : '');
    if (opt_data.features.lastCommitTimestamp) {
      output.append('<td class="last-updated cell-type-collapsed">');
      if (branchData105.lastCommit && branchData105.lastCommit.authorTimestamp) {
        JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: branchData105.lastCommit.authorTimestamp}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.total > 0) {
    output.append('<a href="#" class="pullrequest-tooltip pullrequest-link pullrequest-status" data-detail="', soy.$$escapeHtml(opt_data.data), '">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: opt_data.status, isSubtle: true}, output);
    output.append('</a>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="pullrequest-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '" href="', soy.$$escapeHtml(opt_data.url), '" ><span>', soy.$$escapeHtml(opt_data.id), ' ', soy.$$escapeHtml(opt_data.name), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer"><div class="reviewer-container"><table class="aui"><tbody>');
  var reviewerList172 = opt_data.reviewers;
  var reviewerListLen172 = reviewerList172.length;
  for (var reviewerIndex172 = 0; reviewerIndex172 < reviewerListLen172; reviewerIndex172++) {
    var reviewerData172 = reviewerList172[reviewerIndex172];
    output.append('<tr><td class="reviewer-avatar">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewerData172, output);
    output.append('</td><td class="reviewer-name"><span title="', soy.$$escapeHtml(reviewerData172.name), '">', soy.$$escapeHtml(reviewerData172.name), '</span></td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="aui"><tbody>');
  var pullRequestList184 = opt_data.pullRequests;
  var pullRequestListLen184 = pullRequestList184.length;
  for (var pullRequestIndex184 = 0; pullRequestIndex184 < pullRequestListLen184; pullRequestIndex184++) {
    var pullRequestData184 = pullRequestList184[pullRequestIndex184];
    output.append('<tr><td class="pullrequest-name">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle(pullRequestData184, output);
    output.append('</td><td class="lozenge">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData184.status, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.PullRequest.state({state: opt_data.status, isSubtle: opt_data.isSubtle}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="branch-name"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small"></span><a class="branch-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', (! opt_data.url) ? ' null-link' : '', '" ', (opt_data.url) ? 'href="' + soy.$$escapeHtml(opt_data.url) + '"' : '', ' title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-review.soy' */
// This file was automatically generated from devstatus-detail-dialog-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.review = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="devstatus-detail-table detail-reviews-container"><div class="devstatus-detail-table reviews-table"><table class="aui"><thead><tr><th class="review cell-type-collapsed">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="reviewer cell-type-collapsed">', soy.$$escapeHtml("Reviewers"), '</th><th class="comment cell-type-collapsed"></th><th class="timestamp">', soy.$$escapeHtml("Date"), '</th></tr></thead><tbody>');
  var reviewList16 = opt_data.reviews;
  var reviewListLen16 = reviewList16.length;
  for (var reviewIndex16 = 0; reviewIndex16 < reviewListLen16; reviewIndex16++) {
    var reviewData16 = reviewList16[reviewIndex16];
    output.append('<tr data-id="', soy.$$escapeHtml(reviewData16.id), '"><td class="review"><a href="', soy.$$escapeHtml(reviewData16.url), '" class="review-link">', soy.$$escapeHtml(reviewData16.id), '</a></td><td class="title"><span class="ellipsis" title="', soy.$$escapeHtml(reviewData16.title), '">', soy.$$escapeHtml(reviewData16.title), '</span></td><td class="state">');
    JIRA.Templates.DevStatus.Review.reviewLozenge({state: reviewData16.state, isSubtle: true}, output);
    output.append('</td><td class="author">');
    if (reviewData16.author) {
      JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewData16.author, output);
    }
    output.append('</td><td class="reviewer">');
    JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(reviewData16, {countThreshold: opt_data.reviewersThreshold, extraReviewers: reviewData16.extraReviewers}), output);
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: {'commentCount': reviewData16.commentCount, 'url': reviewData16.url}}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(reviewData16, {lastUpdated: reviewData16.lastModified, datetimeFormat: 'longAge', showUpdatedText: false}), output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/util/DevStatusNavigation.js' */
if(!JIRA.DevStatus){AJS.namespace("JIRA.DevStatus")}JIRA.DevStatus.Navigate={getUrl:function(){return window.location.href},reload:function(){_.defer(function(){window.location.reload()})},navigate:function(a){_.defer(function(){window.location=a})},redirectToLogin:function(){this.navigate(AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(window.location.href))}};
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusInit.js' */
(function(){JIRA.DevStatus.setDetailDialogParam=function(){AJS.Meta.set("fusion-open-detail-dialog",JIRA.DevStatus.URL.getDetailDialogParam())};JIRA.DevStatus.setDetailDialogParam()})();AJS.$(function(){JIRA.DevStatus.showTooltip=true;var d={devStatusContainer:"#devstatus-container",parentContainer:"[id$='devstatus-panel']",link:"a.devstatus-cta-link",statusPanel:".status-panels",viewIssueHeader:".mod-header",agileHeader:".ghx-header",agileNavMenuLink:'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-development-integration-plugin-greenhopper-devstatus-panel"]'};function e(g){return g.find("body").hasClass("page-type-dashboard")}function b(g){return g.find("body").hasClass("ghx-agile")}function c(g){return g.find("body").hasClass("ka ajax-issue-search-and-view")}function a(h,i,g){JIRA.DevStatus.devStatusModule.initializePanel({container:h,showTooltip:JIRA.DevStatus.showTooltip,headerSelector:i,devStatusPanelVisibilityToggler:g,phaseTwoDisabled:!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.phasetwo.enabled")})}function f(g,i,h,j){_.defer(function(){var k=h?1000:0;var l={duration:k,complete:j};if(i){g.slideDown(l)}else{g.slideUp(l)}})}JIRA.DevStatus.documentReadyInit=function(h){JIRA.DevStatus.devStatusModule=new JIRA.DevStatus.DevStatusModule({parentContainerSelector:d.parentContainer,linkSelector:d.link,panelSelector:d.devStatusContainer,statusPanelSelector:d.statusPanel});if(e(h)||b(h)){h.find("body").on("click",d.agileNavMenuLink,JIRA.DevStatus.Analytics.fireAgileDevStatusLinkClicked);JIRA.DevStatus.showTooltip=false}else{if(c(h)){if(JIRA.Issues.Api.isFullScreenIssueVisible()){var g=AJS.$(d.devStatusContainer);if(g.length>0){a(g,d.viewIssueHeader,f)}}}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(j,i){if(i.not(document).is(d.parentContainer)){a(i.find(d.devStatusContainer),d.viewIssueHeader,f);JIRA.DevStatus.showTooltip=false;return true}return false});JIRA.bind("GH.DetailView.updated",function(j,i){a(AJS.$(d.devStatusContainer),d.agileHeader)})};AJS.$(function(){JIRA.DevStatus.documentReadyInit(AJS.$(document))})});
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusModule.js' */
Backbone.define("JIRA.DevStatus.DevStatusModule",Backbone.Model.extend({initialize:function(a){_.defaults(this,a);this._listeners=new JIRA.DevStatus.Util.Listeners();this.createBranchFormDialog=new JIRA.DevStatus.CreateBranchFormDialog(a);this.devSummaryJson=null},initializePanel:function(a){this._listeners.stopListening();this._getContainers(a);this.labsOptIn=JIRA.DevStatus.Labs.LabsOptInModel.createFromDOM(this.parentContainer);a.showTooltip=a.showTooltip&&!(this.labsOptIn.isAllowed()&&!(this.labsOptIn.isOptedIn()||this.labsOptIn.isDismissed()));this._createCreateBranchView(a);this.devSummaryJson=this.devStatusContainer.find(".dev-summary.json-blob").data("json");this._initLabsOptInView();this._initTryLabsView();this._createDevStatusData(a);this._createAnalyticsModel(a);this._createSummaryViews(a);this._setupDataEventHandlers();this.devStatusPanelVisibilityToggler=a.devStatusPanelVisibilityToggler;if(!a.phaseTwoDisabled){this._startDevStatus()}else{this._postRender(false,true)}this.labsOptIn.on("change:optedIn",this._onChangeLabsOptIn,this);if(this.labsOptIn.isAllowed()&&this.labsOptIn.isOptedIn()){this._onChangeLabsOptIn(this.labsOptIn,true)}return this},_createCreateBranchView:function(a){this.createBranchView=new JIRA.DevStatus.CreateBranchView({el:this.createBranchContainer,showTooltip:a.showTooltip})},_createDevStatusData:function(a){this.devStatusData=new JIRA.DevStatus.DevStatusData({issueId:JIRA.Issue.getIssueId()})},_createSummaryViews:function(a){var c=this;var b=this.devStatusContainer.data();this._summaryModules=_.clone(this.statusPanelContainer.find(".status-panel").map(function(){var d=AJS.$(this);return new JIRA.DevStatus[d.data("module")]({dataAttrs:b,el:d,labsOptIn:c.labsOptIn,analyticsModel:c.analyticsModel})}));this._errorModule=new JIRA.DevStatus.SummaryErrorModule({el:this.messagePanelContainer,dataAttrs:b})},_createAnalyticsModel:function(a){this.analyticsModel=new JIRA.DevStatus.AnalyticsModel({devStatusContainer:this.devStatusContainer,devStatusData:this.devStatusData})},_getContainers:function(a){this.devStatusContainer=a.container;this.parentContainer=a.container.closest(this.parentContainerSelector);this.createBranchContainer=a.container.find(this.linkSelector);this.statusPanelContainer=a.container.find(this.statusPanelSelector);this.headerContainer=this.parentContainer.find(a.headerSelector);this.messagePanelContainer=a.container.find(".message-panel")},_onLoadingStarted:function(){this._startLoadingModuleData()},_onLoadingSuccess:function(b,a,c){this._renderModules({success:true,renderData:this.devStatusData.get("aggregatedData")});this._postRender(!a,c)},_onLoadingFailure:function(){this._renderModules({success:false,renderData:this.devSummaryJson?this.devSummaryJson.cachedValue:undefined});this._postRender(false,true)},_setupDataEventHandlers:function(){this._listeners.startListening(this.devStatusData,"beforeRequest",this._onLoadingStarted,this);this._listeners.startListening(this.devStatusData,"requestSuccess",this._onLoadingSuccess,this);this._listeners.startListening(this.devStatusData,"requestFail",this._onLoadingFailure,this)},_startDevStatus:function(){var a=!this.devSummaryJson||this.devSummaryJson.isStale===true;if(this.devSummaryJson){this.devStatusData.setAggregateData(this.devSummaryJson.cachedValue,true,!a)}if(a){this._startLoadingModuleData();this.devStatusData.retrieveAggregateData()}},_onChangeLabsOptIn:function(a,b){if(b===true){}else{}},_initLabsOptInView:function(){this.labsOptInView=new JIRA.DevStatus.Labs.LabsOptInView({el:this.parentContainer.find(".labs-on-off-container"),labsOptIn:this.labsOptIn}).render()},_initTryLabsView:function(){var a=AJS.$('<div class="try-labs-container"></div>').appendTo(this.headerContainer);new JIRA.DevStatus.Labs.TryLabsView({el:a,labsOptIn:this.labsOptIn}).render()},_postRender:function(g,f){var e=this._isAnySummaryViewVisibleOnPanel()||this._isAnyErrorViewVisible();if(e){var d=this.analyticsModel.getIssue();JIRA.DevStatus.SummaryAnalytics.fireSummaryShownEvent(d.isAssignee,d.issueType,d.issueStatus,this.analyticsModel.getSummary());this._openDetailDialogUrlLink()}this._togglePanelEmptyStatus(!this._isAnySummaryViewVisibleOnPanel(true));var a=this.parentContainer;function b(){if(f){a.addClass("js-animation-completed")}}var c=e||(this.createBranchContainer.size()>0);if(this.devStatusPanelVisibilityToggler&&(a.is(":visible")!==c)){this.devStatusPanelVisibilityToggler(this.parentContainer,c,g,b)}else{b()}},_getModuleByType:function(a){return _.find(this._summaryModules,function(b){return b.data&&b.data.getType&&_.isEqual(b.data.getType(),a)})},_openDetailDialogUrlLink:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a){var c;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(a)){c=this._getModuleByType("repository")}else{c=this._getModuleByType(a);if(c){AJS.Meta.set("fusion-open-detail-dialog",undefined)}}if(c){var b=c.view;if(b&&b.isVisible()){AJS.Meta.set("fusion-analytics-new-context-link",true);b.getSummaryLink().click()}}}},_togglePanelEmptyStatus:function(a){if(this.statusPanelContainer){this.statusPanelContainer.toggleClass("empty-status",a)}},_isAnySummaryViewVisibleOnPanel:function(){return !!_.find(this._summaryModules,function(a){return a.isViewVisible()})},_isAnyErrorViewVisible:function(){return this._errorModule.isViewVisible()},_renderModules:function(a){_.each(this._summaryModules,function(b){b.render(a.renderData)});this._errorModule.render(a.success?a.renderData:undefined)},_startLoadingModuleData:function(){_.each(this._summaryModules,function(a){a.startLoading()})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusData.js' */
Backbone.define("JIRA.DevStatus.DevStatusData",Backbone.Model.extend({properties:["aggregatedData"],namedEvents:["beforeRequest","requestFail","requestSuccess"],initialize:function(a){this.issueId=a.issueId},retrieveAggregateData:function(){var a=AJS.contextPath()+"/rest/dev-status/1.0/issue/summary?issueId="+this.issueId;this.trigger("beforeRequest");return AJS.$.ajax(a).done(_.bind(this.setAggregateData,this)).fail(_.bind(this.setAggregateDataError,this)).promise()},setAggregateData:function(b,a,c){this.set("aggregatedData",b);this.trigger("requestSuccess",this,a===true,!!c)},setAggregateDataError:function(b,a){this.set("aggregatedData",undefined);this.trigger("requestFail",this,b)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/analytics/AnalyticsModel.js' */
Backbone.define("JIRA.DevStatus.AnalyticsModel",Backbone.Model.extend({TO_ANALYTIC_KEY_OVERRIDE:{repository:"commit"},properties:["issue","summary"],initialize:function(a){this.devStatusContainer=a.devStatusContainer;this.devStatusData=a.devStatusData;this._getAllAnalyticData()},getIssue:function(){return this.get("issue")},getSummary:function(){return this.get("summary")},_getAllAnalyticData:function(){this.set("issue",this._getAnalyticIssueData());this._initListenerToData()},_getAnalyticIssueData:function(){return{isAssignee:this.devStatusContainer.data("is-assignee"),isAssignable:this.devStatusContainer.data("is-assignable"),issueStatus:this.devStatusContainer.data("issue-status"),issueType:this.devStatusContainer.data("issue-type")}},_getAnalyticSummaryData:function(c){var a=this;var b={};_.each(c.summary,function(e,d){b[a.TO_ANALYTIC_KEY_OVERRIDE[d]||d]=e.overall.count>0});return b},_initListenerToData:function(){var a=this;this.devStatusData.on("requestSuccess",function(){a.set("summary",a._getAnalyticSummaryData(a.devStatusData.get("aggregatedData")))})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/CreateBranchView.js' */
Backbone.define("JIRA.DevStatus.CreateBranchView",Backbone.View.extend({initialize:function(a){this.tooltipShown=!a.showTooltip;this.linkTextSelector=".devstatus-cta-link-text";this.issueContainer=".issue-container";this._processLinkForNavigableURL();this._initTooltip();_.defer(_.bind(this._openCreateBranchDialog,this))},getCreateBranchLink:function(){return this.$el},_processLinkForNavigableURL:function(){this.getCreateBranchLink().data("cta",this._getCta(this.$el));this.getCreateBranchLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam("create-branch"))},_openCreateBranchDialog:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a==="create-branch"){AJS.Meta.set("fusion-open-detail-dialog",undefined);AJS.Meta.set("fusion-analytics-new-context-link",true);this.getCreateBranchLink().click()}},_initTooltip:function(){if(!this.tooltipShown&&this.$el.length>0){_.defer(_.bind(function(){var a=this.$el.data("cta");if(a){new AJS.HelpTip({id:a+".tooltip",title:"Start development",bodyHtml:JIRA.Templates.DevStatus.Tooltip.createBranch(),anchor:this.$el.find(this.linkTextSelector),isSequence:true,inlineDialogOpts:{container:this.issueContainer}});this.tooltipShown=true;AJS.HelpTip.Manager.showSequences()}},this))}},_getCta:function(c){var b=c.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BasePanelModule.js' */
Backbone.define("JIRA.DevStatus.BasePanelModule",Backbone.Model.extend({initialize:function(a){this.options=_.defaults({},a);this.data=this.createModel()},render:function(a){this.startViews();this.data.updateData(a);this.view.render()},startLoading:function(){this.data.startLoadingData&&this.data.startLoadingData()},startViews:function(){if(!this.view){this.view=this.createView()}},stopViews:function(){if(this.view){this.view.undelegateEvents();this.view.$el.empty();this.view.hide();this.view=null}},isViewVisible:function(){return this.view&&this.view.isVisible()},createView:function(){},createModel:function(){}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryView.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryView",Backbone.View.extend({template:undefined,events:{"simpleClick .summary":"_onSummaryLinkClick"},initialize:function(a){this.options=_.clone(a);this.model.on("change:hasData",this._addOrRemoveHasDataClass,this);this.model.on("change:dataLoading",this._addOrRemoveDataLoadingClass,this);this.transitionView=new JIRA.DevStatus.SummaryTransitionView({model:this.model,el:this.$el})},render:function(){var b=this.isVisible();if(b){var a=AJS.$(this.template(_.extend({issueKey:JIRA.Issue.getIssueKey()},this.model.getOverall())));if(this._shouldAnimateDataTransition()){this.transitionView.renderVisible(a)}else{this.$el.html(a);JIRA.DevStatus.Date.addTooltip(a)}this._renderNavigableSummaryLink();this.show()}else{if(!this._isHidden()){if(this._shouldAnimateDataTransition()){this.transitionView.renderHidden(_.bind(this.hide,this))}else{this.hide()}}}this._addOrRemoveDataLoadingClass();this._addOrRemoveHasDataClass()},getDefaultDetailDialogParameters:function(){return{issueKey:JIRA.Issue.getIssueKey(),issueId:JIRA.Issue.getIssueId(),tabs:this.model.get("byInstanceType"),dataType:this.model.getType(),showContactAdminForm:this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm}},getSummaryLink:function(){return this.$el.find("a.summary")},isVisible:function(){return this.model.getOverall().count>0},_addOrRemoveHasDataClass:function(){var a=this.model.get("hasData");this.$el.toggleClass("js-has-data",a)},_renderNavigableSummaryLink:function(){this.getSummaryLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam(this.model.getType()))},_addOrRemoveDataLoadingClass:function(){var a=this.model.get("dataLoading");this.$el.toggleClass("data-loading",a)},_onSummaryLinkClick:function(a){a.preventDefault();console.log("Summary view not supported: ",this)},_shouldAnimateDataTransition:function(){return !!this.model.getPreviousOverall()},_isHidden:function(){return this.$el.hasClass("hidden")},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryTransitionView.js' */
Backbone.define("JIRA.DevStatus.SummaryTransitionView",Backbone.View.extend({slideTransitionTime:500,initialize:function(){},renderVisible:function(b){var a=!AJS.$.contains(document,this.$el[0]);if(this._hasPreviousData()){if(this._hasDataChanged()){this._prepareContentsForTransition(b,this.$el);this.$el.addClass("roll-transition")}}else{this._preStartSlideTransition();this.$el.addClass("slide-down-transition");a=true}this.$el.html(b);JIRA.DevStatus.Date.addTooltip(b);if(a){_.defer(_.bind(this._initiateTransition,this))}else{this._initiateTransition()}},renderHidden:function(b){var a=this;this.$el.slideUp(this.slideTransitionTime,function(){a.$el.css("display","");b()})},_initiateTransition:function(){if(this.$el.hasClass("slide-down-transition")){this._postStartSlideTransition();this.$el.removeClass("slide-down-transition");this._startSlideDownTransition(this.$el,0)}else{if(this.$el.hasClass("roll-transition")){this.$el.removeClass("roll-transition");this._startRollTransition()}var b=this.$el.find(".sliding-container");if(b.length>0){var a=this;b.each(function(d,c){var e=AJS.$(c);var f=e.data("prevHeight");a._startSlideDownTransition(e,f)})}}},_startSlideDownTransition:function(a,b){var c=a.height();if(b!==c){a.height(b).animate({height:c},this.slideTransitionTime,function(){a.css("height","auto");a.find(".rolling-content").removeClass("transit")})}},_startRollTransition:function(){this.$el.find(".rolling-container").each(_.bind(function(b,a){var f=AJS.$(a);var e=f.find(".rolling-content");var d=e.find(":not(.old-content)");var c=d.height();f.height(c);e.addClass("transit");d.css("margin-top","-"+c+"px").animate({"margin-top":"0"},this.slideTransitionTime,function(){f.css("height","auto");f.find(".old-content").remove();e.removeClass("transit");d.css("margin-top","")})},this))},_prepareContentsForTransition:function(b,d){b=AJS.$("<div></div>").append(b);var c=b.find(".sliding-container");var f=d.find(".sliding-container");c.each(function(h,i){var g=f.get(h);if(g){var j=AJS.$(g);AJS.$(i).data("prevHeight",j.height())}});var e=b.find(".rolling-container");var a=d.find(".rolling-container");e.each(function(i,j){var k=AJS.$(j).find(".rolling-content");var h=a.get(i);if(h){var g=AJS.$(h).find(".rolling-content").children();g.addClass("old-content");k.append(g)}})},_hasPreviousData:function(){var a=this.model.getPreviousOverall();return a&&a.count>0},_hasDataChanged:function(){return !_.isEqual(this.model.getOverall(),this.model.getPreviousOverall())},_preStartSlideTransition:function(){this.$el.css("height","0");this.$el.css("opacity","0")},_postStartSlideTransition:function(){this.$el.css("height","");this.$el.css("opacity","")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModule.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModule",JIRA.DevStatus.BasePanelModule.extend({model:undefined,viewType:undefined,createModel:function(){return new this.model({})},createView:function(){return new this.viewType(_.extend(_.clone(this.options),{model:this.data}))}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModel.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModel",Backbone.Model.extend({typeId:undefined,properties:["byInstanceType","overall","previousOverall","hasData","dataLoading"],startLoadingData:function(){this.set("dataLoading",true)},updateData:function(b){this.set("hasData",b!==undefined);this.set("dataLoading",false);this.set("previousOverall",this.getOverall());if(b&&b.summary&&b.summary[this.typeId]){var a=b.summary[this.typeId];this.set("byInstanceType",a.byInstanceType);this.set("overall",a.overall)}else{this.set("byInstanceType",{});this.set("overall",{count:0})}},getType:function(){return this.typeId},getOverall:function(){return this.get("overall")},getPreviousOverall:function(){return this.get("previousOverall")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInModel.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInModel",Backbone.Model.extend({defaults:{allowed:false,optedIn:false,optedInByAdmin:false,dismissed:false,id:1},isAllowed:function(){return this.get("allowed")},isOptedIn:function(){return this.get("optedIn")},isOptedInByAdmin:function(){return this.get("optedInByAdmin")},setOptedIn:function(a){return this.save({optedIn:a},{wait:true}).done(function(){JIRA.DevStatus.LabsAnalytics.fireLabsEvent(a)})},toggleOptedIn:function(a){var b=this.isOptedIn();return this.setOptedIn(!b)},setDismissed:function(a){return this.save({dismissed:a},{wait:true})},isDismissed:function(){return this.get("dismissed")},url:function(){return AJS.contextPath()+"/rest/dev-status/1.0/labs-opt-in/"}},{createFromDOM:function(b){var a=AJS.$(b).find("#devstatus-container");return new JIRA.DevStatus.Labs.LabsOptInModel(a.data("labs-json"))}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInView.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInView",Backbone.View.extend({events:{"click .toggle-labs":"_onClickToggle","click .labs-close":"_onClickDismiss","click .feedback-link":"_onClickFeedback"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change",this.render,this);this.labsOptIn.on("change:optedIn",this._onChangeOptedIn,this)},render:function(){var a=this.labsOptIn;if(a.isAllowed()&&(a.isOptedInByAdmin()||!a.isDismissed())){this._show()}else{this._hide()}return this},_onClickToggle:function(a){a.preventDefault();this.labsOptIn.toggleOptedIn()},_onClickDismiss:function(a){a.preventDefault();this.labsOptIn.setDismissed(true)},_onClickFeedback:function(a){a.preventDefault();this._showFeedbackDialog()},_onChangeOptedIn:function(b,a){if(a===false){this._showFeedbackDialog({summary:"How can Atlassian improve the development panel?"})}},_showFeedbackDialog:function(b){var a=new JIRA.DevStatus.FeedbackDialog(b);a.show()},_show:function(){this.$el.html(JIRA.Templates.DevStatus.labsOnOff({isOptedIn:this.labsOptIn.isOptedIn(),isOptedInByAdmin:this.labsOptIn.isOptedInByAdmin()}));this.$el.removeClass("hidden")},_hide:function(){this.$el.empty();this.$el.addClass("hidden")}},{COLLECTOR_ID:"effe8b72"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/TryLabsView.js' */
Backbone.define("JIRA.DevStatus.Labs.TryLabsView",Backbone.View.extend({events:{"click .try-labs":"_onClickTryLabs"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change:dismissed",this.render,this)},render:function(){if(!this.labsOptIn.isAllowed()||this.labsOptIn.isOptedIn()||!this.labsOptIn.isDismissed()){this.$el.empty()}else{this.$el.html(JIRA.Templates.DevStatus.tryLabs())}return this},_onClickTryLabs:function(a){a.preventDefault();this.labsOptIn.setDismissed(false)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModule.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModule",JIRA.DevStatus.BasePanelModule.extend({createModel:function(){return new JIRA.DevStatus.SummaryErrorModel({})},createView:function(){var a=this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm;return new JIRA.DevStatus.SummaryErrorView({model:this.data,el:this.options.el,showContactAdminForm:a})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModel.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModel",Backbone.Model.extend({properties:["hasErrors","errorInstances","configInstances"],defaults:function(){return{hasErrors:false,errorInstances:[],configInstances:[]}},updateData:function(b){var c=this._extractErrors(b&&b.errors);var a=this._extractErrors(b&&b.configErrors);this.set("hasErrors",!b||!_.isEmpty(c)||!_.isEmpty(a));this.set("errorInstances",c);this.set("configInstances",a)},_extractErrors:function(a){if(!a){return[]}return _.map(_.filter(a,function(b){return b.error}),function(b){return b.instance})}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorView.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorView",JIRA.DevStatus.BaseSummaryView.extend({initialize:function(a){this.showContactAdminForm=a.showContactAdminForm},render:function(){if(this.isVisible()){this.$el.html(JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon({instances:this.model.get("errorInstances"),notConfiguredInstances:this.model.get("configInstances"),showContactAdminForm:this.showContactAdminForm}));this.show()}else{this.hide()}return this},isVisible:function(){return this.model.get("hasErrors")}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateBranchFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateBranchFormDialog",Backbone.View.extend({initialize:function(a){AJS.namespace("JIRA.DevStatus.CtaDialog");this.parentContainerSelector=a.parentContainerSelector;this.panelSelector=a.panelSelector;this.linkSelector=a.linkSelector;this.dialogId="devstatus-cta-dialog";JIRA.DevStatus.CtaDialogAnalytics.initialize(this.parentContainerSelector,this.linkSelector,this.dialogId);this._initFormDialog()},_initFormDialog:function(){var a=this;var b=JIRA.DevStatus.CtaDialog.dialog=new JIRA.FormDialog({id:this.dialogId,width:560,content:function(c){this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:a._getCta(this.$activeTrigger)});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".target").eq(0).focus();JIRA.DevStatus.CtaDialogAnalytics.fireCreateBranchEvent("dialog.open")})},trigger:this.linkSelector,autoClose:true})},_getCta:function(d){var c=d.data("cta");if(c){return c}else{var b=d.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateReviewFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateReviewFormDialog",Backbone.View.extend({initialize:function(a){this.linkSelector=a.linkSelector;this.applicationType=a.applicationType;this.instances=a.instances;this.dialog.instance=this},renderSuccess:function(){AJS.$(".create-review-instance a").attr("href",JIRA.DevStatus.URL.getCreateReviewDetailUrl(this.applicationType))},_processTargets:function(b){var c=this,a=_.map(b,function(e){var d=_.find(c.instances,function(f){return f.baseUrl===e.baseUrl});if(!d){return null}return _.extend({},e,d)});return _.sortBy(_.filter(a,_.identity),"name")},dialog:new JIRA.FormDialog({id:"devstatus-cta-create-review-dialog",trigger:".create-review-instance a",width:560,content:function(c){var a=this.instance,b=this;this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:"devstatus.cta.createreview",processTargets:function(d){return b.instance._processTargets.call(b.instance,d)},uniqueResultAction:function(d){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true);JIRA.DevStatus.Navigate.navigate(d.url)}});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".primary.target").eq(0).focus();AJS.$(".target").click(function(f){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true)})})},autoClose:true})}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/InstancePickerView.js' */
Backbone.define("JIRA.DevStatus.InstancePickerView",Backbone.View.extend({ARROW_KEY_UP_CODE:38,ARROW_KEY_DOWN_CODE:40,template:JIRA.Templates.DevStatus.Dialog.content,events:{"keydown .jira-dialog-content":"_onTargetKeyboardSelect","focus .target":"_onTargetFocus"},initialize:function(a){this.currentSelected=null;this.link=a.activeTrigger;this.cta=a.cta;this.processTargets=a.processTargets;this.uniqueResultAction=a.uniqueResultAction||function(b){JIRA.DevStatus.Navigate.navigate(b.url)}},render:function(){var b=this._getIssueId(this.link),a=AJS.$.Deferred();this._fetchTargets(this.cta,b).done(_.bind(function(c){if(this.processTargets){c.remoteApps=this.processTargets(c.remoteApps)}var e=this._isUniqueResult(c);if(e){this.uniqueResultAction(e)}else{var d=AJS.$(this.template(c));a.resolve(d)}},this)).fail(function(c){a.resolve(c)});return a.promise()},_fetchTargets:function(b,c){var a=AJS.$.Deferred();AJS.$.ajax({url:contextPath+"/rest/dev-status/1.0/issue/targets?cta="+encodeURIComponent(b)+"&issueId="+encodeURIComponent(c)}).done(function(d){a.resolve(d)}).fail(function(e,d){a.reject(JIRA.SmartAjax.buildDialogErrorContent(e).html())});return a.promise()},_getIssueId:function(a){return(a&&a.data("issueid"))||JIRA.Issue.getIssueId()},_isUniqueResult:function(a){return a.remoteApps.length===1&&a.remoteApps[0]},_toggleEntry:function(d,b,a){var c=d.eq(b);a&&c.focus();c.addClass("selected");this.currentSelected=c},_removeSelected:function(){if(this.currentSelected){this.currentSelected.removeClass("selected");this.currentSelected=null}},_onTargetKeyboardSelect:function(d){if(d.type==="keydown"){var c=0;if(d.keyCode===this.ARROW_KEY_UP_CODE){c=-1}else{if(d.keyCode===this.ARROW_KEY_DOWN_CODE){c=1}}if(c!==0){d.preventDefault();var b=this.$el.find(".target");var a=b.index(this.$el.find(".selected"));if(a!==-1){b.eq((a+c)%b.size()).focus()}}}},_onTargetFocus:function(a){this._removeSelected();this._toggleEntry(AJS.$(a.target),0,false)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogView.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogView",Backbone.View.extend({frameEvents:{"click .menu-item":"_doTabClick"},frameTemplate:JIRA.Templates.DevStatus.DetailDialog.frame,oauthStatusTemplate:JIRA.Templates.DevStatus.DetailDialog.oauthStatus,authenticationTemplate:JIRA.Templates.DevStatus.DetailDialog.authenticationScreen,connectionProblemTemplate:JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen,connectionProblemWarningTemplate:JIRA.Templates.DevStatus.connectionProblemAsWarning,noPermissionToViewAllTemplate:JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll,initialize:function(a){this.options=_.defaults({},a,{width:560,model:new JIRA.DevStatus.BaseDetailDialogModel(a)});this.model=this.options.model;this._initFetchHandlers();this._initFormDialog()},renderSuccess:function(b,a){return this},shouldRefreshOnTabSwitch:function(a){return false},getTitle:function(b,a){console.warn("Unimplemented getTitle() function",this);return a},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more information by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related development information"},getConnectionMessageInCanvas:function(){return "Unable to retrieve development information"},getNoPermissionToViewAllMessageInCanvas:function(){return "Unable to retrieve development information"},getContactAdmistratorsOrLoginMessageInCanvas:function(){if(JIRA.Users.LoggedInUser.isAnonymous()){return "You might be able to view more by authenticating with JIRA."}else{return "Please contact your administrator."}},hasData:function(a){return a.length>0},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},_getPane:function(a){return a?this.$el.find("#tab-content-"+a.replace(/(:|\.|\[|\])/g,"\\$1")):AJS.$()},getContentContainer:function(a){return this._getPane(a||this._getActiveApplicationType()).find(".detail-content-container")},_doTabClick:function(b){b.preventDefault();var a=this._getActiveApplicationType();this.model.switchTab(a,this.shouldRefreshOnTabSwitch(a));this.analytics&&this.analytics.fireDetailTabClicked(a)},_redirectToLoginIf401:function(a){if(a&&a.status===401){JIRA.DevStatus.Navigate.redirectToLogin();return true}return false},_initFetchHandlers:function(){this.model.on("fetchRequested",this._showLoadingIndicator,this);this.model.on("fetchSucceeded",this._handleFetchSucceeded,this);this.model.on("fetchFailed",this._handleFetchFailed,this)},_handleFetchSucceeded:function(c,a){this._hideLoadingIndicator(c);var b=a.detail&&this.hasData(a.detail);if(b){this.renderSuccess(c,a.detail)}this._renderError(c,a.errors,b);this._postRender()},_handleFetchFailed:function(b,a){this._hideLoadingIndicator(b);if(!this._redirectToLoginIf401(a)){this._renderError(b,[],false,true)}},_initAuthenticationCallbacks:function(){this._patchAJSIconsForAppLinks();var a=this;var d=function(g,f){a.model.oauthStatusChanged(f.appType);a.model.fetchAuthenticationStatuses();g.preventDefault()};var c=function(g,f){AJS.$.ajax(AJS.contextPath()+"/rest/auth/1/session").promise().fail(function(e){a._redirectToLoginIf401(e)})};var b=AJS.$(document);b.bind("applinks.auth.approved",d);b.bind("applinks.auth.denied",c);AJS.$(this.dialog).bind("Dialog.beforeHide",function(){b.unbind("applinks.auth.approved",d);b.unbind("applinks.auth.denied",c);a.instanceListPopup&&a.instanceListPopup.remove()});AJS.$('<div class="applinks-auth-confirmation-container hidden"></div>').appendTo(this.$el)},_initFetchAuthenticationHandlers:function(){this.model.on("fetchAuthRequested",this._showLoadingIndicator,this);this.model.on("fetchAuthSucceeded",this._handleAuthSucceeded,this);this.model.on("fetchAuthFailed",this._handleAuthFailed,this)},_handleAuthSucceeded:function(b){var a=this;var d=_.filter(b,function(e){return e.configured&&!e.authenticated&&e.source&&e.source.applicationLinkId});var c=this._getOAuthStatusDiv();if(d.length>0&&!JIRA.Users.LoggedInUser.isAnonymous()){c.html(this.oauthStatusTemplate({message:this.getOAuthMessageInFooter(d)}));this._renderUnauthInstancesInFooter(d);c.show()}else{c.hide()}},_handleAuthFailed:function(a){this._redirectToLoginIf401(a);this._getOAuthStatusDiv().hide()},_renderUnauthInstancesInFooter:function(c){var b=this._getOAuthStatusDiv();var d=_.map(_.pluck(c,"source"),this._createOAuthInstanceDiv);if(d.length>0){b.append(d[0]);if(d.length>1){b.append(", ");b.append(d[1]);if(d.length>2){b.append(" ");var e=AJS.$('<span class="more-instances"><a href="#">'+"... more"+"</a></span>");b.append(e);var a=AJS.$('<ul class="instance-list"></ul>');_.each(d.slice(2),function(f){a.append(AJS.$('<li class="instance-in-popup"></li>').append(f))});AJS.InlineDialog(e,"instance-list-popup",function(g,f,h){g.html(a);h();return false},{width:150,offsetX:-100,onTop:true})}}}},_createOAuthInstanceDiv:function(a){var b=ApplinksUtils.createAuthRequestInline(null,{id:a.applicationLinkId,authUri:AJS.contextPath()+"/plugins/servlet/applinks/oauth/login-dance/authorize?applicationLinkID="+encodeURIComponent(a.applicationLinkId),appUri:a.baseUrl,appName:a.name,appType:a.type});return AJS.$('<span class="instance"></span>').append(b.find("a.applink-authenticate").text(a.name))},_patchAJSIconsForAppLinks:function(){AJS.icons=AJS.icons||{};AJS.icons.addIcon=AJS.icons.addIcon||{};AJS.icons.addIcon.init=AJS.icons.addIcon.init||function(){}},_getOAuthStatusDiv:function(){var a=this.$el.find(".buttons-container .oauth-status");if(a.length){return a}else{return AJS.$('<div class="oauth-status" />').appendTo(this.$el.find(".buttons-container.form-footer"))}},_renderError:function(f,g,d,c){var a=_.groupBy(g,function(h){var i=h.error;if(i==="unauthorized"||i==="incapable"){return i}else{return"others"}});var b=_.pluck(a.unauthorized,"instance");var e=_.pluck(a.others,"instance");if(b.length>0){this.model.fetchAuthenticationStatuses()}if(d){if(e.length>0){this._renderConnectionErrorBeforeData(f,e)}}else{if(b.length>0){this._renderAuthenticationError(f,b,e)}else{if(c||e.length>0){this._renderConnectionError(f,e)}else{this._renderNoPermissionToViewAllWarning(f)}}}},_renderConnectionErrorBeforeData:function(b,a){this.getContentContainer(b).prepend(this.connectionProblemWarningTemplate({instances:a,showContactAdminForm:this.options.showContactAdminForm}))},_renderConnectionError:function(b,a){this.getContentContainer(b).html(this.connectionProblemTemplate({instances:a,title:this.getConnectionMessageInCanvas(),showContactAdminForm:this.options.showContactAdminForm}))},renderNoPermissionToViewAllWarningAtBottom:function(c,d){var a=this.model.get("tabs")[c]||{};var b=this.model.get("contentMap")[c]||{};if(d<a.count){if((b.errors||[]).length===0||JIRA.Users.LoggedInUser.isAnonymous()){this.getContentContainer(c).append(this._getNoPermissionToViewAllHtml())}}},_getNoPermissionToViewAllHtml:function(){return this.noPermissionToViewAllTemplate({message:this.getNoPermissionToViewAllMessageInCanvas(),secondaryMessage:this.getContactAdmistratorsOrLoginMessageInCanvas()})},_renderNoPermissionToViewAllWarning:function(a){this.getContentContainer(a).html(this._getNoPermissionToViewAllHtml())},_renderAuthenticationError:function(f,c,e){var a=this.getContentContainer(f);a.html(this.authenticationTemplate({unauthInstances:c,title:this.getOAuthMessageInCanvas(),otherInstances:e,showContactAdminForm:this.options.showContactAdminForm}));var d=_.map(c,this._createOAuthInstanceDiv);var b=a.find(".instances");_.each(d,function(h,g){if(g!==0){b.append(", ")}b.append(h)})},_initFormDialog:function(){var a=this;this.dialog=new JIRA.FormDialog({id:this.options.id,width:this.options.width,content:function(b){a.setElement(this.$popup);a.delegateEvents(_.extend({},a.frameEvents,a.events));a._renderFrame();a._initAuthenticationCallbacks();a._initFetchAuthenticationHandlers();a.model.fetchAuthenticationStatuses();a.model.switchTab(a._getActiveApplicationType());b()},autoClose:true})},_postRender:function(){this.$el.find(".extra-content-in-title").tooltip();this.dialog._positionInCenter();this.$el.find(".active-pane a:eq(0)").focus()},_getActiveApplicationType:function(){return this.$el.find(".menu-item.active-tab").data("applicationType")},_showLoadingIndicator:function(c){var a=this._getPane(c);a._removeClass("ready");a.addClass("loading");var b=a.find(".status-loading");b.spin("large");b.show()},_hideLoadingIndicator:function(c){var a=this._getPane(c);a.addClass("ready");var b=a.find(".status-loading");if(b){a.removeClass("loading");b.hide();b.spinStop()}},_renderFrame:function(){this.$el.html(this.frameTemplate({title:this.getTitle(this.options.count,this.options.issueKey),tabs:this._convertTabsForSoy(),initialTab:this.options.initialTab}));if(this.options.height){this.$el.find(".form-body").css("min-height",this.options.height)}},_convertTabsForSoy:function(){return _.chain(this.model.get("tabs")).map(function(b,a){return _.extend({type:a},b)}).sortBy(function(a){return a.type}).value()},_createReviewersInlineDialog:function(){this.reviewerInlineDialogView=new JIRA.DevStatus.ReviewerInlineDialogView({el:this.$el.find(".extrareviewers-tooltip"),});return this.reviewerInlineDialogView},_removeInlineDialog:function(a){if(this[a]){this[a].hide();this[a].remove();this[a]=undefined}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogModel.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogModel",Backbone.Model.extend({TAB_PREFIX:"#tab-menu-",PANE_PREFIX:"#tab-content-",properties:["tabs","contentMap","oauthStatuses","selectedTab","selectedPane"],namedEvents:["fetchRequested","fetchFailed","fetchSucceeded","fetchAuthRequested","fetchAuthFailed","fetchAuthSucceeded"],initialize:function(a){this.issueKey=a.issueKey;this.issueId=a.issueId;this.type=a.dataType;this.set("contentMap",{});this.set("tabs",a.tabs)},switchTab:function(b,a){this.set("selectedTab",this.TAB_PREFIX+b);this.set("selectedPane",this.PANE_PREFIX+b);if(this.get("contentMap")[b]==null||a){this._fetchContents(b)}},_fetchContents:function(a){this.trigger("fetchRequested",a);this._handleFetch(a,AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/issue/detail",data:{issueId:this.issueId,applicationType:a,dataType:this.type}}).promise())},_handleFetch:function(c,b){var a=this;b.done(function(d){a._fireSuccessResult(c,d)}).fail(function(e,d){a._fireFailResult(c,e)})},_fireSuccessResult:function(b,a){this._updateContents(b,a);this.trigger("fetchSucceeded",b,a)},_fireFailResult:function(b,a){this._updateContents(b);this.trigger("fetchFailed",b,a)},_updateContents:function(b,a){this.get("contentMap")[b]=a},fetchAuthenticationStatuses:function(){var b=_.keys(this.get("tabs")||{});if(!_.isEmpty(b)){var a=this;AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/provider/auth-status",data:{applicationType:b}}).promise().done(function(c){if(c&&c.data){a._updateOAuthStatuses(c.data);a.trigger("fetchAuthSucceeded",c.data)}else{a._updateOAuthStatuses();a.trigger("fetchAuthFailed",null,c)}}).fail(function(d,c){a._updateOAuthStatuses();a.trigger("fetchAuthFailed",d)})}},oauthStatusChanged:function(b){if(_.has(this.get("tabs"),b)){var a=this._getCurrentApplicationType();if(a===b){this._fetchContents(a)}else{this.get("contentMap")[b]=null}}},_getCurrentApplicationType:function(){var a=this.get("selectedTab");if(a){return a.slice(this.TAB_PREFIX.length)}return null},_updateOAuthStatuses:function(a){this.set("oauthStatuses",a)}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/ReviewerInlineDialogView.js' */
Backbone.define("JIRA.DevStatus.ReviewerInlineDialogView",JIRA.DevStatus.BaseDetailDialogView.extend({extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{mouseenter:"_onHoverExtraReviewersToolTip",click:"_onClickExtraReviewersToolTip"},_onHoverExtraReviewersToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.target);var d="extrareviewers-tooltip";this.activeExtraReviewersToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.extraReviewersToolTipTemplate({reviewers:g.data("reviewers")}));a.activeExtraReviewersToolTip.$content=h;i()},{cacheContent:false,hideDelay:200,onHover:true,width:false})},_onClickExtraReviewersToolTip:function(a){if(this.activeExtraReviewersToolTip){a.stopPropagation()}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/build/DetailDialogBuildView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBuildView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.build,events:{"click a.project-link":"_onClickProjectLink","click a.plan-link":"_onClickPlanLink","click a.build-link":"_onClickBuildLink"},initialize:function(a){this.analytics=JIRA.DevStatus.BuildsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"build",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.projects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,projects:this.sortProjectsAndPlans(c),hasArtifacts:this.hasArtifacts(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getBuildCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#build|1\u003cbuilds}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more builds by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related builds"},getConnectionMessageInCanvas:function(){return "Unable to retrieve build information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related builds."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.projects||[])},[]).length>0},sortProjectsAndPlans:function(a){a=_.sortBy(a,function(b){return _.last(_.sortBy(b.plans,function(c){return c.build.finishedDate})).build.finishedDate}).reverse();_.each(a,function(b){b.plans=_.sortBy(b.plans,function(c){return c.build.finishedDate}).reverse()});return a},hasArtifacts:function(a){return _.any(a,function(b){return _.any(b.plans,function(c){return c.build&&c.build.artifacts&&c.build.artifacts.length})})},getBuildCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.plans,"key")})).length},_onClickProjectLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailProjectClicked()},_onClickPlanLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailPlanClicked()},_onClickBuildLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailBuildClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/deployment/DetailDialogDeploymentView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogDeploymentView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment,events:{"click a.project-link":"_onClickProjectLink","click a.environment-link":"_onClickEnvironmentLink","click a.release-link":"_onClickReleaseLink"},initialize:function(a){this.analytics=JIRA.DevStatus.DeploymentsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"deployment",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.deploymentProjects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,deploymentProjects:this.sortProjects(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getEnvironmentCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#deployment|1\u003cdeployments}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more deployments by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related deployments"},getConnectionMessageInCanvas:function(){return "Unable to retrieve deployment information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related deployments."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.deploymentProjects||[])},[]).length>0},sortProjects:function(a){return _.sortBy(a,function(b){return _.last(_.sortBy(b.environments,function(c){return new Date(c.lastDeployed||0).getTime()})).lastDeployed}).reverse()},getEnvironmentCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.environments,"environmentId")})).length},_onClickProjectLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailProjectClicked()},_onClickEnvironmentLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailEnvironmentClicked()},_onClickReleaseLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailReleaseClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogCommitView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogCommitView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.commit,events:{"click a.repository-link":"_onClickRepositoryLink","click a.changesetid":"_onClickChangesetId","click .filecount a":"_onClickFiles","click .file-expand a":"_onClickExpand","click .create-review-commit a":"_onClickCreateReview","click .filename a":"_onClickFile","mouseenter .reviews-link":"_onHoverReviewsToolTip",click:"_onClickReviewsToolTip"},initialize:function(a){this.analytics=JIRA.DevStatus.CommitsAnalytics;this.issueId=a.issueId;var c=AJS.Meta.get("fusion-open-detail-dialog");var b;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(c)){b=JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(c)}JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"commit",width:1000,height:400,initialTab:b},a))},concatResults:function(a){return _.reduce(a,function(b,d){var c=d.repositories||[];_.each(c,function(e){e.showInstance=d._instance&&!d._instance.singleInstance;e.instance=d._instance});return b.concat(c)},[])},_clipEllipsis:function(){function a(b){return b.outerWidth()}this.$el.find(".detail-content-container .file .ellipsis").each(function(b,f){var e=AJS.$(f);var c=a(e);if(c==0){return}var d=e.find("a");if(a(d)>c){var g=d.text();while(a(d)>c){g=g.slice(1);d.text("\u2026"+g)}}})},renderSuccess:function(e,a){var c=this.concatResults(a);var b=this.getContentContainer(e);this.transformedRepositories=this.transformRepositories(c);var d=this.setupCreateReviewDialog(this.transformedRepositories);b.html(this.template({applicationType:e,repositories:this.transformedRepositories,canCreateReview:d}));this.renderNoPermissionToViewAllWarningAtBottom(e,this.getUniqueCommitCount(c));JIRA.DevStatus.Date.addTooltip(b);this.setupBranchesTooltip();this.createReviewDialog&&this.createReviewDialog.renderSuccess();return this},setupCreateReviewDialog:function(a){var c=_.chain(a).filter(function(e){return e.showCreateReview}).pluck("instance").value();var d=false;if(c.length){this.createReviewDialog=new JIRA.DevStatus.CreateReviewFormDialog({analytics:this.analytics,applicationType:this._getActiveApplicationType(),issueId:this.issueId,instances:c});d=true}var b=AJS.Meta.get("fusion-open-detail-dialog");if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(b)&&JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(b)===this._getActiveApplicationType()){AJS.Meta.set("fusion-open-detail-dialog",undefined);if(d){this.createReviewDialog.dialog.show()}}return d},_onHoverReviewsToolTip:function(c){var a=this;c.preventDefault();var b=AJS.$(c.target);var d="commit-reviews-popup";this.activeReviewsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var g=a._getCommitDetails(AJS.$(f)).reviews;var e=AJS.$(f);JIRA.DevStatus.CommitsAnalytics.fireDetailReviewsShown(a._getActiveApplicationType());h.html(JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog({reviewData:g}));h.find("a").click(function(j){a._onClickReview(j)});i()},{cacheContent:false,hideDelay:200,showDelay:50,onHover:true,width:false})},_onClickReviewsToolTip:function(a){if(this.activeReviewsToolTip){a.stopPropagation()}},setupBranchesTooltip:function(){var a=this;AJS.$(".branches-link").tooltip({title:function(){var b=a._getCommitDetails(AJS.$(this)).branches;JIRA.DevStatus.CommitsAnalytics.fireDetailBranchesShown(a._getActiveApplicationType());return JIRA.Templates.DevStatus.DetailDialog.branchesTooltip({branchData:b})},html:true})},getTitle:function(d,b){var a=_.chain(this.model.get("tabs")).map(function(e){return e.count}).reduce(function(e,f){return e+f},0).value();var c=Math.max(a-d,0);return AJS.$.trim(AJS.format("{1}: {0} unique {0,choice,1#commit|1\u003ccommits}{2,choice,0# |0\u003c (and {2} duplicates)}",d,b,c))},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more commits by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related commits"},getConnectionMessageInCanvas:function(){return "Unable to retrieve commit information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related commits."},hasData:function(a){return this.concatResults(a).length>0},transformRepositories:function(b){b=this.sortRepositoriesAndCommits(b);var a=this;var c=[["reviews","showReviews"],["branches","showBranches"],["files","showFiles"],["createReviewUrl","showCreateReview"]];_.each(c,function(d){b=a._setRepositoryFromFromCommitField(b,d[0],d[1])});b=this.prepareReviews(b);return b},_setRepositoryFromFromCommitField:function(b,c,a){_.each(b,function(d){d[a]=_.find(d.commits,function(e){return e[c]!=null})!=null});return b},prepareReviews:function(b){var a=this;_.each(b,function(c){_.each(c.commits,a._orderCommitReviews)});return b},_orderCommitReviews:function(b){if(b.reviews&&b.reviews.reviews){var a=["REVIEW","APPROVAL","SUMMARIZE","REJECTED","CLOSED"];b.reviews.reviews=_.chain(b.reviews.reviews).filter(function(c){return _.contains(a,c.state)}).sortBy(function(c){return _.indexOf(a,c.state)}).value()}},sortRepositoriesAndCommits:function(a){a=_.sortBy(a,function(b){return b.name.toLowerCase()});_.each(a,function(b){b.commits=_.sortBy(b.commits,"authorTimestamp").reverse()});return a},getUniqueCommitCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.filter(_.pluck(b.commits,"id"),function(c){return c})})).length},_getRepoDetails:function(a){return this.transformedRepositories[parseInt(a.parents(".detail-commits-container").data("repository-index"))]},_getCommitDetails:function(a){return this._getRepoDetails(a).commits[parseInt(a.parents("tr").data("commit-index"))]},_onClickRepositoryLink:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickChangesetId:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailCommitClicked(this._getActiveApplicationType())},_onClickExpand:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target));if(a.toggle(a.getRows())){JIRA.DevStatus.CommitsAnalytics.fireDetailFilesExpandedClicked(this._getActiveApplicationType())}this._clipEllipsis()},_onClickFiles:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target)).toggle(AJS.$(b.target).closest(".commitrow").next(".filerow"));this._clipEllipsis();if(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileExpandedClicked(this._getActiveApplicationType())}},_onClickCreateReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(this._getActiveApplicationType(),false)},_onClickReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailReviewClicked(this._getActiveApplicationType())},_onClickFile:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileClicked(this._getActiveApplicationType())},_getFileExpand:function(a){var c=a.closest(".detail-commits-container");function b(d){return d.length>d.filter(".hidden").length}return{getRows:function(){return c.find(".filerow")},toggle:function(e){var d=b(e);e.toggleClass("hidden",d);this._updateExpandLabel();return !d},_updateExpandLabel:function(){c.find(".file-expand a").text(b(this.getRows())?"Hide files":"Show all files")}}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogBranchView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBranchView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.branch,pullRequestToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip,STATE_ORDER:["OPEN","MERGED","DECLINED"],events:{"click a.repository-link":"_onClickRepositoryLink","click a.branch-link":"_onClickBranchLink","click a.pullrequest-link":"_onClickPullRequestLink","click a.create-pullrequest-link":"_onClickCreatePullRequestLink","mouseenter .pullrequest-tooltip":"_onHoverPullRequestsToolTip","click .pullrequest-tooltip":"_onClickPullRequestsToolTip"},initialize:function(a){this.analyticIssueData=a.analyticIssueData||{};this.analytics=JIRA.DevStatus.BranchesAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({},a,{type:"branch",width:1000,height:400,dataType:"pullrequest"}))},renderSuccess:function(g,a){var c=this._sortBranchesByName(this._removeWithNoRepos(this._extractAllBranches(a)));var f=this._extractAllPullRequests(a);this._populatePullRequestStateByBranch(c,f);var d=this._getBranchFeatures(c);var e=this._getBranchCount(c);var b=this.getContentContainer(g);if(e>0){b.html(this.template({applicationType:g,branches:c,features:d,branchCount:e}));JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(g,e);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#branch|1\u003cbranches}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more branches by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related branches"},getConnectionMessageInCanvas:function(){return "Unable to retrieve branch information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related branches."},hasData:function(a){return this._removeWithNoRepos(this._extractAllBranches(a)).length>0},_extractAllBranches:function(a){return _.compact(_.flatten(_.pluck(a,"branches")))},_getBranchFeatures:function(a){return{pullRequests:_.find(a,function(b){return b.createPullRequestUrl||(b.pullRequestState&&b.pullRequestState.total)})!=null,lastCommitId:_.find(a,function(b){return b.lastCommit&&b.lastCommit.displayId})!=null,lastCommitTimestamp:_.find(a,function(b){return b.lastCommit&&b.lastCommit.authorTimestamp})!=null}},_removeWithNoRepos:function(a){return _.filter(a,function(b){return b.repository})},_extractAllPullRequests:function(a){return _.flatten(_.compact(_.pluck(a,"pullRequests")))},_sortBranchesByName:function(a){return _.sortBy(a,function(b){return b.repository.name+b.name})},_onClickRepositoryLink:function(){this.analytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickBranchLink:function(){this.analytics.fireDetailBranchClicked(this._getActiveApplicationType())},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestLozengeClick(this._getActiveApplicationType())},_onClickCreatePullRequestLink:function(){this.analytics.fireDetailCreatePullRequestClicked(this._getActiveApplicationType(),this.analyticIssueData.isAssignee,this.analyticIssueData.isAssignable)},_onHoverPullRequestsToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.target);var d="pullrequest-tooltip";this.activePullRequestsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.pullRequestToolTipTemplate({pullRequests:g.data("detail")}));a.activePullRequestsToolTip.$content=h;i()},{onHover:true,hideDelay:200,showDelay:50,offsetX:-200,cacheContent:false,width:400})},_onClickPullRequestsToolTip:function(a){if(this.activePullRequestsToolTip){a.stopPropagation()}},_getBranchCount:function(a){return a.length},_populatePullRequestStateByBranch:function(b,c){var a=this;_.each(b,function(d){var e=_.filter(c,function(f){return f.source.url===d.url});d.pullRequestState=a._summarisePullRequestState(e)});return b},_sortPullRequestsByStatus:function(a){return _.sortBy(a,function(b){return(b.status==="OPEN"?"2":(b.status==="MERGED"?"1":"0"))+b.lastUpdated}).reverse()},_getFirstStatusWithCount:function(a){return _.find(this.STATE_ORDER,function(b){return a[b]})},_summarisePullRequestState:function(a){var b=_.groupBy(a,function(c){return c.status});return{status:this._getFirstStatusWithCount(b),data:JSON.stringify(this._sortPullRequestsByStatus(a)),total:_.size(a)}}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogPullRequestView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogPullRequestView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.pullRequest,extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{"click a.pullrequest-link":"_onClickPullRequestLink"},initialize:function(a){this.analytics=JIRA.DevStatus.PullRequestsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"pullrequest",width:1000,height:400},a))},renderSuccess:function(f,a){var d=this._removeAuthorFromReviewers(this._extractAllPullRequests(a));var e=this._getSortedPullRequestsByDate(d);var c=_.size(e);var b=this.getContentContainer(f);if(c>0){b.html(this.template({pullRequests:e,pullRequestCount:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(f,c);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#pull request|1\u003cpull requests}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more pull requests by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related pull requests"},getConnectionMessageInCanvas:function(){return "Unable to retrieve pull request information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related pull requests."},hasData:function(a){return this._extractAllPullRequests(a).length>0},_extractAllPullRequests:function(a){return _.compact(_.flatten(_.pluck(a,"pullRequests")))},_removeAuthorFromReviewers:function(a){return _.map(a,function(d){if(d.reviewers&&d.author){var c=_.filter(d.reviewers,function(e){return e.name!=d.author.name});if(d.reviewers.length==c.length){return d}var b=_.clone(d);b.reviewers=c;return b}return d})},_sortReviewers:function(b){var a=this.options.reviewersThreshold;_.each(b,function(d,c){if(_.size(d.reviewers)>0){d.reviewers=_.sortBy(_.filter(d.reviewers,function(e){return e.name}),function(e){return e.approved?"0"+e.name:"1"+e.name});if(d.reviewers.length>a+1){d.extraReviewers=JSON.stringify(d.reviewers.slice(a))}}})},_getSortedPullRequestsByDate:function(a){this._sortReviewers(a);return _.sortBy(a,"lastUpdate").reverse()},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestClicked(this._getActiveApplicationType())}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/DetailDialogReviewView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogReviewView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.review,events:{"click a.review-link":"_onClickReviewLink","click a.comment-link":"_onClickReviewLink"},initialize:function(a){this.analytics=JIRA.DevStatus.ReviewsAnalytics;this.finalStates=["REJECTED","CLOSED"];this.nonFinalStates=["REVIEW","APPROVAL","SUMMARIZE"];this.validStates=_.union(this.finalStates,this.nonFinalStates);JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"review",width:1000,height:400},a))},_updateReviewers:function(a){a.reviewers=_.chain(a.reviewers).filter(function(b){if(b&&a.author&&a.author.name&&b.name){return !_.isEqual(b.name,a.author.name)}return true}).sortBy(function(b){return(b.complete?"0":"1")+b.name}).map(function(b){b.approved=b.complete;return b}).value();if(a.moderator&&!_.isEqual(a.moderator,a.author)){a.reviewers=[_.extend(a.moderator,{name:"Moderator:"+" "+a.moderator.name})].concat(a.reviewers)}return a},_updateReview:function(a){return function(b){if(b.state&&b.dueDate&&_.contains(a,b.state)){delete b.dueDate}if(b.dueDate&&moment(b.dueDate).isBefore(moment())){b.overDue=true}return b}},_addExtraReviewersJson:function(a){return function(b){if(b.reviewers){b.extraReviewers=JSON.stringify(b.reviewers.slice(a))}return b}},_reviewCompare:function(b,a){if(b.dueDate&&!a.dueDate){return -1}else{if(!b.dueDate&&a.dueDate){return 1}else{if(b.dueDate&&a.dueDate){return b.dueDate.localeCompare(a.dueDate)}else{if(b.lastModified&&a.lastModified){return a.lastModified.localeCompare(b.lastModified)}}}}return 0},_mergeInstanceData:function(a,b){return a.concat(b.reviews||[])},_prepareReviews:function(b){var a=this;return _.chain(b).reduce(this._mergeInstanceData,[]).filter(function(c){c.state=c.state&&c.state.toUpperCase();return _.contains(a.validStates,c.state)}).map(_.compose(this._addExtraReviewersJson(this.options.reviewersThreshold),this._updateReviewers,this._updateReview(this.finalStates))).sort(this._reviewCompare).value()},renderSuccess:function(d,a){var c=this._prepareReviews(a),b=this.getContentContainer(d);if(c.length>0){b.html(this.template({applicationType:d,reviews:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(d,c.length);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#review|1\u003creviews}",b,a)},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related reviews."},getOAuthMessageInCanvas:function(){return "Authenticate to see related reviews"},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more reviews by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getConnectionMessageInCanvas:function(){return "Unable to retrieve review information"},hasData:function(a){return _.flatten(_.pluck(a,"reviews"),true).length>0},_onClickReviewLink:function(){this.analytics.fireDetailReviewClicked()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModel.js' */
Backbone.define("JIRA.DevStatus.CommitModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"repository"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'templates/viewissue/commit/devstatus-panel-commit.soy' */
// This file was automatically generated from devstatus-panel-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Commit == 'undefined') { JIRA.Templates.DevStatus.Commit = {}; }


JIRA.Templates.DevStatus.Commit.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  JIRA.Templates.DevStatus.transitionContainer({content: '<div class="summary-content"><a class="summary" href="#" title="' + soy.$$escapeHtml(AJS.format("Commits related to {0}",opt_data.issueKey)) + '">' + AJS.format("{0}{1}{2} {1,choice,1#commit|1\x3ccommits}",'<span class="count">',opt_data.count,'</span>') + '</a></div>'}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitView.js' */
Backbone.define("JIRA.DevStatus.CommitView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Commit.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogCommitView=new JIRA.DevStatus.DetailDialogCommitView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-commit-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.CommitsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogCommitView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-commit-panel-resources', location = 'js/viewissue/summary/commit/CommitModule.js' */
Backbone.define("JIRA.DevStatus.CommitModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.CommitModel,viewType:JIRA.DevStatus.CommitView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModel.js' */
Backbone.define("JIRA.DevStatus.PullRequestModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"pullrequest"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'templates/viewissue/pullrequest/devstatus-panel-pullrequest.soy' */
// This file was automatically generated from devstatus-panel-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.PullRequest == 'undefined') { JIRA.Templates.DevStatus.PullRequest = {}; }


JIRA.Templates.DevStatus.PullRequest.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Pull requests related to {0}",opt_data.issueKey)), '">', AJS.format("{0}{1}{2} {1,choice,1#pull request|1\x3cpull requests}",'<span class="count">',opt_data.stateCount,'</span>'), '</a> ');
  JIRA.Templates.DevStatus.PullRequest.state(soy.$$augmentData(opt_data, {isSubtle: true}), param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.PullRequest.state = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.state == 'OPEN') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-complete pullrequest-state">' + soy.$$escapeHtml("OPEN") + '</span>' : (opt_data.state == 'MERGED') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-success pullrequest-state">' + soy.$$escapeHtml("MERGED") + '</span>' : (opt_data.state == 'DECLINED') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + ' aui-lozenge-error pullrequest-state">' + soy.$$escapeHtml("DECLINED") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestView.js' */
Backbone.define("JIRA.DevStatus.PullRequestView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.PullRequest.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogPullRequestView=new JIRA.DevStatus.DetailDialogPullRequestView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-pullrequest-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2}));JIRA.DevStatus.PullRequestsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogPullRequestView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-pullrequest-panel-resources', location = 'js/viewissue/summary/pullrequest/PullRequestModule.js' */
Backbone.define("JIRA.DevStatus.PullRequestModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.PullRequestModel,viewType:JIRA.DevStatus.PullRequestView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModel.js' */
Backbone.define("JIRA.DevStatus.ReviewModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"review"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'templates/viewissue/review/devstatus-panel-review.soy' */
// This file was automatically generated from devstatus-panel-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Review == 'undefined') { JIRA.Templates.DevStatus.Review = {}; }


JIRA.Templates.DevStatus.Review.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Reviews related to {0}",opt_data.issueKey)), '">', AJS.format("{0}{1}{2} {1,choice,1#review|1\x3creviews}",'<span class="count">',opt_data.stateCount,'</span>'), '</a> ');
  JIRA.Templates.DevStatus.Review.reviewLozenge({state: opt_data.state, isSubtle: true}, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(opt_data, {showUpdatedText: true}), output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Review.reviewDate = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.dueDate) {
    JIRA.Templates.DevStatus.lastUpdated({text: "Due", lastUpdated: opt_data.dueDate, extraClass: opt_data.overDue ? 'overdue' : undefined, datetimeFormat: 'fullAge'}, output);
  } else if (opt_data.lastUpdated) {
    JIRA.Templates.DevStatus.lastUpdated({text: opt_data.showUpdatedText ? "Updated" : '', lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Review.reviewLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.state == 'REVIEW') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-current ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Review") + '</span>' : (opt_data.state == 'CLOSED') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-success ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Closed") + '</span>' : (opt_data.state == 'DRAFT') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-complete ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Draft") + '</span>' : (opt_data.state == 'DEAD') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Abandoned") + '</span>' : (opt_data.state == 'REJECTED') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Rejected") + '</span>' : (opt_data.state == 'UNKNOWN') ? '<span class="aui-lozenge aui-lozenge-overflow aui-lozenge-error ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Unknown") + '</span>' : (opt_data.state == 'APPROVAL') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Approval") + '</span>' : (opt_data.state == 'SUMMARIZE') ? '<span class="aui-lozenge aui-lozenge-overflow ' + ((opt_data.isSubtle) ? 'aui-lozenge-subtle' : '') + '">' + soy.$$escapeHtml("Summarize") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewView.js' */
Backbone.define("JIRA.DevStatus.ReviewView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Review.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogReviewView=new JIRA.DevStatus.DetailDialogReviewView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-review-detail-dialog",count:this.model.getOverall().count,reviewersThreshold:2}));JIRA.DevStatus.ReviewsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogReviewView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-review-panel-resources', location = 'js/viewissue/summary/review/ReviewModule.js' */
Backbone.define("JIRA.DevStatus.ReviewModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.ReviewModel,viewType:JIRA.DevStatus.ReviewView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModel.js' */
Backbone.define("JIRA.DevStatus.BranchModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"branch"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'templates/viewissue/branch/devstatus-panel-branch.soy' */
// This file was automatically generated from devstatus-panel-branch.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Branches == 'undefined') { JIRA.Templates.DevStatus.Branches = {}; }


JIRA.Templates.DevStatus.Branches.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  JIRA.Templates.DevStatus.transitionContainer({content: '<div class="summary-content"><a class="summary" href="#" title="' + soy.$$escapeHtml(AJS.format("Branches related to {0}",opt_data.issueKey)) + '">' + AJS.format("{0}{1}{2} {1,choice,1#branch|1\x3cbranches}",'<span class="count">',opt_data.count,'</span>') + '</a></div>'}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Updated", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchView.js' */
Backbone.define("JIRA.DevStatus.BranchView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Branches.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBranchView=new JIRA.DevStatus.DetailDialogBranchView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-branch-detail-dialog",count:this.model.getOverall().count,analyticIssueData:this.options.analyticsModel.getIssue()}));JIRA.DevStatus.BranchesAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBranchView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-branch-panel-resources', location = 'js/viewissue/summary/branch/BranchModule.js' */
Backbone.define("JIRA.DevStatus.BranchModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BranchModel,viewType:JIRA.DevStatus.BranchView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModel.js' */
Backbone.define("JIRA.DevStatus.BuildModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"build"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'templates/viewissue/build/devstatus-panel-build.soy' */
// This file was automatically generated from devstatus-panel-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Build == 'undefined') { JIRA.Templates.DevStatus.Build = {}; }


JIRA.Templates.DevStatus.Build.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt>');
  var param4 = new soy.StringBuilder('<div class="summary-content"><a class="summary" href="#" title="', soy.$$escapeHtml(AJS.format("Builds related to {0}",opt_data.issueKey)), '">');
  var countText__soy8 = new soy.StringBuilder((opt_data.successfulBuildCount > 0) ? (opt_data.failedBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.failedBuildCount,'</span>') : (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",'<span class="count">',opt_data.successfulBuildCount,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",'<span class="count">',opt_data.count,'</span>') : (opt_data.failedBuildCount > 0) ? (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.failedBuildCount,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",'<span class="count">',opt_data.count,'</span>') : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} incomplete",'<span class="count">',opt_data.count,'</span>'));
  countText__soy8 = countText__soy8.toString();
  param4.append(countText__soy8, '</a> ');
  JIRA.Templates.DevStatus.Build.statusIcon(opt_data, param4);
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dt>');
  JIRA.Templates.DevStatus.lastUpdated({text: "Latest", lastUpdated: opt_data.lastUpdated, datetimeFormat: 'fullAge'}, output);
  output.append('</dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Build.statusIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy45 = new soy.StringBuilder((opt_data.failedBuildCount > 0) ? 'aui-iconfont-error' : (opt_data.successfulBuildCount > 0) ? 'aui-iconfont-approve' : (opt_data.unknownBuildCount > 0) ? 'aui-iconfont-devtools-task-cancelled' : '');
  iconClass__soy45 = iconClass__soy45.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy45), '">', soy.$$escapeHtml(opt_data.iconText), '</span>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildView.js' */
Backbone.define("JIRA.DevStatus.BuildView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Build.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogBuildView=new JIRA.DevStatus.DetailDialogBuildView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-build-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.BuildsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogBuildView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-build-panel-resources', location = 'js/viewissue/summary/build/BuildModule.js' */
Backbone.define("JIRA.DevStatus.BuildModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.BuildModel,viewType:JIRA.DevStatus.BuildView}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModel.js' */
Backbone.define("JIRA.DevStatus.DeploymentModel",JIRA.DevStatus.BaseSummaryModel.extend({typeId:"deployment-environment"}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'templates/viewissue/deployment/devstatus-panel-deployment.soy' */
// This file was automatically generated from devstatus-panel-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Deployment == 'undefined') { JIRA.Templates.DevStatus.Deployment = {}; }


JIRA.Templates.DevStatus.Deployment.summaryPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dd>');
  var param4 = new soy.StringBuilder('<div class="summary-content" title="', soy.$$escapeHtml(AJS.format("Deployments related to {0}",opt_data.issueKey)), '">');
  if (opt_data.topEnvironments.length) {
    var anchorStart__soy10 = '<a class="summary">';
    var anchorEnd__soy11 = '</a>';
    var instanceOne__soy12 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[0]}), instanceOne__soy12);
    instanceOne__soy12 = instanceOne__soy12.toString();
    var instanceTwo__soy15 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[1]}), instanceTwo__soy15);
    instanceTwo__soy15 = instanceTwo__soy15.toString();
    var instanceThree__soy18 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.Deployment.instance(soy.$$augmentData(opt_data, {environment: opt_data.topEnvironments[2]}), instanceThree__soy18);
    instanceThree__soy18 = instanceThree__soy18.toString();
    param4.append((opt_data.successfulCount == 1) ? AJS.format("{0}Deployed{1} to {2}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12) : (opt_data.successfulCount == 2) ? AJS.format("{0}Deployed{1} to {2} and {3}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15) : (opt_data.successfulCount == 3) ? AJS.format("{0}Deployed{1} to {2}, {3} and {4}",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15,instanceThree__soy18) : (opt_data.successfulCount > 3) ? AJS.format("{0}Deployed{1} to {2}, {3}, {4} and {5} more",anchorStart__soy10,anchorEnd__soy11,instanceOne__soy12,instanceTwo__soy15,instanceThree__soy18,opt_data.successfulCount - 3) : '');
  } else {
    param4.append(soy.$$escapeHtml("No deployments contain latest commits"));
  }
  param4.append('</div>');
  JIRA.Templates.DevStatus.transitionContainer({content: param4.toString()}, output);
  output.append('</dd></dl>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Deployment.instance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment) ? '<span class="environment" ' + ((opt_data.showProjects) ? 'title="' + soy.$$escapeHtml(AJS.format("Project: {0}",opt_data.environment.project)) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.environment.title) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentView.js' */
Backbone.define("JIRA.DevStatus.DeploymentView",JIRA.DevStatus.BaseSummaryView.extend({template:JIRA.Templates.DevStatus.Deployment.summaryPanel,_onSummaryLinkClick:function(a){a.preventDefault();this.detailDialogDeploymentView=new JIRA.DevStatus.DetailDialogDeploymentView(_.extend(this.getDefaultDetailDialogParameters(),{id:"devstatus-deployment-detail-dialog",count:this.model.getOverall().count}));JIRA.DevStatus.DeploymentsAnalytics.fireSummaryClickedEvent(this.options.analyticsModel.getSummary());this.detailDialogDeploymentView.show()}}));
/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-deployment-panel-resources', location = 'js/viewissue/summary/deployment/DeploymentModule.js' */
Backbone.define("JIRA.DevStatus.DeploymentModule",JIRA.DevStatus.BaseSummaryModule.extend({model:JIRA.DevStatus.DeploymentModel,viewType:JIRA.DevStatus.DeploymentView}));
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTip.js' */
(function(e){function a(){return false}function c(){return true}var j=0,f=new Date().getTime();function g(l){l=""+(l||"");return l.replace(/\./g,"-")}function i(m,l){if(AJS.EventQueue&&l&&l.attributes.id){var o={};var n=g(l.attributes.id);var p="";if(l.attributes.eventPrefix){p=l.attributes.eventPrefix;if(p.charAt(p.length-1)!=="."){p+="."}}o.name=p+"helptips."+n+"."+m;o.properties={};AJS.EventQueue.push(o)}}function b(){return"c"+f+(j++)}var d=AJS.HelpTip=function(l){var m;this.attributes=e.extend({},l);this.attributes.id||(this.attributes.id=false);this.attributes.callbacks||(this.attributes.callbacks={});if(this.attributes.isSequence){if(!this.attributes.weight){this.attributes.weight=Number.MAX_VALUE}AJS.HelpTip.Manager.sequences.push(this)}if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;delete this.attributes.body}this.cid=b();m=this.attributes.anchor;delete this.attributes.anchor;this.view=(m)?new h(this,m):new k(this);this.view.$el.addClass("aui-help-tip")};e.extend(d.prototype,{show:function(n){n=n||{};var m=this;var o=e.Deferred();if(this.attributes.callbacks.beforeShow){var l=this.attributes.callbacks.beforeShow();if(l&&_.isFunction(l.done)){l.done(o.resolve)}else{o.resolve()}}else{o.resolve()}o.done(function(){AJS.HelpTip.Manager.show(function(){if(!m.isDismissed()){if(!n.force&&AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:m.id,weight:1000,show:function(){m.view.show()}})}else{m.view.show()}i("shown",m)}})})},dismiss:function(){var l=g(arguments[0]||"programmatically");this.view.dismiss();if(l==="close-button"&&this.attributes.isSequence){AJS.HelpTip.Manager.clearSequences()}if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);i("dismissed."+l,this)}},isVisible:function(){return this.view.$el.is(":visible")},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)}});var h=function(m,l){this.initialize(m,l)};e.extend(h.prototype,{initialize:function(n,m){var l=this;this.model=n;this.beforeHide=a;this.popup=AJS.InlineDialog(m,n.cid,_.bind(this._createDialog,this),_.extend({container:"#content",noBind:true,preHideCallback:function(){return l.beforeHide()},calculatePositions:function(o,r,t,q){var p=AJS.InlineDialog.opts.calculatePositions(o,r,t,q);var s=e(this.container);p.popupCss.top-=s.offset().top;p.popupCss.left-=s.offset().left;return p},addActiveClass:false,initCallback:n.attributes.callbacks.init,hideCallback:n.attributes.callbacks.hide},n.attributes.inlineDialogOpts));this._popupHide=this.popup.hide;this.popup.hide=a;this.$el=e(this.popup[0]);AJS.$(document).bind("showLayer",function(q,p,o){if(p==="inlineDialog"&&o.id===n.cid){AJS.InlineDialog.current=null;AJS.$(document.body).unbind("click."+n.cid+".inline-dialog-check");o._validateClickToClose=a;o.hide=a}})},show:function(){this.popup.show()},dismiss:function(){this.beforeHide=c;this._popupHide()},_createDialog:function(q,o,n){var m=this;var p=AJS.HelpTip.Manager.sequences;var l=this.model.attributes.position;q.html(e(AJS.Templates.HelpTip.tipContent(_.extend({hasSequence:(p.length>1&&(l+1<p.length)),length:p.length,position:l},this.model.attributes))));q.unbind("mouseover mouseout");q.find(".helptip-link").click(function(){i("learn-more.clicked",m.model)});q.find(".helptip-close").click(function(r){r.preventDefault();m.model.dismiss("close-button")});q.find(".helptip-next").click(function(s){s.preventDefault();m.model.dismiss("next-button");var r=l+1;p[r]&&(p[r].show({force:true}))});n()}});var k=function(l){this.initialize(l)};e.extend(k.prototype,{initialize:function(){this.$el=e("<div></div>")},show:function(){},dismiss:function(){}})})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTipManager.js' */
(function(c){var b=AJS.contextPath()+"/rest/helptips/1.0/tips";var a={dismissedTipIds:[],sequences:[],loaded:c.Deferred(),url:function(){return b},sync:function(e,d){e||(e="get");d||(d=null);return c.ajax(this.url(),{type:e,context:this,dataType:"json",contentType:"application/json",data:d&&JSON.stringify(d),processData:false}).promise()},fetch:function(){var d=this.sync();d.done(function(e){c.merge(this.dismissedTipIds,e);this.loaded.resolve()});return d.promise()},show:function(d){this.loaded.done(d)},dismiss:function(d){var e=d.attributes.id;if(!e){d._dismissed=true}else{this.dismissedTipIds.push(e);this.sync("post",{id:e})}},undismiss:function(d){var e=d.attributes.id;if(!e){d._dismissed=false}else{this.dismissedTipIds.splice(c.inArray(e,this.dismissedTipIds),1);this.sync("delete",{id:e})}},isDismissed:function(d){var e=d.attributes.id;return(e)?c.inArray(e,this.dismissedTipIds)>=0:d._dismissed},clearSequences:function(){this.sequences=[]},hideSequences:function(){_.each(this.sequences,function(d){d.view.dismiss()})},showSequences:function(){if(!this._showStarted){var d=this;var e=0;this._showStarted=true;c.when(this.loaded).done(function(){d.sequences.sort(function(g,f){return g.attributes.weight-f.attributes.weight});d.sequences=_.filter(d.sequences,function(g){var f=_.indexOf(d.dismissedTipIds,g.attributes.id)===-1;if(f){g.attributes.position=e++}return f});if(d.sequences.length>0){d.sequences[0].show({force:true})}d._showStarted=false})}}};AJS.HelpTip.Manager=a;a.fetch()})(AJS.$);
/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'templates/HelpTip.soy' */
// This file was automatically generated from HelpTip.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? '<h2 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h2>' : '', '<p class="helptip-body">', opt_data.bodyHtml, '</p>', (opt_data.url) ? '<p><a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + ((opt_data.linkText) ? soy.$$escapeHtml(opt_data.linkText) : soy.$$escapeHtml("Learn more")) + '</a></p>' : '');
  AJS.Templates.HelpTip.tipFooter(opt_data, output);
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.tipFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="tip-footer">');
  AJS.Templates.HelpTip.nextButton(opt_data, output);
  AJS.Templates.HelpTip.closeButton(opt_data, output);
  AJS.Templates.HelpTip.sequencePaging(opt_data, output);
  output.append('</form>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.nextButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.hasSequence) ? '<button class="aui-button helptip-next" type="button">' + soy.$$escapeHtml("Next") + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.closeButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button ', (opt_data.hasSequence) ? ' aui-button-link ' : '', ' helptip-close" type="button">', soy.$$escapeHtml("Close"), '</button>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.sequencePaging = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.length > 1) ? '<span class="helptip-sequence-paging">' + soy.$$escapeHtml(opt_data.position + 1) + '/' + soy.$$escapeHtml(opt_data.length) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-tooltip-resources', location = 'templates/viewissue/devstatus-cta-tooltips.soy' */
// This file was automatically generated from devstatus-cta-tooltips.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Tooltip == 'undefined') { JIRA.Templates.DevStatus.Tooltip = {}; }


JIRA.Templates.DevStatus.Tooltip.createBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'create-branch', content: '<p>' + soy.$$escapeHtml("Create a branch for this issue in your source repository") + '. <a class="cta-learn-more-link" href="https://www.atlassian.com/git/workflows" target="_blank">' + soy.$$escapeHtml("Learn more about branching strategies") + '.</a></p><p class="branch-illustration"></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.tooltipLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cta-tooltip', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '">', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-analytics-resources', location = 'js/analytics/devstatus-analytics.js' */
(function(d,a){AJS.namespace("JIRA.DevStatus.Analytics");var b=".edit-permission-link";function c(){return !_.isUndefined(AJS.Analytics)&&!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.analytics.disabled")}a.DevStatus.Analytics={fireEvent:function(f,h,g){if(c()){var e="devstatus."+f;var i=(typeof h!=="object")?{}:h;if(g===true){AJS.Analytics.triggerPrivacyPolicySafeEvent(e,i)}else{AJS.trigger("analyticsEvent",{name:e,data:i})}}},fireAgileDevStatusLinkClicked:function(){return a.DevStatus.Analytics.fireEvent("panel.agile.icon.clicked")}};a.DevStatus.LabsAnalytics={fireLabsEvent:function(e){var f=e?"on":"off";return a.DevStatus.Analytics.fireEvent("labs.toggle."+f)}};a.DevStatus.SummaryAnalytics={fireSummaryShownEvent:function(g,f,e,h){var j=g?"assignee":"nonassignee";var i=_.extend({issueType:f,issueStatus:e},h);return a.DevStatus.Analytics.fireEvent("summary.shown."+j,i)},fireSummaryClickedEvent:function(f,e){var h=AJS.Meta.get("fusion-analytics-new-context-link");var g=".clicked";if(h){AJS.Meta.set("fusion-analytics-new-context-link",undefined);g+=".newcontext"}return a.DevStatus.Analytics.fireEvent(f+".summary"+g,e,true)},fireDetailTabClicked:function(f,e){return a.DevStatus.Analytics.fireEvent(e+".detail."+f+".tab.clicked")}};a.DevStatus.BuildsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("builds",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.project.clicked")},fireDetailPlanClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.plan.clicked")},fireDetailBuildClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.build.clicked")}};a.DevStatus.DeploymentsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("deployments",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.project.clicked")},fireDetailEnvironmentClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.environment.clicked")},fireDetailReleaseClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.release.clicked")}};a.DevStatus.CommitsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("commits",e)},fireDetailRepoClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".repo.clicked")},fireDetailCommitClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".commit.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"commits")},fireDetailFileExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.expanded.clicked")},fireDetailFilesExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".files.expanded.clicked")},fireDetailFileClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.clicked")},fireDetailReviewsShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".reviews.shown")},fireDetailReviewClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".review.clicked")},fireDetailBranchesShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".branches.shown")},fireDetailCreateReviewClicked:function(f,e){return a.DevStatus.Analytics.fireEvent("commits.detail."+f+".review.create"+(e?".all":""))}};a.DevStatus.ReviewsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("reviews",e)},fireDetailReviewClicked:function(){return a.DevStatus.Analytics.fireEvent("reviews.detail.review.clicked")}};a.DevStatus.BranchesAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("branches",e)},_fireDetailClickedEvent:function(f,e){return a.DevStatus.Analytics.fireEvent("branches.detail."+f+"."+e+".clicked")},fireDetailRepoClicked:function(e){this._fireDetailClickedEvent(e,"repo")},fireDetailBranchClicked:function(e){this._fireDetailClickedEvent(e,"branch")},fireDetailPullRequestLozengeClick:function(e){this._fireDetailClickedEvent(e,"pullrequest.lozenge")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"branches")},fireDetailCreatePullRequestClicked:function(g,e,h){var f="pullrequest.create";if(e){f+=".assignee"}else{f+=".nonassignee";if(h){f+=".assignable"}else{f+=".nonassignable"}}this._fireDetailClickedEvent(g,f)}};a.DevStatus.PullRequestsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("pullrequests",e)},fireDetailPullRequestClicked:function(e){return a.DevStatus.Analytics.fireEvent("pullrequests.detail."+e+".pullrequest.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"pullrequests")}};a.DevStatus.LearnMoreAnalytics={fireLearnMoreEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("learnmore."+e,f)}};a.DevStatus.CtaDialogAnalytics={issueDetails:{},fireCreateBranchEvent:function(e,g){g=(typeof g!=="object")?{}:g;var f=d.extend({issueStatus:this.issueDetails.status,issueType:this.issueDetails.type},g);return a.DevStatus.Analytics.fireEvent("createbranch."+e+"."+(this.issueDetails.isAssignee?"assignee":"nonassignee"),f)},_populateIssueDetails:function(e){this.issueDetails={status:""+e.data("issueStatus"),type:""+e.data("issueType"),isAssignee:e.data("isAssignee")}},_initHandler:function(h,g,j,i){if(j&&g.not(document).is(j)){var f=this;g.find(i).on("simpleClick",function(){var e=d(this);f._fireCreateBranchEvent(e)})}},_fireCreateBranchEvent:function(f){this._populateIssueDetails(f);var e="click";var g=AJS.Meta.get("fusion-analytics-new-context-link");if(g){AJS.Meta.set("fusion-analytics-new-context-link",undefined);e+=".newcontext"}this.fireCreateBranchEvent(e)},initialize:function(h,g,f){if(c()){var e=this;a.bind(a.Events.NEW_CONTENT_ADDED,_.bind(function(j,i){this._initHandler(j,i,h,g)},this));a.bind("GH.DetailView.updated",_.bind(function(i){this._initHandler(i,AJS.$(h),h,g)},this));d(g).on("simpleClick",function(){var i=d(this);e._fireCreateBranchEvent(i)});d(document).on("click","#"+f+" .jira-dialog-content .target",function(){var i=d(this);e.fireCreateBranchEvent("dialog.click",{title:i.find(".title").attr("title"),applicationType:i.data("applicationType")})});d(document).on("click","#"+f+" .jira-dialog-content button.cancel",function(){e.fireCreateBranchEvent("dialog.cancel")});d(document).on("click",".cta-tooltip .cta-learn-more-link",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.ctahelptipbranching")})}}};a.DevStatus.AdminAnalytics={fireAdminEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("admin."+e,f)},initialize:function(){if(c()){var e=this,f=d("#project-config-panel-dev-status");f.find(b).on("click",function(){e.fireAdminEvent("editpermissionlink.config."+(d("ul.permissions-list li.devstatus-admin-permission-item").length>0?"withpermissions":"nopermissions"))});f.find(".learn-more-link").on("click",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.adminappvertisementlink")});f.find("#project-config-applinks-connect").on("click",function(){e.fireAdminEvent("connect")});f.find(".devstatus-admin-connect-button-option").on("click",function(){var g=d(this).data("key")||"unknown";e.fireAdminEvent("connect."+g)})}}};a.DevStatus.AdminSummaryAnalytics={initialize:function(){if(c()){d("#project-config-webpanel-devstatus-admin-summary-panel").find(b).on("click",function(){a.DevStatus.AdminAnalytics.fireAdminEvent("editpermissionlink.summary.nopermissions")})}}}})(AJS.$,JIRA);
/* module-key = 'com.tempoplugin.tempo-teams:tempo-teams-atl-resources', location = 'com/tempoplugin/team/ui/customfield/edit_team_customfield.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(c,b){var a=function(f){var d=AJS.$("select.tempo-customfield");_.each(d,function(g){var e=AJS.$("#"+g.id+"-single-select");if(e.length===0){new AJS.SingleSelect({element:g})}})};AJS.$(".select.tempo-customfield").ready(a)});
/* module-key = 'com.atlassian.jira.plugin.system.comment-panel:expandablecomments', location = 'js/plugin/comment/comments-expanding.js' */
AJS.$(function($) {
    $(document).on('simpleClick', '.collapsed-comments', function(e) {
        e.preventDefault();

        var collapsedLink = $(this);
        var collapsedLinkBlock = collapsedLink.closest('.message-container');
        var container = collapsedLink.closest('.issuePanelContainer');
        var module = collapsedLink.closest('.module');
        var numCommentsBefore = collapsedLinkBlock.prevAll('.activity-comment').length;
        var numCollapsed = collapsedLink.find('.show-more-comments').data('collapsed-count');

        showLoading();
        makeRequest();

        function showLoading() {
            collapsedLink.find('.show-more-comments').text("Loading...");
        }

        function makeRequest() {
            var url = collapsedLink.attr('href');
            JIRA.SmartAjax.makeRequest({
                url: url,
                method: 'GET',
                headers: { "X-PJAX": true } // needed for the ViewIssue action to return only the activity panel
            }).done(showCollapsed);
        }

        function showCollapsed(html) {
            var commentsToShow = $(html).find('.activity-comment').slice(numCommentsBefore, numCommentsBefore + numCollapsed);
            collapsedLinkBlock.replaceWith(commentsToShow);
            JIRA.trace("jira.issue.comment.expanded");
            JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED, [module, JIRA.CONTENT_ADDED_REASON.panelRefreshed]);

            // Expand the twixi for the first comment
            container.find('.activity-comment:first').removeClass('collapsed').addClass('expanded');
        }
    });
});

/* module-key = 'com.atlassian.jirafisheyeplugin:css', location = 'script/fisheye.js' */
AJS.$(function(){AJS.JFEP=AJS.JFEP||{};var a=function(b){AJS.$(".review-filter",b).live("change",function(d){var f=AJS.$(d.target).val(),c=AJS.$(d.target).is(":checked")?"block":"none";AJS.$(".review-status-"+f).css("display",c)});AJS.$(".tab-content",b).find(".project-activity:gt(0)").addClass("hidden");AJS.$("#activity-filter",b).live("change",function(c){var d=AJS.$("#activity-filter").val();AJS.$(".project-activity").addClass("hidden");AJS.$(".limit-"+d).removeClass("hidden")})};AJS.$("#preview-hide-tab",AJS.$(document)).live("click",function(b){AJS.$("#preview_form").submit();b.preventDefault()});if(JIRA.ViewIssueTabs){JIRA.ViewIssueTabs.onTabReady(a)}else{a(document)}AJS.JFEP.reviewIssueToggle=function(){AJS.$(".review-issue-target").addClass("hidden");AJS.$(".review-issue-trigger").click(function(c){c.preventDefault();var b=AJS.$(this).attr("href");AJS.$(b).toggleClass("hidden")})};AJS.JFEP.ignoreCookieName=function(){var b=AJS.$("#header-details-user-fullname").attr("data-username");if(!b){b="__ANON"}return"JFEP.ignoredAppLinks."+b};AJS.JFEP.ignoreAppLink=function(f){var e;var c=document.cookie;if(c.indexOf(AJS.JFEP.ignoreCookieName()+"=")>-1){var d=new RegExp(AJS.JFEP.ignoreCookieName()+"=([^;]*)");e=d.exec(c)[1]}else{e=""}if(e.indexOf(f)==-1){e+=(e.length>0?"|":"")+f;var b=new Date();b.setDate(b.getDate()+365);document.cookie=AJS.JFEP.ignoreCookieName()+"="+e+"; expires="+b.toUTCString()+"; path="+contextPath}};AJS.JFEP.clearIgnoredAppLinks=function(){var b=new Date();b.setDate(b.getDate()-5);document.cookie=AJS.JFEP.ignoreCookieName()+"=expired;expires="+b.toUTCString()+"; path="+contextPath};AJS.$(".ignore-applink").live("click",function(){var b=AJS.$(this).attr("data-id");AJS.JFEP.ignoreAppLink(b);AJS.$(this).parents(".credentials-required-message").slideUp()});AJS.$(".clear-ignored-applinks").live("click",function(){AJS.JFEP.clearIgnoredAppLinks();document.location.reload(true)});AJS.JFEP.loadMoreChangesets=function(c,b,d,e){jQuery("#more-changesets-action-spinner").show();jQuery("#more-changesets-blurb").hide();JIRA.SmartAjax.makeRequest({url:c+"/rest/tabs/1.0/more-changesets/"+b+d,type:"GET",dataType:"json",contentType:"application/json",complete:function(i,f,h){if(!h.successful){var g=(h.status!==401||h.statusText===JIRA.SmartAjax.SmartAjaxResult.TIMEOUT)?JSON.parse(h.data).errorMessages:JIRA.SmartAjax.buildSimpleErrorContent(h);jQuery(document).trigger(JIRA.SERVER_ERROR_EVENT,g)}else{e(h.data.changesets)}}})}});
/* module-key = 'com.atlassian.bonfire.plugin:bonfire-analytics', location = 'includes/js/analytics/capture-analytics.js' */
AJS.EventQueue=AJS.EventQueue||[];
jQuery(prepAccountInfo);
function isTrackingOn(){return jQuery("#bonfire-build-info").find('[data-bonfire-var="bonfire-gaStatus"]').data("bonfire-value")
}function prepAccountInfo(){var A=jQuery("#bonfire-build-info").find('[data-bonfire-var="bonfire-gaTrackingCode"]').data("bonfire-value")
}function trackEvent(A,B){if(isTrackingOn()){AJS.EventQueue.push({name:A,properties:B})
}}function getBonfire(A){trackEvent("jira.capture.getCapture",{source:"JIRA",browser:A})
}function sessionStatusChangeInJira(A){trackEvent("jira.capture.statusChange",{source:"JIRA",status:A})
}function noteStatusChangeInJira(A){trackEvent("jira.capture.notes",{source:"JIRA",status:A})
}function trackHelpButtonUse(){trackEvent("jira.capture.notes.help.button",{source:"JIRA",location:"viewSessionPage"})
}function trackParticipation(A){trackEvent("jira.capture.session.participate",{source:"JIRA",status:A})
};
/* module-key = 'com.atlassian.servicedesk:sd-almond', location = '/vendor/almond-noconflict-pre.js' */
window.__require=window.require;window.__requirejs=window.requirejs;window.__define=window.define;
/* module-key = 'com.atlassian.servicedesk:sd-almond', location = '/vendor/almond.js' */
var requirejs,require,define;(function(e){var h,a,k,l,d={},c={},r={},o={},j=Object.prototype.hasOwnProperty,i=[].slice;function s(t,u){return j.call(t,u)}function m(w,u){var E,A,y,B,x,G,H,D,C,z,F=u&&u.split("/"),v=r.map,t=(v&&v["*"])||{};if(w&&w.charAt(0)==="."){if(u){F=F.slice(0,F.length-1);w=F.concat(w.split("/"));for(D=0;D<w.length;D+=1){z=w[D];if(z==="."){w.splice(D,1);D-=1}else{if(z===".."){if(D===1&&(w[2]===".."||w[0]==="..")){break}else{if(D>0){w.splice(D-1,2);D-=2}}}}}w=w.join("/")}}if((F||t)&&v){E=w.split("/");for(D=E.length;D>0;D-=1){A=E.slice(0,D).join("/");if(F){for(C=F.length;C>0;C-=1){y=v[F.slice(0,C).join("/")];if(y){y=y[A];if(y){B=y;x=D;break}}}}if(B){break}if(!G&&t&&t[A]){G=t[A];H=D}}if(!B&&G){B=G;x=H}if(B){E.splice(0,x,B);w=E.join("/")}}return w}function q(t,u){return function(){return a.apply(e,i.call(arguments,0).concat([t,u]))}}function n(t){return function(u){return m(u,t)}}function f(t){return function(u){d[t]=u}}function g(u){if(s(c,u)){var t=c[u];delete c[u];o[u]=true;h.apply(e,t)}if(!s(d,u)&&!s(o,u)){throw new Error("No "+u)}return d[u]}function p(u){var v,t=u?u.indexOf("!"):-1;if(t>-1){v=u.substring(0,t);u=u.substring(t+1,u.length)}return[v,u]}k=function(u,t){var v,x=p(u),w=x[0];u=x[1];if(w){w=m(w,t);v=g(w)}if(w){if(v&&v.normalize){u=v.normalize(u,n(t))}else{u=m(u,t)}}else{u=m(u,t);x=p(u);w=x[0];u=x[1];if(w){v=g(w)}}return{f:w?w+"!"+u:u,n:u,pr:w,p:v}};function b(t){return function(){return(r&&r.config&&r.config[t])||{}}}l={require:function(t){return q(t)},exports:function(t){var u=d[t];if(typeof u!=="undefined"){return u}else{return(d[t]={})}},module:function(t){return{id:t,uri:"",exports:d[t],config:b(t)}}};h=function(u,D,C,B){var w,A,x,t,v,y=[],z;B=B||u;if(typeof C==="function"){D=!D.length&&C.length?["require","exports","module"]:D;for(v=0;v<D.length;v+=1){t=k(D[v],B);A=t.f;if(A==="require"){y[v]=l.require(u)}else{if(A==="exports"){y[v]=l.exports(u);z=true}else{if(A==="module"){w=y[v]=l.module(u)}else{if(s(d,A)||s(c,A)||s(o,A)){y[v]=g(A)}else{if(t.p){t.p.load(t.n,q(B,true),f(A),{});y[v]=d[A]}else{throw new Error(u+" missing "+A)}}}}}}x=C.apply(d[u],y);if(u){if(w&&w.exports!==e&&w.exports!==d[u]){d[u]=w.exports}else{if(x!==e||!z){d[u]=x}}}}else{if(u){d[u]=C}}};requirejs=require=a=function(w,x,t,u,v){if(typeof w==="string"){if(l[w]){return l[w](x)}return g(k(w,x).f)}else{if(!w.splice){r=w;if(x.splice){w=x;x=t;t=null}else{w=e}}}x=x||function(){};if(typeof t==="function"){t=u;u=v}if(u){h(e,w,x,t)}else{setTimeout(function(){h(e,w,x,t)},15)}return a};a.config=function(t){r=t;return a};define=function(t,u,v){if(u===e){return}if(!u.splice){v=u;u=[]}if(!s(d,t)&&!s(c,t)){c[t]=[t,u,v]}};define.amd={jQuery:true}}());
/* module-key = 'com.atlassian.servicedesk:sd-almond', location = '/vendor/almond-noconflict-post.js' */
if(window.__require){window.require=window.__require;window.requirejs=window.__requirejs;window.define=window.__define}else{delete window.define.amd}try{delete window.__require}catch(e){window.__require=undefined}try{delete window.__requirejs}catch(e){window.__requirejs=undefined}try{delete window.__define}catch(e){window.__define=undefined};
/* module-key = 'com.atlassian.servicedesk:sd-tracking', location = '/servicedesk/util/tracking.js' */
define("servicedesk/util/tracking",["servicedesk/underscore","servicedesk/jQuery","util/app-data","servicedesk/util/build-info"],function(g,e,i,d){var b=false;var c=[];var j=function(){var k=require("servicedesk/util/tracking-state");if(k){return k.enabled}};var h=function(m){var l=0;for(var k=0;k<m.length;k++){var n=m.charCodeAt(k);l=((l<<5)-l)+n;l&=l}return l};var f={};var a="customer";if(i.getUsername()!=null){a=h(i.getUsername())}f.trackPageview=function(k){if(j()){if(b){AJS.log("Tracking page view: "+k)}g.each(c,function(l){l.pageview(k)})}};f.trackSynchronousPageview=function(k){if(j()){if(b){AJS.log("Tracking page view (synchronously): "+k)}g.each(c,function(l){l.synchronousPageview(k)})}};f.trackEvent=function(m,l,k){if(j()){if(b){AJS.log("TrackEvent: "+m+" "+l)}g.each(c,function(n){n.event(m,l,k)})}};e(function(){if(j()){AJS.EventQueue=AJS.EventQueue||[];c.push({pageview:function(l){var k=l.replace(/^\/?/,"").replace(/\//g,".");this.event("page.view",k)},synchronousPageview:function(k){this.pageview(k)},event:function(o,n,l){var k=["servicedesk",o,n].join(".");var m={name:k,properties:l||{}};m.properties.sdVersion=d.pluginVersion;AJS.EventQueue.push(m)}})}});return f});
/* module-key = 'com.atlassian.servicedesk:sd-browser-metrics-events', location = '/servicedesk/analytics/browsermetric/sd-browser-metrics-events.js' */
define("servicedesk/analytics/browsermetric/sd-browser-metrics-events",["exports"],function(a){a.customerEvents={START:"sd.customer.request.start",END:"sd.customer.request.end"};a.agentEvents={START:"sd.agent.request.start",END:"sd.agent.request.end"}});
/* module-key = 'com.atlassian.servicedesk:sd-i18n-js', location = '/backport/aui55/js/format.js' */
AJS.format=function(i){var b=/'(?!')/g,h=/^\d+$/,e=/^(\d+),number$/,c=/^(\d+)\,choice\,(.+)/,g=/^\s*?(-?\d+)([#<])(.+)/;var f=function(r,p){var o="",m;if(m=r.match(h)){o=p.length>++r?p[r]:""}else{if(m=r.match(e)){o=p.length>++m[1]?p[m[1]]:""}else{if(m=r.match(c)){var s=(p.length>++m[1]?p[m[1]]:null);if(s!==null){var t=m[2].split("|");var n=null;for(var l=0;l<t.length;l++){var k=t[l].match(g);var q=parseInt(k[1],10);if(s<q){if(n){o=n;break}else{o=k[3];break}}if(s==q&&k[2]=="#"){o=k[3];break}else{}if(l==t.length-1){o=k[3]}n=k[3]}var j=[o].concat(Array.prototype.slice.call(p,1));o=AJS.format.apply(AJS,j)}}}}return o};var d=function(o){var m=false,j=-1,n=0;for(var l=0;l<o.length;l++){var p=o.charAt(l);if(p=="'"){m=!m}if(m){continue}if(p==="{"){if(n===0){j=l}n++}else{if(p==="}"){if(n>0){n--;if(n===0){var k=[];k.push(o.substring(0,l+1));k.push(o.substring(0,j));k.push(o.substring(j+1,l));return k}}}}}return null};var a=function(m){var k=arguments,l="",j=d(m);while(j){m=m.substring(j[0].length);l+=j[1].replace(b,"");l+=f(j[2],k);j=d(m)}l+=m.replace(b,"");return l};return a.apply(AJS,arguments)};AJS.I18n={getText:function(a){var b=Array.prototype.slice.call(arguments,1);if(AJS.I18n.keys&&Object.prototype.hasOwnProperty.call(AJS.I18n.keys,a)){return AJS.format.apply(null,[AJS.I18n.keys[a]].concat(b))}return a}};
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/underscore.js' */
(function(){var w=this;var k=w._;var E={};var D=Array.prototype,g=Object.prototype,r=Function.prototype;var I=D.push,o=D.slice,y=D.concat,B=D.unshift,d=g.toString,j=g.hasOwnProperty;var M=D.forEach,q=D.map,F=D.reduce,c=D.reduceRight,b=D.filter,C=D.every,p=D.some,n=D.indexOf,l=D.lastIndexOf,u=Array.isArray,f=Object.keys,G=r.bind;var N=function(O){if(O instanceof N){return O}if(!(this instanceof N)){return new N(O)}this._wrapped=O};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=N}exports._=N}else{w._=N}N.VERSION="1.4.2";var J=N.each=N.forEach=function(T,S,R){if(T==null){return}if(M&&T.forEach===M){T.forEach(S,R)}else{if(T.length===+T.length){for(var Q=0,O=T.length;Q<O;Q++){if(S.call(R,T[Q],Q,T)===E){return}}}else{for(var P in T){if(N.has(T,P)){if(S.call(R,T[P],P,T)===E){return}}}}}};N.map=N.collect=function(R,Q,P){var O=[];if(R==null){return O}if(q&&R.map===q){return R.map(Q,P)}J(R,function(U,S,T){O[O.length]=Q.call(P,U,S,T)});return O};N.reduce=N.foldl=N.inject=function(S,R,O,Q){var P=arguments.length>2;if(S==null){S=[]}if(F&&S.reduce===F){if(Q){R=N.bind(R,Q)}return P?S.reduce(R,O):S.reduce(R)}J(S,function(V,T,U){if(!P){O=V;P=true}else{O=R.call(Q,O,V,T,U)}});if(!P){throw new TypeError("Reduce of empty array with no initial value")}return O};N.reduceRight=N.foldr=function(U,R,O,Q){var P=arguments.length>2;if(U==null){U=[]}if(c&&U.reduceRight===c){if(Q){R=N.bind(R,Q)}return arguments.length>2?U.reduceRight(R,O):U.reduceRight(R)}var T=U.length;if(T!==+T){var S=N.keys(U);T=S.length}J(U,function(X,V,W){V=S?S[--T]:--T;if(!P){O=U[V];P=true}else{O=R.call(Q,O,U[V],V,W)}});if(!P){throw new TypeError("Reduce of empty array with no initial value")}return O};N.find=N.detect=function(R,Q,P){var O;A(R,function(U,S,T){if(Q.call(P,U,S,T)){O=U;return true}});return O};N.filter=N.select=function(R,Q,P){var O=[];if(R==null){return O}if(b&&R.filter===b){return R.filter(Q,P)}J(R,function(U,S,T){if(Q.call(P,U,S,T)){O[O.length]=U}});return O};N.reject=function(R,Q,P){var O=[];if(R==null){return O}J(R,function(U,S,T){if(!Q.call(P,U,S,T)){O[O.length]=U}});return O};N.every=N.all=function(R,Q,P){Q||(Q=N.identity);var O=true;if(R==null){return O}if(C&&R.every===C){return R.every(Q,P)}J(R,function(U,S,T){if(!(O=O&&Q.call(P,U,S,T))){return E}});return !!O};var A=N.some=N.any=function(R,Q,P){Q||(Q=N.identity);var O=false;if(R==null){return O}if(p&&R.some===p){return R.some(Q,P)}J(R,function(U,S,T){if(O||(O=Q.call(P,U,S,T))){return E}});return !!O};N.contains=N.include=function(Q,P){var O=false;if(Q==null){return O}if(n&&Q.indexOf===n){return Q.indexOf(P)!=-1}O=A(Q,function(R){return R===P});return O};N.invoke=function(P,Q){var O=o.call(arguments,2);return N.map(P,function(R){return(N.isFunction(Q)?Q:R[Q]).apply(R,O)})};N.pluck=function(P,O){return N.map(P,function(Q){return Q[O]})};N.where=function(P,O){if(N.isEmpty(O)){return[]}return N.filter(P,function(R){for(var Q in O){if(O[Q]!==R[Q]){return false}}return true})};N.max=function(R,Q,P){if(!Q&&N.isArray(R)&&R[0]===+R[0]&&R.length<65535){return Math.max.apply(Math,R)}if(!Q&&N.isEmpty(R)){return -Infinity}var O={computed:-Infinity};J(R,function(V,S,U){var T=Q?Q.call(P,V,S,U):V;T>=O.computed&&(O={value:V,computed:T})});return O.value};N.min=function(R,Q,P){if(!Q&&N.isArray(R)&&R[0]===+R[0]&&R.length<65535){return Math.min.apply(Math,R)}if(!Q&&N.isEmpty(R)){return Infinity}var O={computed:Infinity};J(R,function(V,S,U){var T=Q?Q.call(P,V,S,U):V;T<O.computed&&(O={value:V,computed:T})});return O.value};N.shuffle=function(R){var Q;var P=0;var O=[];J(R,function(S){Q=N.random(P++);O[P-1]=O[Q];O[Q]=S});return O};var a=function(O){return N.isFunction(O)?O:function(P){return P[O]}};N.sortBy=function(R,Q,O){var P=a(Q);return N.pluck(N.map(R,function(U,S,T){return{value:U,index:S,criteria:P.call(O,U,S,T)}}).sort(function(V,U){var T=V.criteria;var S=U.criteria;if(T!==S){if(T>S||T===void 0){return 1}if(T<S||S===void 0){return -1}}return V.index<U.index?-1:1}),"value")};var t=function(T,S,P,R){var O={};var Q=a(S);J(T,function(W,U){var V=Q.call(P,W,U,T);R(O,V,W)});return O};N.groupBy=function(Q,P,O){return t(Q,P,O,function(R,S,T){(N.has(R,S)?R[S]:(R[S]=[])).push(T)})};N.countBy=function(Q,P,O){return t(Q,P,O,function(R,S,T){if(!N.has(R,S)){R[S]=0}R[S]++})};N.sortedIndex=function(V,U,R,Q){R=R==null?N.identity:a(R);var T=R.call(Q,U);var O=0,S=V.length;while(O<S){var P=(O+S)>>>1;R.call(Q,V[P])<T?O=P+1:S=P}return O};N.toArray=function(O){if(!O){return[]}if(O.length===+O.length){return o.call(O)}return N.values(O)};N.size=function(O){return(O.length===+O.length)?O.length:N.keys(O).length};N.first=N.head=N.take=function(Q,P,O){return(P!=null)&&!O?o.call(Q,0,P):Q[0]};N.initial=function(Q,P,O){return o.call(Q,0,Q.length-((P==null)||O?1:P))};N.last=function(Q,P,O){if((P!=null)&&!O){return o.call(Q,Math.max(Q.length-P,0))}else{return Q[Q.length-1]}};N.rest=N.tail=N.drop=function(Q,P,O){return o.call(Q,(P==null)||O?1:P)};N.compact=function(O){return N.filter(O,function(P){return !!P})};var x=function(P,Q,O){J(P,function(R){if(N.isArray(R)){Q?I.apply(O,R):x(R,Q,O)}else{O.push(R)}});return O};N.flatten=function(P,O){return x(P,O,[])};N.without=function(O){return N.difference(O,o.call(arguments,1))};N.uniq=N.unique=function(U,T,S,R){var P=S?N.map(U,S,R):U;var Q=[];var O=[];J(P,function(W,V){if(T?(!V||O[O.length-1]!==W):!N.contains(O,W)){O.push(W);Q.push(U[V])}});return Q};N.union=function(){return N.uniq(y.apply(D,arguments))};N.intersection=function(P){var O=o.call(arguments,1);return N.filter(N.uniq(P),function(Q){return N.every(O,function(R){return N.indexOf(R,Q)>=0})})};N.difference=function(P){var O=y.apply(D,o.call(arguments,1));return N.filter(P,function(Q){return !N.contains(O,Q)})};N.zip=function(){var O=o.call(arguments);var R=N.max(N.pluck(O,"length"));var Q=new Array(R);for(var P=0;P<R;P++){Q[P]=N.pluck(O,""+P)}return Q};N.object=function(S,Q){var O={};for(var R=0,P=S.length;R<P;R++){if(Q){O[S[R]]=Q[R]}else{O[S[R][0]]=S[R][1]}}return O};N.indexOf=function(S,Q,R){if(S==null){return -1}var P=0,O=S.length;if(R){if(typeof R=="number"){P=(R<0?Math.max(0,O+R):R)}else{P=N.sortedIndex(S,Q);return S[P]===Q?P:-1}}if(n&&S.indexOf===n){return S.indexOf(Q,R)}for(;P<O;P++){if(S[P]===Q){return P}}return -1};N.lastIndexOf=function(S,Q,R){if(S==null){return -1}var O=R!=null;if(l&&S.lastIndexOf===l){return O?S.lastIndexOf(Q,R):S.lastIndexOf(Q)}var P=(O?R:S.length);while(P--){if(S[P]===Q){return P}}return -1};N.range=function(T,R,S){if(arguments.length<=1){R=T||0;T=0}S=arguments[2]||1;var P=Math.max(Math.ceil((R-T)/S),0);var O=0;var Q=new Array(P);while(O<P){Q[O++]=T;T+=S}return Q};var H=function(){};N.bind=function e(R,P){var Q,O;if(R.bind===G&&G){return G.apply(R,o.call(arguments,1))}if(!N.isFunction(R)){throw new TypeError}O=o.call(arguments,2);return Q=function(){if(!(this instanceof Q)){return R.apply(P,O.concat(o.call(arguments)))}H.prototype=R.prototype;var T=new H;var S=R.apply(T,O.concat(o.call(arguments)));if(Object(S)===S){return S}return T}};N.bindAll=function(P){var O=o.call(arguments,1);if(O.length==0){O=N.functions(P)}J(O,function(Q){P[Q]=N.bind(P[Q],P)});return P};N.memoize=function(Q,P){var O={};P||(P=N.identity);return function(){var R=P.apply(this,arguments);return N.has(O,R)?O[R]:(O[R]=Q.apply(this,arguments))}};N.delay=function(P,Q){var O=o.call(arguments,2);return setTimeout(function(){return P.apply(null,O)},Q)};N.defer=function(O){return N.delay.apply(N,[O,1].concat(o.call(arguments,1)))};N.throttle=function(Q,R){var P,T,U,V,S,W;var O=N.debounce(function(){S=V=false},R);return function(){P=this;T=arguments;var X=function(){U=null;if(S){W=Q.apply(P,T)}O()};if(!U){U=setTimeout(X,R)}if(V){S=true}else{V=true;W=Q.apply(P,T)}O();return W}};N.debounce=function(Q,S,P){var R,O;return function(){var W=this,V=arguments;var U=function(){R=null;if(!P){O=Q.apply(W,V)}};var T=P&&!R;clearTimeout(R);R=setTimeout(U,S);if(T){O=Q.apply(W,V)}return O}};N.once=function(Q){var O=false,P;return function(){if(O){return P}O=true;P=Q.apply(this,arguments);Q=null;return P}};N.wrap=function(O,P){return function(){var Q=[O];I.apply(Q,arguments);return P.apply(this,Q)}};N.compose=function(){var O=arguments;return function(){var P=arguments;for(var Q=O.length-1;Q>=0;Q--){P=[O[Q].apply(this,P)]}return P[0]}};N.after=function(P,O){if(P<=0){return O()}return function(){if(--P<1){return O.apply(this,arguments)}}};N.keys=f||function(Q){if(Q!==Object(Q)){throw new TypeError("Invalid object")}var P=[];for(var O in Q){if(N.has(Q,O)){P[P.length]=O}}return P};N.values=function(Q){var O=[];for(var P in Q){if(N.has(Q,P)){O.push(Q[P])}}return O};N.pairs=function(Q){var P=[];for(var O in Q){if(N.has(Q,O)){P.push([O,Q[O]])}}return P};N.invert=function(Q){var O={};for(var P in Q){if(N.has(Q,P)){O[Q[P]]=P}}return O};N.functions=N.methods=function(Q){var P=[];for(var O in Q){if(N.isFunction(Q[O])){P.push(O)}}return P.sort()};N.extend=function(O){J(o.call(arguments,1),function(P){for(var Q in P){O[Q]=P[Q]}});return O};N.pick=function(P){var Q={};var O=y.apply(D,o.call(arguments,1));J(O,function(R){if(R in P){Q[R]=P[R]}});return Q};N.omit=function(Q){var R={};var P=y.apply(D,o.call(arguments,1));for(var O in Q){if(!N.contains(P,O)){R[O]=Q[O]}}return R};N.defaults=function(O){J(o.call(arguments,1),function(P){for(var Q in P){if(O[Q]==null){O[Q]=P[Q]}}});return O};N.clone=function(O){if(!N.isObject(O)){return O}return N.isArray(O)?O.slice():N.extend({},O)};N.tap=function(P,O){O(P);return P};var K=function(V,U,P,Q){if(V===U){return V!==0||1/V==1/U}if(V==null||U==null){return V===U}if(V instanceof N){V=V._wrapped}if(U instanceof N){U=U._wrapped}var S=d.call(V);if(S!=d.call(U)){return false}switch(S){case"[object String]":return V==String(U);case"[object Number]":return V!=+V?U!=+U:(V==0?1/V==1/U:V==+U);case"[object Date]":case"[object Boolean]":return +V==+U;case"[object RegExp]":return V.source==U.source&&V.global==U.global&&V.multiline==U.multiline&&V.ignoreCase==U.ignoreCase}if(typeof V!="object"||typeof U!="object"){return false}var O=P.length;while(O--){if(P[O]==V){return Q[O]==U}}P.push(V);Q.push(U);var X=0,Y=true;if(S=="[object Array]"){X=V.length;Y=X==U.length;if(Y){while(X--){if(!(Y=K(V[X],U[X],P,Q))){break}}}}else{var T=V.constructor,R=U.constructor;if(T!==R&&!(N.isFunction(T)&&(T instanceof T)&&N.isFunction(R)&&(R instanceof R))){return false}for(var W in V){if(N.has(V,W)){X++;if(!(Y=N.has(U,W)&&K(V[W],U[W],P,Q))){break}}}if(Y){for(W in U){if(N.has(U,W)&&!(X--)){break}}Y=!X}}P.pop();Q.pop();return Y};N.isEqual=function(P,O){return K(P,O,[],[])};N.isEmpty=function(P){if(P==null){return true}if(N.isArray(P)||N.isString(P)){return P.length===0}for(var O in P){if(N.has(P,O)){return false}}return true};N.isElement=function(O){return !!(O&&O.nodeType===1)};N.isArray=u||function(O){return d.call(O)=="[object Array]"};N.isObject=function(O){return O===Object(O)};J(["Arguments","Function","String","Number","Date","RegExp"],function(O){N["is"+O]=function(P){return d.call(P)=="[object "+O+"]"}});if(!N.isArguments(arguments)){N.isArguments=function(O){return !!(O&&N.has(O,"callee"))}}if(typeof(/./)!=="function"){N.isFunction=function(O){return typeof O==="function"}}N.isFinite=function(O){return N.isNumber(O)&&isFinite(O)};N.isNaN=function(O){return N.isNumber(O)&&O!=+O};N.isBoolean=function(O){return O===true||O===false||d.call(O)=="[object Boolean]"};N.isNull=function(O){return O===null};N.isUndefined=function(O){return O===void 0};N.has=function(P,O){return j.call(P,O)};N.noConflict=function(){w._=k;return this};N.identity=function(O){return O};N.times=function(R,Q,P){for(var O=0;O<R;O++){Q.call(P,O)}};N.random=function(P,O){if(O==null){O=P;P=0}return P+(0|Math.random()*(O-P+1))};var m={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};m.unescape=N.invert(m.escape);var L={escape:new RegExp("["+N.keys(m.escape).join("")+"]","g"),unescape:new RegExp("("+N.keys(m.unescape).join("|")+")","g")};N.each(["escape","unescape"],function(O){N[O]=function(P){if(P==null){return""}return(""+P).replace(L[O],function(Q){return m[O][Q]})}});N.result=function(O,Q){if(O==null){return null}var P=O[Q];return N.isFunction(P)?P.call(O):P};N.mixin=function(O){J(N.functions(O),function(P){var Q=N[P]=O[P];N.prototype[P]=function(){var R=[this._wrapped];I.apply(R,arguments);return s.call(this,Q.apply(N,R))}})};var z=0;N.uniqueId=function(O){var P=z++;return O?O+P:P};N.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var v=/(.)^/;var h={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var i=/\\|'|\r|\n|\t|\u2028|\u2029/g;N.template=function(W,R,Q){Q=N.defaults({},Q,N.templateSettings);var S=new RegExp([(Q.escape||v).source,(Q.interpolate||v).source,(Q.evaluate||v).source].join("|")+"|$","g");var T=0;var O="__p+='";W.replace(S,function(Y,Z,X,ab,aa){O+=W.slice(T,aa).replace(i,function(ac){return"\\"+h[ac]});O+=Z?"'+\n((__t=("+Z+"))==null?'':_.escape(__t))+\n'":X?"'+\n((__t=("+X+"))==null?'':__t)+\n'":ab?"';\n"+ab+"\n__p+='":"";T=aa+Y.length});O+="';\n";if(!Q.variable){O="with(obj||{}){\n"+O+"}\n"}O="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+O+"return __p;\n";try{var P=new Function(Q.variable||"obj","_",O)}catch(U){U.source=O;throw U}if(R){return P(R,N)}var V=function(X){return P.call(this,X,N)};V.source="function("+(Q.variable||"obj")+"){\n"+O+"}";return V};N.chain=function(O){return N(O).chain()};var s=function(O){return this._chain?N(O).chain():O};N.mixin(N);J(["pop","push","reverse","shift","sort","splice","unshift"],function(O){var P=D[O];N.prototype[O]=function(){var Q=this._wrapped;P.apply(Q,arguments);if((O=="shift"||O=="splice")&&Q.length===0){delete Q[0]}return s.call(this,Q)}});J(["concat","join","slice"],function(O){var P=D[O];N.prototype[O]=function(){return s.call(this,P.apply(this._wrapped,arguments))}});N.extend(N.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/backbone.js' */
(function(){var u=this;var B=u.Backbone;var g=[];var D=g.push;var n=g.slice;var t=g.splice;var z;if(typeof exports!=="undefined"){z=exports}else{z=u.Backbone={}}z.VERSION="1.0.0";var L=u._;if(!L&&(typeof require!=="undefined")){L=require("servicedesk/underscore")}z.$=u.jQuery||u.Zepto||u.ender||u.$;z.noConflict=function(){u.Backbone=B;return this};z.emulateHTTP=false;z.emulateJSON=false;var J=z.Events={on:function(M,P,O){if(!x(this,"on",M,[P,O])||!P){return this}this._events||(this._events={});var N=this._events[M]||(this._events[M]=[]);N.push({callback:P,context:O,ctx:O||this});return this},once:function(N,Q,O){if(!x(this,"once",N,[Q,O])||!Q){return this}var M=this;var P=L.once(function(){M.off(N,P);Q.apply(this,arguments)});P._callback=Q;return this.on(N,P,O)},off:function(M,V,N){var T,U,W,S,R,O,Q,P;if(!this._events||!x(this,"off",M,[V,N])){return this}if(!M&&!V&&!N){this._events={};return this}S=M?[M]:L.keys(this._events);for(R=0,O=S.length;R<O;R++){M=S[R];if(W=this._events[M]){this._events[M]=T=[];if(V||N){for(Q=0,P=W.length;Q<P;Q++){U=W[Q];if((V&&V!==U.callback&&V!==U.callback._callback)||(N&&N!==U.context)){T.push(U)}}}if(!T.length){delete this._events[M]}}}return this},trigger:function(O){if(!this._events){return this}var N=n.call(arguments,1);if(!x(this,"trigger",O,N)){return this}var P=this._events[O];var M=this._events.all;if(P){b(P,N)}if(M){b(M,arguments)}return this},stopListening:function(P,M,R){var N=this._listeners;if(!N){return this}var O=!M&&!R;if(typeof M==="object"){R=this}if(P){(N={})[P._listenerId]=P}for(var Q in N){N[Q].off(M,R,this);if(O){delete this._listeners[Q]}}return this}};var w=/\s+/;var x=function(T,R,N,Q){if(!N){return true}if(typeof N==="object"){for(var P in N){T[R].apply(T,[P,N[P]].concat(Q))}return false}if(w.test(N)){var S=N.split(w);for(var O=0,M=S.length;O<M;O++){T[R].apply(T,[S[O]].concat(Q))}return false}return true};var b=function(R,P){var S,Q=-1,O=R.length,N=P[0],M=P[1],T=P[2];switch(P.length){case 0:while(++Q<O){(S=R[Q]).callback.call(S.ctx)}return;case 1:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N)}return;case 2:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M)}return;case 3:while(++Q<O){(S=R[Q]).callback.call(S.ctx,N,M,T)}return;default:while(++Q<O){(S=R[Q]).callback.apply(S.ctx,P)}}};var C={listenTo:"on",listenToOnce:"once"};L.each(C,function(M,N){J[N]=function(Q,O,S){var P=this._listeners||(this._listeners={});var R=Q._listenerId||(Q._listenerId=L.uniqueId("l"));P[R]=Q;if(typeof O==="object"){S=this}Q[M](O,S,this);return this}});J.bind=J.on;J.unbind=J.off;L.extend(z,J);var E=z.Model=function(M,O){var P;var N=M||{};O||(O={});this.cid=L.uniqueId("c");this.attributes={};L.extend(this,L.pick(O,F));if(O.parse){N=this.parse(N,O)||{}}if(P=L.result(this,"defaults")){N=L.defaults({},N,P)}this.set(N,O);this.changed={};this.initialize.apply(this,arguments)};var F=["url","urlRoot","collection"];L.extend(E.prototype,J,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(M){return L.clone(this.attributes)},sync:function(){return z.sync.apply(this,arguments)},get:function(M){return this.attributes[M]},escape:function(M){return L.escape(this.get(M))},has:function(M){return this.get(M)!=null},set:function(U,M,Y){var S,V,W,T,R,X,O,Q;if(U==null){return this}if(typeof U==="object"){V=U;Y=M}else{(V={})[U]=M}Y||(Y={});if(!this._validate(V,Y)){return false}W=Y.unset;R=Y.silent;T=[];X=this._changing;this._changing=true;if(!X){this._previousAttributes=L.clone(this.attributes);this.changed={}}Q=this.attributes,O=this._previousAttributes;if(this.idAttribute in V){this.id=V[this.idAttribute]}for(S in V){M=V[S];if(!L.isEqual(Q[S],M)){T.push(S)}if(!L.isEqual(O[S],M)){this.changed[S]=M}else{delete this.changed[S]}W?delete Q[S]:Q[S]=M}if(!R){if(T.length){this._pending=true}for(var P=0,N=T.length;P<N;P++){this.trigger("change:"+T[P],this,Q[T[P]],Y)}}if(X){return this}if(!R){while(this._pending){this._pending=false;this.trigger("change",this,Y)}}this._pending=false;this._changing=false;return this},unset:function(M,N){return this.set(M,void 0,L.extend({},N,{unset:true}))},clear:function(N){var M={};for(var O in this.attributes){M[O]=void 0}return this.set(M,L.extend({},N,{unset:true}))},hasChanged:function(M){if(M==null){return !L.isEmpty(this.changed)}return L.has(this.changed,M)},changedAttributes:function(O){if(!O){return this.hasChanged()?L.clone(this.changed):false}var Q,P=false;var N=this._changing?this._previousAttributes:this.attributes;for(var M in O){if(L.isEqual(N[M],(Q=O[M]))){continue}(P||(P={}))[M]=Q}return P},previous:function(M){if(M==null||!this._previousAttributes){return null}return this._previousAttributes[M]},previousAttributes:function(){return L.clone(this._previousAttributes)},fetch:function(N){N=N?L.clone(N):{};if(N.parse===void 0){N.parse=true}var M=this;var O=N.success;N.success=function(P){if(!M.set(M.parse(P,N),N)){return false}if(O){O(M,P,N)}M.trigger("sync",M,P,N)};H(this,N);return this.sync("read",this,N)},save:function(Q,N,U){var R,M,T,O=this.attributes;if(Q==null||typeof Q==="object"){R=Q;U=N}else{(R={})[Q]=N}if(R&&(!U||!U.wait)&&!this.set(R,U)){return false}U=L.extend({validate:true},U);if(!this._validate(R,U)){return false}if(R&&U.wait){this.attributes=L.extend({},O,R)}if(U.parse===void 0){U.parse=true}var P=this;var S=U.success;U.success=function(W){P.attributes=O;var V=P.parse(W,U);if(U.wait){V=L.extend(R||{},V)}if(L.isObject(V)&&!P.set(V,U)){return false}if(S){S(P,W,U)}P.trigger("sync",P,W,U)};H(this,U);M=this.isNew()?"create":(U.patch?"patch":"update");if(M==="patch"){U.attrs=R}T=this.sync(M,this,U);if(R&&U.wait){this.attributes=O}return T},destroy:function(N){N=N?L.clone(N):{};var M=this;var Q=N.success;var O=function(){M.trigger("destroy",M,M.collection,N)};N.success=function(R){if(N.wait||M.isNew()){O()}if(Q){Q(M,R,N)}if(!M.isNew()){M.trigger("sync",M,R,N)}};if(this.isNew()){N.success();return false}H(this,N);var P=this.sync("delete",this,N);if(!N.wait){O()}return P},url:function(){var M=L.result(this,"urlRoot")||L.result(this.collection,"url")||r();if(this.isNew()){return M}return M+(M.charAt(M.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(N,M){return N},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(M){return this._validate({},L.extend(M||{},{validate:true}))},_validate:function(O,N){if(!N.validate||!this.validate){return true}O=L.extend({},this.attributes,O);var M=this.validationError=this.validate(O,N)||null;if(!M){return true}this.trigger("invalid",this,M,L.extend(N||{},{validationError:M}));return false}});var a=["keys","values","pairs","invert","pick","omit"];L.each(a,function(M){E.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.attributes);return L[M].apply(L,N)}});var c=z.Collection=function(N,M){M||(M={});if(M.url){this.url=M.url}if(M.model){this.model=M.model}if(M.comparator!==void 0){this.comparator=M.comparator}this._reset();this.initialize.apply(this,arguments);if(N){this.reset(N,L.extend({silent:true},M))}};var o={add:true,remove:true,merge:true};var K={add:true,merge:false,remove:false};L.extend(c.prototype,J,{model:E,initialize:function(){},toJSON:function(M){return this.map(function(N){return N.toJSON(M)})},sync:function(){return z.sync.apply(this,arguments)},add:function(N,M){return this.set(N,L.defaults(M||{},K))},remove:function(R,P){R=L.isArray(R)?R.slice():[R];P||(P={});var Q,M,O,N;for(Q=0,M=R.length;Q<M;Q++){N=this.get(R[Q]);if(!N){continue}delete this._byId[N.id];delete this._byId[N.cid];O=this.indexOf(N);this.models.splice(O,1);this.length--;if(!P.silent){P.index=O;N.trigger("remove",N,this,P)}this._removeReference(N)}return this},set:function(N,Z){Z=L.defaults(Z||{},o);if(Z.parse){N=this.parse(N,Z)}if(!L.isArray(N)){N=N?[N]:[]}var U,Q,W,X,O,V;var P=Z.at;var T=this.comparator&&(P==null)&&Z.sort!==false;var R=L.isString(this.comparator)?this.comparator:null;var Y=[],M=[],S={};for(U=0,Q=N.length;U<Q;U++){if(!(W=this._prepareModel(N[U],Z))){continue}if(O=this.get(W)){if(Z.remove){S[O.cid]=true}if(Z.merge){O.set(W.attributes,Z);if(T&&!V&&O.hasChanged(R)){V=true}}}else{if(Z.add){Y.push(W);W.on("all",this._onModelEvent,this);this._byId[W.cid]=W;if(W.id!=null){this._byId[W.id]=W}}}}if(Z.remove){for(U=0,Q=this.length;U<Q;++U){if(!S[(W=this.models[U]).cid]){M.push(W)}}if(M.length){this.remove(M,Z)}}if(Y.length){if(T){V=true}this.length+=Y.length;if(P!=null){t.apply(this.models,[P,0].concat(Y))}else{D.apply(this.models,Y)}}if(V){this.sort({silent:true})}if(Z.silent){return this}for(U=0,Q=Y.length;U<Q;U++){(W=Y[U]).trigger("add",W,this,Z)}if(V){this.trigger("sort",this,Z)}return this},reset:function(P,N){N||(N={});for(var O=0,M=this.models.length;O<M;O++){this._removeReference(this.models[O])}N.previousModels=this.models;this._reset();this.add(P,L.extend({silent:true},N));if(!N.silent){this.trigger("reset",this,N)}return this},push:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:this.length},M));return N},pop:function(N){var M=this.at(this.length-1);this.remove(M,N);return M},unshift:function(N,M){N=this._prepareModel(N,M);this.add(N,L.extend({at:0},M));return N},shift:function(N){var M=this.at(0);this.remove(M,N);return M},slice:function(N,M){return this.models.slice(N,M)},get:function(M){if(M==null){return void 0}return this._byId[M.id!=null?M.id:M.cid||M]},at:function(M){return this.models[M]},where:function(M,N){if(L.isEmpty(M)){return N?void 0:[]}return this[N?"find":"filter"](function(O){for(var P in M){if(M[P]!==O.get(P)){return false}}return true})},findWhere:function(M){return this.where(M,true)},sort:function(M){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}M||(M={});if(L.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(L.bind(this.comparator,this))}if(!M.silent){this.trigger("sort",this,M)}return this},sortedIndex:function(M,P,N){P||(P=this.comparator);var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L.sortedIndex(this.models,M,O,N)},pluck:function(M){return L.invoke(this.models,"get",M)},fetch:function(M){M=M?L.clone(M):{};if(M.parse===void 0){M.parse=true}var O=M.success;var N=this;M.success=function(P){var Q=M.reset?"reset":"set";N[Q](P,M);if(O){O(N,P,M)}N.trigger("sync",N,P,M)};H(this,M);return this.sync("read",this,M)},create:function(N,M){M=M?L.clone(M):{};if(!(N=this._prepareModel(N,M))){return false}if(!M.wait){this.add(N,M)}var P=this;var O=M.success;M.success=function(Q){if(M.wait){P.add(N,M)}if(O){O(N,Q,M)}};N.save(null,M);return N},parse:function(N,M){return N},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(O,N){if(O instanceof E){if(!O.collection){O.collection=this}return O}N||(N={});N.collection=this;var M=new this.model(O,N);if(!M._validate(O,N)){this.trigger("invalid",this,O,N);return false}return M},_removeReference:function(M){if(this===M.collection){delete M.collection}M.off("all",this._onModelEvent,this)},_onModelEvent:function(O,N,P,M){if((O==="add"||O==="remove")&&P!==this){return}if(O==="destroy"){this.remove(N,M)}if(N&&O==="change:"+N.idAttribute){delete this._byId[N.previous(N.idAttribute)];if(N.id!=null){this._byId[N.id]=N}}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];L.each(y,function(M){c.prototype[M]=function(){var N=n.call(arguments);N.unshift(this.models);return L[M].apply(L,N)}});var k=["groupBy","countBy","sortBy"];L.each(k,function(M){c.prototype[M]=function(P,N){var O=L.isFunction(P)?P:function(Q){return Q.get(P)};return L[M](this.models,O,N)}});var G=z.View=function(M){this.cid=L.uniqueId("view");this._configure(M||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var v=/^(\S+)\s*(.*)$/;var e=["model","collection","el","id","attributes","className","tagName","events"];L.extend(G.prototype,J,{tagName:"div",$:function(M){return this.$el.find(M)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(M,N){if(this.$el){this.undelegateEvents()}this.$el=M instanceof z.$?M:z.$(M);this.el=this.$el[0];if(N!==false){this.delegateEvents()}return this},delegateEvents:function(Q){if(!(Q||(Q=L.result(this,"events")))){return this}this.undelegateEvents();for(var P in Q){var R=Q[P];if(!L.isFunction(R)){R=this[Q[P]]}if(!R){continue}var O=P.match(v);var N=O[1],M=O[2];R=L.bind(R,this);N+=".delegateEvents"+this.cid;if(M===""){this.$el.on(N,R)}else{this.$el.on(N,M,R)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(M){if(this.options){M=L.extend({},L.result(this,"options"),M)}L.extend(this,L.pick(M,e));this.options=M},_ensureElement:function(){if(!this.el){var M=L.extend({},L.result(this,"attributes"));if(this.id){M.id=L.result(this,"id")}if(this.className){M["class"]=L.result(this,"className")}var N=z.$("<"+L.result(this,"tagName")+">").attr(M);this.setElement(N,false)}else{this.setElement(L.result(this,"el"),false)}}});z.sync=function(S,N,M){var P=j[S];L.defaults(M||(M={}),{emulateHTTP:z.emulateHTTP,emulateJSON:z.emulateJSON});var R={type:P,dataType:"json"};if(!M.url){R.url=L.result(N,"url")||r()}if(M.data==null&&N&&(S==="create"||S==="update"||S==="patch")){R.contentType="application/json";R.data=JSON.stringify(M.attrs||N.toJSON(M))}if(M.emulateJSON){R.contentType="application/x-www-form-urlencoded";R.data=R.data?{model:R.data}:{}}if(M.emulateHTTP&&(P==="PUT"||P==="DELETE"||P==="PATCH")){R.type="POST";if(M.emulateJSON){R.data._method=P}var O=M.beforeSend;M.beforeSend=function(T){T.setRequestHeader("X-HTTP-Method-Override",P);if(O){return O.apply(this,arguments)}}}if(R.type!=="GET"&&!M.emulateJSON){R.processData=false}if(R.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){R.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var Q=M.xhr=z.ajax(L.extend(R,M));N.trigger("request",N,Q,M);return Q};var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};z.ajax=function(){return z.$.ajax.apply(z.$,arguments)};var p=z.Router=function(M){M||(M={});if(M.routes){this.routes=M.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var q=/\((.*?)\)/g;var s=/(\(\?)?:\w+/g;var d=/\*\w+/g;var h=/[\-{}\[\]+?.,\\\^$|#\s]/g;L.extend(p.prototype,J,{initialize:function(){},route:function(N,O,P){if(!L.isRegExp(N)){N=this._routeToRegExp(N)}if(L.isFunction(O)){P=O;O=""}if(!P){P=this[O]}var M=this;z.history.route(N,function(R){var Q=M._extractParameters(N,R);P&&P.apply(M,Q);M.trigger.apply(M,["route:"+O].concat(Q));M.trigger("route",O,Q);z.history.trigger("route",M,O,Q)});return this},navigate:function(N,M){z.history.navigate(N,M);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=L.result(this,"routes");var N,M=L.keys(this.routes);while((N=M.pop())!=null){this.route(N,this.routes[N])}},_routeToRegExp:function(M){M=M.replace(h,"\\$&").replace(q,"(?:$1)?").replace(s,function(O,N){return N?O:"([^/]+)"}).replace(d,"(.*?)");return new RegExp("^"+M+"$")},_extractParameters:function(M,N){var O=M.exec(N).slice(1);return L.map(O,function(P){return P?decodeURIComponent(P):null})}});var i=z.History=function(){this.handlers=[];L.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var A=/^[#\/]|\s+$/g;var f=/^\/+|\/+$/g;var I=/msie [\w.]+/;var m=/\/$/;i.started=false;L.extend(i.prototype,J,{interval:50,getHash:function(N){var M=(N||this).location.href.match(/#(.*)$/);return M?M[1]:""},getFragment:function(O,N){if(O==null){if(this._hasPushState||!this._wantsHashChange||N){O=this.location.pathname;var M=this.root.replace(m,"");if(!O.indexOf(M)){O=O.substr(M.length)}}else{O=this.getHash()}}return O.replace(A,"")},start:function(O){if(i.started){throw new Error("Backbone.history has already been started")}i.started=true;this.options=L.extend({},{root:"/"},this.options,O);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var N=this.getFragment();var M=document.documentMode;var Q=(I.exec(navigator.userAgent.toLowerCase())&&(!M||M<=7));this.root=("/"+this.root+"/").replace(f,"/");if(Q&&this._wantsHashChange){this.iframe=z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(N)}if(this._hasPushState){z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!Q){z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=N;var R=this.location;var P=R.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!P){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&P&&R.hash){this.fragment=this.getHash().replace(A,"");this.history.replaceState({},document.title,this.root+this.fragment+R.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);i.started=false},route:function(M,N){this.handlers.unshift({route:M,callback:N})},checkUrl:function(N){var M=this.getFragment();if(M===this.fragment&&this.iframe){M=this.getFragment(this.getHash(this.iframe))}if(M===this.fragment){return false}if(this.iframe){this.navigate(M)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(O){var N=this.fragment=this.getFragment(O);var M=L.any(this.handlers,function(P){if(P.route.test(N)){P.callback(N);return true}});return M},navigate:function(O,N){if(!i.started){return false}if(!N||N===true){N={trigger:N}}O=this.getFragment(O||"");if(this.fragment===O){return}this.fragment=O;var M=this.root+O;if(this._hasPushState){this.history[N.replace?"replaceState":"pushState"]({},document.title,M)}else{if(this._wantsHashChange){this._updateHash(this.location,O,N.replace);if(this.iframe&&(O!==this.getFragment(this.getHash(this.iframe)))){if(!N.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,O,N.replace)}}else{return this.location.assign(M)}}if(N.trigger){this.loadUrl(O)}},_updateHash:function(M,O,P){if(P){var N=M.href.replace(/(javascript:|#).*$/,"");M.replace(N+"#"+O)}else{M.hash="#"+O}}});z.history=new i;var l=function(M,O){var N=this;var Q;if(M&&L.has(M,"constructor")){Q=M.constructor}else{Q=function(){return N.apply(this,arguments)}}L.extend(Q,N,O);var P=function(){this.constructor=Q};P.prototype=N.prototype;Q.prototype=new P;if(M){L.extend(Q.prototype,M)}Q.__super__=N.prototype;return Q};E.extend=c.extend=p.extend=G.extend=i.extend=l;var r=function(){throw new Error('A "url" property or function must be specified')};var H=function(O,N){var M=N.error;N.error=function(P){if(M){M(O,P,N)}O.trigger("error",O,P,N)}}}).call(this);
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/backbone.brace.js' */
/*! 
 *  Backbone Brace - 2013-06-04 
 *  Copyright 2013 Atlassian Software Systems Pty Ltd
 *  Licensed under the Apache License, Version 2.0
 *
 *  Modified by Atlassian
 */
(function(){var l=this;var i=l.Brace;var p;if(typeof exports!=="undefined"){p=exports}else{p=l.Brace={}}p.noConflict=function(){l.Brace=i;return this};var q=l._;if(!q&&(typeof require!=="undefined")){q=require("servicedesk/underscore")}var b=l.Backbone;if(!b&&(typeof require!=="undefined")){b=require("servicedesk/backbone")}function g(t){if(q.isArray(t)){return q.reduce(t,function(u,v){u[v]=null;return u},{})}return t}function e(t,u){if(!t||u==null){return u}if(t===String&&q.isString(u)){return u}if(t===Number&&q.isNumber(u)){return u}if(t===Boolean&&q.isBoolean(u)){return u}if(typeof t==="string"||t instanceof String){if(typeof u!==""+t){throw"The typeof "+u+" is "+typeof u+" but expected it to be "+t}return u}if(q.isArray(t)||t===Array){if(!c(u)){throw"Array type expected, but nonnull, non-Array value provided."}return t===Array||!t[0]?u:q.map(u,q.bind(e,null,t[0]))}if(typeof t!=="function"){throw"Invalid expected type "+t+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(u instanceof t){return u}if(f(t)){return new t(e([t.model],u))}return new t(u)}function f(u,t){return u&&(u.__super__ instanceof (t||b.Collection)||u.__super__===(t||b.Collection).prototype||u===(t||b.Collection))}function c(t){return q.has(t,"length")&&!(t instanceof String||q.has({string:1,"function":1},typeof t)||t instanceof b.Collection)}function o(v,u){var t={};q.each(v,function(x,w){if(!u[w]||h(x,u[w])){t[w]=x}else{if(!x||h(u[w],x)){return}else{throw w+" has conflicted type descriptors."}}});return t}function h(u,t){if(!t||t===u){return true}if(!u||typeof u==="string"){return false}if(u instanceof Array){return t===Array||(t instanceof Array&&h(u[0],t[0]))}if(typeof t!=="function"){return false}if(f(t)){return f(u,t)}return u.prototype instanceof t}function s(t){if(q.isObject(t)){return q.reduce(t,function(u,w,v){if(w&&q.isFunction(w.toJSON)){u[v]=w.toJSON()}else{if(q.isArray(w)){u[v]=q.map(w,function(x){if(x&&q.isFunction(x.toJSON)){return x.toJSON()}else{return x}})}}return u},t)}else{return t}}function j(u){return function t(){var v=u.call(this);var w=v[this.idAttribute]||v.id;if(typeof w!=="undefined"){v.id=w}return s(v)}}p.Mixins={createMethodName:function(t,u){return t+u.charAt(0).toUpperCase()+u.substr(1)},applyMixin:function(u,t){q.forEach(q.keys(t),function(C){var z=u.prototype;if("initialize"===C){var B=z.initialize;z.initialize=function(){if(B){B.apply(this,arguments)}t.initialize.apply(this,arguments)};return}if("validate"===C){var v=z.validate;z.validate=function(){if(v){var E=v.apply(this,arguments);if(E){return E}}return t.validate.apply(this,arguments)};return}if("defaults"===C){var y=z.defaults||(z.defaults={});var A=t[C];for(var x in A){if(y.hasOwnProperty(x)){throw"Mixin error: class already has default '"+x+"' defined"}y[x]=A[x]}return}if("namedAttributes"===C){var w=g(z.namedAttributes)||{};var D=g(t[C]);z.namedAttributes=q.extend(w,o(D,w));return}if("namedEvents"===C){if(!q.isArray(t[C])){throw"Expects events member on mixin to be an array"}if(!z.namedEvents){z.namedEvents=[]}z.namedEvents=q.uniq(z.namedEvents.concat(t[C]));return}if(z.hasOwnProperty(C)){throw"Mixin error: class already has property '"+C+"' defined"}z[C]=t[C]},this)}};p.AttributesMixinCreator={create:function(u){var t={};if(!u){u={}}if(!q.has(u,"id")){u.id=null}q.each(u,function(x,w){var y=p.Mixins.createMethodName("set",w);t[y]=function(A,z){return this.set(w,A,z)};var v=p.Mixins.createMethodName("get",w);t[v]=function(){return this.get(w)}});return t},ensureType:e};p.EventsMixinCreator={create:function(u){var t={};var v=function(x){var w=p.Mixins.createMethodName("on",x);t[w]=function(){return this.on.apply(this,[x].concat(q.toArray(arguments)))};var y=p.Mixins.createMethodName("trigger",x);t[y]=function(){return this.trigger.apply(this,[x].concat(q.toArray(arguments)))}};q.each(u,q.bind(v,this));return t}};function n(u){return function t(x,y){var z;var w=q.extend({},x);var v;if(x&&x.mixins){v=x.mixins;delete w.mixins}z=u.call(this,w,y);if(this.prototype.namedEvents){p.Mixins.applyMixin(z,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){p.Mixins.applyMixin(z,{namedAttributes:this.prototype.namedAttributes})}if(v){q.each(x.mixins,function(A){p.Mixins.applyMixin(z,A)})}if(z.prototype.namedEvents){p.Mixins.applyMixin(z,p.EventsMixinCreator.create(z.prototype.namedEvents))}if(z.prototype.namedAttributes){z.prototype.namedAttributes=g(z.prototype.namedAttributes);p.Mixins.applyMixin(z,p.AttributesMixinCreator.create(z.prototype.namedAttributes))}if(z.prototype.toJSON){z.prototype.toJSON=j(z.prototype.toJSON)}z.extend=t;return z}}function d(x,v){var w=x.prototype;var t=v.prototype;var u=w.set;t.set=function(D,E,C){var B,A=this.namedAttributes;if(!A||D==null){return u.apply(this,arguments)}if(q.isObject(D)){B=q.clone(D);C=E}else{B={};B[D]=E}for(var z in B){if(!q.has(B,z)){continue}if(!q.has(A,z)){throw"Attribute '"+z+"' does not exist"}B[z]=e(A[z],B[z])}return u.call(this,B,C)};var y=w.get;t.get=function(z){if(this.namedAttributes&&!q.has(this.namedAttributes,z)){throw"Attribute '"+z+"' does not exist"}return y.apply(this,arguments)}}function a(x,u){var w=x.prototype;var t=u.prototype;var v=w.parse;t.parse=function(y,z){return q.pick(v(y,z),q.keys(this.namedAttributes))}}function m(t){var v=t.extend();var u=t.extend;v.extend=n(u);return v}function r(t){var u=m(t);d(t,u);a(t,u);return u}p.Model=r(b.Model);p.Collection=m(b.Collection);p.View=m(b.View);p.Router=m(b.Router);var k=function(){this.initialize.apply(this,arguments)};q.extend(k.prototype,b.Events,{initialize:function(){}});k.extend=b.Model.extend;p.Evented=m(k)}());
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/global/setup-backbone.js' */
vp_=_.noConflict();vpBrace=Brace.noConflict();vpBackbone=Backbone.noConflict();
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/trace-AMD.js' */
define("servicedesk/jira/trace",function(){if(typeof JIRA==="undefined"){window.JIRA={}}return JIRA.trace||function(){}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/backbone-AMD.js' */
define("servicedesk/backbone",function(){return vpBackbone});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/backbone.brace-AMD.js' */
define("servicedesk/backbone-brace",["servicedesk/backbone"],function(){return vpBrace});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/underscore-AMD.js' */
define("servicedesk/underscore",function(){return vp_});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/jquery-AMD.js' */
define("servicedesk/jQuery",function(){return AJS.$});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/jquery-serializeobject.js' */
jQuery.fn.sdSerializeObject=function(){var b={};var a=this.find(":input").serializeArray();jQuery.each(a,function(){if(b[this.name]){if(!b[this.name].push){b[this.name]=[b[this.name]]}b[this.name].push(this.value||"")}else{b[this.name]=this.value||""}});return b};
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/vendor/jquery.hoverintent.js' */
(function(a){a.fn.hoverIntent=function(k,j){var l={sensitivity:7,interval:100,timeout:0};l=a.extend(l,j?{over:k,out:j}:k);var n,m,h,d;var e=function(f){n=f.pageX;m=f.pageY};var c=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);if((Math.abs(h-n)+Math.abs(d-m))<l.sensitivity){a(f).unbind("mousemove",e);f.hoverIntent_s=1;return l.over.apply(f,[g])}else{h=n;d=m;f.hoverIntent_t=setTimeout(function(){c(g,f)},l.interval)}};var i=function(g,f){f.hoverIntent_t=clearTimeout(f.hoverIntent_t);f.hoverIntent_s=0;return l.out.apply(f,[g])};var b=function(o){var g=jQuery.extend({},o);var f=this;if(f.hoverIntent_t){f.hoverIntent_t=clearTimeout(f.hoverIntent_t)}if(o.type=="mouseenter"){h=g.pageX;d=g.pageY;a(f).bind("mousemove",e);if(f.hoverIntent_s!=1){f.hoverIntent_t=setTimeout(function(){c(g,f)},l.interval)}}else{a(f).unbind("mousemove",e);if(f.hoverIntent_s==1){f.hoverIntent_t=setTimeout(function(){i(g,f)},l.timeout)}}};return this.bind("mouseenter",b).bind("mouseleave",b)}})(jQuery);
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/app-data.js' */
define("util/app-data",["servicedesk/jQuery"],function(b){var a={objectCache:{},store:{},get:function(d){var e=this.store[d];if(e!==undefined){return e}var c=b("meta[name='"+d+"']");if(c.length===0){c=b("meta[name='ajs-"+d+"']")}if(c.length){e=c.attr("content");this.put(d,e)}return e},getBoolean:function(c){return this.get(c)=="true"},getUsername:function(){return this.get("remote-user")},getObject:function(d){if(!this.objectCache[d]){var c=this.get(d);var f;if(c&&c.length){try{f=JSON.parse(c)}catch(e){}}this.objectCache[d]=f}return this.objectCache[d]},put:function(c,d){this.store[c]=d}};return a});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/ajax.js' */
define("servicedesk/util/ajax",["servicedesk/jQuery","servicedesk/backbone","servicedesk/underscore","servicedesk/analytics/browsermetric/sd-browser-metrics-events","exports"],function(f,j,l,b,e){var c=function(n,o){f(document).trigger(n,o)};function k(p,q,n,t,s,o){var r={url:p,type:q,dataType:n,contentType:t,beforeSend:function(){c(b.agentEvents.START,[p,q])},complete:function(v,w,u){if(u.successful){c(b.agentEvents.END,[p,q,"success"]);if(s){s(v,w,u)}}else{c(b.agentEvents.END,[p,q,"failed"]);if(o){o(v,w,u)}}}};return r}function d(o,q,n){var p=k(o,"GET","json","application/json",q,n);if(l.isObject(o)){p=l.extend(p,o)}else{p.url=o}return JIRA.SmartAjax.makeRequest(p)}function i(o,p,q,n){return h("json",o,p,q,n)}function a(o,p,q,n){return h("html",o,p,q,n)}function h(n,p,q,s,o){var r=k(p,"POST",n,"application/json",s,o);r.data=JSON.stringify(q);r.timeout=180000;return JIRA.SmartAjax.makeRequest(r)}function g(o,p,r,n){var q=k(o,"PUT","json","application/json",r,n);q.data=JSON.stringify(p);return JIRA.SmartAjax.makeRequest(q)}function m(o,q,n){var p=k(o,"DELETE","json","application/json",q,n);return JIRA.SmartAjax.makeRequest(p)}e.get=d;e.post=i;e.postForHtml=a;e.put=g;e.del=m;e.getErrorCollection=function(p){var n;try{n=JSON.parse(p.responseText)}catch(o){n={errors:[{errorMessage:"Something has gone wrong with your request. If symptoms persist contact your System Administrator."}]}}return n}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/meta.js' */
define("servicedesk/util/meta",["servicedesk/jQuery","servicedesk/underscore","exports"],function(e,i,d){var h={};function g(k,l){h[k]=l}function b(l){if(typeof h[l]!="undefined"){return h[l]}var k=e("meta[name='ajs-"+l+"']");if(!k.length){return undefined}var m=k.attr("content");return c(m)}function f(k){return this.get(k)===true}function j(k){return +this.get(k)}function a(){var k={};e("meta[name^=ajs-]").each(function(){k[this.name.substring(4)]=this.content});return e.extend(k,h)}function c(l){var k=l?l.toLowerCase():"";if(k=="true"){return true}if(k=="false"){return false}return l}d.set=g;d.get=b;d.getBoolean=f;d.getNumber=j;d.getAllAsMap=a});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/context-path.js' */
define("servicedesk/util/context-path",["servicedesk/util/meta"],function(a){return a.get("context-path")});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/page-visibility.js' */
define("servicedesk/util/page-visibility",["servicedesk/jQuery","exports"],function(i,h){var f;var g;var d="hidden";var l="visible";var n="atlvisibilitychange";var e=i(document);function k(o){i(document).attr("atlHidden",o)}if(typeof document.hidden!=="undefined"){g="visibilitychange";f="visibilityState"}else{if(typeof document.mozHidden!=="undefined"){g="mozvisibilitychange";f="mozVisibilityState"}else{if(typeof document.msHidden!=="undefined"){g="msvisibilitychange";f="msVisibilityState"}else{if(typeof document.webkitHidden!=="undefined"){g="webkitvisibilitychange";f="webkitVisibilityState"}else{g=n;f="atlVisibilityState";if(document.createEvent){var b=document.createEvent("Event");b.initEvent(g,false,false);var c=i(window);c.focus(function(){k(l);e.trigger(b)});c.blur(function(){k(d);e.trigger(b)})}}}}}var a=function(){k(document[f])};if(g!=n){a();e.on(g,a)}else{if(document.hasFocus){k(document.hasFocus()?l:d)}else{k(l)}}function j(){return e.attr("atlHidden")==l}function m(o){e.on(g,o);return{remove:function(){e.off(g,o)}}}h.HIDDEN=d;h.VISIBLE=l;h.isPageVisible=j;h.addVisibilityChangeEventListener=m});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/common-utils.js' */
define("servicedesk/util/common",["servicedesk/jQuery","exports"],function(b,a){a.goToUrl=function(c){window.location.href=c};a.escapeMarkup=soy.$$escapeHtml;a.patterns={EMAIL:/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/};a.scopeJqlToProject=function(d){var c=AJS.Meta.get("projectKey");var e="project = '"+c+"'";d=d||"";d=b.trim(d);if(d!==""){if(d.toLowerCase().indexOf("order by")===0){e=e+" "+d}else{e=e+" AND "+d}}return e};a.isOpeningInNewTab=function(c){if(!c.altKey&&!c.ctrlKey&&!c.metaKey&&!c.shiftKey){return false}return true};a.parseJSON=function(f){var c;try{c=JSON.parse(f)}catch(d){}return c};a.getMetaKeys=function(c){if(c){return{metaPressed:c.metaKey||c.ctrlKey,shiftPressed:c.shiftKey}}else{return{metaPressed:false,shiftPressed:false}}}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/json-data-provider.js' */
define("servicedesk/util/json-data-provider",["servicedesk/jQuery","exports"],function(d,a){var c=d("meta[name='jsonPayload']").attr("content");var b=c&&JSON.parse(c);a.getAndConsume=function(f){var e=b&&b[f];if(e){delete b[f];return e}}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/agent/sla/util/goal-utils.js' */
define("servicedesk/agent/sla/util/goal-utils",["servicedesk/underscore","servicedesk/util/constants","exports"],function(b,c,a){a.formatGoalFromMillisecond=function(e){if(!(b.isFinite(e)&&e!==0)){return""}var d=Math.floor(e/c.HOUR),f=(e%c.HOUR)/c.MINUTE,g=[];if(d>0){g.push(AJS.format("{0}h",d))}if(f>0){g.push(AJS.format("{0}m",f))}return g.join(" ")}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/build-info.js' */
define("servicedesk/util/build-info",["servicedesk/util/meta"],function(a){return{pluginVersion:a.get("pluginVersion")}});
/* module-key = 'com.atlassian.servicedesk:sd-lib', location = '/servicedesk/util/constants.js' */
define("servicedesk/util/constants",["exports"],function(a){a.MINUTE=60*1000;a.HOUR=60*a.MINUTE});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/model/agent-project-model.js' */
define("servicedesk/shared/model/agent-project-model",["servicedesk/backbone-brace"],function(a){return a.Model.extend({namedAttributes:{key:String,name:String,avatarUrl:String,projectAdmins:Array,allocated:Boolean,isAllocatedByGroup:Boolean,disabledMsg:String,inAccessibleMsg:String,accessible:Boolean,teamRoleMisconfigured:Boolean}})});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/model/agent-project-collection.js' */
define("servicedesk/shared/model/agent-project-collection",["servicedesk/backbone-brace","servicedesk/shared/model/agent-project-model"],function(a,b){return a.Collection.extend({model:b})});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/model/agent-management-error-model.js' */
define("servicedesk/shared/model/agent-management-error-model",["servicedesk/backbone-brace"],function(a){return a.Model.extend({namedAttributes:{runOutOfAgentLicenses:Boolean,readOnlyJIRA:Boolean,agentGroupPreExisting:Boolean,agentGroupPermissionIncorrect:Boolean,outgoingMailConfigured:Boolean,purchaseLink:String,umTroubleshootingLink:String},canAddNewAgent:function(){return !this.getRunOutOfAgentLicenses()&&!this.getReadOnlyJIRA()&&!this.getAgentGroupPreExisting()&&!this.getAgentGroupPermissionIncorrect()&&this.getOutgoingMailConfigured()},canPromoteUser:function(){return !this.getRunOutOfAgentLicenses()&&!this.getReadOnlyJIRA()&&!this.getAgentGroupPreExisting()&&!this.getAgentGroupPermissionIncorrect()}})});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/model/agent-model.js' */
define("servicedesk/shared/model/agent-model",["servicedesk/backbone-brace","servicedesk/util/ajax","servicedesk/jQuery","servicedesk/underscore","servicedesk/shared/model/agent-project-collection"],function(c,b,d,a){return c.Model.extend({namedEvents:["agentUpdatedOnServer","agentCreatedOnServer","agentPromotedFromUser","agentRevokedOnServer"],namedAttributes:{key:String,name:String,canAdministerJira:Boolean,displayName:String,avatarUrls:Object,allocations:Array,groupAllocatedProjects:Object,nonManagedAllocatedProjects:Array,nonManagedLicenseGroups:Array,adminProjects:Array,groupAllocatedAdminProjects:Object,nonManagedAdminProjects:Array},idAttribute:"key",getUrl:function(){return AJS.contextPath()+"/rest/servicedesk/1/servicedesk/admin/agent"},createOnServer:function(f){var e=d.Deferred();b.post(this.getUrl(),{username:f.username,fullname:f.fullname,email:f.email,notification:!!f.notification},a.bind(function(h,i,g){e.resolve(g.data);this.triggerAgentCreatedOnServer()},this),function(g){e.reject(b.getErrorCollection(g))});return e},updateOnServer:function(f){var e=d.Deferred();f.userKey=this.getKey();b.put(this.getUrl(),f,a.bind(function(h,i,g){e.resolve(g.data);this.triggerAgentUpdatedOnServer()},this),function(g){e.reject(b.getErrorCollection(g))});return e},promoteFromUser:function(g){var e=d.Deferred();var f=this.getUrl()+"/promote";var h={userKey:g};b.put(f,h,a.bind(function(j,k,i){e.resolve(i.data);this.triggerAgentPromotedFromUser()},this),function(i){e.reject(b.getErrorCollection(i))});return e},revokeAccess:function(g){var e=d.Deferred();var f=this.getUrl()+"/revoke";var h={userKey:g};b.put(f,h,a.bind(function(j,k,i){e.resolve(i.data);this.triggerAgentRevokedOnServer()},this),function(i){e.reject(b.getErrorCollection(i))});return e},isAllocated:function(){return !!this.getAllocations().length},toJSON:function(){var e=c.Model.prototype.toJSON.call(this);e.nonManagedLicenseGroupsString=e.nonManagedLicenseGroups.join(", ");e.cid=this.cid;return e}})});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/model/agent-collection.js' */
define("servicedesk/shared/model/agent-collection",["servicedesk/backbone-brace","servicedesk/shared/model/agent-model"],function(a,b){return a.Collection.extend({model:b})});
/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/mixin/form/form-mixin.soy' */
// This file was automatically generated from form-mixin.soy.
// Please don't edit this file by hand.

if (typeof ServiceDesk == 'undefined') { var ServiceDesk = {}; }
if (typeof ServiceDesk.Templates == 'undefined') { ServiceDesk.Templates = {}; }
if (typeof ServiceDesk.Templates.Shared == 'undefined') { ServiceDesk.Templates.Shared = {}; }
if (typeof ServiceDesk.Templates.Shared.Form == 'undefined') { ServiceDesk.Templates.Shared.Form = {}; }


ServiceDesk.Templates.Shared.Form.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error shadowed closeable"><p class="title">', soy.$$escapeHtml("Error!"), '</p><span class="aui-icon icon-error"></span>');
  var errorList6 = opt_data.errors;
  var errorListLen6 = errorList6.length;
  for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
    var errorData6 = errorList6[errorIndex6];
    output.append('<p>', soy.$$escapeHtml(errorData6.errorMessage), '</p>');
  }
  output.append((opt_data.isNotAdmin) ? '<p>' + soy.$$escapeHtml("Please contact the system administrator.") + '</p>' : '', '<span class="aui-icon icon-close" role="button" tabindex="0"></span></div>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Shared.Form.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message error shadowed closeable"><p class="title">', soy.$$escapeHtml("Error!"), '</p><span class="aui-icon icon-error"></span><p>', soy.$$escapeHtml(opt_data.error), '</p><p>', soy.$$escapeHtml("Please contact the system administrator."), '</p><span class="aui-icon icon-close" role="button" tabindex="0"></span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.servicedesk:cv-sd-shared', location = '/servicedesk/shared/mixin/form/form-mixin.js' */
define("servicedesk/shared/mixin/form-mixin",["servicedesk/jQuery","servicedesk/underscore"],function(b,a){return{applySDErrorsShimToField:function(d,c){a.each(c.errors,function(e){if(!e.field){e.field=d}});this.applyErrors(c)},applyErrors:function(e,d,f){f=!!f;this.$(".error").remove();if(e){if(e.errors){var g=a.filter(e.errors,function(h){return !h.field});var c=a.filter(e.errors,function(h){return !!h.field});this.applyFieldErrors(c,d);this.applyErrorMessage(g,f)}if(e["status-code"]&&e["status-code"]>400&&e.message){this.applyError(e.message)}}},removeError:function(c){b(c.currentTarget).closest(".error").remove();c.preventDefault()},applyError:function(d){var c=b(ServiceDesk.Templates.Shared.Form.error({error:d}));this._bindRemoveErrorOnClick(c);this.$(".aui-message.error.shadowed.closeable").remove();this.$("form").prepend(c);c.find(".icon-close")},applyErrorMessage:function(e,d){if(e.length){var c=b(ServiceDesk.Templates.Shared.Form.errorMessage({errors:e,isNotAdmin:d}));this._bindRemoveErrorOnClick(c);this.$(".aui-message.error.shadowed.closeable").remove();this.$("form").prepend(c);c[0].scrollIntoView();c.find(".icon-close")}},_bindRemoveErrorOnClick:function(c){var d=c.find(".icon-close");if(d){d.click(this.removeError)}else{c.click(this.removeError)}},applyFieldErrors:function(d,c){c=c||".field-group";a.each(d,function(f){var e=b("<div class='error' />").attr("data-field",f.field).text(f.errorMessage);var g=this.$(":input[name='"+f.field+"'], [data-select2-name='"+f.field+"']");if(g.is(":password")){g.val("")}var h=g.closest(c);h.append(e)},this)},showSpinner:function(){this.$(".js-status").addClass("loading")},hideSpinner:function(){this.$(".js-status").removeClass("loading")},showSuccess:function(d,c){this.$(".js-status").removeClass("loading").addClass("success");if(d){a.delay(a.bind(d,c),800)}},disableSubmit:function(){this.$("form").find(':input[type="submit"]').attr("aria-disabled","aria-disabled");this.$("form").find(':input[type="submit"]').attr("disabled","disabled")},enableSubmit:function(){this.$("form").find(':input[type="submit"]').removeAttr("aria-disabled","aria-disabled");this.$("form").find(':input[type="submit"]').removeAttr("disabled","disabled")}}});
/* module-key = 'com.atlassian.servicedesk:pk-utils', location = '/pocketknife/utils/jira-compat-utils.js' */
if(typeof PK=="undefined"){var PK={}}if(typeof PK.utils=="undefined"){PK.utils={}}PK.utils.JSONStringify=function(b){var a=JSON.stringify(b);if(a&&typeof(a)==="string"){if(/\?\?/.test(a)){var c="\\u003F";a=a.replace(/\?\?/g,c+c)}}return a};PK.utils.setButtonEnabled=function(b,a){if(a){b.removeAttr("aria-disabled");b.removeAttr("disabled")}else{b.attr("aria-disabled","true");b.attr("disabled","disabled")}};
/* module-key = 'com.atlassian.servicedesk:pk-utils', location = '/servicedesk/util/ajax.js' */
define("servicedesk/util/ajax",["servicedesk/jQuery","servicedesk/backbone","servicedesk/underscore","servicedesk/analytics/browsermetric/sd-browser-metrics-events","exports"],function(f,j,l,b,e){var c=function(n,o){f(document).trigger(n,o)};function k(p,q,n,t,s,o){var r={url:p,type:q,dataType:n,contentType:t,beforeSend:function(){c(b.agentEvents.START,[p,q])},complete:function(v,w,u){if(u.successful){c(b.agentEvents.END,[p,q,"success"]);if(s){s(v,w,u)}}else{c(b.agentEvents.END,[p,q,"failed"]);if(o){o(v,w,u)}}}};return r}function d(o,q,n){var p=k(o,"GET","json","application/json",q,n);if(l.isObject(o)){p=l.extend(p,o)}else{p.url=o}return JIRA.SmartAjax.makeRequest(p)}function i(o,p,q,n){return h("json",o,p,q,n)}function a(o,p,q,n){return h("html",o,p,q,n)}function h(n,p,q,s,o){var r=k(p,"POST",n,"application/json",s,o);r.data=JSON.stringify(q);r.timeout=180000;return JIRA.SmartAjax.makeRequest(r)}function g(o,p,r,n){var q=k(o,"PUT","json","application/json",r,n);q.data=JSON.stringify(p);return JIRA.SmartAjax.makeRequest(q)}function m(o,q,n){var p=k(o,"DELETE","json","application/json",q,n);return JIRA.SmartAjax.makeRequest(p)}e.get=d;e.post=i;e.postForHtml=a;e.put=g;e.del=m;e.getErrorCollection=function(p){var n;try{n=JSON.parse(p.responseText)}catch(o){n={errors:[{errorMessage:AJS.I18n.getText("sd.error.ajax.general")}]}}return n}});
/* module-key = 'com.atlassian.servicedesk:spin-js', location = 'backport/aui501/js/external/spin/spin.js' */
!function(i,k,a){var e=["webkit","Moz","ms","O"],p={},o;function g(q,t){var r=k.createElement(q||"div"),s;for(s in t){r[s]=t[s]}return r}function h(r){for(var q=1,s=arguments.length;q<s;q++){r.appendChild(arguments[q])}return r}var j=function(){var q=g("style",{type:"text/css"});h(k.getElementsByTagName("head")[0],q);return q.sheet||q.styleSheet}();function c(u,q,v,y){var r=["opacity",q,~~(u*100),v,y].join("-"),s=0.01+v/y*100,x=Math.max(1-(1-u)/q*(100-s),u),w=o.substring(0,o.indexOf("Animation")).toLowerCase(),t=w&&"-"+w+"-"||"";if(!p[r]){j.insertRule("@"+t+"keyframes "+r+"{0%{opacity:"+x+"}"+s+"%{opacity:"+u+"}"+(s+0.01)+"%{opacity:1}"+(s+q)%100+"%{opacity:"+u+"}100%{opacity:"+x+"}}",j.cssRules.length);p[r]=1}return r}function n(u,v){var t=u.style,q,r;if(t[v]!==a){return v}v=v.charAt(0).toUpperCase()+v.slice(1);for(r=0;r<e.length;r++){q=e[r]+v;if(t[q]!==a){return q}}}function f(q,s){for(var r in s){q.style[n(q,r)||r]=s[r]}return q}function m(s){for(var q=1;q<arguments.length;q++){var r=arguments[q];for(var t in r){if(s[t]===a){s[t]=r[t]}}}return s}function l(q){var r={x:q.offsetLeft,y:q.offsetTop};while((q=q.offsetParent)){r.x+=q.offsetLeft,r.y+=q.offsetTop}return r}var d={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:1/4,fps:20,zIndex:2000000000,className:"spinner",top:"auto",left:"auto",position:"relative"};var b=function b(q){if(!this.spin){return new b(q)}this.opts=m(q||{},b.defaults,d)};b.defaults={};m(b.prototype,{spin:function(x){this.stop();var B=this,q=B.opts,r=B.el=f(g(0,{className:q.className}),{position:q.position,width:0,zIndex:q.zIndex}),A=q.radius+q.length+q.width,C,z;if(x){x.insertBefore(r,x.firstChild||null);z=l(x);C=l(r);f(r,{left:(q.left=="auto"?z.x-C.x+(x.offsetWidth>>1):parseInt(q.left,10)+A)+"px",top:(q.top=="auto"?z.y-C.y+(x.offsetHeight>>1):parseInt(q.top,10)+A)+"px"})}r.setAttribute("aria-role","progressbar");B.lines(r,B.opts);if(!o){var u=0,s=q.fps,w=s/q.speed,v=(1-q.opacity)/(w*q.trail/100),y=w/q.lines;(function t(){u++;for(var D=q.lines;D;D--){var E=Math.max(1-(u+D*y)%w*v,q.opacity);B.opacity(r,q.lines-D,E,q)}B.timeout=B.el&&setTimeout(t,~~(1000/s))})()}return B},stop:function(){var q=this.el;if(q){clearTimeout(this.timeout);if(q.parentNode){q.parentNode.removeChild(q)}this.el=a}return this},lines:function(s,u){var r=0,q;function t(v,w){return f(g(),{position:"absolute",width:(u.length+u.width)+"px",height:u.width+"px",background:v,boxShadow:w,transformOrigin:"left",transform:"rotate("+~~(360/u.lines*r+u.rotate)+"deg) translate("+u.radius+"px,0)",borderRadius:(u.corners*u.width>>1)+"px"})}for(;r<u.lines;r++){q=f(g(),{position:"absolute",top:1+~(u.width/2)+"px",transform:u.hwaccel?"translate3d(0,0,0)":"",opacity:u.opacity,animation:o&&c(u.opacity,u.trail,r,u.lines)+" "+1/u.speed+"s linear infinite"});if(u.shadow){h(q,f(t("#000","0 0 4px #000"),{top:2+"px"}))}h(s,h(q,t(u.color,"0 0 1px rgba(0,0,0,.1)")))}return s},opacity:function(r,q,s){if(q<r.childNodes.length){r.childNodes[q].style.opacity=s}}});(function(){function q(t,s){return g("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',s)}var r=f(g("group"),{behavior:"url(#default#VML)"});if(!n(r,"transform")&&r.adj){j.addRule(".spin-vml","behavior:url(#default#VML)");b.prototype.lines=function(v,u){var t=u.length+u.width,B=2*t;function A(){return f(q("group",{coordsize:B+" "+B,coordorigin:-t+" "+-t}),{width:B,height:B})}var w=-(u.width+u.length)*2+"px",z=f(A(),{position:"absolute",top:w,left:w}),y;function x(C,s,D){h(z,h(f(A(),{rotation:360/u.lines*C+"deg",left:~~s}),h(f(q("roundrect",{arcsize:u.corners}),{width:t,height:u.width,left:u.radius,top:-u.width>>1,filter:D}),q("fill",{color:u.color,opacity:u.opacity}),q("stroke",{opacity:0}))))}if(u.shadow){for(y=1;y<=u.lines;y++){x(y,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(y=1;y<=u.lines;y++){x(y)}return h(v,z)};b.prototype.opacity=function(t,s,v,u){var w=t.firstChild;u=u.shadow&&u.lines||0;if(w&&s+u<w.childNodes.length){w=w.childNodes[s+u];w=w&&w.firstChild;w=w&&w.firstChild;if(w){w.opacity=v}}}}else{o=n(r,"animation")}})();if(typeof define=="function"&&define.amd){define(function(){return b})}else{i.Spinner=b}}(window,document);
/* module-key = 'com.atlassian.servicedesk:spin-js', location = 'backport/aui501/js/external/jquery/jquery.spin.js' */
(function(a){a.fn.spin=function(e,d){var c,b;if(typeof e==="string"){if(!e in a.fn.spin.presets){throw new Error("Preset '"+e+"' isn't defined")}c=a.fn.spin.presets[e];b=d||{}}else{if(d){throw new Error("Invalid arguments. Accepted arguments:\n$.spin([String preset[, Object options]]),\n$.spin(Object options),\n$.spin(Boolean shouldSpin)")}c=a.fn.spin.presets.small;b=a.isPlainObject(e)?e:{}}if(window.Spinner){return this.each(function(){var g=a(this),f=g.data();if(f.spinner){f.spinner.stop();delete f.spinner}if(e===false){return}b=a.extend({color:g.css("color")},c,b);f.spinner=new Spinner(b).spin(this)})}else{throw"Spinner class not available."}};a.fn.spin.presets={small:{lines:12,length:3,width:2,radius:3,trail:60,speed:1.5},medium:{lines:12,length:5,width:3,radius:8,trail:60,speed:1.5},large:{lines:12,length:8,width:4,radius:10,trail:60,speed:1.5}};a.fn.spinStop=function(){if(window.Spinner){return this.each(function(){var c=a(this),b=c.data();if(b.spinner){b.spinner.stop();delete b.spinner}})}else{throw"Spinner class not available."}}})(jQuery);
/* module-key = 'com.atlassian.servicedesk:servicedesk-global', location = '/servicedesk/global/servicedesk-global.js' */
AJS.$(function viewportGlobalReady(d){var b=require("servicedesk/util/tracking");var f=require("servicedesk/admin/create/create-servicedesk-view");JIRA.Dialogs.globalAddViewport=new JIRA.FormDialog({id:"create-service-desk-dialog",trigger:".sd-create",content:function(g){f.render().done(g)},width:840});new JIRA.FormDialog({id:"create-request-dialog",trigger:"#servicedesk-request-portal-link_lnk, #createRequest-menu, .request-portal, a.lnk#servicedesk-section",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions});var c=d("body");c.on("click","#servicedesk-request-portal-link_lnk",function(){b.trackPageview("/header/sd/ticket")});c.on("click","#servicedesk-list-link_lnk",function(){b.trackPageview("/header/sd/list")});c.on("click","#servicedesk-admin-create-link_lnk",function(){b.trackPageview("/header/sd/create")});c.on("click","#servicedesk-section",function(){b.trackPageview("/header/sd/topmenu")});d(".input-file input").focus(function a(){d(this).parent().addClass("is-focused")}).blur(function e(){d(this).parent().removeClass("is-focused")})});
/* module-key = 'com.atlassian.servicedesk:servicedesk-global', location = '/servicedesk/global/request-portals.soy' */
// This file was automatically generated from request-portals.soy.
// Please don't edit this file by hand.

if (typeof ServiceDesk == 'undefined') { var ServiceDesk = {}; }
if (typeof ServiceDesk.Templates == 'undefined') { ServiceDesk.Templates = {}; }
if (typeof ServiceDesk.Templates.Global == 'undefined') { ServiceDesk.Templates.Global = {}; }


ServiceDesk.Templates.Global.requestPortalForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui top-label"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Create Service Desk Request"), '</h2>');
  if (opt_data.serviceDesks.length > 0) {
    output.append('<p>', soy.$$escapeHtml("You can raise a ticket through one of the following Service Desks"), '</p><ul>');
    var sdList11 = opt_data.serviceDesks;
    var sdListLen11 = sdList11.length;
    for (var sdIndex11 = 0; sdIndex11 < sdListLen11; sdIndex11++) {
      var sdData11 = sdList11[sdIndex11];
      output.append('<li><a data-key="', soy.$$escapeHtml(sdData11.key), '" href="', soy.$$escapeHtml(""), '/servicedesk/customer/', soy.$$escapeHtml(sdData11.key), '">', soy.$$escapeHtml(sdData11.name), '</a></li>');
    }
    output.append('</ul>');
  } else {
    output.append('<div class="aui-message"><p class="title"><span class="aui-icon icon-generic"></span><strong>', soy.$$escapeHtml("No Requests"), '</strong></p><p>', soy.$$escapeHtml("There are no requests or Service Desks. Please contact your administrator if this is not correct."), '</p></div>');
  }
  output.append('</div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.servicedesk:servicedesk-global', location = '/servicedesk/admin/create/create-service-desk.soy' */
// This file was automatically generated from create-service-desk.soy.
// Please don't edit this file by hand.

if (typeof ServiceDesk == 'undefined') { var ServiceDesk = {}; }
if (typeof ServiceDesk.Templates == 'undefined') { ServiceDesk.Templates = {}; }
if (typeof ServiceDesk.Templates.Admin == 'undefined') { ServiceDesk.Templates.Admin = {}; }
if (typeof ServiceDesk.Templates.Admin.CreateServiceDesk == 'undefined') { ServiceDesk.Templates.Admin.CreateServiceDesk = {}; }


ServiceDesk.Templates.Admin.CreateServiceDesk.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-close-dialog sd-gs-close-button cancel">', soy.$$escapeHtml("Close"), '</span><h2 class="dialog-title">', (opt_data.isLicenseCountExceeded || opt_data.isEligibleForPromotion && (! opt_data.isUserDirWritable || ! opt_data.hasValidAgentGroup)) ? soy.$$escapeHtml("Error creating a service desk") : (opt_data.isEligibleForPromotion && opt_data.areAllLicensesUsed) ? soy.$$escapeHtml("Problem creating a Service Desk") : soy.$$escapeHtml("Create a Service Desk"), '</h2>');
  ServiceDesk.Templates.Admin.CreateServiceDesk.page(opt_data, output);
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.page = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.isLicenseCountExceeded) {
    ServiceDesk.Templates.Admin.CreateServiceDesk.warnLicenseExceeded(opt_data, output);
  } else if (opt_data.isEligibleForPromotion && opt_data.areAllLicensesUsed) {
    ServiceDesk.Templates.Admin.CreateServiceDesk.promoteErrorNoLicenses(opt_data, output);
  } else if (opt_data.isEligibleForPromotion && (! opt_data.isUserDirWritable || ! opt_data.hasValidAgentGroup)) {
    ServiceDesk.Templates.Admin.CreateServiceDesk.promoteErrorMisconfigured(opt_data, output);
  } else {
    if (opt_data.isEligibleForPromotion && ! opt_data.isFirstEvaluator) {
      ServiceDesk.Templates.Admin.CreateServiceDesk.promoteAdminInfo(null, output);
    }
    output.append('<div class="sd-gs-container-errors" id="error-container" style="display: none;"><div class="aui-message error"><span class="aui-icon icon-error"></span><ul></ul></div></div><div class="sd-gs-container"><div class="sd-gs-sections sd-gsnew-panel sd-gsnew-switch"><div class="sd-gs-buttons">');
    if (opt_data.isAdmin) {
      ServiceDesk.Templates.Admin.CreateServiceDesk.createSDProjectButton(opt_data, output);
    } else {
      if (opt_data.projects.length > 0) {
        ServiceDesk.Templates.Admin.CreateServiceDesk.enableSDProjectButton(opt_data, output);
      } else {
        output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("There are no projects for which you are able to enable Service Desk at the moment."), '</p></div>');
      }
    }
    output.append('</div><div class="hidden aui sd-gs-create-existing-container"></div><div class="hidden sd-gs-create-new"></div></div><div class="sd-gs-sections sd-gsnew-panel sd-gsnew-value-prop"><p>', soy.$$escapeHtml("Start out with Service Desk immediately!"), '</p><ul><li>', soy.$$escapeHtml("Get a Service Desk workflow and issue types out of the box"), '</li><li>', soy.$$escapeHtml("Report on historical information from existing data"), '</li><li>', soy.$$escapeHtml("Add functionality like Customer Portal and SLAs without affecting your existing project configuration"), '</li></ul></div></div>');
  }
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.warnLicenseExceeded = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-container-errors"><div class="aui-message error"><span class="aui-icon icon-error"></span><p>', soy.$$escapeHtml("You are not able to create a service desk because the number of agents has exceeded the number of agents your JIRA Service Desk is licensed for."), '</p>', (opt_data.isAdmin) ? '<p><a href="' + soy.$$escapeHtml("") + '/secure/admin/AgentAllocation.jspa">' + soy.$$escapeHtml("You can free up a license at JIRA Administration - Service Desk Agents.") + '</a><p>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.promoteErrorNoLicenses = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-container-errors"><div class="aui-message warning"><span class="aui-icon icon-warning"></span><p>', soy.$$escapeHtml("In order for you to create a service desk, you will be allocated an agent license. However, you have reached your JIRA Service Desk license seats for agents."), '</p>', (opt_data.isAdmin) ? '<p><a href="' + soy.$$escapeHtml("") + '/secure/admin/AgentAllocation.jspa">' + soy.$$escapeHtml("You can free up a license at JIRA Administration - Service Desk Agents.") + '</a><p>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.promoteErrorMisconfigured = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-container-errors"><div class="aui-message error"><span class="aui-icon icon-error"></span><p>', (! opt_data.isUserDirWritable) ? soy.$$escapeHtml("In order for you to create a service desk, you need to be allocated an agent license, which requires an update of the user directory. The user directory connected to JIRA is read-only and therefore the service desk cannot be created.") : (! opt_data.hasValidAgentGroup) ? soy.$$escapeHtml("In order for you to create a service desk, you need to be allocated an agent license. However, this is not possible because the agents group is misconfigured.") : '', '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.promoteAdminInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-messages"><div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("In order for you to use this service desk functionality, you will be allocated an agent license. You can manage license allocation"), '&nbsp;<a href="', soy.$$escapeHtml(""), '/secure/admin/AgentAllocation.jspa" target="_tab">', soy.$$escapeHtml("here"), '</a></p></div></div>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.fromExisting = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui top-label sd-gs-form-eap"><div class="sd-gs-create-existing-inner"><div class="field-group"><label for="sd-Project">', soy.$$escapeHtml("Select a project"), '</label><select class="select" name="projectKey" id="sd-Project">');
  var projectList96 = opt_data.projects;
  var projectListLen96 = projectList96.length;
  for (var projectIndex96 = 0; projectIndex96 < projectListLen96; projectIndex96++) {
    var projectData96 = projectList96[projectIndex96];
    output.append('<option value="', soy.$$escapeHtml(projectData96.key), '">', soy.$$escapeHtml(projectData96.name), '</option>');
  }
  output.append('</select></div><div class="field-group"><div class="spinner sd-gs-spinner"></div><button type="submit" accesskey="', soy.$$escapeHtml("s"), '" class="sd-existing-submit aui-button aui-button-primary" name="enable" > ', soy.$$escapeHtml("Enable"), '</button><a class="sd-cancel-create cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div><div class="errors"></div></form>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.fromNew = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui top-label sd-gs-form-eap"><div class="field-group"><label for="project-name">', soy.$$escapeHtml("Name your service desk project"), '</label><input id="project-name" name="projectName" type="text" class="text" /></div><div class="field-group"><label for="project-key">', soy.$$escapeHtml("Pick a unique key"), '</label><div class="sd-gs-key-field"><input id="project-key" name="projectKey" type="text" class="text" /> <a href="#" class="aui-icon project-key-help icon-help"></a></div></div><div class="field-group"><div class="spinner sd-gs-spinner"></div><button type="submit" accesskey="', soy.$$escapeHtml("s"), '" class="aui-button aui-button-primary" > ', soy.$$escapeHtml("Create"), '</button><a class="sd-cancel-create cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div><div class="errors"></div></form>');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.createSDProjectButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-button-container"><a href="#" class="sd-createnew-button aui-button aui-button-primary">', soy.$$escapeHtml("New Service Desk Project"), '</a></div>', (opt_data.projects.length > 0) ? '<div class="sd-gs-description"><span>' + soy.$$escapeHtml("or") + ' </span><a href="#" class="sd-existing-button aui-button aui-button-link">' + soy.$$escapeHtml("Enable for existing project") + '</a></div>' : '');
  return opt_sb ? '' : output.toString();
};


ServiceDesk.Templates.Admin.CreateServiceDesk.enableSDProjectButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-gs-button-container"><a href="#" class="sd-existing-button aui-button aui-button-primary">', soy.$$escapeHtml("Enable for existing project"), '</a></div><div class="sd-gs-description"><span>', soy.$$escapeHtml("To create a new Service Desk project, please contact your JIRA administrator."), '</span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.servicedesk:servicedesk-global', location = '/servicedesk/admin/create/create-servicedesk-view.js' */
define("servicedesk/admin/create/create-servicedesk-view",["servicedesk/jQuery","servicedesk/backbone-brace","servicedesk/underscore","servicedesk/util/ajax","servicedesk/util/common","servicedesk/util/tracking","exports"],function(d,g,j,f,i,h,c){var l=g.Model.extend({});var b=function(m,n){return{submit:function(p){var o=d(p.target).sdSerializeObject();PK.utils.setButtonEnabled(this.$el.find(":submit"),false);this.$el.addClass("loading");d(".sd-gs-container .spinner").spin();this._hideGenericError();f.post(AJS.contextPath()+m,o).done(j.bind(this.success,this)).fail(j.bind(this.error,this));p.preventDefault()},success:function(o){AJS.Cookie.save("sd.create.first","true");h.trackPageview("/admin/servicedesk/enable/"+n);i.goToUrl(AJS.contextPath()+"/servicedesk/agent/"+o.projectKey+"/queues")},error:function(q){this.$(".error").remove();if(q.responseText){var p=JSON.parse(q.responseText).errors;j.each(p,j.bind(function(t){var s=this.$(":input[name='"+t.field+"']");if(s&&s.size()){var r=d("<div />").addClass("error").text(t.errorMessage);r.appendTo(s.parent())}else{this._showGenericError(t.errorMessage)}},this))}else{var o=d("<div />").addClass("error").text("An error has occurred, we are unsure about the state of this operation. Refresh the page and try again.");o.appendTo(this.$(".errors"))}PK.utils.setButtonEnabled(this.$el.find(":submit"),true);d(".sd-gs-container .spinner").spinStop()},complete:function(){this.$el.removeClass("loading")},_showGenericError:function(p){var r=d("#error-container").show();var q=r.find("ul");var o=d("<li />").addClass("error").text(p);o.appendTo(q)},_hideGenericError:function(o){d("#error-container").hide();var q=d("#error-container");var p=q.find("ul");p.empty()}}};var a=g.View.extend({mixins:[b("/rest/servicedesk/1/servicedesk","existing")],template:ServiceDesk.Templates.Admin.CreateServiceDesk.fromExisting,events:{submit:"submit"},bindSingleSelect:function(){var m=this.$("#sd-Project");if(!m.data("ss-bound")){m.data("ss-bound",true);new AJS.SingleSelect({element:m,itemAttrDisplayed:"label"})}},render:function(){this.$el.html(this.template(this.model.toJSON())).removeClass("hidden").show();this.bindSingleSelect();this.$el.find(":input:visible:first").focus()}});var k=g.View.extend({mixins:[b("/rest/servicedesk/1/servicedesk/gettingstarted","new")],template:ServiceDesk.Templates.Admin.CreateServiceDesk.fromNew,events:{"input #project-name":"generateProjectKey","input #project-key":"uppercaseProjectKey","click .sd-cancel-create":"clear",submit:"submit"},initialize:function(){this.keygen=new JIRA.ProjectKeyGenerator({desiredKeyLength:4,maxKeyLength:10})},clear:function(){this.$(":text").val("")},bindKeyHelp:function(){new AJS.InlineDialog(this.$(".project-key-help"),"project-key-help-popup",function(o,n,m){o.html(JIRA.Templates.CreateProject.keyHelp());m()},{width:330,offsetX:-30})},generateProjectKey:function(n){var m=d(n.target).val();this.$("#project-key").val(this.keygen.generateKey(m))},uppercaseProjectKey:function(n){var m=d(n.target).val();this.$("#project-key").val(m.toUpperCase())},render:function(){this.$el.html(this.template(this.model.toJSON())).removeClass("hidden").show();this.$el.find(":input:visible:first").focus();this.bindKeyHelp()}});var e=g.View.extend({events:{"click .sd-existing-button":"enableFromExisting","click .sd-createnew-button":"enableFromScratch","click .sd-gs-close-button":"hideDialog","click .sd-cancel-create":"showOptions"},template:ServiceDesk.Templates.Admin.CreateServiceDesk.dialog,initialize:function(){this.fromExistingView=new a({model:this.model});this.fromScratchView=new k({model:this.model})},hideDialog:function(m){JIRA.Dialogs.globalAddViewport.hide();m.preventDefault()},showOptions:function(m){this.fromScratchView.$el.hide();this.fromExistingView.$el.hide();this.$createOptions.show();m.preventDefault()},enableFromExisting:function(m){this.$createOptions.hide();this.fromScratchView.$el.hide();this.fromExistingView.render();m.preventDefault()},enableFromScratch:function(m){this.$createOptions.hide();this.fromExistingView.$el.hide();this.fromScratchView.render();m.preventDefault()},render:function(){this.$el.html(this.template(this.model.toJSON()));this.fromExistingView.setElement(this.$(".sd-gs-create-existing-container"));this.fromScratchView.setElement(this.$(".sd-gs-create-new"));this.$createOptions=this.$(".sd-gs-buttons");return this.$el}});c.render=function(n){var m=d.Deferred();f.get(AJS.contextPath()+"/rest/servicedesk/1/servicedesk/gettingstarted",j.bind(function(s,o,q){var r=new e({model:new l(q.data),el:n});var p=r.render();m.resolve(p)}));return m.promise()};c.registerUtils=function(m){i=m}});
/* module-key = 'com.atlassian.servicedesk:sd-create-kb-view-issue-resource', location = '/servicedesk/components/kblabelselect/kblabelselect.js' */
define("servicedesk/components/kblabelselect",["servicedesk/jQuery","exports"],function(b,a){return JIRA.LabelPicker.extend({_getDefaultOptions:function(){return b.extend(true,this._super(),{ajaxOptions:{projectKey:"",url:function(){var c=this.projectKey;if(typeof c==="function"){c=c()}return contextPath+"/rest/servicedesk/1/servicedesk/"+c+"/kb/labels"},query:true,formatResponse:this._formatResponse}})},_formatResponse:function(d){var c=new AJS.GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(d&&d.contentNameMatches&&d.contentNameMatches.length>0){b.each(d.contentNameMatches[0],function(){c.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:AJS.escapeHtml(this.name),highlighted:true}))})}return[c]}})});
/* module-key = 'com.atlassian.servicedesk:sd-create-kb-view-issue-resource', location = '/servicedesk/agent/knowledgebase/createkb/create-kb.js' */
define("servicedesk/admin/createkb/create-kb",["servicedesk/jQuery","servicedesk/backbone-brace","servicedesk/underscore","servicedesk/components/kblabelselect","servicedesk/util/common","servicedesk/util/ajax","servicedesk/util/tracking","exports"],function(f,i,l,g,k,h,j,e){var b=i.Model.extend({namedAttributes:{issueId:Number,projectKey:String,labels:Array,title:String}});var d=function(){var m=JIRA.Issue.getIssueKey();return m.substring(0,m.indexOf("-"))};var c=function(){return AJS.contextPath()+"/rest/servicedesk/1/servicedesk/"+d()+"/kb/create-draft"};var a=i.View.extend({template:ServiceDesk.Templates.Admin.CreateKB.dialog,events:{"click .sd-cancel-create-kb":"close",submit:"submit"},disable:function(){this.undelegateEvents()},close:function(m){this.disable();this.options.dialog.closeRequested=true;this.options.dialog.hide();m.preventDefault()},initLabelPicker:function(){var m=this;var n=this.$("#kb-labels");if(!n.data("ss-bound")){n.data("ss-bound",true);this.labelPicker=new g({element:n,submitInputVal:true,width:250,ajaxOptions:{projectKey:function(){var o=JIRA.Issue.getIssueKey();return o.substring(0,o.indexOf("-"))},error:function(q,r,p,o){m._addErrors(o.data)}}});this.labelPicker._addMultipleItems(l.map(this.model.getLabels(),function(o){return new AJS.ItemDescriptor({label:o,value:o,title:o})},this))}},initSingleSelect:function(){var m=this.$("#kb-template");this.singleSelect=new AJS.SingleSelect({element:m,itemAttrDisplayed:"label",width:250,revertOnInvalid:true})},submit:function(q){j.trackPageview("/viewissue/kb/createdraft/submit");var n=c();var p=f(q.target).sdSerializeObject();var r=JIRA.Issue.getIssueId();var m=p.articleSummary||"";m=f.trim(m).substring(0,255);var o={issueId:r,template:p.templateKey,title:m,labels:""};l.each(this.labelPicker.lozengeGroup.items,function(s){o.labels+=" "+s.value});PK.utils.setButtonEnabled(this.$el.find(":submit"),false);this.$el.addClass("loading");f(".sd-kb-container .spinner").spin();h.post(n,o).done(l.bind(this.success,this)).fail(l.bind(this.error,this));q.preventDefault()},success:function(m){k.goToUrl(m.url)},error:function(m){this._addErrors(m.responseText);PK.utils.setButtonEnabled(this.$el.find(":submit"),true);f(".sd-kb-container .spinner").spinStop()},_addErrors:function(q){var n=this.$(".errors");n.empty();if(q){var p=JSON.parse(q);if(p.errors){var o=p.errors;l.each(o,l.bind(function(s){var r=f("<div />").addClass("error").text(s.errorMessage);r.appendTo(n)}))}else{if(p.message){n.append(f("<div />").addClass("error").text(p.message))}}}else{var m=f("<div />").addClass("error").text("An error has occurred, we are unsure about the state of this operation. Refresh the page and try again.");m.appendTo(this.$(".errors"))}},complete:function(){this.$el.removeClass("loading")},render:function(){var m={title:this.model.getTitle()};this.$el.html(this.template(m)).removeClass("hidden").show()},focus:function(){this.initLabelPicker();this.initSingleSelect();this.$el.find(":input:visible:first").focus()}});e.register=function(n){if(!n.length){return}var m=AJS.InlineDialog(n,"createKBDialog",function(p,o,r){m.closeRequested=false;j.trackPageview("/viewissue/kb/createdraft/opendialog");var q={url:c(),data:{issueId:JIRA.Issue.getIssueId()}};h.get(q,function(v,w,u){var t=new b(u.data);var s=new a({el:p,model:t,dialog:m});s.render();r();setTimeout(function(){s.focus()},0)})},{hideDelay:null,persistent:true,preHideCallback:function(){return m.closeRequested||!!JIRA.Dialog.current}});return m}});
/* module-key = 'com.atlassian.servicedesk:sd-create-kb-view-issue-resource', location = '/servicedesk/agent/knowledgebase/createkb/create-kb.soy' */
// This file was automatically generated from create-kb.soy.
// Please don't edit this file by hand.

if (typeof ServiceDesk == 'undefined') { var ServiceDesk = {}; }
if (typeof ServiceDesk.Templates == 'undefined') { ServiceDesk.Templates = {}; }
if (typeof ServiceDesk.Templates.Admin == 'undefined') { ServiceDesk.Templates.Admin = {}; }
if (typeof ServiceDesk.Templates.Admin.CreateKB == 'undefined') { ServiceDesk.Templates.Admin.CreateKB = {}; }


ServiceDesk.Templates.Admin.CreateKB.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="sd-kb-container"><form class="aui top-label"><div class="field-group"><label for="kb-primary-problem">', soy.$$escapeHtml("Primary problem / desired outcome"), '</label><input id="kb-primary-problem" name="articleSummary" type="text" class="text" value="', soy.$$escapeHtml(opt_data.title), '" maxlength="255" /></div><div class="field-group"><label for="kb-labels">', soy.$$escapeHtml("Labels"), '</label><select id="kb-labels" multiple="articleLabels" class="hidden"></select></div><div class="field-group"><label for="kb-template">', soy.$$escapeHtml("Template"), '</label><select class="select" id="kb-template" name="templateKey"><option selected="selected" value="com.atlassian.confluence.plugins.confluence-knowledge-base:kb-troubleshooting-article-blueprint" label="', soy.$$escapeHtml("Troubleshooting"), '">', soy.$$escapeHtml("Troubleshooting"), '</option><option value="com.atlassian.confluence.plugins.confluence-knowledge-base:kb-how-to-article-blueprint" label="', soy.$$escapeHtml("How-To"), '">', soy.$$escapeHtml("How-To"), '</option></select></div><div class="field-group sd-button-group"><div class="spinner sd-gs-spinner"></div><button type="submit" accesskey="', soy.$$escapeHtml("s"), '" class="aui-button aui-button-primary" > ', soy.$$escapeHtml("Create"), '</button><a class="cancel sd-cancel-create-kb" href="#">Cancel</a></div><div class="errors"></div></form></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.servicedesk:sd-create-kb-view-issue-resource', location = '/servicedesk/agent/knowledgebase/createkb/sd-create-kb-viewissue.js' */
jQuery(function(d){var e=require("servicedesk/admin/createkb/create-kb");var a="#sd-create-kb-link";var c="#inline-dialog-createKBDialog";var b;d(document).ready(function(){var f=function(){window.JIRA||(window.JIRA={});window.JIRA.Issues||(window.JIRA.Issues={});window.JIRA.Issues.IntroDialog||(window.JIRA.Issues.IntroDialog={});window.JIRA.Issues.IntroDialog.dialogs||(window.JIRA.Issues.IntroDialog.dialogs={});var g=d(a);if(b){g.off("click");b.detach();d(c).remove()}b=e.register(g)};f();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,f)})});
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();
/* module-key = 'com.atlassian.gadgets.embedded:gadget-standalone-resources', location = 'js/gadgets-standalone.js' */
new gadgets.IfrGadgetService();gadgets.IfrGadgetService.prototype.setTitle=function(title){};
/* module-key = 'net.customware.plugins.connector.atlassian.jira-connector-plugin:commentbutton-js', location = 'net/customware/plugins/connector/jira/issue/comment/comment.js' */
AJS.$(document).ready(function(){AJS.$(".activity-comment .action-links").append('<a href="#" title="Publish this comment to linked systems" class="connector-push-comment"></a>');AJS.$(document).delegate("a.connector-push-comment","click",function(c){c.preventDefault();var a=AJS.$(c.target);var f=AJS.$("#key-val").attr("rel");var e=a.parents(".activity-comment");if(e.length>0){var b=e[0].id.substring(8);var d=contextPath+"/plugins/servlet/customware/connector/comment/pushcomment.action?id="+b;var g="publish-comment-"+b+"-dialog";a.attr("id","publish-comment-"+b+"-trigger");if(!JIRA.Dialogs[g]){JIRA.Dialogs[g]=new JIRA.FormDialog({id:g,trigger:"#publish-comment-"+b+"-trigger",url:d,handleRedirect:true,ajaxOptions:{data:{decorator:"dialog",inline:"true"},url:d},onSuccessfulSubmit:function(){},issueMsg:"connector_comment_pushed",onContentRefresh:function(){}});JIRA.Dialogs[g].show()}}})});
/* module-key = 'jira.webresources:jquery-easing', location = '/includes/jquery/plugins/easing/jquery.easing.1.3.js' */
jQuery.easing["jswing"]=jQuery.easing["swing"];jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return jQuery.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}});
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox-1.3.4.js' */
(function($){var tmp,loading,overlay,wrap,outer,content,close,title,nav_left,nav_right,selectedIndex=0,selectedOpts={},selectedArray=[],currentIndex=0,currentOpts={},currentArray=[],ajaxLoader=null,imgPreloader=new Image(),imgRegExp=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,swfRegExp=/[^\.]\.(swf)\s*$/i,loadingTimer,loadingFrame=1,titleHeight=0,titleStr="",start_pos,final_pos,busy=false,fx=$.extend($("<div/>")[0],{prop:0}),isIE6=$.browser.msie&&$.browser.version<7&&!window.XMLHttpRequest,_abort=function(){loading.hide();imgPreloader.onerror=imgPreloader.onload=null;if(ajaxLoader){ajaxLoader.abort()}tmp.empty()},_error=function(){if(false===selectedOpts.onError(selectedArray,selectedIndex,selectedOpts)){loading.hide();busy=false;return }selectedOpts.titleShow=false;selectedOpts.width="auto";selectedOpts.height="auto";tmp.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');_process_inline()},_start=function(){var obj=selectedArray[selectedIndex],href,type,title,str,emb,ret;_abort();selectedOpts=$.extend({},$.fn.fancybox.defaults,(typeof $(obj).data("fancybox")=="undefined"?selectedOpts:$(obj).data("fancybox")));ret=selectedOpts.onStart(selectedArray,selectedIndex,selectedOpts);if(ret===false){busy=false;return }else{if(typeof ret=="object"){selectedOpts=$.extend(selectedOpts,ret)}}title=selectedOpts.title||(obj.nodeName?$(obj).attr("title"):obj.title)||"";if(obj.nodeName&&!selectedOpts.orig){selectedOpts.orig=$(obj).children("img:first").length?$(obj).children("img:first"):$(obj)}if(title===""&&selectedOpts.orig&&selectedOpts.titleFromAlt){title=selectedOpts.orig.attr("alt")}href=selectedOpts.href||(obj.nodeName?$(obj).attr("href"):obj.href)||null;if((/^(?:javascript)/i).test(href)||href=="#"){href=null}if(selectedOpts.type){type=selectedOpts.type;if(!href){href=selectedOpts.content}}else{if(selectedOpts.content){type="html"}else{if(href){if(href.match(imgRegExp)){type="image"}else{if(href.match(swfRegExp)){type="swf"}else{if($(obj).hasClass("iframe")){type="iframe"}else{if(href.indexOf("#")===0){type="inline"}else{type="ajax"}}}}}}}if(!type){_error();return }if(type=="inline"){obj=href.substr(href.indexOf("#"));type=$(obj).length>0?"inline":"ajax"}selectedOpts.type=type;selectedOpts.href=href;selectedOpts.title=title;if(selectedOpts.autoDimensions){if(selectedOpts.type=="html"||selectedOpts.type=="inline"||selectedOpts.type=="ajax"){selectedOpts.width="auto";selectedOpts.height="auto"}else{selectedOpts.autoDimensions=false}}if(selectedOpts.modal){selectedOpts.overlayShow=true;selectedOpts.hideOnOverlayClick=false;selectedOpts.hideOnContentClick=false;selectedOpts.enableEscapeButton=false;selectedOpts.showCloseButton=false}selectedOpts.padding=parseInt(selectedOpts.padding,10);selectedOpts.margin=parseInt(selectedOpts.margin,10);tmp.css("padding",(selectedOpts.padding+selectedOpts.margin));$(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){$(this).replaceWith(content.children())});switch(type){case"html":tmp.html(selectedOpts.content);_process_inline();break;case"inline":if($(obj).parent().is("#fancybox-content")===true){busy=false;return }$('<div class="fancybox-inline-tmp" />').hide().insertBefore($(obj)).bind("fancybox-cleanup",function(){$(this).replaceWith(content.children())}).bind("fancybox-cancel",function(){$(this).replaceWith(tmp.children())});$(obj).appendTo(tmp);_process_inline();break;case"image":busy=false;$.fancybox.showActivity();imgPreloader=new Image();imgPreloader.onerror=function(){_error()};imgPreloader.onload=function(){busy=true;imgPreloader.onerror=imgPreloader.onload=null;_process_image()};imgPreloader.src=href;break;case"swf":selectedOpts.scrolling="no";str='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"><param name="movie" value="'+href+'"></param>';emb="";$.each(selectedOpts.swf,function(name,val){str+='<param name="'+name+'" value="'+val+'"></param>';emb+=" "+name+'="'+val+'"'});str+='<embed src="'+href+'" type="application/x-shockwave-flash" width="'+selectedOpts.width+'" height="'+selectedOpts.height+'"'+emb+"></embed></object>";tmp.html(str);_process_inline();break;case"ajax":busy=false;$.fancybox.showActivity();selectedOpts.ajax.win=selectedOpts.ajax.success;ajaxLoader=$.ajax($.extend({},selectedOpts.ajax,{url:href,data:selectedOpts.ajax.data||{},error:function(XMLHttpRequest,textStatus,errorThrown){if(XMLHttpRequest.status>0){_error()}},success:function(data,textStatus,XMLHttpRequest){var o=typeof XMLHttpRequest=="object"?XMLHttpRequest:ajaxLoader;if(o.status==200){if(typeof selectedOpts.ajax.win=="function"){ret=selectedOpts.ajax.win(href,data,textStatus,XMLHttpRequest);if(ret===false){loading.hide();return }else{if(typeof ret=="string"||typeof ret=="object"){data=ret}}}tmp.html(data);_process_inline()}}}));break;case"iframe":_show();break}},_process_inline=function(){var w=selectedOpts.width,h=selectedOpts.height;if(w.toString().indexOf("%")>-1){w=parseInt(($(window).width()-(selectedOpts.margin*2))*parseFloat(w)/100,10)+"px"}else{w=w=="auto"?"auto":w+"px"}if(h.toString().indexOf("%")>-1){h=parseInt(($(window).height()-(selectedOpts.margin*2))*parseFloat(h)/100,10)+"px"}else{h=h=="auto"?"auto":h+"px"}tmp.wrapInner('<div style="width:'+w+";height:"+h+";overflow: "+(selectedOpts.scrolling=="auto"?"auto":(selectedOpts.scrolling=="yes"?"scroll":"hidden"))+';position:relative;"></div>');selectedOpts.width=tmp.width();selectedOpts.height=tmp.height();_show()},_process_image=function(){selectedOpts.width=imgPreloader.width;selectedOpts.height=imgPreloader.height;$("<img />").attr({"id":"fancybox-img","src":imgPreloader.src,"alt":selectedOpts.title}).appendTo(tmp);_show()},_show=function(){var pos,equal;loading.hide();if(wrap.is(":visible")&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){$.event.trigger("fancybox-cancel");busy=false;return }busy=true;$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");if(wrap.is(":visible")&&currentOpts.titlePosition!=="outside"){wrap.css("height",wrap.height())}currentArray=selectedArray;currentIndex=selectedIndex;currentOpts=selectedOpts;if(currentOpts.overlayShow){overlay.css({"background-color":currentOpts.overlayColor,"opacity":currentOpts.overlayOpacity,"cursor":currentOpts.hideOnOverlayClick?"pointer":"auto","height":$(document).height()});if(!overlay.is(":visible")){if(isIE6){$("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({"visibility":"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}overlay.show()}}else{overlay.hide()}final_pos=_get_zoom_to();_process_title();if(wrap.is(":visible")){$(close.add(nav_left).add(nav_right)).hide();pos=wrap.position(),start_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};equal=(start_pos.width==final_pos.width&&start_pos.height==final_pos.height);content.fadeTo(currentOpts.changeFade,0.3,function(){var finish_resizing=function(){content.html(tmp.contents()).fadeTo(currentOpts.changeFade,1,_finish)};$.event.trigger("fancybox-change");content.empty().removeAttr("filter").css({"border-width":currentOpts.padding,"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2});if(equal){finish_resizing()}else{fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.changeSpeed,easing:currentOpts.easingChange,step:_draw,complete:finish_resizing})}});return }wrap.removeAttr("style");content.css("border-width",currentOpts.padding);if(currentOpts.transitionIn=="elastic"){start_pos=_get_zoom_from();content.html(tmp.contents());wrap.show();if(currentOpts.opacity){final_pos.opacity=0}fx.prop=0;$(fx).animate({prop:1},{duration:currentOpts.speedIn,easing:currentOpts.easingIn,step:_draw,complete:_finish});return }if(currentOpts.titlePosition=="inside"&&titleHeight>0){title.show()}content.css({"width":final_pos.width-currentOpts.padding*2,"height":selectedOpts.autoDimensions?"auto":final_pos.height-titleHeight-currentOpts.padding*2}).html(tmp.contents());wrap.css(final_pos).fadeIn(currentOpts.transitionIn=="none"?0:currentOpts.speedIn,_finish)},_format_title=function(title){if(title&&title.length){if(currentOpts.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+currentOpts.titlePosition+'">'+title+"</div>"}return false},_process_title=function(){titleStr=currentOpts.title||"";titleHeight=0;title.empty().removeAttr("style").removeClass();if(currentOpts.titleShow===false){title.hide();return }titleStr=$.isFunction(currentOpts.titleFormat)?currentOpts.titleFormat(titleStr,currentArray,currentIndex,currentOpts):_format_title(titleStr);if(!titleStr||titleStr===""){title.hide();return }title.addClass("fancybox-title-"+currentOpts.titlePosition).html(titleStr).appendTo("body").show();switch(currentOpts.titlePosition){case"inside":title.css({"width":final_pos.width-(currentOpts.padding*2),"marginLeft":currentOpts.padding,"marginRight":currentOpts.padding});titleHeight=title.outerHeight(true);title.appendTo(outer);final_pos.height+=titleHeight;break;case"over":title.css({"marginLeft":currentOpts.padding,"width":final_pos.width-(currentOpts.padding*2),"bottom":currentOpts.padding}).appendTo(outer);break;case"float":title.css("left",parseInt((title.width()-final_pos.width-40)/2,10)*-1).appendTo(wrap);break;default:title.css({"width":final_pos.width-(currentOpts.padding*2),"paddingLeft":currentOpts.padding,"paddingRight":currentOpts.padding}).appendTo(wrap);break}title.hide()},_set_navigation=function(){if(currentOpts.enableEscapeButton||currentOpts.enableKeyboardNav){$(document).bind("keydown.fb",function(e){if(e.keyCode==27&&currentOpts.enableEscapeButton){e.preventDefault();$.fancybox.close()}else{if((e.keyCode==37||e.keyCode==39)&&currentOpts.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"){e.preventDefault();$.fancybox[e.keyCode==37?"prev":"next"]()}}})}if(!currentOpts.showNavArrows){nav_left.hide();nav_right.hide();return }if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!==0){nav_left.show()}if((currentOpts.cyclic&&currentArray.length>1)||currentIndex!=(currentArray.length-1)){nav_right.show()}},_finish=function(){if(!$.support.opacity){content.get(0).style.removeAttribute("filter");wrap.get(0).style.removeAttribute("filter")}if(selectedOpts.autoDimensions){content.css("height","auto")}wrap.css("height","auto");if(titleStr&&titleStr.length){title.show()}if(currentOpts.showCloseButton){close.show()}_set_navigation();if(currentOpts.hideOnContentClick){content.bind("click",$.fancybox.close)}if(currentOpts.hideOnOverlayClick){overlay.bind("click",$.fancybox.close)}$(window).bind("resize.fb",$.fancybox.resize);if(currentOpts.centerOnScroll){$(window).bind("scroll.fb",$.fancybox.center)}if(currentOpts.type=="iframe"){$('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+($.browser.msie?'allowtransparency="true""':"")+' scrolling="'+selectedOpts.scrolling+'" src="'+currentOpts.href+'"></iframe>').appendTo(content)}wrap.show();busy=false;$.fancybox.center();currentOpts.onComplete(currentArray,currentIndex,currentOpts);_preload_images()},_preload_images=function(){var href,objNext;if((currentArray.length-1)>currentIndex){href=currentArray[currentIndex+1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}if(currentIndex>0){href=currentArray[currentIndex-1].href;if(typeof href!=="undefined"&&href.match(imgRegExp)){objNext=new Image();objNext.src=href}}},_draw=function(pos){var dim={width:parseInt(start_pos.width+(final_pos.width-start_pos.width)*pos,10),height:parseInt(start_pos.height+(final_pos.height-start_pos.height)*pos,10),top:parseInt(start_pos.top+(final_pos.top-start_pos.top)*pos,10),left:parseInt(start_pos.left+(final_pos.left-start_pos.left)*pos,10)};if(typeof final_pos.opacity!=="undefined"){dim.opacity=pos<0.5?0.5:pos}wrap.css(dim);content.css({"width":dim.width-currentOpts.padding*2,"height":dim.height-(titleHeight*pos)-currentOpts.padding*2})},_get_viewport=function(){return[$(window).width()-(currentOpts.margin*2),$(window).height()-(currentOpts.margin*2),$(document).scrollLeft()+currentOpts.margin,$(document).scrollTop()+currentOpts.margin]},_get_zoom_to=function(){var view=_get_viewport(),to={},resize=currentOpts.autoScale,double_padding=currentOpts.padding*2,ratio;if(currentOpts.width.toString().indexOf("%")>-1){to.width=parseInt((view[0]*parseFloat(currentOpts.width))/100,10)}else{to.width=currentOpts.width+double_padding}if(currentOpts.height.toString().indexOf("%")>-1){to.height=parseInt((view[1]*parseFloat(currentOpts.height))/100,10)}else{to.height=currentOpts.height+double_padding}if(resize&&(to.width>view[0]||to.height>view[1])){if(selectedOpts.type=="image"||selectedOpts.type=="swf"){ratio=(currentOpts.width)/(currentOpts.height);if((to.width)>view[0]){to.width=view[0];to.height=parseInt(((to.width-double_padding)/ratio)+double_padding,10)}if((to.height)>view[1]){to.height=view[1];to.width=parseInt(((to.height-double_padding)*ratio)+double_padding,10)}}else{to.width=Math.min(to.width,view[0]);to.height=Math.min(to.height,view[1])}}to.top=parseInt(Math.max(view[3]-20,view[3]+((view[1]-to.height-40)*0.5)),10);to.left=parseInt(Math.max(view[2]-20,view[2]+((view[0]-to.width-40)*0.5)),10);return to},_get_obj_pos=function(obj){var pos=obj.offset();pos.top+=parseInt(obj.css("paddingTop"),10)||0;pos.left+=parseInt(obj.css("paddingLeft"),10)||0;pos.top+=parseInt(obj.css("border-top-width"),10)||0;pos.left+=parseInt(obj.css("border-left-width"),10)||0;pos.width=obj.width();pos.height=obj.height();return pos},_get_zoom_from=function(){var orig=selectedOpts.orig?$(selectedOpts.orig):false,from={},pos,view;if(orig&&orig.length){pos=_get_obj_pos(orig);from={width:pos.width+(currentOpts.padding*2),height:pos.height+(currentOpts.padding*2),top:pos.top-currentOpts.padding-20,left:pos.left-currentOpts.padding-20}}else{view=_get_viewport();from={width:currentOpts.padding*2,height:currentOpts.padding*2,top:parseInt(view[3]+view[1]*0.5,10),left:parseInt(view[2]+view[0]*0.5,10)}}return from},_animate_loading=function(){if(!loading.is(":visible")){clearInterval(loadingTimer);return }$("div",loading).css("top",(loadingFrame*-40)+"px");loadingFrame=(loadingFrame+1)%12};$.fn.fancybox=function(options){if(!$(this).length){return this}$(this).data("fancybox",$.extend({},options,($.metadata?$(this).metadata():{}))).unbind("click.fb").bind("click.fb",function(e){e.preventDefault();if(busy){return }busy=true;$(this).blur();selectedArray=[];selectedIndex=0;var rel=$(this).attr("rel")||"";if(!rel||rel==""||rel==="nofollow"){selectedArray.push(this)}else{selectedArray=$("a[rel="+rel+"], area[rel="+rel+"]");selectedIndex=selectedArray.index(this)}_start();return });return this};$.fancybox=function(obj){var opts;if(busy){return }busy=true;opts=typeof arguments[1]!=="undefined"?arguments[1]:{};selectedArray=[];selectedIndex=parseInt(opts.index,10)||0;if($.isArray(obj)){for(var i=0,j=obj.length;i<j;i++){if(typeof obj[i]=="object"){$(obj[i]).data("fancybox",$.extend({},opts,obj[i]))}else{obj[i]=$({}).data("fancybox",$.extend({content:obj[i]},opts))}}selectedArray=jQuery.merge(selectedArray,obj)}else{if(typeof obj=="object"){$(obj).data("fancybox",$.extend({},opts,obj))}else{obj=$({}).data("fancybox",$.extend({content:obj},opts))}selectedArray.push(obj)}if(selectedIndex>selectedArray.length||selectedIndex<0){selectedIndex=0}_start()};$.fancybox.showActivity=function(){clearInterval(loadingTimer);loading.show();loadingTimer=setInterval(_animate_loading,66)};$.fancybox.hideActivity=function(){loading.hide()};$.fancybox.next=function(){return $.fancybox.pos(currentIndex+1)};$.fancybox.prev=function(){return $.fancybox.pos(currentIndex-1)};$.fancybox.pos=function(pos){if(busy){return }pos=parseInt(pos);selectedArray=currentArray;if(pos>-1&&pos<currentArray.length){selectedIndex=pos;_start()}else{if(currentOpts.cyclic&&currentArray.length>1){selectedIndex=pos>=currentArray.length?0:currentArray.length-1;_start()}}return };$.fancybox.cancel=function(){if(busy){return }busy=true;$.event.trigger("fancybox-cancel");_abort();selectedOpts.onCancel(selectedArray,selectedIndex,selectedOpts);busy=false};$.fancybox.close=function(){if(busy||wrap.is(":hidden")){return }busy=true;if(currentOpts&&false===currentOpts.onCleanup(currentArray,currentIndex,currentOpts)){busy=false;return }_abort();$(close.add(nav_left).add(nav_right)).hide();$(content.add(overlay)).unbind();$(window).unbind("resize.fb scroll.fb");$(document).unbind("keydown.fb");content.find("iframe").attr("src",isIE6&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(currentOpts.titlePosition!=="inside"){title.empty()}wrap.stop();function _cleanup(){overlay.fadeOut("fast");title.empty().hide();wrap.hide();$.event.trigger("fancybox-cleanup");content.empty();currentOpts.onClosed(currentArray,currentIndex,currentOpts);currentArray=selectedOpts=[];currentIndex=selectedIndex=0;currentOpts=selectedOpts={};busy=false}if(currentOpts.transitionOut=="elastic"){start_pos=_get_zoom_from();var pos=wrap.position();final_pos={top:pos.top,left:pos.left,width:wrap.width(),height:wrap.height()};if(currentOpts.opacity){final_pos.opacity=1}title.empty().hide();fx.prop=1;$(fx).animate({prop:0},{duration:currentOpts.speedOut,easing:currentOpts.easingOut,step:_draw,complete:_cleanup})}else{wrap.fadeOut(currentOpts.transitionOut=="none"?0:currentOpts.speedOut,_cleanup)}};$.fancybox.resize=function(){if(overlay.is(":visible")){overlay.css("height",$(document).height())}$.fancybox.center(true)};$.fancybox.center=function(){var view,align;if(busy){return }align=arguments[0]===true?1:0;view=_get_viewport();if(!align&&(wrap.width()>view[0]||wrap.height()>view[1])){return }wrap.stop().animate({"top":parseInt(Math.max(view[3]-20,view[3]+((view[1]-content.height()-40)*0.5)-currentOpts.padding)),"left":parseInt(Math.max(view[2]-20,view[2]+((view[0]-content.width()-40)*0.5)-currentOpts.padding))},typeof arguments[0]=="number"?arguments[0]:200)};$.fancybox.init=function(){if($("#fancybox-wrap").length){return }$("body").append(tmp=$('<div id="fancybox-tmp"></div>'),loading=$('<div id="fancybox-loading"><div></div></div>'),overlay=$('<div id="fancybox-overlay"></div>'),wrap=$('<div id="fancybox-wrap"></div>'));outer=$('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(wrap);outer.append(content=$('<div id="fancybox-content"></div>'),close=$('<a id="fancybox-close"></a>'),title=$('<div id="fancybox-title"></div>'),nav_left=$('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),nav_right=$('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));close.click($.fancybox.close);loading.click($.fancybox.cancel);nav_left.click(function(e){e.preventDefault();$.fancybox.prev()});nav_right.click(function(e){e.preventDefault();$.fancybox.next()});if($.fn.mousewheel){wrap.bind("mousewheel.fb",function(e,delta){if(busy){e.preventDefault()}else{if($(e.target).get(0).clientHeight==0||$(e.target).get(0).scrollHeight===$(e.target).get(0).clientHeight){e.preventDefault();$.fancybox[delta>0?"prev":"next"]()}}})}if(!$.support.opacity){wrap.addClass("fancybox-ie")}if(isIE6){loading.addClass("fancybox-ie6");wrap.addClass("fancybox-ie6");$('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(outer)}};$.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:0.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};$(document).ready(function(){$.fancybox.init()})})(jQuery);
/* module-key = 'jira.webresources:jquery-fancybox', location = '/includes/jquery/plugins/fancybox/jquery.fancybox.jira.js' */
AJS.$.fn.fancybox.defaults.titleFormat=function(title){if(title&&title.length){title=AJS.escapeHtml(title);if(this.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+title+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+this.titlePosition+'">'+title+"</div>"}};
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/issuecomponents.soy' */
// This file was automatically generated from issuecomponents.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.watchersWithBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div class="autocomplete-user-target"><select id="watchers" name="watchers" data-description="', soy.$$escapeHtml("Start Typing for Users"), '" class="watchers-user-picker hidden" multiple="multiple">');
  var watcherList8 = opt_data.watchers;
  var watcherListLen8 = watcherList8.length;
  for (var watcherIndex8 = 0; watcherIndex8 < watcherListLen8; watcherIndex8++) {
    var watcherData8 = watcherList8[watcherIndex8];
    output.append('<option style="background-image:url(\'', soy.$$escapeHtml(watcherData8.avatarUrls['16x16']), '\')" selected="selected" value="', soy.$$escapeHtml(watcherData8.name), '">', soy.$$escapeHtml(watcherData8.displayName), '</option>');
  }
  output.append('</select></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.watchersNoBrowse = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><label for="watchers-multi-select">', soy.$$escapeHtml("Add Watchers"), '</label><div><input type="text" class="text" id="watchers-nosearch" /><div class="description">', soy.$$escapeHtml("Type username and press enter."), '</div></div><div class="recipients"><ol class="watchers">');
  var watcherList24 = opt_data.watchers;
  var watcherListLen24 = watcherList24.length;
  for (var watcherIndex24 = 0; watcherIndex24 < watcherListLen24; watcherIndex24++) {
    var watcherData24 = watcherList24[watcherIndex24];
    JIRA.Templates.Fields.recipientUsername({username: watcherData24.name, icon: watcherData24.avatarUrls['16x16'], displayName: watcherData24.displayName, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml(opt_data.msg), '</p><ul>');
  var messageList36 = opt_data.errors;
  var messageListLen36 = messageList36.length;
  for (var messageIndex36 = 0; messageIndex36 < messageListLen36; messageIndex36++) {
    var messageData36 = messageList36[messageIndex36];
    output.append('<li>', soy.$$escapeHtml(messageData36), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.usersListReadOnly = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui recipients-form"><a href="#" class="cancel aui-icon aui-icon-close"></a><fieldset><div class="recipients"><ol class="voters">');
  var voterList44 = opt_data.users;
  var voterListLen44 = voterList44.length;
  for (var voterIndex44 = 0; voterIndex44 < voterListLen44; voterIndex44++) {
    var voterData44 = voterList44[voterIndex44];
    JIRA.Templates.Fields.recipientUsername({username: voterData44.name, icon: voterData44.avatarUrls['16x16'], displayName: voterData44.displayName, readOnly: true, escape: true}, output);
  }
  output.append('</ol></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:viewissue', location = '/includes/jquery/plugins/shorten/shorten.js' */
define("jira/ajs/shorten/shortener",["jira/ajs/control","jira/data/local-storage","jquery"],function(Control,localStorage,jQuery){return Control.extend({_getDefaultOptions:function(){return{items:"a, span",numRows:1,shortenText:"hide",shortenOnInit:true,persist:true,expandButtonTooltip:"Click to view {0} more",collapseButtonTooltip:"Hide"}},init:function(options){if(typeof options==="string"){options={element:options}}options=options||{};this.options=jQuery.extend(this._getDefaultOptions(),options);this._timerId=0;this.expanded=false;this.$container=jQuery(this.options.element);this._assignEvents("body",document.body);this._ready()},_isValid:function(){return !this.initialized&&this.$container.is(":visible")&&this.$container.children().length>0},_ready:function(){if(this._isValid()){this.$items=this.$container.children(this.options.items);this.$expandButton=this._render("expandButton");this.$collapseButton=this._render("collapseButton");this._assignEvents("expand-button",".shortener-expand");this._assignEvents("collapse-button",".shortener-collapse");if(!jQuery.browser.msie||jQuery.browser.version>="9"){this._assignEvents("resize-region",window)}if(this._isCollapsedOnInit()){this.collapse()}else{this.expand()}this.initialized=true}},_renders:{"expandButton":function(){return jQuery("<a href='#' class='ellipsis shortener-expand' title='"+this.options.expandButtonTooltip+"'></a><br>")},"collapseButton":function(){return jQuery("<a title='Hide' class='icon icon-hide shortener-collapse' href='#'><span>"+this.options.collapseButtonTooltip+"</span></a>")}},_events:{"expand-button":{"click":function(event){if(event.currentTarget===this.$expandButton[0]){event.preventDefault();this.expand();this._saveState("expanded")}}},"collapse-button":{"click":function(event){if(event.currentTarget===this.$collapseButton[0]){event.preventDefault();this.collapse();this._saveState("collapsed");this.$container.scrollIntoView()}}},"resize-region":{"resize":function(){clearTimeout(this._timerId);if(!this.expanded){var instance=this;this._timerId=setTimeout(function(){instance.collapse()},400)}}},"body":{tabSelect:function(){this._ready()}}},_saveState:function(value){try{localStorage.setItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"),value)}catch(QUOTA_EXCEEDED_ERR){}},_loadState:function(){return localStorage.getItem("AJS.Shortener#"+this.$container.closest("[id]").attr("id"))},_isCollapsedOnInit:function(){var shortenOnInit=this._loadState();if(shortenOnInit!==null){return shortenOnInit!=="expanded"}return this.options.shortenOnInit},_removeButtons:function(){this.$expandButton.remove();this.$collapseButton.remove()},_getOverflowIndex:function(){if(this.$items.length>1){var currentRow=1;var prevItemPageX=-1;for(var i=0;i<this.$items.length;i++){var itemPageX=this.$items.eq(i).offset().left;if(itemPageX<=prevItemPageX){currentRow++;if(currentRow>this.options.numRows){return i}}prevItemPageX=itemPageX}}return -1},expand:function(){this._removeButtons();if(this._getOverflowIndex()>0){this.$collapseButton=this._render("collapseButton");this.$container.append(this.$collapseButton);this.$container.css("height","auto");if(jQuery.browser.msie&&jQuery.browser.version<"9"){jQuery("body").toggleClass("reflow")}}this.expanded=true},collapse:function(){this._removeButtons();var i=this._getOverflowIndex();if(i>0){this.$container.css({"position":"absolute","visibility":"hidden","width":this.$container[0].clientWidth+"px"});var $expandButtonContent=this.$expandButton.first();do{var remainingItemCount=(this.$items.length-i);$expandButtonContent.text("("+remainingItemCount+")");this.$expandButton.insertBefore(this.$items[i]);i--;var oi=this.$items.eq(i).offset();var ob=this.$expandButton.offset();if(oi.left<ob.left&&ob.top<oi.top+10){break}}while(i>0);var height=(i<this.$items.length-1)?(this.$items.eq(i+1).offset().top-this.$container.offset().top)+"px":"auto";this.$container.css({"height":height,"position":"static","visibility":"visible","width":"auto"});$expandButtonContent.attr("title",AJS.format(this.options.expandButtonTooltip,remainingItemCount));if(jQuery.browser.msie&&jQuery.browser.version<"9"){jQuery("body").toggleClass("reflow")}}else{this.$container.css("height","auto")}this.expanded=false}})});define("jira/jquery/plugins/shorten/shorten",["jira/ajs/shorten/shortener","jquery"],function(Shortener,jQuery){jQuery.fn.shorten=function(options){var res=[];options=options||{};this.each(function(){options.element=this;res.push(new Shortener(options))});return res}});AJS.namespace("AJS.Shortener",null,require("jira/ajs/shorten/shortener"));(function(){require("jira/jquery/plugins/shorten/shorten")})();
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initShorten.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var jQuery=require("jquery");require("jira/jquery/plugins/shorten/shorten");Events.bind(Types.NEW_CONTENT_ADDED,function(e,$ctx){jQuery(".shorten",$ctx).shorten()})})();
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initToggleBlock.js' */
AJS.$(function(){new JIRA.ToggleBlock({blockSelector:".toggle-wrap",triggerSelector:".mod-header .toggle-title",storageCollectionName:"block-states",});if(JIRA.Events.ISSUE_REFRESHED){JIRA.bind(JIRA.Events.ISSUE_REFRESHED,function(){if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS)}})}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSlideshow.js' */
(function($){var defaultOpts={type:"image",centerOnScroll:true,onStart:AJS.disableKeyboardShortcuts,onClosed:AJS.enableKeyboardShortcuts};function initGallery($ctx){var transition="elastic";var galleryOpts=$.extend({},defaultOpts,{transitionIn:transition,transitionOut:transition});$ctx.find(".gallery, [id$='_thumb']").each(function(){$(this).fancybox(galleryOpts)});$ctx.find("#attachment_thumbnails .attachment-title").click(function(e){if(e.which===1){e.preventDefault();$(this).closest(".attachment-content").find(".gallery").click()}})}function initWorkflow($ctx){$ctx.find("a.issueaction-viewworkflow:not(.new-workflow-designer)").each(function(){$(this).fancybox(defaultOpts)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx,reason){initGallery($ctx);initWorkflow($ctx)});$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="attachmentmodule"){initGallery($new)}else{if(panel==="details-module"){initWorkflow($new)}}})}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initComment.js' */
(function($){var commentForm=JIRA.Issue.CommentForm={setCaretAtEndOfCommentField:function(){var $field=this.getField(),field=$field[0],length;if($field.length){length=$field.val().length;$field.scrollTop($field.attr("scrollHeight"));if(field.setSelectionRange&&length>0){field.setSelectionRange(length,length)}}},disable:function(){this.getForm().find("textarea").attr("readonly","readonly");this.getForm().find(":submit").attr("disabled","disabled")},isDirty:function(){var field=this.getField();if(field.length){return field[0].value!==field[0].defaultValue}return false},handleBrowseAway:function(){var isDirty=commentForm.isDirty(),isVisible=commentForm.getForm()&&commentForm.getForm().is(":visible");if(isDirty&&isVisible){return "You have entered a comment on this issue. If you navigate away from this page without first saving, the comment will be lost."}},setSubmitState:function(){if(jQuery.trim(this.getField().val()).length>0){this.getForm().find(":submit").removeAttr("disabled")}else{this.getForm().find(":submit").attr("disabled","disabled")}},enable:function(){this.getForm().find("textarea").removeAttr("readonly");this.getForm().find(":submit").removeAttr("disabled")},getCommentVisibility:function(){var visibility=$("#commentLevel :selected").val();if(visibility){var split_v=visibility.split(":");return{"type":split_v[0],"value":$("#commentLevel :selected").text()}}return null},ajaxSubmit:function(callback){var $loading=jQuery('<span class="icon throbber loading"></span>');var issueId=JIRA.Issue.getIssueId();var issueKey=JIRA.Issue.getIssueKey();var restURL=contextPath+"/rest/api/2/issue/"+issueKey+"/comment";var newComment={"body":this.getField()[0].value};var visibility=this.getCommentVisibility();if(visibility){newComment["visibility"]=visibility}$.ajax({url:restURL,type:"POST",contentType:"application/json",data:JSON.stringify(newComment),success:function(data){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"]);JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[issueId,{complete:function(){var newCommentId="comment-"+data.id;jQuery("#"+newCommentId).scrollIntoView({marginBottom:200,marginTop:200});var $focusedTabs=$("#issue_actions_container > .issue-data-block.focused");$focusedTabs.removeClass("focused");var $newfocusedTab=$("#"+newCommentId);$newfocusedTab.addClass("focused");$loading.remove();footerComment.hide(true);commentForm.enable()}}])},error:function(xhr){function buildErrorDialog(errorMessage){var errorContent="<h2>"+"Error"+"</h2>"+'<div class="ajaxerror">'+'<div class="aui-message error">'+'<span class="aui-icon icon-warning"/>'+errorMessage+"</div>"+"</div>";return $(errorContent)}var response=$.parseJSON(xhr.responseText);var content;if(response&&response.errors&&response.errors.comment){content=buildErrorDialog(response.errors.comment)}else{content=JIRA.SmartAjax.buildDialogErrorContent(xhr)}new JIRA.FormDialog({content:content}).show();$loading.remove();commentForm.enable()}});$loading.appendTo(this.getForm().find(":submit").parent())},getForm:function(){var $form=$("form#issue-comment-add");if($form.length===1){this.$form=$form}return this.$form||$()},getField:function(){return this.getForm().find("#comment")},getSubmitButton:function(){return this.getForm().find("#issue-comment-add-submit")},hide:function(cancel){if(cancel){this.cancel()}this.getForm().detach();if(JIRA.Events.UNLOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.UNLOCK_PANEL_REFRESHING,["addcommentmodule"])}},show:function(){this.focus();if(JIRA.Events.LOCK_PANEL_REFRESHING){JIRA.trigger(JIRA.Events.LOCK_PANEL_REFRESHING,["addcommentmodule"])}},focus:function(){this.focusField();this.setCaretAtEndOfCommentField()},focusField:function(){this.getField().focus().trigger("keyup");this.getSubmitButton().scrollIntoView({marginBottom:200})},showNoCommentMsg:function(e){if(this.getField().val()===""){$("#emptyCommentErrMsg").show();return true}},cancel:function(){var instance=this;setTimeout(function(){instance.getField().val("")},100);$("#comment-preview_link.selected").click()}};var footerComment={getModule:function(){return $("#addcomment")},isActive:function(){return this.getModule().hasClass("active")},hide:function(cancel){if(this.isActive()){this.getModule().removeClass("active");commentForm.hide(cancel)}},ajaxSubmit:function(){commentForm.ajaxSubmit(function(){footerComment.hide()})},show:function(){if(!this.isActive()){this.getModule().addClass("active");this.appendForm();commentForm.show()}else{commentForm.focusField()}},appendForm:function(){this.getModule().find(".mod-content").append(commentForm.getForm())}};var oldBeforeUnload=window.onbeforeunload;$(document).delegate("body:not(.ka) #issue-comment-add","submit",function(e){window.onbeforeunload=oldBeforeUnload}).delegate(".ka #addcomment #issue-comment-add","submit",function(e){footerComment.ajaxSubmit();e.preventDefault()}).delegate(".issue-header #comment-issue","click",function(e){footerComment.show();e.preventDefault()}).delegate("#footer-comment-button","click",function(e){footerComment.show();e.preventDefault()}).delegate("#addcomment .cancel","click",function(e){e.preventDefault();footerComment.hide(true)}).delegate("#issue-comment-add","submit",function(){window.setTimeout(function(){commentForm.disable()},0)}).delegate("#issue-comment-add #comment","input",function(){commentForm.setSubmitState()}).delegate("#issue-comment-add input[type='submit']","click",function(e){if(commentForm.showNoCommentMsg()){e.preventDefault()}}).bind("showWikiInput",function(){var $commentField=commentForm.getField();if($commentField.is(":visible:enabled")){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated");if($commentField.length>0){$commentField.focus()}commentForm.setCaretAtEndOfCommentField()}}).bind("showWikiPreview",function(){JIRA.Issue.getStalker().trigger("stalkerHeightUpdated")});window.onbeforeunload=function(){return oldBeforeUnload.apply(this,arguments)||commentForm.handleBrowseAway.apply(this,arguments)};$(function(){new AJS.SecurityLevelSelect($("#commentLevel"))});JIRA.Issue.getDirtyCommentWarning=commentForm.handleBrowseAway;JIRA.Issue.invokeCommentTrigger=function(){var addIssueComment=AJS.$(".add-issue-comment");if(addIssueComment.length===0){return }var toolbarTrigger=addIssueComment.filter(".toolbar-trigger");if(toolbarTrigger.length>0){toolbarTrigger.click()}else{addIssueComment.click()}}})(AJS.$);AJS.$(function(){if(parseUri(window.location.href).anchor==="add-comment"){AJS.$("#footer-comment-button").click()}});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initCustomFieldTabs.js' */
(function($,scope){var activateTab=function(tabName){var tabTrigger;if(typeof tabName!=="string"&&tabName.length>0){return }if(tabName[0]!=="#"){tabName="#"+tabName}console.log("activating tab",tabName);tabTrigger=$("a[href='"+tabName+"']",scope);if(tabTrigger.length){AJS.tabs.change(tabTrigger)}};var revealer=function(e){var $containingTab=$(e.target).closest(".tabs-pane");if($containingTab.length>0){activateTab($containingTab.attr("id"))}};$(function(){if(JIRA.Events.NEW_CONTENT_ADDED){JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context){var $customFieldModule=$context.find(scope);$customFieldModule.unbind("reveal");$customFieldModule.bind("reveal",revealer);AJS.tabs.setup()})}if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="details-module"){var $activeTab=$existing.find(scope).find(".active-tab");if($activeTab.length===1){activateTab($activeTab.find("a").attr("href"))}}})}$(scope).bind("reveal",revealer)})})(AJS.$,"#customfieldmodule");
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initSubtaskTimeLogging.js' */
(function($){$(document).delegate("#tt_include_subtasks input","click",function(e){if(AJS.$(this).is(":checked")){AJS.$("#tt_info_single").hide();AJS.$("#tt_info_aggregate").show()}else{AJS.$("#tt_info_aggregate").hide();AJS.$("#tt_info_single").show()}})})(AJS.$);
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVotersModel.js' */
(function(){var JIRAUserModel=Backbone.Model.extend({idAttribute:"key"});var WatchersAndVoterUsers=Backbone.Collection.extend({model:JIRAUserModel,initialize:function(options){if(options===undefined){throw new Error("Must supply options")}if(options.issueKey){this.issueKey=options.issueKey}else{throw new Error("Must supply issue key")}if(options.endpoint){this.endpoint=options.endpoint}else{throw new Error("Must supply an endpoint")}if(options.modelKey){this.modelKey=options.modelKey}else{throw new Error("Must supply an model key")}},url:function(){return[AJS.contextPath(),"rest/api/2/issue",this.issueKey,this.endpoint].join("/")},parse:function(response){return(response&&response[this.modelKey])?response[this.modelKey]:[]},ajax:function(options){options=_.extend({url:this.url(),headers:{"Content-Type":"application/json"},success:_.bind(function(){this.fetch()},this),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)},options);return AJS.$.ajax(options)},getUser:function(username){return AJS.$.ajax({url:AJS.contextPath()+"/rest/api/2/user?username="+encodeURIComponent(username),error:_.bind(function(xhr){if(xhr.status!==404){this.handleErrorResponse(xhr,"There was an error adding watcher")}},this)})},handleErrorResponse:function(xhr,msg){var errorCollection=this._parseResponse(xhr.responseText);if(errorCollection.errorMessages){var html=JIRA.Templates.Issue.error({msg:msg,errors:errorCollection.errorMessages});JIRA.Messages.showErrorMsg(html,{closeable:true})}this.trigger("errorOccurred")},_parseResponse:function(responseText){try{return JSON.parse(responseText)}catch(e){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var msg="<p>"+"Communications Breakdown"+"</p>"+"<p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(msg,{closeable:true})}});JIRA.VotersUsersCollection=WatchersAndVoterUsers.extend({initialize:function(issueKey){var options={issueKey:issueKey,endpoint:"votes",modelKey:"voters"};WatchersAndVoterUsers.prototype.initialize.apply(this,[options])},vote:function(){return this.ajax({type:"POST"})},unvote:function(){return this.ajax({type:"DELETE"})}});JIRA.WatchersUsersCollection=WatchersAndVoterUsers.extend({initialize:function(issueKey){this.canBrowseUsers=AJS.Meta.get("can-search-users");this.isReadOnly=!AJS.Meta.get("can-edit-watchers");var options={issueKey:issueKey,endpoint:"watchers",modelKey:"watchers"};WatchersAndVoterUsers.prototype.initialize.apply(this,[options])},addWatcher:function(user){return this.ajax({type:"POST",data:'"'+user+'"'})},removeWatcher:function(user){return this.ajax({type:"DELETE",url:this.url()+"?username="+user})}})})();
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVotersView.js' */
(function(){JIRA.VotersView=Backbone.View.extend({initialize:function(options){this.collection=options.collection;this.collection.bind("replace reset add remove",this.render,this)},renderNoWatchers:function(){if(this.$(".recipients li").length===0){var $empty=AJS.messages.info({closeable:false,body:"There are no voters for this issue"});this.$("fieldset").append($empty)}else{this.$(".voters-empty").remove()}},render:function(){var deferred=jQuery.Deferred();this.collection.fetch().done(_.bind(function(){this.$el.html(JIRA.Templates.Issue.usersListReadOnly({users:this.collection.toJSON()}));this.renderNoWatchers();deferred.resolve(this.$el)},this));return deferred.promise()}});var AbstractWatchersView=Backbone.View.extend({renderNoWatchers:function(){if(this.$(".recipients li").length===0){var $empty=AJS.messages.info({closeable:false,body:"There are no watchers."});this.$("fieldset").append($empty)}else{this.$(".watchers-empty").remove()}},render:function(){var deferred=jQuery.Deferred();this.collection.fetch().done(_.bind(function(){this._render();this.renderNoWatchers();deferred.resolve(this.$el);window.setTimeout(_.bind(function(){this.focus()},this),0)},this));return deferred.promise()},watch:function(){AJS.$("#watching-toggle").text("Stop watching this issue")},unwatch:function(){AJS.$("#watching-toggle").text("Start watching this issue")},focus:AJS.$.noop,_incrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount+1);this.renderNoWatchers()},_decrementWatcherCount:function(){var $el=AJS.$("#watcher-data");var currentCount=parseInt($el.text(),10);$el.text(currentCount-1);this.renderNoWatchers()}});JIRA.WatchersView=AbstractWatchersView.extend({events:{selected:"addWatcherToModel",unselect:"removeWatcherFromModel"},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersWithBrowse({watchers:this.collection.toJSON()}));var picker=new JIRA.MultiUserListPicker({element:this.$el.find(".watchers-user-picker"),width:220})},focus:function(){this.$el.find("#watchers-textarea").focus()},addWatcherToModel:function(e,descriptor){e.preventDefault();this.collection.addWatcher(descriptor.value()).done(_.bind(function(){this._incrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.watch()}},this))},removeWatcherFromModel:function(e,descriptor){this.collection.removeWatcher(descriptor.value()).done(_.bind(function(){this._decrementWatcherCount();if(descriptor.value()===AJS.Meta.get("remote-user")){this.unwatch();JIRA.trace("jira.issue.watcher.deleted")}},this))}});JIRA.WatchersNoBrowseView=AbstractWatchersView.extend({events:{"click .remove-recipient":"removeWatcher","submit":"addWatcher"},addWatcher:function(e){e.preventDefault();this.removeInlineError();var $field=AJS.$("#watchers-nosearch");var username=AJS.$.trim(AJS.$("#watchers-nosearch").val());$field.attr("disabled","disabled");if(this.hasUsername(username)){$field.removeAttr("disabled");this.showInlineError(AJS.format("User {0} is already watching this issue",username));$field.val("")}else{this.collection.getUser(username).done(_.bind(function(data){var html=JIRA.Templates.Fields.recipientUsername({icon:data.avatarUrls["16x16"],username:data.name,displayName:data.displayName});if(username===AJS.Meta.get("remote-user")){this.watch()}$field.val("");this.$(".watchers").append(html);this.collection.addWatcher(data.name);this._incrementWatcherCount()},this)).fail(_.bind(function(xhr){if(xhr.status===404){this.showInlineError("User does not exist")}},this)).always(function(){$field.removeAttr("disabled").focus()})}},hasUsername:function(username){var result=false;this.$(".watchers li").each(function(){if(AJS.$(this).attr("data-username")===username){result=true;return false}});return result},removeInlineError:function(){this.$(".error").remove()},showInlineError:function(msg){AJS.$("<div />").addClass("error").text(msg).insertAfter(this.$(".description"))},focus:function(){AJS.$("#watchers-nosearch").focus()},removeWatcher:function(e){e.preventDefault();var $item=AJS.$(e.target).closest("li");var username=$item.attr("data-username");if(username){$item.remove();this.collection.removeWatcher(username);this._decrementWatcherCount();if(username===AJS.Meta.get("remote-user")){this.unwatch()}}JIRA.trace("jira.issue.watcher.deleted")},_render:function(){this.$el.html(JIRA.Templates.Issue.watchersNoBrowse({watchers:this.collection.toJSON()}))}});JIRA.WatchersReadOnly=AbstractWatchersView.extend({_render:function(){this.$el.html(JIRA.Templates.Issue.usersListReadOnly({users:this.collection.toJSON()}))}})})();
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initWatchers.js' */
AJS.$(function(){function getView(collection){if(collection.isReadOnly){return JIRA.WatchersReadOnly}else{if(collection.canBrowseUsers){return JIRA.WatchersView}else{return JIRA.WatchersNoBrowseView}}}var dialog=AJS.InlineDialog("#view-watcher-list","watchers",function(contents,trigger,doShowPopup){var loadingIcon=AJS.$("#watching-toggle").next(".icon");var collection=new JIRA.WatchersUsersCollection(JIRA.Issue.getIssueKey());loadingIcon.addClass("loading");var view=getView(collection);new view({collection:collection}).render().done(function(viewHtml){contents.html(viewHtml);contents.find(".cancel").click(function(e){dialog.hide();e.preventDefault()});loadingIcon.removeClass("loading");doShowPopup()});collection.on("errorOccurred",function(){dialog.hide()})},{width:240,useLiveEvents:true,items:"#view-watcher-list",preHideCallback:function(){return !AJS.InlineLayer.current}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog.hide()}});AJS.$(document).click(function(e){var currentDialog=AJS.InlineDialog.current;if(currentDialog&&currentDialog.id==="watchers"){if(!jQuery(e.target).closest("#inline-dialog-watchers, #watchers-suggestions").length){currentDialog.hide()}}});AJS.$(document).bind("showLayer",function(e,type,hash){if(type&&type==="inlineDialog"&&hash&&hash.id&&hash.id==="watchers"){AJS.$("body").unbind("click.watchers.inline-dialog-check")}})});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/initVoters.js' */
AJS.$(function(){var dialog=AJS.InlineDialog("#view-voter-list","voters",function(contents,trigger,doShowPopup){var loadingIcon=AJS.$("#vote-toggle").next(".icon");var collection=new JIRA.VotersUsersCollection(JIRA.Issue.getIssueKey());loadingIcon.addClass("loading");new JIRA.VotersView({collection:collection}).render().done(function(viewHtml){contents.html(viewHtml);contents.find(".cancel").click(function(e){dialog.hide();e.preventDefault()});loadingIcon.removeClass("loading");doShowPopup()});collection.on("errorOccurred",function(){dialog.hide()})},{width:240,useLiveEvents:true,items:"#view-voters-list",preHideCallback:function(){return !AJS.InlineLayer.current}});AJS.$(document).bind("keydown",function(e){if(e.keyCode===27&&AJS.InlineDialog.current!=dialog&&dialog.is(":visible")){if(AJS.InlineDialog.current){AJS.InlineDialog.current.hide()}dialog.hide()}});AJS.$(document).click(function(e){var currentDialog=AJS.InlineDialog.current;if(currentDialog&&currentDialog.id==="voters"){if(!jQuery(e.target).closest("#inline-dialog-voters").length){currentDialog.hide()}}})});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/ViewIssueTabs.js' */
JIRA.ViewIssueTabs=(function(){var useHistoryApi=AJS.Meta.get("viewissue-use-history-api")!==false;var AJAX_LOAD_CLASS="ajax-activity-content";var AJAX_LINK_SELECTOR=AJS.format("a.{0}",AJAX_LOAD_CLASS);var issueTabLoadedListeners=[];var $tabWrapper,$tabContents;var xhrInProgress;function dispatchIssueTabLoadedEvent(container){container=container||document;AJS.$.each(issueTabLoadedListeners,function(i,fn){fn(container)})}function bindToTabDivs(container){var $newTabWrapper=AJS.$(container).find(".issuePanelWrapper");var $newTabContents=AJS.$(container).find("#issue_actions_container");$tabContents=$newTabContents.length?$newTabContents:$tabContents;$tabWrapper=$newTabWrapper.length?$newTabWrapper:$tabWrapper}function dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey){var errorPopup=new JIRA.FormDialog({id:"issue-tab-error-dialog",widthClass:"small",content:JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,false)});setActiveTab(activeTabKey);$tabContents.show();errorPopup.show()}function setActiveTab(activeTabKey){AJS.$("#issue-tabs li").each(function(){var $li=AJS.$(this);var tabKey=$li.data("key");var labelHtml=AJS.format("<strong>{0}</strong>",$li.data("label"));if(tabKey==activeTabKey){$li.addClass("active");$li.html(labelHtml)}else{$li.removeClass("active");var id=$li.data("id");var href=$li.data("href");$li.html(AJS.format('<a id="{0}" href="{1}" class="{2}">{3}</a>',id,href,AJAX_LOAD_CLASS,labelHtml))}});enableAjaxOnLinks(AJS.$("#issue-tabs"))}function putTabInLoadingState(activeTabKey){setActiveTab(activeTabKey)}function enableAjaxOnLinks(context){var activeTabKey=AJS.$(context).find("li.active").data("key");AJS.$(context).find(AJAX_LINK_SELECTOR).click(function(event){if(event.metaKey){return }event.preventDefault();if(xhrInProgress){xhrInProgress.abort()}var $a=AJS.$(this);var containerID="#activitymodule div.mod-content";var loadingTabKey=$a.parent().data("key");if(loadingTabKey){putTabInLoadingState(loadingTabKey)}var xhr=JIRA.SmartAjax.makeRequest({jqueryAjaxFn:useHistoryApi?AJS.$.pjax:AJS.$.ajax,headers:{"X-PJAX":true},container:containerID,url:$a.attr("href"),timeout:null,complete:function(xhr,status,smartAjaxResult){if(status!="abort"){xhrInProgress=null;if(!smartAjaxResult.successful){if(smartAjaxResult.status<300||smartAjaxResult.status>=400){dispatchIssueTabErrorEvent(smartAjaxResult,activeTabKey)}return }var container=AJS.$(containerID);var newElements=AJS.$(smartAjaxResult.data);if(!useHistoryApi){smartUpdate(container,newElements)}dispatchIssueTabLoadedEvent(container);JIRA.trace("jira.issue.tab.loaded")}}});jQuery(xhr).throbber({target:$tabWrapper});xhrInProgress=xhr})}function smartUpdate(container,newElements){var newTabs=newElements.filter(".tabwrap");var oldTabs=container.find(".tabwrap");var newContents=newElements.find("#issue_actions_container").contents();var oldContents=$tabContents.contents();if(newTabs.length&&oldTabs.length&&newContents.length&&oldContents.length){oldTabs.replaceWith(newTabs);var currentContentHeight=$tabContents.height();$tabContents.append(newContents);var newContentHeight=$tabContents.height()-currentContentHeight;var visibleHeightDifference=AJS.$(window).scrollTop()+AJS.$(window).height()-($tabContents.offset().top+newContentHeight);if(visibleHeightDifference>0){$tabContents.css("height",newContentHeight+visibleHeightDifference);oldContents.remove();var preDelay=150;setTimeout(function(){var pixelsPerSecond=500;var animSpeed=visibleHeightDifference/pixelsPerSecond*1000;$tabContents.animate({height:newContentHeight},animSpeed,"easeOutQuart",function(){$tabContents.css("height","auto")})},preDelay)}else{$tabContents.empty().append(newContents)}newElements.filter("script").each(function(){AJS.$.globalEval(this.text||this.textContent||this.innerHTML||"")})}else{container.empty().append(newElements)}}function appendHashCodeToLinks(context){AJS.$(context).find(AJAX_LINK_SELECTOR).each(function(){var $a=AJS.$(this);$a.attr("href",$a.attr("href")+"#issue-tabs")})}function processActivityModuleLinks(context){if(!useHistoryApi||AJS.$.support.pjax){enableAjaxOnLinks(context)}else{appendHashCodeToLinks(context)}}function setupMouseoverBehaviour(context){jQuery(context).bind("moveToFinished",function(event,target){jQuery("a.twixi:visible",target).focus()})}function initLivestamp(context){context.find("time.livestamp").livestamp()}function onTabReady(listener){if(jQuery.inArray(listener,issueTabLoadedListeners)<0){issueTabLoadedListeners.push(listener)}}onTabReady(bindToTabDivs);onTabReady(processActivityModuleLinks);onTabReady(setupMouseoverBehaviour);onTabReady(JIRA.userhover);onTabReady(initLivestamp);return{onTabReady:onTabReady,domReady:dispatchIssueTabLoadedEvent}})();AJS.$(function(){if(JIRA.Events.PANEL_REFRESHED){JIRA.bind(JIRA.Events.PANEL_REFRESHED,function(e,panel,$new,$existing){if(panel==="activitymodule"){var $focusedTab=$existing.find("#issue_actions_container > .issue-data-block.focused");if($focusedTab.length===1){$new.find("#"+$focusedTab.attr("id")).addClass("focused")}}})}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(event,$el){JIRA.ViewIssueTabs.domReady($el)});
/* module-key = 'jira.webresources:viewissue', location = '/includes/jira/viewissue/WatchersAndVoters.js' */
AJS.$(function(){var toggleVotingAndWatching=function(trigger,className,resultContainer,issueOpTrigger,i18n){var classNameOn=className+"-on",classNameOff=className+"-off",restPath="/voters",spinner=trigger.next(".icon"),data,method="POST";if(trigger.hasClass(classNameOn)){method="DELETE"}if(className.indexOf("watch")!==-1){restPath="/watchers"}trigger.removeClass(classNameOn).removeClass(classNameOff);if(method==="POST"){data={dummy:true}}AJS.$(JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/api/1.0/issues/"+trigger.attr("rel")+restPath,type:method,dataType:"json",data:data,contentType:"application/json",complete:function(xhr,textStatus,smartAjaxResult){var optIn=method==="POST";if(smartAjaxResult.successful){if(optIn){trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}else{trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}resultContainer.text(smartAjaxResult.data.count);resultContainer[optIn?"addClass":"removeClass"](classNameOn);resultContainer[optIn?"removeClass":"addClass"](classNameOff)}else{if(!smartAjaxResult.aborted){alert(JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult,{alert:true}))}if(optIn){trigger.addClass(classNameOff);trigger.text(i18n.titleOff);issueOpTrigger.attr("title",i18n.titleOff).text(i18n.textOff)}else{trigger.addClass(classNameOn);trigger.text(i18n.titleOn);issueOpTrigger.attr("title",i18n.titleOn).text(i18n.textOn)}}}})).throbber({target:spinner})};AJS.$(document).delegate("#toggle-vote-issue","click",function(e){e.preventDefault();AJS.$("#vote-toggle").click()});AJS.$(document).delegate("#toggle-watch-issue","click",function(e){e.preventDefault();AJS.$("#watching-toggle").click()});var addI18nErrorCodes=function(i18n){AJS.$("input[type=hidden][id|=error]").each(function(index,elem){var i18n_id=elem.id.replace("error-","");i18n[i18n_id]=elem.value})};AJS.$(document).delegate("#vote-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Remove vote for this issue",titleOff:"Vote for this issue",textOn:"Remove Vote",textOff:"Add Vote",actionTextOff:"Vote",actionTextOn:"Voted"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"vote-state",AJS.$("#vote-data"),AJS.$("#toggle-vote-issue"),i18n)});AJS.$(document).delegate("#watching-toggle","click",function(e){e.preventDefault();var i18n={titleOn:"Stop watching this issue",titleOff:"Start watching this issue",textOn:"Stop Watching",textOff:"Watch Issue",actionTextOff:"Watch",actionTextOn:"Watching"};addI18nErrorCodes(i18n);toggleVotingAndWatching(AJS.$(this),"watch-state",AJS.$("#watcher-data"),AJS.$("#toggle-watch-issue"),i18n)})});
/* module-key = 'jira.webresources:attach-screenshot-resources', location = '/includes/jira/issue/attachScreenshot.js' */
AJS.namespace("JIRA.Issue.AttachScreenshot");(function initializeAttachScreenshot(){AJS.EventQueue=AJS.EventQueue||[];AJS.$(document).on("click","#attach-screenshot",function(){AJS.EventQueue.push({name:"attach.screenshot.display",properties:{}})})})();
/* module-key = 'com.atlassian.jira.plugins.jira-bitbucket-connector-plugin:requiredResourceForAjaxCommitsTab', location = 'javascripts/dvcs-tabs.js' */
if(typeof(com)=="undefined"){com={}}if(typeof(com.atlassian)=="undefined"){com.atlassian={}}if(typeof(com.atlassian.jira)=="undefined"){com.atlassian.jira={}}if(typeof(com.atlassian.jira.dvcs)=="undefined"){com.atlassian.jira.dvcs={}}com.atlassian.jira.dvcs.showChangesetByFork=function(d,b,c,a){AJS.$("#"+d+" .CommitPanel").each(function(f,e){AJS.$(e).hide()});AJS.$("#"+d+"-"+b).show();com.atlassian.jira.dvcs.registerForksTooltip(d,c,a)};com.atlassian.jira.dvcs.registerForksTooltip=function(c,b,a){com.atlassian.jira.dvcs.registerInlineDialogTooltip(AJS.$("#fork-drop-down-"+c),"This changeset is present in multiple repositories (forks). Currently showing <a href='"+a+"' target='_blank'>"+b+"</a>.")};com.atlassian.jira.dvcs.registerInlineDialogTooltip=function(b,a){AJS.InlineDialog(AJS.$(b),"tooltip_"+AJS.$(b).attr("id"),function(d,c,e){d.css({padding:"10px"}).html(a);e();return false},{onHover:true,hideDelay:200,showDelay:1000,arrowOffsetX:-8,offsetX:-80,addActiveClass:false})};AJS.$(document).on("click","#dvcs-commits-tabpanel.ajax-activity-content",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"issue"}})});AJS.$(document).on("click",".dvcs-link",function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.linkclick",data:{type:AJS.$(this).attr("data-link-type")}})});AJS.$(document).on("click",'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-bitbucket-connector-plugin-dvcs-commits-greenhopper-tab"]',function(a){AJS.trigger("analyticsEvent",{name:"jira.dvcsconnector.commit.tabclick",data:{source:"agile"}})});
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'js/jquery.editinplace.js' */
jQuery.fn.editInPlace=function(a){var b={url:"",params:"",field_type:"text",select_options:"",textarea_cols:"25",textarea_rows:"10",bg_over:"#ffc",bg_out:"transparent",saving_text:"Saving...",saving_image:"",default_text:"(Click here to add text)",select_text:"Choose new value",value_required:null,element_id:"element_id",update_value:"update_value",original_html:"original_html",save_button:'<button class="inplace_save">Save</button>',cancel_button:'<button class="inplace_cancel">Cancel</button>',show_buttons:false,on_blur:"save",callback:null,callbackShowErrors:true,success:null,error:function(d){alert("Failed to save value: "+d.responseText||"Unspecified Error")}};if(a){jQuery.extend(b,a)}if(b.saving_image!=""){var c=new Image();c.src=b.saving_image}String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};String.prototype.escape_html=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};return this.each(function(){if(jQuery(this).html()==""){jQuery(this).html(b.default_text)}var d=false;var e=jQuery(this);var f=0;jQuery(this).mouseover(function(){jQuery(this).css("background",b.bg_over)}).mouseout(function(){jQuery(this).css("background",b.bg_out)}).click(function(){f++;if(!d){d=true;var m=jQuery(this).html();var q=(b.show_buttons)?b.save_button+" "+b.cancel_button:"";if(m==b.default_text){jQuery(this).html("")}if(b.field_type=="textarea"){var p='<textarea name="inplace_value" class="inplace_field">'+jQuery(this).text().trim().escape_html()+"</textarea>"}else{if(b.field_type=="text"){var p='<input type="text" name="inplace_value" class="inplace_field" value="'+jQuery(this).text().trim().escape_html()+'" />'}else{if(b.field_type=="select"){var n=b.select_options.split(",");var p='<select name="inplace_value" class="inplace_field"><option value="">'+b.select_text+"</option>";for(var l=0;l<n.length;l++){var h=n[l].split(":");var o=h[1]||h[0];var k=o==m?'selected="selected" ':"";p+="<option "+k+'value="'+o.trim().escape_html()+'">'+h[0].trim().escape_html()+"</option>"}p+="</select>"}}}jQuery(this).html('<form class="inplace_form" style="display: inline; margin: 0; padding: 0;">'+p+" "+q+"</form>")}if(f==1){function g(){d=false;f=0;e.css("background",b.bg_out);e.html(m);return false}function j(){e.css("background",b.bg_out);var i=jQuery(this);var s=(i.is("form"))?i.children(0).val():i.parent().children(0).val();if(b.saving_image!=""){var r='<img src="'+b.saving_image+'" alt="Saving..." />'}else{var r=b.saving_text}e.html(r);if(b.params!=""){b.params="&"+b.params}if(b.callback){html=b.callback(e.attr("id"),s,m,b.params);d=false;f=0;if(html){e.html(html||s)}else{if(b.callbackShowErrors){alert("Failed to save value: "+s)}e.html(m)}}else{if(b.value_required&&(s==""||s==undefined)){d=false;f=0;e.html(m);alert("Error: You must enter a value to save this field")}else{jQuery.ajax({url:b.url,type:"POST",data:b.update_value+"="+s+"&"+b.element_id+"="+e.attr("id")+b.params+"&"+b.original_html+"="+m,dataType:"html",complete:function(t){d=false;f=0},success:function(u){var t=u||b.default_text;e.html(t);if(b.success){b.success(u,e)}},error:function(t){e.html(m);if(b.error){b.error(t,e)}}})}}return false}e.children("form").children(".inplace_field").focus().select();e.children("form").children(".inplace_cancel").click(g);e.children("form").children(".inplace_save").click(j);if(!b.show_buttons){if(b.on_blur=="save"){e.children("form").children(".inplace_field").blur(j)}else{e.children("form").children(".inplace_field").blur(g)}}jQuery(document).keyup(function(i){if(i.keyCode==27){g()}});e.children("form").submit(j)}})})};
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.dropdown.js' */
tempo.dropdown=(function(b){function a(){var d=b(this.hash);var e=d.is(":visible");b("div.action-list .box, div.actions-list.box").hide();b("a.open-dropdown").removeClass("active");if(!e){d.show();b(this).addClass("active")}else{d.hide();b(this).removeClass("active")}return false}function c(){b("a.open-dropdown").bind("click",a);b(document).bind("click",function(){var d=b(this);if(!d.is(".action-list *,.open-dropdown,.open-dropdown *")){b("div.action-list .box, div.actions-list.box").hide();b("a.open-dropdown:not(.open-issue)").removeClass("active")}});b("a.open-dropdown:not(.open-issue)").removeClass("active");tempo.widget.Dropdown.create({trigger:".tempo-actions-trigger",ajaxOptions:{dataType:"json",cache:false,formatSuccess:function(e){var d=tempo.widget.formatSuccess(e);d.find("ul:first").remove();return d}}})}return{init:c,handler:a}}(AJS.$));
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.ui.js' */
tempo.ui=(function(a){function b(){a("a.tempo-spinner").live("click",function(){tempo.spinner.show()});a("a.no-link").live("click",function(){return false});a("select.tempoDynamicDropDown").live("change",function(){var d=a(this);d.attr("selectedValue",d.val())});var c=window.onbeforeunload;window.onbeforeunload=function(){a("form.tempo-form").fixDirtyForm();if(a.isFunction(c)){return c.call([])}return true}}return{init:b}}(AJS.$));
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.inplace.js' */
tempo.inplace=(function(c){function b(g){var h=false;AJS.$(g).find("submit-result").each(function(){var i=c(this);if(i.attr("valid")==="false"){i.find("errors").each(function(){var j=c(this);alert(j.find("errorMessage").text())});h=false}else{h=true}});return h}function f(g){return AJS.$("<div/>").text(g).html()}function a(g){if(g){tempo.state.dirty=true}else{tempo.requireReload()}}function e(l,k,j,h,i,g){var m=f(k);c.ajax({url:h,async:false,type:"POST",data:i,dataType:"xml",success:function(n){if(!b(n)){return j}else{a(g)}},error:function(n){alert("Error: "+tempo.extractErrorMessage(n.responseText));return j}});return m}function d(j,g){j=j||document;var h="Save";var i="Cancel";c("span.tempo-edit-inplace",j).each(function(){var k=c(this);var o=k.hasClass("required");var m=k.attr("data-type")||"text";var l=k.attr("data-key");var n=k.attr("data-resource");if(m!=="select"){k.editInPlace({value_required:o,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',callbackShowErrors:false,field_type:m,callback:function(r,q,p){e(r,q,p,n,{value:q,attributeKey:l},g);a(g);return c(p).text(q)}})}else{k.bind("click",function(){var p=k.siblings("select");k.hide();p.show()})}});tempo.widget.Dropdown.create({trigger:".tempo-actions-trigger",ajaxOptions:{dataType:"json",cache:false,formatSuccess:function(l){var k=tempo.widget.formatSuccess(l);k.find("ul:first").remove();return k}}});c("span.editHours",j).editInPlace({value_required:true,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',callbackShowErrors:false,field_type:"text",callback:function(o,l,k){var n=c("#"+o).attr("hourtype");var p=o.replace(n+"_","");var m=e(o,l,k,contextPath+"/rest/tempo-rest/1.0/worklogs/hours/update",{worklogId:p,worklogHours:l,hourType:n},g);if(parseInt(m,10)!==parseInt(c(k).text(),10)){a(g);return c(k).text(l)}return m}});c("span.editDesc",j).editInPlace({value_required:true,callbackShowErrors:false,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',field_type:"textarea",textarea_rows:3,callback:function(m,l,k){var n=m.replace("comment_","");e(m,l,k,contextPath+"/rest/tempo-rest/1.0/worklogs/description/update",{worklogId:n,worklogDescription:l},g);return c(k).text(l)}});c("span.tempo-calendar-inline",j).each(function(){var l=c(this);var q=l.find(".tempo-calendar-display");var m=l.find(".tempo-calendar-input");var n=l.find(".tempo-calendar-trigger");var p=m.attr("id").replace("date_","");q.editInPlace({value_required:true,callbackShowErrors:false,show_buttons:true,save_button:'<a class="inplace_save" title="'+h+'">saveText</a>',cancel_button:'<a class="inplace_cancel" title="'+i+'">cancelText</a>',field_type:"text",callback:function(u,t,s){return e(u,t,s,contextPath+"/rest/tempo-rest/1.0/worklogs/date/update",{worklogId:p,worklogDate:t},g)}});var o=l.hasClass("showStartTime");var r=l.hasClass("ISO8061WeekNumbers");var k=tempo.DATE_FORMAT;if(o){k=tempo.DATE_TIME_FORMAT}Calendar.setup({context:l,firstDay:0,displayArea:q.attr("id"),inputField:m.attr("id"),button:n.attr("id"),align:"Tl",singleClick:true,ifFormat:k,daFormat:k,timeFormat:"24",showsTime:o,useISO8601WeekNumbers:r,electric:false});m.bind("change",function(){e(this,this.value,this.value,contextPath+"/rest/tempo-rest/1.0/worklogs/date/update",{worklogId:p,worklogDate:this.value},g)})})}return d}(AJS.$));
/* module-key = 'is.origo.jira.tempo-plugin:tempo-resource', location = 'com/tempoplugin/js/tempo.worklogforms.js' */
tempo.worklogforms=(function(a){function b(){function f(i){jira.widget.autocomplete.Issues({fieldID:i,ajaxData:{fieldName:i,showSubTasks:"true",currentJQL:""}})}function e(j,i){if(a.browser.msie){a(j).find(":not([autocomplete])").keypress(function(k){if(k.which===13){j.trigger(i);return false}});a(j).find("[autocomplete]").keypress(function(k){if(k.which===13){return false}})}}var c=new tempo.widget.FormPopup({id:"tempo-split-form-dialog",trigger:"a.worklogaction-tempo-split-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var i=this.get$popupContent();i.bind("split",tempo.submit);a("#issue-split-button",i).bind("click",function(){i.trigger("split");return false});e(i,"split");f("splitIssue");a(".tempo-timepicker",i).tempoTimePicker();a("select.tempo-issue-picker",i).tempoIssuePicker({submitHandler:function(){i.trigger("split")}})}});var h=new tempo.widget.FormPopup({id:"tempo-move-form-dialog",trigger:"a.worklogaction-tempo-move-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var i=this.get$popupContent();i.bind("move",tempo.submit);a("#issue-move-button",i).bind("click",function(){i.trigger("move");return false});e(i,"move");f("moveIssueKey");a(".tempo-timepicker",i).tempoTimePicker();a("select.tempo-issue-picker",i).tempoIssuePicker({submitHandler:function(){i.trigger("move")}})}});var d=new tempo.widget.FormPopup({id:"tempo-delete-form-dialog",trigger:"a.worklogaction-tempo-delete-worklog",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium"});a("a.delete-worklog").live("click",function(){var j=a("#comment_"+this.id.split("_")[1]).text();var i=confirm(this.title+"\n '"+a.trim(j)+"'");if(i){AJS.$.ajax({async:false,url:this.href,type:"DELETE",success:function(){tempo.reload()},error:function(k){alert("Error during delete: "+tempo.extractErrorMessage(k.responseText))}})}return false});var g=a("#tempo-report-module.stalker-original").find(":input.worklog-attribute");g.live("click",function(){var i=a(this);if(i.val()!==null&&i.parent().find(".no-value").length===1){i.trigger("change")}});g.live("change",function(){var k=a(this);var i=k.attr("data-worklog");var j=k.attr("data-key");var l=k.val();if(k.is(":checkbox")&&!k.is(":checked")){l=""}a.ajax({url:contextPath+"/rest/tempo-rest/2.0/worklogs/"+i+"/attributes",data:{value:l,attributeKey:j},type:"POST",dataType:"xml",success:function(m){a(m).find("submit-result").each(function(){var o=a(this);if(o.attr("valid")==="false"){o.find("errors").each(function(){var q=a(this);alert(q.find("errorMessage").text())})}else{tempo.requireReload();if(k.hasClass("tempoDynamicDropDown")){var n=k.siblings("span.edit-select");if(n.length>0){var p=k.children("option:selected").text();k.hide();n.text(p).show()}}}})},error:function(m){alert("Unknown update error: "+m)}})})}return{init:b}}(AJS.$));
/* module-key = 'is.origo.jira.tempo-plugin:tempo-issueview-resource', location = 'com/tempoplugin/js/tempo.issuepanel.js' */
tempo.ui.init();tempo.worklogforms.init();tempo.dropdown.init();JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,d){if(JIRA.Issues&&JIRA.Issues.InlineEdit){JIRA.Issues.InlineEdit.BlurTriggerMapping.custom.billingKeys=JIRA.Issues.InlineEdit.BlurTriggers.Default}var b=AJS.$(d);function c(e){b.find("#tempo-content").empty().append(e)}function a(e){AJS.$.ajax({async:true,url:contextPath+"/TempoIssuePanel!default.jspa?id="+jira.app.issue.getIssueId()+"&period="+e,type:"GET",success:function(h){c(h);tempo.inplace(b.find("#tempo-content"));b.find("#tempo-content a.open-dropdown").bind("click",tempo.dropdown.handler)}})}if(b.find("#tempo-content")){var g=b.find("#tempo-content");if(g.hasClass("empty")){a("");g.removeClass("empty")}}b.find("a.selectperiod").live("click",function(h){var i=AJS.$(this).attr("id").replace("period_","");a(i);h.preventDefault();return false})});
/* module-key = 'is.origo.jira.tempo-plugin:tempo-dialog-resource', location = 'com/tempoplugin/js/tempo.dialog.js' */
tempo.dialog=(function(d){function k(){return{page:0,panel:0,date:"",user:tempo.state.user,issue:"",period:false,header:false,comment:"",id:"",time:"",billedTime:"",remainingEstimate:"",focus:":input:visible:first",name:"tempo-add-button"}}function e(p,m){var l=m.getCurrentPanel().body;var n=d(m.page[0].buttonpanel).find("#issue-add-another");if(n.attr("checked")&&(p==="add"||p==="add-close")){l.trigger("add");d(l).find(".showperiod")[0].checked=false}else{l.trigger(p)}d("form.tempo-form :input:visible:first").focus();if(p==="cancel"){var o=l.find("form").fixDirtyForm();if(tempo.state.dirty){tempo.reload()}else{m.hide();o.cleanFormValidation();o.resetFormFields()}o.fixDirtyForm()}}var a={initialised:false};function g(n){var l=a[n];if(l){return l}l=new AJS.Dialog(780,570);var m=0;if(!a.initialised){d("div.dialog-panel-body").live("add",tempo.submit).live("add-close",tempo.submit).live("update",tempo.submit);a.initialised=true}d("#"+n+"-dialog").each(function(s){var r=d(this);d("input.tempo-show-period",r).bind("click",tempo.showHoursLabel);d("form.tempo-form textarea",r).expandOnInput();d("div.tempo-timepicker",r).tempoTimePicker();d("div.datepicker",r).tempoDatePicker({validate:true});d("select.tempo-project-picker",r).tempoProjectPicker();d("select.tempo-activity-picker",r).tempoActivityPicker();d("select.tempo-picker-all-issues",r).tempoIssuePicker();d("select.tempo-picker-internal",r).tempoIssuePicker({type:"internal"});d("select.tempo-picker-assigned",r).tempoIssuePicker({type:"assigned"});d("select.tempo-picker-watched",r).tempoIssuePicker({type:"watched"});d("select.dialog-user-picker",r).tempoSingleUserPicker();d("select.tempo-issue-picker-filter",r).tempoIssuePicker();d("select.tempo-filter-dropdown",r).tempoFilterPicker();d("select.tempo-filter-dropdown",r).trigger("change");var t=r.attr("title");if(s===0){tempo.state.popup_title[n]=t}else{l.addPage();l.page[s].addHeader(t)}r.find("ul.dialog-buttons li").each(function(){var p=d(this);l.page[s].addButton(p.text(),function(v){var u=p.attr("class");e(u,v)})});var o;if(r.find("input[name=planning]").val()==="true"){o="Plan another"}else{o="Log another"}l.page[s].buttonpanel.prepend(d("<label>").attr({"for":"issue-add-another"}).text(o)).prepend(d("<input>").attr({id:"issue-add-another",name:o,value:o,type:"checkbox"}));var q=true;d(l.page[s].buttonpanel).find("button").each(function(){if(q){d(this).attr("accesskey","s");q=false}});r.find("div.dialog-panel-form").each(function(){var u=d(this).detach();l.page[s].addPanel(this.title,"dialog-panel-"+m,"");var p=l.getCurrentPanel().body;p.append(u);m++;this.title="";u.find("form").each(function(){d(this).bind("before-submit",function(v){v.stopPropagation()});d(this).submit(function(w){w.stopPropagation();var v=d(".button-panel-button[accesskey=s]");v.click();return false})})})});a[n]=l;return l}function c(o){o=d.extend(k(),o);var n=g(o.name);if(o.page<2){n.page[o.page].addHeader(tempo.state.popup_title[o.name])}var l=n.getPage(o.page).body;l.setFormFields(o);if(o.panel>=0&&o.panel<n.getPage(o.page).panel.length){n.gotoPanel(o.panel)}else{n.gotoPanel(0)}n.show();l.siblings("h2").addClass(o.name);var m=l.find(o.focus);m.trigger("focus").select()}var f=0;function h(l){var m=AJS.InlineDialog(l.start,(++f).toString(),contextPath+"/TempoTimesheetProgress.jspa?period="+l.period+"&user="+l.user.userName,{width:350,initCallback:function(){d(".close").bind("click",function(){m.hide()})}});m.show();return false}function i(m){AJS.$(document).trigger("hideAllLayers");function l(o){if(o&&o.length>0&&o[0].popup!==undefined){o[0].popup.hide()}}var n=AJS.InlineDialog(m.start,"user-hover-dialog-tempo-"+(++f),contextPath+(m.action||"/TempoEditWorklog!default.jspa?key="+m.issue)+"&date="+m.date+(m.user?"&user="+m.user.userName:""),{width:700,hideDelay:20000,initCallback:function(){var p=d("#inline-dialog-user-hover-dialog-tempo-"+f);p.css("z-index","4000");p.addClass("active").click(function(t){var s=d(t.target);if(!s.is(".aui-list-item-link")&&!s.is(".tempo-inline-link")&&!s.is(".issueaction-tempo-add-hours-on-issue")){t.stopPropagation()}if(s.is(".issueaction-tempo-add-hours-on-issue")){l(n)}});n.show();tempo.inplace(p,true);d(".close",p).bind("click",function(){l(n);return false});var r=d("#hidden-log-work-link");if(r.length>0){var o=null;if(m.addAction){var q=contextPath+m.addAction+"&date="+m.date+"&user="+m.user.userName;r.attr("href",q);o=r}else{o={click:function(){c(m)}}}d(".cell-add",p).bind("click",function(){o.click()})}},hideCallback:function(){if(tempo.state.dirty){tempo.reload()}}});n.show();return false}function b(l){var n=d("#hidden-log-work-link");if(n.length>0){var m=contextPath+(l.action||"/TempoAddHours!default.jspa?key="+l.issue);n.attr("href",m+"&date="+l.date+"&enddate="+l.end+"&user="+l.user.userName);n.click()}}function j(){var l=d("#user");d.extend(tempo.state,{user:{fullName:l.html(),userName:l.attr("title"),userAvatar:contextPath+l.data("avatar"),selectedPanelWorklog:l.data("selected-panel-worklog"),selectedPanelPlan:l.data("selected-panel-plan")}});d("a.section-name").bind("click",function(A){A.stopPropagation();window.location=(d(this).attr("href"))});d("#add-buttons a.open-dialog").bind("click",function(){var A=k();A.page=0;A.name=this.name;tempo.dialog.panel(A);return false});if(tempo.table&&tempo.table.hasClass("tempo-calendar-table")){d("div.event",tempo.table).bind("click",function(){var C=d(this);var D=C.closest("td");var F=D.attr("data-tempo-date").split("|");var B=F[0];var E=C.find("a.tempo-view-planning-details").attr("href");var A={action:E,date:B,start:C,page:0};tempo.dialog.inline(A);return false});d("td.cal-day",tempo.table).bind("click",function(){var A=d(this).attr("data-tempo-date").split("|");tempo.dialog.panel({date:A[0],endDate:A[0],dateFormat:A[1],endDateFormat:A[1],name:"tempo-plan-button",page:0});return false})}if(tempo.table&&tempo.table.hasClass("tempo-timesheet-table")){var x=tempo.table;var r={active:false,start:null,end:null};var s,z,y,o,p;if(tempo.timesheet.disableStalker()){s=d("#tempo-table").find("thead")}else{s=d("#tempo-table.stalker-clone").find("thead");o=+s.find("tr.rowHeader th:first").attr("colspan")-1;p={dates:null,weekDays:null}}y=s.find("tr.rowHeader:nth(1) th.weekday");z=s.find("tr.rowHeader:first th.normal");var m=s.find("tr.rowHeader:nth(1) th:first a.tempo-edit-hours-on-item");if(m.length>0){y.css("cursor","pointer").live("click",function(){var B=m.attr("href");var A={start:d(this),date:d(this).attr("data-tempo-date"),dateFormat:d(this).attr("data-tempo-date-formatted"),action:B,name:"tempo-plan-button"};tempo.dialog.inline(A)})}if(z){var t=s.find("tr.rowHeader:first th:first a.tempo-edit-hours-on-item");if(t.length>0){z.bind("click",function(){var B=t.attr("href");var A={start:d(this),date:d(this).attr("data-tempo-date"),dateFormat:d(this).attr("data-tempo-date-formatted"),action:B,name:"tempo-plan-button"};tempo.dialog.inline(A);return false})}}var q=x.find("tbody");var n=q.find("td");var v=q.find("tr").length;d("td.time-cell.value-cell").bind("mousedown",function(){var A=d(this);r.active=true;r.start=A;r.end=A});var u=n.filter(".edit-day").not(".not-selectable)").bind("mousedown",function(){var A=d(this);if(!A.hasClass("not-selectable")){r.active=true;r.start=A;r.end=A;A.css("background-color","#ffcc99")}});var w="center";if(v<201){u.bind("mouseenter",function(){var B=d(this);var E=B.getPosition();var D=E.col-o;if(p){p.dates=d(z[D-1]).addClass("highlight");p.weekDays=d(y[D-1]).addClass("highlight")}if(r.active){if(!B.hasClass("not-selectable")){var C=r.start.getPosition();var A=r.end.getPosition();if(C.row===E.row){if(w==="center"){if(E.col<C.col){w="left"}else{if(E.col>A.col){w="right"}}}if(w==="left"){if(E.col>C.col){r.start.css("background-color","")}r.start=B;if(E.col===A.col){w="center"}}else{if(w==="right"){if(E.col<A.col){r.end.css("background-color","")}r.end=B;if(E.col===C.col){w="center"}}}B.css("background-color","#ffcc99")}}}}).bind("mouseleave",function(){if(p&&p.dates!==null){p.dates.removeClass("highlight");p.weekDays.removeClass("highlight");p.dates=null}})}d("html").bind("mouseup",function(){if(r.active){r.active=false;w="center";u.css("background-color","");var I=d.trim(r.end.text())||r.end.find("div.allocation-bar").length;var K=r.start.closest("tr");var F=r.start.attr("abbr").split("|");var B=r.end.attr("abbr").split("|");var C=F[0];var H=B[0];var L={date:C,endDate:H,dateFormat:F[1],dateTimeFormat:F[2],endDateFormat:B[1]};var D=null;var E=null;if(K.is(".sublog")){var G=K.prevAll(".mainlog:first");if(G.is(".log-user")){D=G.find("td.username");E=G.find("td.image")}}if(K.is(".log-user")){D=K.find("td.username");E=K.find("td.image");L.issue=K.attr("data-issueKey");if(tempo.planning){L.name="tempo-plan-button"}}if(D){L.user={userName:D.attr("data-tempo-user"),fullName:D.find("a").html(),userAvatar:E.find("img").attr("src")}}else{L.user=tempo.state.user}if(K.is(".log-issue")){L.issue=K.find("td.issue a").attr("title")}var J=K.find("td:first a.tempo-add-hours-to-item").attr("href");var A=K.find("td:first a.tempo-edit-hours-on-item").attr("href");L.editAction=A;L.addAction=J;L.start=r.start;L.end=H;L.focus="input[name=time]";if(I&&(C===H)&&A){L.action=A;tempo.dialog.inline(L)}else{if(J){L.action=J;tempo.dialog.simple(L)}else{L.page=0;tempo.dialog.panel(L)}}r.start=null;r.end=null}})}}d("select.plan-user-picker").live("selected",function(){var o=d(this);var m=o.data("counter");var l=d("select#request-select-"+m);var n=d(this).val()[0];if(n!==""&&l.length>0){l.empty();l.append(d("<option>",{value:""}).text("No reviewer selected"));AJS.$.ajax({url:contextPath+"/rest/tempo-rest/2.0/planning/getSupervisors/",cache:false,data:{username:n},success:function(p){d(p).find("simple-user").each(function(){var q=d(this);var r=(q.attr("selectedSupervisor")==="true")?(" ("+"Supervisor"+")"):"";l.append(d("<option>",{value:q.attr("userName")}).text(q.attr("displayName")+r))})}})}});return{panel:c,inline:i,simple:b,progress:h,init:j}}(AJS.$));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone-1.0.0.js' */
(function(){var U=this;var b=U.Backbone;var G=[];var d=G.push;var N=G.slice;var T=G.splice;var Z;if(typeof exports!=="undefined"){Z=exports}else{Z=U.Backbone={}}Z.VERSION="1.0.0";var l=U._;if(!l&&(typeof require!=="undefined")){l=require("underscore")}Z.$=U.jQuery||U.Zepto||U.ender||U.$;Z.noConflict=function(){U.Backbone=b;return this};Z.emulateHTTP=false;Z.emulateJSON=false;var j=Z.Events={on:function(m,p,o){if(!X(this,"on",m,[p,o])||!p){return this}this._events||(this._events={});var n=this._events[m]||(this._events[m]=[]);n.push({callback:p,context:o,ctx:o||this});return this},once:function(n,q,o){if(!X(this,"once",n,[q,o])||!q){return this}var m=this;var p=l.once(function(){m.off(n,p);q.apply(this,arguments)});p._callback=q;return this.on(n,p,o)},off:function(m,v,n){var t,u,w,s,r,o,q,p;if(!this._events||!X(this,"off",m,[v,n])){return this}if(!m&&!v&&!n){this._events={};return this}s=m?[m]:l.keys(this._events);for(r=0,o=s.length;r<o;r++){m=s[r];if(w=this._events[m]){this._events[m]=t=[];if(v||n){for(q=0,p=w.length;q<p;q++){u=w[q];if((v&&v!==u.callback&&v!==u.callback._callback)||(n&&n!==u.context)){t.push(u)}}}if(!t.length){delete this._events[m]}}}return this},trigger:function(o){if(!this._events){return this}var n=N.call(arguments,1);if(!X(this,"trigger",o,n)){return this}var p=this._events[o];var m=this._events.all;if(p){B(p,n)}if(m){B(m,arguments)}return this},stopListening:function(p,m,r){var n=this._listeners;if(!n){return this}var o=!m&&!r;if(typeof m==="object"){r=this}if(p){(n={})[p._listenerId]=p}for(var q in n){n[q].off(m,r,this);if(o){delete this._listeners[q]}}return this}};var W=/\s+/;var X=function(t,r,n,q){if(!n){return true}if(typeof n==="object"){for(var p in n){t[r].apply(t,[p,n[p]].concat(q))}return false}if(W.test(n)){var s=n.split(W);for(var o=0,m=s.length;o<m;o++){t[r].apply(t,[s[o]].concat(q))}return false}return true};var B=function(r,p){var s,q=-1,o=r.length,n=p[0],m=p[1],t=p[2];switch(p.length){case 0:while(++q<o){(s=r[q]).callback.call(s.ctx)}return ;case 1:while(++q<o){(s=r[q]).callback.call(s.ctx,n)}return ;case 2:while(++q<o){(s=r[q]).callback.call(s.ctx,n,m)}return ;case 3:while(++q<o){(s=r[q]).callback.call(s.ctx,n,m,t)}return ;default:while(++q<o){(s=r[q]).callback.apply(s.ctx,p)}}};var c={listenTo:"on",listenToOnce:"once"};l.each(c,function(m,n){j[n]=function(q,o,s){var p=this._listeners||(this._listeners={});var r=q._listenerId||(q._listenerId=l.uniqueId("l"));p[r]=q;if(typeof o==="object"){s=this}q[m](o,s,this);return this}});j.bind=j.on;j.unbind=j.off;l.extend(Z,j);var e=Z.Model=function(m,o){var p;var n=m||{};o||(o={});this.cid=l.uniqueId("c");this.attributes={};l.extend(this,l.pick(o,f));if(o.parse){n=this.parse(n,o)||{}}if(p=l.result(this,"defaults")){n=l.defaults({},n,p)}this.set(n,o);this.changed={};this.initialize.apply(this,arguments)};var f=["url","urlRoot","collection"];l.extend(e.prototype,j,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(m){return l.clone(this.attributes)},sync:function(){return Z.sync.apply(this,arguments)},get:function(m){return this.attributes[m]},escape:function(m){return l.escape(this.get(m))},has:function(m){return this.get(m)!=null},set:function(u,m,y){var s,v,w,t,r,x,o,q;if(u==null){return this}if(typeof u==="object"){v=u;y=m}else{(v={})[u]=m}y||(y={});if(!this._validate(v,y)){return false}w=y.unset;r=y.silent;t=[];x=this._changing;this._changing=true;if(!x){this._previousAttributes=l.clone(this.attributes);this.changed={}}q=this.attributes,o=this._previousAttributes;if(this.idAttribute in v){this.id=v[this.idAttribute]}for(s in v){m=v[s];if(!l.isEqual(q[s],m)){t.push(s)}if(!l.isEqual(o[s],m)){this.changed[s]=m}else{delete this.changed[s]}w?delete q[s]:q[s]=m}if(!r){if(t.length){this._pending=true}for(var p=0,n=t.length;p<n;p++){this.trigger("change:"+t[p],this,q[t[p]],y)}}if(x){return this}if(!r){while(this._pending){this._pending=false;this.trigger("change",this,y)}}this._pending=false;this._changing=false;return this},unset:function(m,n){return this.set(m,void 0,l.extend({},n,{unset:true}))},clear:function(n){var m={};for(var o in this.attributes){m[o]=void 0}return this.set(m,l.extend({},n,{unset:true}))},hasChanged:function(m){if(m==null){return !l.isEmpty(this.changed)}return l.has(this.changed,m)},changedAttributes:function(o){if(!o){return this.hasChanged()?l.clone(this.changed):false}var q,p=false;var n=this._changing?this._previousAttributes:this.attributes;for(var m in o){if(l.isEqual(n[m],(q=o[m]))){continue}(p||(p={}))[m]=q}return p},previous:function(m){if(m==null||!this._previousAttributes){return null}return this._previousAttributes[m]},previousAttributes:function(){return l.clone(this._previousAttributes)},fetch:function(n){n=n?l.clone(n):{};if(n.parse===void 0){n.parse=true}var m=this;var o=n.success;n.success=function(p){if(!m.set(m.parse(p,n),n)){return false}if(o){o(m,p,n)}m.trigger("sync",m,p,n)};h(this,n);return this.sync("read",this,n)},save:function(q,n,u){var r,m,t,o=this.attributes;if(q==null||typeof q==="object"){r=q;u=n}else{(r={})[q]=n}if(r&&(!u||!u.wait)&&!this.set(r,u)){return false}u=l.extend({validate:true},u);if(!this._validate(r,u)){return false}if(r&&u.wait){this.attributes=l.extend({},o,r)}if(u.parse===void 0){u.parse=true}var p=this;var s=u.success;u.success=function(w){p.attributes=o;var v=p.parse(w,u);if(u.wait){v=l.extend(r||{},v)}if(l.isObject(v)&&!p.set(v,u)){return false}if(s){s(p,w,u)}p.trigger("sync",p,w,u)};h(this,u);m=this.isNew()?"create":(u.patch?"patch":"update");if(m==="patch"){u.attrs=r}t=this.sync(m,this,u);if(r&&u.wait){this.attributes=o}return t},destroy:function(n){n=n?l.clone(n):{};var m=this;var q=n.success;var o=function(){m.trigger("destroy",m,m.collection,n)};n.success=function(r){if(n.wait||m.isNew()){o()}if(q){q(m,r,n)}if(!m.isNew()){m.trigger("sync",m,r,n)}};if(this.isNew()){n.success();return false}h(this,n);var p=this.sync("delete",this,n);if(!n.wait){o()}return p},url:function(){var m=l.result(this,"urlRoot")||l.result(this.collection,"url")||R();if(this.isNew()){return m}return m+(m.charAt(m.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(n,m){return n},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(m){return this._validate({},l.extend(m||{},{validate:true}))},_validate:function(o,n){if(!n.validate||!this.validate){return true}o=l.extend({},this.attributes,o);var m=this.validationError=this.validate(o,n)||null;if(!m){return true}this.trigger("invalid",this,m,l.extend(n||{},{validationError:m}));return false}});var A=["keys","values","pairs","invert","pick","omit"];l.each(A,function(m){e.prototype[m]=function(){var n=N.call(arguments);n.unshift(this.attributes);return l[m].apply(l,n)}});var C=Z.Collection=function(n,m){m||(m={});if(m.url){this.url=m.url}if(m.model){this.model=m.model}if(m.comparator!==void 0){this.comparator=m.comparator}this._reset();this.initialize.apply(this,arguments);if(n){this.reset(n,l.extend({silent:true},m))}};var O={add:true,remove:true,merge:true};var k={add:true,merge:false,remove:false};l.extend(C.prototype,j,{model:e,initialize:function(){},toJSON:function(m){return this.map(function(n){return n.toJSON(m)})},sync:function(){return Z.sync.apply(this,arguments)},add:function(n,m){return this.set(n,l.defaults(m||{},k))},remove:function(r,p){r=l.isArray(r)?r.slice():[r];p||(p={});var q,m,o,n;for(q=0,m=r.length;q<m;q++){n=this.get(r[q]);if(!n){continue}delete this._byId[n.id];delete this._byId[n.cid];o=this.indexOf(n);this.models.splice(o,1);this.length--;if(!p.silent){p.index=o;n.trigger("remove",n,this,p)}this._removeReference(n)}return this},set:function(n,z){z=l.defaults(z||{},O);if(z.parse){n=this.parse(n,z)}if(!l.isArray(n)){n=n?[n]:[]}var u,q,w,x,o,v;var p=z.at;var t=this.comparator&&(p==null)&&z.sort!==false;var r=l.isString(this.comparator)?this.comparator:null;var y=[],m=[],s={};for(u=0,q=n.length;u<q;u++){if(!(w=this._prepareModel(n[u],z))){continue}if(o=this.get(w)){if(z.remove){s[o.cid]=true}if(z.merge){o.set(w.attributes,z);if(t&&!v&&o.hasChanged(r)){v=true}}}else{if(z.add){y.push(w);w.on("all",this._onModelEvent,this);this._byId[w.cid]=w;if(w.id!=null){this._byId[w.id]=w}}}}if(z.remove){for(u=0,q=this.length;u<q;++u){if(!s[(w=this.models[u]).cid]){m.push(w)}}if(m.length){this.remove(m,z)}}if(y.length){if(t){v=true}this.length+=y.length;if(p!=null){T.apply(this.models,[p,0].concat(y))}else{d.apply(this.models,y)}}if(v){this.sort({silent:true})}if(z.silent){return this}for(u=0,q=y.length;u<q;u++){(w=y[u]).trigger("add",w,this,z)}if(v){this.trigger("sort",this,z)}return this},reset:function(p,n){n||(n={});for(var o=0,m=this.models.length;o<m;o++){this._removeReference(this.models[o])}n.previousModels=this.models;this._reset();this.add(p,l.extend({silent:true},n));if(!n.silent){this.trigger("reset",this,n)}return this},push:function(n,m){n=this._prepareModel(n,m);this.add(n,l.extend({at:this.length},m));return n},pop:function(n){var m=this.at(this.length-1);this.remove(m,n);return m},unshift:function(n,m){n=this._prepareModel(n,m);this.add(n,l.extend({at:0},m));return n},shift:function(n){var m=this.at(0);this.remove(m,n);return m},slice:function(n,m){return this.models.slice(n,m)},get:function(m){if(m==null){return void 0}return this._byId[m.id!=null?m.id:m.cid||m]},at:function(m){return this.models[m]},where:function(m,n){if(l.isEmpty(m)){return n?void 0:[]}return this[n?"find":"filter"](function(o){for(var p in m){if(m[p]!==o.get(p)){return false}}return true})},findWhere:function(m){return this.where(m,true)},sort:function(m){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}m||(m={});if(l.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(l.bind(this.comparator,this))}if(!m.silent){this.trigger("sort",this,m)}return this},sortedIndex:function(m,p,n){p||(p=this.comparator);var o=l.isFunction(p)?p:function(q){return q.get(p)};return l.sortedIndex(this.models,m,o,n)},pluck:function(m){return l.invoke(this.models,"get",m)},fetch:function(m){m=m?l.clone(m):{};if(m.parse===void 0){m.parse=true}var o=m.success;var n=this;m.success=function(p){var q=m.reset?"reset":"set";n[q](p,m);if(o){o(n,p,m)}n.trigger("sync",n,p,m)};h(this,m);return this.sync("read",this,m)},create:function(n,m){m=m?l.clone(m):{};if(!(n=this._prepareModel(n,m))){return false}if(!m.wait){this.add(n,m)}var p=this;var o=m.success;m.success=function(q){if(m.wait){p.add(n,m)}if(o){o(n,q,m)}};n.save(null,m);return n},parse:function(n,m){return n},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(o,n){if(o instanceof e){if(!o.collection){o.collection=this}return o}n||(n={});n.collection=this;var m=new this.model(o,n);if(!m._validate(o,n)){this.trigger("invalid",this,o,n);return false}return m},_removeReference:function(m){if(this===m.collection){delete m.collection}m.off("all",this._onModelEvent,this)},_onModelEvent:function(o,n,p,m){if((o==="add"||o==="remove")&&p!==this){return }if(o==="destroy"){this.remove(n,m)}if(n&&o==="change:"+n.idAttribute){delete this._byId[n.previous(n.idAttribute)];if(n.id!=null){this._byId[n.id]=n}}this.trigger.apply(this,arguments)}});var Y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];l.each(Y,function(m){C.prototype[m]=function(){var n=N.call(arguments);n.unshift(this.models);return l[m].apply(l,n)}});var K=["groupBy","countBy","sortBy"];l.each(K,function(m){C.prototype[m]=function(p,n){var o=l.isFunction(p)?p:function(q){return q.get(p)};return l[m](this.models,o,n)}});var g=Z.View=function(m){this.cid=l.uniqueId("view");this._configure(m||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var V=/^(\S+)\s*(.*)$/;var E=["model","collection","el","id","attributes","className","tagName","events"];l.extend(g.prototype,j,{tagName:"div",$:function(m){return this.$el.find(m)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(m,n){if(this.$el){this.undelegateEvents()}this.$el=m instanceof Z.$?m:Z.$(m);this.el=this.$el[0];if(n!==false){this.delegateEvents()}return this},delegateEvents:function(q){if(!(q||(q=l.result(this,"events")))){return this}this.undelegateEvents();for(var p in q){var r=q[p];if(!l.isFunction(r)){r=this[q[p]]}if(!r){continue}var o=p.match(V);var n=o[1],m=o[2];r=l.bind(r,this);n+=".delegateEvents"+this.cid;if(m===""){this.$el.on(n,r)}else{this.$el.on(n,m,r)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(m){if(this.options){m=l.extend({},l.result(this,"options"),m)}l.extend(this,l.pick(m,E));this.options=m},_ensureElement:function(){if(!this.el){var m=l.extend({},l.result(this,"attributes"));if(this.id){m.id=l.result(this,"id")}if(this.className){m["class"]=l.result(this,"className")}var n=Z.$("<"+l.result(this,"tagName")+">").attr(m);this.setElement(n,false)}else{this.setElement(l.result(this,"el"),false)}}});Z.sync=function(s,n,m){var p=J[s];l.defaults(m||(m={}),{emulateHTTP:Z.emulateHTTP,emulateJSON:Z.emulateJSON});var r={type:p,dataType:"json"};if(!m.url){r.url=l.result(n,"url")||R()}if(m.data==null&&n&&(s==="create"||s==="update"||s==="patch")){r.contentType="application/json";r.data=JSON.stringify(m.attrs||n.toJSON(m))}if(m.emulateJSON){r.contentType="application/x-www-form-urlencoded";r.data=r.data?{model:r.data}:{}}if(m.emulateHTTP&&(p==="PUT"||p==="DELETE"||p==="PATCH")){r.type="POST";if(m.emulateJSON){r.data._method=p}var o=m.beforeSend;m.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",p);if(o){return o.apply(this,arguments)}}}if(r.type!=="GET"&&!m.emulateJSON){r.processData=false}if(r.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var q=m.xhr=Z.ajax(l.extend(r,m));n.trigger("request",n,q,m);return q};var J={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Z.ajax=function(){return Z.$.ajax.apply(Z.$,arguments)};var P=Z.Router=function(m){m||(m={});if(m.routes){this.routes=m.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var Q=/\((.*?)\)/g;var S=/(\(\?)?:\w+/g;var D=/\*\w+/g;var H=/[\-{}\[\]+?.,\\\^$|#\s]/g;l.extend(P.prototype,j,{initialize:function(){},route:function(n,o,p){if(!l.isRegExp(n)){n=this._routeToRegExp(n)}if(l.isFunction(o)){p=o;o=""}if(!p){p=this[o]}var m=this;Z.history.route(n,function(r){var q=m._extractParameters(n,r);p&&p.apply(m,q);m.trigger.apply(m,["route:"+o].concat(q));m.trigger("route",o,q);Z.history.trigger("route",m,o,q)});return this},navigate:function(n,m){Z.history.navigate(n,m);return this},_bindRoutes:function(){if(!this.routes){return }this.routes=l.result(this,"routes");var n,m=l.keys(this.routes);while((n=m.pop())!=null){this.route(n,this.routes[n])}},_routeToRegExp:function(m){m=m.replace(H,"\\$&").replace(Q,"(?:$1)?").replace(S,function(o,n){return n?o:"([^/]+)"}).replace(D,"(.*?)");return new RegExp("^"+m+"$")},_extractParameters:function(m,n){var o=m.exec(n).slice(1);return l.map(o,function(p){return p?decodeURIComponent(p):null})}});var I=Z.History=function(){this.handlers=[];l.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var a=/^[#\/]|\s+$/g;var F=/^\/+|\/+$/g;var i=/msie [\w.]+/;var M=/\/$/;I.started=false;l.extend(I.prototype,j,{interval:50,getHash:function(n){var m=(n||this).location.href.match(/#(.*)$/);return m?m[1]:""},getFragment:function(o,n){if(o==null){if(this._hasPushState||!this._wantsHashChange||n){o=this.location.pathname;var m=this.root.replace(M,"");if(!o.indexOf(m)){o=o.substr(m.length)}}else{o=this.getHash()}}return o.replace(a,"")},start:function(o){if(I.started){throw new Error("Backbone.history has already been started")}I.started=true;this.options=l.extend({},{root:"/"},this.options,o);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment();var m=document.documentMode;var q=(i.exec(navigator.userAgent.toLowerCase())&&(!m||m<=7));this.root=("/"+this.root+"/").replace(F,"/");if(q&&this._wantsHashChange){this.iframe=Z.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(n)}if(this._hasPushState){Z.$(window).on("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!q){Z.$(window).on("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=n;var r=this.location;var p=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!p){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&p&&r.hash){this.fragment=this.getHash().replace(a,"");this.history.replaceState({},document.title,this.root+this.fragment+r.search)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){Z.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);I.started=false},route:function(m,n){this.handlers.unshift({route:m,callback:n})},checkUrl:function(n){var m=this.getFragment();if(m===this.fragment&&this.iframe){m=this.getFragment(this.getHash(this.iframe))}if(m===this.fragment){return false}if(this.iframe){this.navigate(m)}this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(o){var n=this.fragment=this.getFragment(o);var m=l.any(this.handlers,function(p){if(p.route.test(n)){p.callback(n);return true}});return m},navigate:function(o,n){if(!I.started){return false}if(!n||n===true){n={trigger:n}}o=this.getFragment(o||"");if(this.fragment===o){return }this.fragment=o;var m=this.root+o;if(this._hasPushState){this.history[n.replace?"replaceState":"pushState"]({},document.title,m)}else{if(this._wantsHashChange){this._updateHash(this.location,o,n.replace);if(this.iframe&&(o!==this.getFragment(this.getHash(this.iframe)))){if(!n.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,o,n.replace)}}else{return this.location.assign(m)}}if(n.trigger){this.loadUrl(o)}},_updateHash:function(m,o,p){if(p){var n=m.href.replace(/(javascript:|#).*$/,"");m.replace(n+"#"+o)}else{m.hash="#"+o}}});Z.history=new I;var L=function(m,o){var n=this;var q;if(m&&l.has(m,"constructor")){q=m.constructor}else{q=function(){return n.apply(this,arguments)}}l.extend(q,n,o);var p=function(){this.constructor=q};p.prototype=n.prototype;q.prototype=new p;if(m){l.extend(q.prototype,m)}q.__super__=n.prototype;return q};e.extend=C.extend=P.extend=g.extend=I.extend=L;var R=function(){throw new Error('A "url" property or function must be specified')};var h=function(o,n){var m=n.error;n.error=function(p){if(m){m(o,p,n)}o.trigger("error",o,p,n)}}}).call(this);
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone.marionette-1.1.0.js' */
/*
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
Backbone.ChildViewContainer=(function(D,C){var A=function(E){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();C.each(E,this.add,this)};C.extend(A.prototype,{add:function(E,G){var F=E.cid;this._views[F]=E;if(E.model){this._indexByModel[E.model.cid]=F}if(G){this._indexByCustom[G]=F}this._updateLength()},findByModel:function(E){return this.findByModelCid(E.cid)},findByModelCid:function(E){var F=this._indexByModel[E];return this.findByCid(F)},findByCustom:function(F){var E=this._indexByCustom[F];return this.findByCid(E)},findByIndex:function(E){return C.values(this._views)[E]},findByCid:function(E){return this._views[E]},remove:function(E){var F=E.cid;if(E.model){delete this._indexByModel[E.model.cid]}C.any(this._indexByCustom,function(H,G){if(H===F){delete this._indexByCustom[G];return true}},this);delete this._views[F];this._updateLength()},call:function(E){this.apply(E,C.tail(arguments))},apply:function(F,E){C.each(this._views,function(G){if(C.isFunction(G[F])){G[F].apply(G,E||[])}})},_updateLength:function(){this.length=C.size(this._views)}});var B=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];C.each(B,function(E){A.prototype[E]=function(){var F=C.values(this._views);var G=[F].concat(C.toArray(arguments));return C[E].apply(C,G)}});return A})(Backbone,_);Backbone.Wreqr=(function(D,C,A){var B={};B.Handlers=(function(G,F){var E=function(H){this.options=H;this._wreqrHandlers={};if(F.isFunction(this.initialize)){this.initialize(H)}};E.extend=G.Model.extend;F.extend(E.prototype,G.Events,{setHandlers:function(H){F.each(H,function(K,I){var J=null;if(F.isObject(K)&&!F.isFunction(K)){J=K.context;K=K.callback}this.setHandler(I,K,J)},this)},setHandler:function(I,K,J){var H={callback:K,context:J};this._wreqrHandlers[I]=H;this.trigger("handler:add",I,K,J)},hasHandler:function(H){return !!this._wreqrHandlers[H]},getHandler:function(I){var H=this._wreqrHandlers[I];if(!H){throw new Error("Handler not found for '"+I+"'")}return function(){var J=Array.prototype.slice.apply(arguments);return H.callback.apply(H.context,J)}},removeHandler:function(H){delete this._wreqrHandlers[H]},removeAllHandlers:function(){this._wreqrHandlers={}}});return E})(D,A);B.CommandStorage=(function(){var E=function(F){this.options=F;this._commands={};if(A.isFunction(this.initialize)){this.initialize(F)}};A.extend(E.prototype,D.Events,{getCommands:function(G){var F=this._commands[G];if(!F){F={command:G,instances:[]};this._commands[G]=F}return F},addCommand:function(G,F){var H=this.getCommands(G);H.instances.push(F)},clearCommands:function(F){var G=this.getCommands(F);G.instances=[]}});return E})();B.Commands=(function(E){return E.Handlers.extend({storageType:E.CommandStorage,constructor:function(G){this.options=G||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var F=Array.prototype.slice.call(arguments);E.Handlers.prototype.constructor.apply(this,F)},execute:function(G,F){G=arguments[0];F=Array.prototype.slice.call(arguments,1);if(this.hasHandler(G)){this.getHandler(G).apply(this,F)}else{this.storage.addCommand(G,F)}},_executeCommands:function(F,H,G){var I=this.storage.getCommands(F);A.each(I.instances,function(J){H.apply(G,J)});this.storage.clearCommands(F)},_initializeStorage:function(F){var H;var G=F.storageType||this.storageType;if(A.isFunction(G)){H=new G()}else{H=G}this.storage=H}})})(B);B.RequestResponse=(function(E){return E.Handlers.extend({request:function(){var G=arguments[0];var F=Array.prototype.slice.call(arguments,1);return this.getHandler(G).apply(this,F)}})})(B);B.EventAggregator=(function(G,E){var F=function(){};F.extend=G.Model.extend;E.extend(F.prototype,G.Events);return F})(D,A);return B})(Backbone,Backbone.Marionette,_);var Marionette=(function(B,G,A){var F={};G.Marionette=F;F.$=G.$;var C=Array.prototype.slice;function D(H){return C.call(H)}function E(J,I){var H=new Error(J);H.name=I||"Error";throw H}F.extend=G.Model.extend;F.getOption=function(J,H){if(!J||!H){return }var I;if(J.options&&(H in J.options)&&(J.options[H]!==undefined)){I=J.options[H]}else{I=J[H]}return I};F.triggerMethod=(function(){var I=/(^|:)(\w)/gi;function J(L,M,K){return K.toUpperCase()}var H=function(L){var K="on"+L.replace(I,J);var M=this[K];if(A.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(A.isFunction(M)){return M.apply(this,A.tail(arguments))}};return H})();F.MonitorDOMRefresh=(function(){function J(K){K._isShown=true;H(K)}function I(K){K._isRendered=true;H(K)}function H(K){if(K._isShown&&K._isRendered){if(A.isFunction(K.triggerMethod)){K.triggerMethod("dom:refresh")}}}return function(K){K.listenTo(K,"show",function(){J(K)});K.listenTo(K,"render",function(){I(K)})}})();(function(M){function L(R,P,N,O){var Q=O.split(/\s+/);A.each(Q,function(S){var T=R[S];if(!T){E("Method '"+S+"' was configured as an event handler, but does not exist.")}R.listenTo(P,N,T,R)})}function H(P,O,N,Q){P.listenTo(O,N,Q,P)}function J(R,P,N,O){var Q=O.split(/\s+/);A.each(Q,function(S){var T=R[S];R.stopListening(P,N,T,R)})}function I(P,O,N,Q){P.stopListening(O,N,Q,P)}function K(Q,N,R,P,O){if(!N||!R){return }if(A.isFunction(R)){R=R.call(Q)}A.each(R,function(T,S){if(A.isFunction(T)){P(Q,N,S,T)}else{O(Q,N,S,T)}})}M.bindEntityEvents=function(O,N,P){K(O,N,P,H,L)};M.unbindEntityEvents=function(O,N,P){K(O,N,P,I,J)}})(F);F.Callbacks=function(){this._deferred=F.$.Deferred();this._callbacks=[]};A.extend(F.Callbacks.prototype,{add:function(I,H){this._callbacks.push({cb:I,ctx:H});this._deferred.done(function(K,J){if(H){K=H}I.call(K,J)})},run:function(H,I){this._deferred.resolve(I,H)},reset:function(){var H=this._callbacks;this._deferred=F.$.Deferred();this._callbacks=[];A.each(H,function(I){this.add(I.cb,I.ctx)},this)}});F.Controller=function(H){this.triggerMethod=F.triggerMethod;this.options=H||{};if(A.isFunction(this.initialize)){this.initialize(this.options)}};F.Controller.extend=F.extend;A.extend(F.Controller.prototype,G.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});F.Region=function(I){this.options=I||{};this.el=F.getOption(this,"el");if(!this.el){var J=new Error("An 'el' must be specified for a region.");J.name="NoElError";throw J}if(this.initialize){var H=Array.prototype.slice.apply(arguments);this.initialize.apply(this,H)}};A.extend(F.Region,{buildRegion:function(I,O){var M=(typeof I==="string");var L=(typeof I.selector==="string");var P=(typeof I.regionType==="undefined");var J=(typeof I==="function");if(!J&&!M&&!L){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var H,K;if(M){H=I}if(I.selector){H=I.selector}if(J){K=I}if(!J&&P){K=O}if(I.regionType){K=I.regionType}var N=new K({el:H});if(I.parentEl){N.getEl=function(Q){var R=I.parentEl;if(A.isFunction(R)){R=R()}return R.find(Q)}}return N}});A.extend(F.Region.prototype,G.Events,{show:function(J){this.ensureEl();var H=J.isClosed||A.isUndefined(J.$el);var I=J!==this.currentView;if(I){this.close()}J.render();if(I||H){this.open(J)}this.currentView=J;F.triggerMethod.call(this,"show",J);F.triggerMethod.call(J,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(H){return F.$(H)},open:function(H){this.$el.empty().append(H.el)},close:function(){var H=this.currentView;if(!H||H.isClosed){return }if(H.close){H.close()}else{if(H.remove){H.remove()}}F.triggerMethod.call(this,"close");delete this.currentView},attachView:function(H){this.currentView=H},reset:function(){this.close();delete this.$el}});F.Region.extend=F.extend;F.RegionManager=(function(J){var I=J.Controller.extend({constructor:function(K){this._regions={};J.Controller.prototype.constructor.call(this,K)},addRegions:function(K,L){var M={};A.each(K,function(O,N){if(typeof O==="string"){O={selector:O}}if(O.selector){O=A.defaults({},O,L)}var P=this.addRegion(N,O);M[N]=P},this);return M},addRegion:function(M,N){var P;var L=A.isObject(N);var K=A.isString(N);var O=!!N.selector;if(K||(L&&O)){P=J.Region.buildRegion(N,J.Region)}else{if(A.isFunction(N)){P=J.Region.buildRegion(N,J.Region)}else{P=N}}this._store(M,P);this.triggerMethod("region:add",M,P);return P},get:function(K){return this._regions[K]},removeRegion:function(K){var L=this._regions[K];this._remove(K,L)},removeRegions:function(){A.each(this._regions,function(L,K){this._remove(K,L)},this)},closeRegions:function(){A.each(this._regions,function(L,K){L.close()},this)},close:function(){this.removeRegions();var K=Array.prototype.slice.call(arguments);J.Controller.prototype.close.apply(this,K)},_store:function(K,L){this._regions[K]=L;this._setLength()},_remove:function(K,L){L.close();delete this._regions[K];this._setLength();this.triggerMethod("region:remove",K,L)},_setLength:function(){this.length=A.size(this._regions)}});var H=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];A.each(H,function(K){I.prototype[K]=function(){var M=A.values(this._regions);var L=[M].concat(A.toArray(arguments));return A[K].apply(A,L)}});return I})(F);F.TemplateCache=function(H){this.templateId=H};A.extend(F.TemplateCache,{templateCaches:{},get:function(H){var I=this.templateCaches[H];if(!I){I=new F.TemplateCache(H);this.templateCaches[H]=I}return I.load()},clear:function(){var I;var H=D(arguments);var J=H.length;if(J>0){for(I=0;I<J;I++){delete this.templateCaches[H[I]]}}else{this.templateCaches={}}}});A.extend(F.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var H=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(H);return this.compiledTemplate},loadTemplate:function(H){var I=F.$(H).html();if(!I||I.length===0){E("Could not find template: '"+H+"'","NoTemplateError")}return I},compileTemplate:function(H){return A.template(H)}});F.Renderer={render:function(J,K){if(!J){var H=new Error("Cannot render the template since it's false, null or undefined.");H.name="TemplateNotFoundError";throw H}var I;if(typeof J==="function"){I=J}else{I=F.TemplateCache.get(J)}return I(K)}};F.View=G.View.extend({constructor:function(){A.bindAll(this,"render");var H=Array.prototype.slice.apply(arguments);G.View.prototype.constructor.apply(this,H);F.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:F.triggerMethod,getTemplate:function(){return F.getOption(this,"template")},mixinTemplateHelpers:function(H){H=H||{};var I=F.getOption(this,"templateHelpers");if(A.isFunction(I)){I=I.call(this)}return A.extend(H,I)},configureTriggers:function(){if(!this.triggers){return }var I={};var H=A.result(this,"triggers");A.each(H,function(K,J){I[J]=function(M){if(M&&M.preventDefault){M.preventDefault()}if(M&&M.stopPropagation){M.stopPropagation()}var L={view:this,model:this.model,collection:this.collection};this.triggerMethod(K,L)}},this);return I},delegateEvents:function(H){this._delegateDOMEvents(H);F.bindEntityEvents(this,this.model,F.getOption(this,"modelEvents"));F.bindEntityEvents(this,this.collection,F.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(H){H=H||this.events;if(A.isFunction(H)){H=H.call(this)}var J={};var I=this.configureTriggers();A.extend(J,H,I);G.View.prototype.delegateEvents.call(this,J)},undelegateEvents:function(){var H=Array.prototype.slice.call(arguments);G.View.prototype.undelegateEvents.apply(this,H);F.unbindEntityEvents(this,this.model,F.getOption(this,"modelEvents"));F.unbindEntityEvents(this,this.collection,F.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return }var H=this.triggerMethod("before:close");if(H===false){return }this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return }if(!this._uiBindings){this._uiBindings=this.ui}var H=A.result(this,"_uiBindings");this.ui={};A.each(A.keys(H),function(J){var I=H[J];this.ui[J]=this.$(I)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return }A.each(this.ui,function(I,H){delete this.ui[H]},this);this.ui=this._uiBindings;delete this._uiBindings}});F.ItemView=F.View.extend({constructor:function(){F.View.prototype.constructor.apply(this,D(arguments))},serializeData:function(){var H={};if(this.model){H=this.model.toJSON()}else{if(this.collection){H={items:this.collection.toJSON()}}}return H},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var J=this.serializeData();J=this.mixinTemplateHelpers(J);var I=this.getTemplate();var H=F.Renderer.render(I,J);this.$el.html(H);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return }this.triggerMethod("item:before:close");F.View.prototype.close.apply(this,D(arguments));this.triggerMethod("item:closed")}});F.CollectionView=F.View.extend({itemViewEventPrefix:"itemview",constructor:function(H){this._initChildViewStorage();F.View.prototype.constructor.apply(this,D(arguments));this._initialEvents()},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(K,L,I){this.closeEmptyView();var J=this.getItemView(K);var H=this.collection.indexOf(K);this.addItemView(K,J,H)},onShowCalled:function(){this.children.each(function(H){F.triggerMethod.call(H,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}},showCollection:function(){var H;this.collection.each(function(J,I){H=this.getItemView(J);this.addItemView(J,H,I)},this)},showEmptyView:function(){var I=F.getOption(this,"emptyView");if(I&&!this._showingEmptyView){this._showingEmptyView=true;var H=new G.Model();this.addItemView(H,I,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getItemView:function(I){var H=F.getOption(this,"itemView");if(!H){E("An `itemView` must be specified","NoItemViewError")}return H},addItemView:function(K,J,I){var L=F.getOption(this,"itemViewOptions");if(A.isFunction(L)){L=L.call(this,K,I)}var H=this.buildItemView(K,J,L);this.addChildViewEventForwarding(H);this.triggerMethod("before:item:added",H);this.children.add(H);this.renderItemView(H,I);if(this._isShown){F.triggerMethod.call(H,"show")}this.triggerMethod("after:item:added",H)},addChildViewEventForwarding:function(H){var I=F.getOption(this,"itemViewEventPrefix");this.listenTo(H,"all",function(){var J=D(arguments);J[0]=I+":"+J[0];J.splice(1,0,H);F.triggerMethod.apply(this,J)},this)},renderItemView:function(H,I){H.render();this.appendHtml(this,H,I)},buildItemView:function(J,H,K){var I=A.extend({model:J},K);return new H(I)},removeItemView:function(I){var H=this.children.findByModel(I);this.removeChildView(H);this.checkEmpty()},removeChildView:function(H){if(H){this.stopListening(H);if(H.close){H.close()}else{if(H.remove){H.remove()}}this.children.remove(H)}this.triggerMethod("item:removed",H)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendHtml:function(H,J,I){H.$el.append(J.el)},_initChildViewStorage:function(){this.children=new G.ChildViewContainer()},close:function(){if(this.isClosed){return }this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");F.View.prototype.close.apply(this,D(arguments))},closeChildren:function(){this.children.each(function(H){this.removeChildView(H)},this);this.checkEmpty()}});F.CompositeView=F.CollectionView.extend({constructor:function(){F.CollectionView.prototype.constructor.apply(this,D(arguments))},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}},getItemView:function(I){var H=F.getOption(this,"itemView")||this.constructor;if(!H){E("An `itemView` must be specified","NoItemViewError")}return H},serializeData:function(){var H={};if(this.model){H=this.model.toJSON()}return H},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var H=this.renderModel();this.$el.html(H);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){F.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var I={};I=this.serializeData();I=this.mixinTemplateHelpers(I);var H=this.getTemplate();return F.Renderer.render(H,I)},appendHtml:function(H,J,I){var K=this.getItemViewContainer(H);K.append(J.el)},getItemViewContainer:function(K){if("$itemViewContainer" in K){return K.$itemViewContainer}var I;var J=F.getOption(K,"itemViewContainer");if(J){var H=A.isFunction(J)?J():J;I=K.$(H);if(I.length<=0){E("The specified `itemViewContainer` was not found: "+K.itemViewContainer,"ItemViewContainerMissingError")}}else{I=K.$el}K.$itemViewContainer=I;return I},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});F.Layout=F.ItemView.extend({regionType:F.Region,constructor:function(H){H=H||{};this._firstRender=true;this._initializeRegions(H);F.ItemView.prototype.constructor.call(this,H)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var I=Array.prototype.slice.apply(arguments);var H=F.ItemView.prototype.render.apply(this,I);return H},close:function(){if(this.isClosed){return }this.regionManager.close();var H=Array.prototype.slice.apply(arguments);F.ItemView.prototype.close.apply(this,H)},addRegion:function(H,I){var J={};J[H]=I;return this._buildRegions(J)[H]},addRegions:function(H){this.regions=A.extend({},this.regions,H);return this._buildRegions(H)},removeRegion:function(H){delete this.regions[H];return this.regionManager.removeRegion(H)},_buildRegions:function(J){var H=this;var I={regionType:F.getOption(this,"regionType"),parentEl:function(){return H.$el}};return this.regionManager.addRegions(J,I)},_initializeRegions:function(H){var I;this._initRegionManager();if(A.isFunction(this.regions)){I=this.regions(H)}else{I=this.regions||{}}this.addRegions(I)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(H){H.reset()})},_initRegionManager:function(){this.regionManager=new F.RegionManager();this.listenTo(this.regionManager,"region:add",function(H,I){this[H]=I;this.trigger("region:add",H,I)});this.listenTo(this.regionManager,"region:remove",function(H,I){delete this[H];this.trigger("region:remove",H,I)})}});F.AppRouter=G.Router.extend({constructor:function(I){G.Router.prototype.constructor.apply(this,D(arguments));this.options=I||{};var J=F.getOption(this,"appRoutes");var H=this._getController();this.processAppRoutes(H,J)},appRoute:function(J,I){var H=this._getController();this._addAppRoute(H,J,I)},processAppRoutes:function(H,J){if(!J){return }var I=A.keys(J).reverse();A.each(I,function(K){this._addAppRoute(H,K,J[K])},this)},_getController:function(){return F.getOption(this,"controller")},_addAppRoute:function(H,J,I){var K=H[I];if(!K){throw new Error("Method '"+I+"' was not found on the controller")}this.route(J,I,A.bind(K,H))}});F.Application=function(H){this._initRegionManager();this._initCallbacks=new F.Callbacks();this.vent=new G.Wreqr.EventAggregator();this.commands=new G.Wreqr.Commands();this.reqres=new G.Wreqr.RequestResponse();this.submodules={};A.extend(this,H);this.triggerMethod=F.triggerMethod};A.extend(F.Application.prototype,G.Events,{execute:function(){var H=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,H)},request:function(){var H=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,H)},addInitializer:function(H){this._initCallbacks.add(H)},start:function(H){this.triggerMethod("initialize:before",H);this._initCallbacks.run(H,this);this.triggerMethod("initialize:after",H);this.triggerMethod("start",H)},addRegions:function(H){return this._regionManager.addRegions(H)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(H){this._regionManager.removeRegion(H)},getRegion:function(H){return this._regionManager.get(H)},module:function(H,J){var I=D(arguments);I.unshift(this);return F.Module.create.apply(F.Module,I)},_initRegionManager:function(){this._regionManager=new F.RegionManager();this.listenTo(this._regionManager,"region:add",function(H,I){this[H]=I});this.listenTo(this._regionManager,"region:remove",function(H,I){delete this[H]})}});F.Application.extend=F.extend;F.Module=function(H,I){this.moduleName=H;this.submodules={};this._setupInitializersAndFinalizers();this.app=I;this.startWithParent=true;this.triggerMethod=F.triggerMethod};A.extend(F.Module.prototype,G.Events,{addInitializer:function(H){this._initializerCallbacks.add(H)},addFinalizer:function(H){this._finalizerCallbacks.add(H)},start:function(H){if(this._isInitialized){return }A.each(this.submodules,function(I){if(I.startWithParent){I.start(H)}});this.triggerMethod("before:start",H);this._initializerCallbacks.run(H,this);this._isInitialized=true;this.triggerMethod("start",H)},stop:function(){if(!this._isInitialized){return }this._isInitialized=false;F.triggerMethod.call(this,"before:stop");A.each(this.submodules,function(H){H.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();F.triggerMethod.call(this,"stop")},addDefinition:function(H,I){this._runModuleDefinition(H,I)},_runModuleDefinition:function(I,J){if(!I){return }var H=A.flatten([this,this.app,G,F,F.$,A,J]);I.apply(this,H)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new F.Callbacks();this._finalizerCallbacks=new F.Callbacks()}});A.extend(F.Module,{create:function(N,H,I){var J=N;var L=D(arguments);L.splice(0,3);H=H.split(".");var K=H.length;var M=[];M[K-1]=I;A.each(H,function(O,P){var Q=J;J=this._getModule(Q,O,N);this._addModuleDefinition(Q,J,M[P],L)},this);return J},_getModule:function(L,I,M,K,H){var J=L[I];if(!J){J=new F.Module(I,M);L[I]=J;L.submodules[I]=J}return J},_addModuleDefinition:function(M,I,L,H){var K;var J;if(A.isFunction(L)){K=L;J=true}else{if(A.isObject(L)){K=L.define;J=L.startWithParent}else{J=true}}if(K){I.addDefinition(K,H)}I.startWithParent=I.startWithParent&&J;if(I.startWithParent&&!I.startWithParentIsConfigured){I.startWithParentIsConfigured=true;M.addInitializer(function(N){if(I.startWithParent){I.start(N)}})}}});return F})(this,Backbone,_);
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:backbone.marionette', location = 'js/lib/backbone.noconflict.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Backbone");JIRA.WorkflowDesigner.Backbone=Backbone.noConflict()}());
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.position.js' */
/*
 * jQuery UI Position 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(G,H){G.ui=G.ui||{};var D=/left|center|right/,E=/top|center|bottom/,A="center",F={},B=G.fn.position,C=G.fn.offset;G.fn.position=function(J){if(!J||!J.of){return B.apply(this,arguments)}J=G.extend({},J);var N=G(J.of),M=N[0],P=(J.collision||"flip").split(" "),O=J.offset?J.offset.split(" "):[0,0],L,I,K;if(M.nodeType===9){L=N.width();I=N.height();K={top:0,left:0}}else{if(M.setTimeout){L=N.width();I=N.height();K={top:N.scrollTop(),left:N.scrollLeft()}}else{if(M.preventDefault){J.at="left top";L=I=0;K={top:J.of.pageY,left:J.of.pageX}}else{L=N.outerWidth();I=N.outerHeight();K=N.offset()}}}G.each(["my","at"],function(){var Q=(J[this]||"").split(" ");if(Q.length===1){Q=D.test(Q[0])?Q.concat([A]):E.test(Q[0])?[A].concat(Q):[A,A]}Q[0]=D.test(Q[0])?Q[0]:A;Q[1]=E.test(Q[1])?Q[1]:A;J[this]=Q});if(P.length===1){P[1]=P[0]}O[0]=parseInt(O[0],10)||0;if(O.length===1){O[1]=O[0]}O[1]=parseInt(O[1],10)||0;if(J.at[0]==="right"){K.left+=L}else{if(J.at[0]===A){K.left+=L/2}}if(J.at[1]==="bottom"){K.top+=I}else{if(J.at[1]===A){K.top+=I/2}}K.left+=O[0];K.top+=O[1];return this.each(function(){var T=G(this),V=T.outerWidth(),S=T.outerHeight(),U=parseInt(G.curCSS(this,"marginLeft",true))||0,R=parseInt(G.curCSS(this,"marginTop",true))||0,X=V+U+(parseInt(G.curCSS(this,"marginRight",true))||0),Y=S+R+(parseInt(G.curCSS(this,"marginBottom",true))||0),W=G.extend({},K),Q;if(J.my[0]==="right"){W.left-=V}else{if(J.my[0]===A){W.left-=V/2}}if(J.my[1]==="bottom"){W.top-=S}else{if(J.my[1]===A){W.top-=S/2}}if(!F.fractions){W.left=Math.round(W.left);W.top=Math.round(W.top)}Q={left:W.left-U,top:W.top-R};G.each(["left","top"],function(a,Z){if(G.ui.position[P[a]]){G.ui.position[P[a]][Z](W,{targetWidth:L,targetHeight:I,elemWidth:V,elemHeight:S,collisionPosition:Q,collisionWidth:X,collisionHeight:Y,offset:O,my:J.my,at:J.at})}});if(G.fn.bgiframe){T.bgiframe()}T.offset(G.extend(W,{using:J.using}))})};G.ui.position={fit:{left:function(I,J){var L=G(window),K=J.collisionPosition.left+J.collisionWidth-L.width()-L.scrollLeft();I.left=K>0?I.left-K:Math.max(I.left-J.collisionPosition.left,I.left)},top:function(I,J){var L=G(window),K=J.collisionPosition.top+J.collisionHeight-L.height()-L.scrollTop();I.top=K>0?I.top-K:Math.max(I.top-J.collisionPosition.top,I.top)}},flip:{left:function(J,L){if(L.at[0]===A){return }var N=G(window),M=L.collisionPosition.left+L.collisionWidth-N.width()-N.scrollLeft(),I=L.my[0]==="left"?-L.elemWidth:L.my[0]==="right"?L.elemWidth:0,K=L.at[0]==="left"?L.targetWidth:-L.targetWidth,O=-2*L.offset[0];J.left+=L.collisionPosition.left<0?I+K+O:M>0?I+K+O:0},top:function(J,L){if(L.at[1]===A){return }var N=G(window),M=L.collisionPosition.top+L.collisionHeight-N.height()-N.scrollTop(),I=L.my[1]==="top"?-L.elemHeight:L.my[1]==="bottom"?L.elemHeight:0,K=L.at[1]==="top"?L.targetHeight:-L.targetHeight,O=-2*L.offset[1];J.top+=L.collisionPosition.top<0?I+K+O:M>0?I+K+O:0}}};if(!G.offset.setOffset){G.offset.setOffset=function(M,J){if(/static/.test(G.curCSS(M,"position"))){M.style.position="relative"}var L=G(M),O=L.offset(),I=parseInt(G.curCSS(M,"top",true),10)||0,N=parseInt(G.curCSS(M,"left",true),10)||0,K={top:(J.top-O.top)+I,left:(J.left-O.left)+N};if("using" in J){J.using.call(M,K)}else{L.css(K)}};G.fn.offset=function(I){var J=this[0];if(!J||!J.ownerDocument){return null}if(I){if(G.isFunction(I)){return this.each(function(K){G(this).offset(I.call(this,K,G(this).offset()))})}return this.each(function(){G.offset.setOffset(this,I)})}return C.call(this)}}if(!G.curCSS){G.curCSS=G.css}(function(){var I=document.getElementsByTagName("body")[0],P=document.createElement("div"),M,O,J,N,L;M=document.createElement(I?"div":"body");J={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(I){G.extend(J,{position:"absolute",left:"-1000px",top:"-1000px"})}for(var K in J){M.style[K]=J[K]}M.appendChild(P);O=I||document.documentElement;O.insertBefore(M,O.firstChild);P.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";N=G(P).offset(function(Q,R){return R}).offset();M.innerHTML="";O.removeChild(M);L=N.top+N.left+(I?2000:0);F.fractions=L>21&&L<22})()}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.droppable.js' */
/*
 * jQuery UI Droppable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(A,B){A.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var D=this.options,C=D.accept;this.isover=0;this.isout=1;this.accept=A.isFunction(C)?C:function(E){return E.is(C)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};A.ui.ddmanager.droppables[D.scope]=A.ui.ddmanager.droppables[D.scope]||[];A.ui.ddmanager.droppables[D.scope].push(this);(D.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var C=A.ui.ddmanager.droppables[this.options.scope];for(var D=0;D<C.length;D++){if(C[D]==this){C.splice(D,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(C,D){if(C=="accept"){this.accept=A.isFunction(D)?D:function(E){return E.is(D)}}A.Widget.prototype._setOption.apply(this,arguments)},_activate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(C&&this._trigger("activate",D,this.ui(C)))},_deactivate:function(D){var C=A.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(C&&this._trigger("deactivate",D,this.ui(C)))},_over:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",D,this.ui(C))}},_out:function(D){var C=A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return }if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",D,this.ui(C))}},_drop:function(D,E){var C=E||A.ui.ddmanager.current;if(!C||(C.currentItem||C.element)[0]==this.element[0]){return false}var F=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var G=A.data(this,"droppable");if(G.options.greedy&&!G.options.disabled&&G.options.scope==C.options.scope&&G.accept.call(G.element[0],(C.currentItem||C.element))&&A.ui.intersect(C,A.extend(G,{offset:G.element.offset()}),G.options.tolerance)){F=true;return false}});if(F){return false}if(this.accept.call(this.element[0],(C.currentItem||C.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",D,this.ui(C));return this.element}return false},ui:function(C){return{draggable:(C.currentItem||C.element),helper:C.helper,position:C.position,offset:C.positionAbs}}});A.extend(A.ui.droppable,{version:"1.8.24"});A.ui.intersect=function(P,J,N){if(!J.offset){return false}var E=(P.positionAbs||P.position.absolute).left,D=E+P.helperProportions.width,M=(P.positionAbs||P.position.absolute).top,L=M+P.helperProportions.height;var G=J.offset.left,C=G+J.proportions.width,O=J.offset.top,K=O+J.proportions.height;switch(N){case"fit":return(G<=E&&D<=C&&O<=M&&L<=K);break;case"intersect":return(G<E+(P.helperProportions.width/2)&&D-(P.helperProportions.width/2)<C&&O<M+(P.helperProportions.height/2)&&L-(P.helperProportions.height/2)<K);break;case"pointer":var H=((P.positionAbs||P.position.absolute).left+(P.clickOffset||P.offset.click).left),I=((P.positionAbs||P.position.absolute).top+(P.clickOffset||P.offset.click).top),F=A.ui.isOver(I,H,O,G,J.proportions.height,J.proportions.width);return F;break;case"touch":return((M>=O&&M<=K)||(L>=O&&L<=K)||(M<O&&L>K))&&((E>=G&&E<=C)||(D>=G&&D<=C)||(E<G&&D>C));break;default:return false;break}};A.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(F,H){var C=A.ui.ddmanager.droppables[F.options.scope]||[];var G=H?H.type:null;var I=(F.currentItem||F.element).find(":data(droppable)").andSelf();droppablesLoop:for(var E=0;E<C.length;E++){if(C[E].options.disabled||(F&&!C[E].accept.call(C[E].element[0],(F.currentItem||F.element)))){continue}for(var D=0;D<I.length;D++){if(I[D]==C[E].element[0]){C[E].proportions.height=0;continue droppablesLoop}}C[E].visible=C[E].element.css("display")!="none";if(!C[E].visible){continue}if(G=="mousedown"){C[E]._activate.call(C[E],H)}C[E].offset=C[E].element.offset();C[E].proportions={width:C[E].element[0].offsetWidth,height:C[E].element[0].offsetHeight}}},drop:function(C,D){var E=false;A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(!this.options){return }if(!this.options.disabled&&this.visible&&A.ui.intersect(C,this,this.options.tolerance)){E=this._drop.call(this,D)||E}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(C.currentItem||C.element))){this.isout=1;this.isover=0;this._deactivate.call(this,D)}});return E},dragStart:function(C,D){C.element.parents(":not(body,html)").bind("scroll.droppable",function(){if(!C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}})},drag:function(C,D){if(C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}A.each(A.ui.ddmanager.droppables[C.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return }var G=A.ui.intersect(C,this,this.options.tolerance);var I=!G&&this.isover==1?"isout":(G&&this.isover==0?"isover":null);if(!I){return }var H;if(this.options.greedy){var F=this.options.scope;var E=this.element.parents(":data(droppable)").filter(function(){return A.data(this,"droppable").options.scope===F});if(E.length){H=A.data(E[0],"droppable");H.greedyChild=(I=="isover"?1:0)}}if(H&&I=="isover"){H.isover=0;H.isout=1;H._out.call(H,D)}this[I]=1;this[I=="isout"?"isover":"isout"]=0;this[I=="isover"?"_over":"_out"].call(this,D);if(H&&I=="isout"){H.isout=0;H.isover=1;H._over.call(H,D)}})},dragStop:function(C,D){C.element.parents(":not(body,html)").unbind("scroll.droppable");if(!C.options.refreshPositions){A.ui.ddmanager.prepareOffsets(C,D)}}}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.resizable.js' */
/*
 * jQuery UI Resizable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(C,D){C.widget("ui.resizable",C.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var F=this,J=this.options;this.element.addClass("ui-resizable");C.extend(this,{_aspectRatio:!!(J.aspectRatio),aspectRatio:J.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:J.helper||J.ghost||J.animate?J.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(C('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=J.handles||(!C(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var K=this.handles.split(",");this.handles={};for(var G=0;G<K.length;G++){var I=C.trim(K[G]),E="ui-resizable-"+I;var H=C('<div class="ui-resizable-handle '+E+'"></div>');H.css({zIndex:J.zIndex});if("se"==I){H.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[I]=".ui-resizable-"+I;this.element.append(H)}}this._renderAxis=function(P){P=P||this.element;for(var M in this.handles){if(this.handles[M].constructor==String){this.handles[M]=C(this.handles[M],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var N=C(this.handles[M],this.element),O=0;O=/sw|ne|nw|se|n|s/.test(M)?N.outerHeight():N.outerWidth();var L=["padding",/ne|nw|n/.test(M)?"Top":/se|sw|s/.test(M)?"Bottom":/^e$/.test(M)?"Right":"Left"].join("");P.css(L,O);this._proportionallyResize()}if(!C(this.handles[M]).length){continue}}};this._renderAxis(this.element);this._handles=C(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!F.resizing){if(this.className){var L=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}F.axis=L&&L[1]?L[1]:"se"}});if(J.autoHide){this._handles.hide();C(this.element).addClass("ui-resizable-autohide").hover(function(){if(J.disabled){return }C(this).removeClass("ui-resizable-autohide");F._handles.show()},function(){if(J.disabled){return }if(!F.resizing){C(this).addClass("ui-resizable-autohide");F._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var E=function(G){C(G).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){E(this.element);var F=this.element;F.after(this.originalElement.css({position:F.css("position"),width:F.outerWidth(),height:F.outerHeight(),top:F.css("top"),left:F.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);E(this.originalElement);return this},_mouseCapture:function(F){var G=false;for(var E in this.handles){if(C(this.handles[E])[0]==F.target){G=true}}return !this.options.disabled&&G},_mouseStart:function(G){var J=this.options,F=this.element.position(),E=this.element;this.resizing=true;this.documentScroll={top:C(document).scrollTop(),left:C(document).scrollLeft()};if(E.is(".ui-draggable")||(/absolute/).test(E.css("position"))){E.css({position:"absolute",top:F.top,left:F.left})}this._renderProxy();var K=B(this.helper.css("left")),H=B(this.helper.css("top"));if(J.containment){K+=C(J.containment).scrollLeft()||0;H+=C(J.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:K,top:H};this.size=this._helper?{width:E.outerWidth(),height:E.outerHeight()}:{width:E.width(),height:E.height()};this.originalSize=this._helper?{width:E.outerWidth(),height:E.outerHeight()}:{width:E.width(),height:E.height()};this.originalPosition={left:K,top:H};this.sizeDiff={width:E.outerWidth()-E.width(),height:E.outerHeight()-E.height()};this.originalMousePosition={left:G.pageX,top:G.pageY};this.aspectRatio=(typeof J.aspectRatio=="number")?J.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var I=C(".ui-resizable-"+this.axis).css("cursor");C("body").css("cursor",I=="auto"?this.axis+"-resize":I);E.addClass("ui-resizable-resizing");this._propagate("start",G);return true},_mouseDrag:function(E){var H=this.helper,G=this.options,M={},P=this,J=this.originalMousePosition,N=this.axis;var Q=(E.pageX-J.left)||0,O=(E.pageY-J.top)||0;var I=this._change[N];if(!I){return false}var L=I.apply(this,[E,Q,O]),K=C.browser.msie&&C.browser.version<7,F=this.sizeDiff;this._updateVirtualBoundaries(E.shiftKey);if(this._aspectRatio||E.shiftKey){L=this._updateRatio(L,E)}L=this._respectSize(L,E);this._propagate("resize",E);H.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(L);this._trigger("resize",E,this.ui());return false},_mouseStop:function(H){this.resizing=false;var I=this.options,M=this;if(this._helper){var G=this._proportionallyResizeElements,E=G.length&&(/textarea/i).test(G[0].nodeName),F=E&&C.ui.hasScroll(G[0],"left")?0:M.sizeDiff.height,K=E?0:M.sizeDiff.width;var N={width:(M.helper.width()-K),height:(M.helper.height()-F)},J=(parseInt(M.element.css("left"),10)+(M.position.left-M.originalPosition.left))||null,L=(parseInt(M.element.css("top"),10)+(M.position.top-M.originalPosition.top))||null;if(!I.animate){this.element.css(C.extend(N,{top:L,left:J}))}M.helper.height(M.size.height);M.helper.width(M.size.width);if(this._helper&&!I.animate){this._proportionallyResize()}}C("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",H);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(G){var J=this.options,I,H,F,K,E;E={minWidth:A(J.minWidth)?J.minWidth:0,maxWidth:A(J.maxWidth)?J.maxWidth:Infinity,minHeight:A(J.minHeight)?J.minHeight:0,maxHeight:A(J.maxHeight)?J.maxHeight:Infinity};if(this._aspectRatio||G){I=E.minHeight*this.aspectRatio;F=E.minWidth/this.aspectRatio;H=E.maxHeight*this.aspectRatio;K=E.maxWidth/this.aspectRatio;if(I>E.minWidth){E.minWidth=I}if(F>E.minHeight){E.minHeight=F}if(H<E.maxWidth){E.maxWidth=H}if(K<E.maxHeight){E.maxHeight=K}}this._vBoundaries=E},_updateCache:function(E){var F=this.options;this.offset=this.helper.offset();if(A(E.left)){this.position.left=E.left}if(A(E.top)){this.position.top=E.top}if(A(E.height)){this.size.height=E.height}if(A(E.width)){this.size.width=E.width}},_updateRatio:function(H,G){var I=this.options,J=this.position,F=this.size,E=this.axis;if(A(H.height)){H.width=(H.height*this.aspectRatio)}else{if(A(H.width)){H.height=(H.width/this.aspectRatio)}}if(E=="sw"){H.left=J.left+(F.width-H.width);H.top=null}if(E=="nw"){H.top=J.top+(F.height-H.height);H.left=J.left+(F.width-H.width)}return H},_respectSize:function(L,G){var J=this.helper,I=this._vBoundaries,Q=this._aspectRatio||G.shiftKey,P=this.axis,S=A(L.width)&&I.maxWidth&&(I.maxWidth<L.width),M=A(L.height)&&I.maxHeight&&(I.maxHeight<L.height),H=A(L.width)&&I.minWidth&&(I.minWidth>L.width),R=A(L.height)&&I.minHeight&&(I.minHeight>L.height);if(H){L.width=I.minWidth}if(R){L.height=I.minHeight}if(S){L.width=I.maxWidth}if(M){L.height=I.maxHeight}var F=this.originalPosition.left+this.originalSize.width,O=this.position.top+this.size.height;var K=/sw|nw|w/.test(P),E=/nw|ne|n/.test(P);if(H&&K){L.left=F-I.minWidth}if(S&&K){L.left=F-I.maxWidth}if(R&&E){L.top=O-I.minHeight}if(M&&E){L.top=O-I.maxHeight}var N=!L.width&&!L.height;if(N&&!L.left&&L.top){L.top=null}else{if(N&&!L.top&&L.left){L.left=null}}return L},_proportionallyResize:function(){var J=this.options;if(!this._proportionallyResizeElements.length){return }var G=this.helper||this.element;for(var F=0;F<this._proportionallyResizeElements.length;F++){var H=this._proportionallyResizeElements[F];if(!this.borderDif){var E=[H.css("borderTopWidth"),H.css("borderRightWidth"),H.css("borderBottomWidth"),H.css("borderLeftWidth")],I=[H.css("paddingTop"),H.css("paddingRight"),H.css("paddingBottom"),H.css("paddingLeft")];this.borderDif=C.map(E,function(K,M){var L=parseInt(K,10)||0,N=parseInt(I[M],10)||0;return L+N})}if(C.browser.msie&&!(!(C(G).is(":hidden")||C(G).parents(":hidden").length))){continue}H.css({height:(G.height()-this.borderDif[0]-this.borderDif[2])||0,width:(G.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var F=this.element,I=this.options;this.elementOffset=F.offset();if(this._helper){this.helper=this.helper||C('<div style="overflow:hidden;"></div>');var E=C.browser.msie&&C.browser.version<7,G=(E?1:0),H=(E?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+H,height:this.element.outerHeight()+H,position:"absolute",left:this.elementOffset.left-G+"px",top:this.elementOffset.top-G+"px",zIndex:++I.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(G,F,E){return{width:this.originalSize.width+F}},w:function(H,F,E){var J=this.options,G=this.originalSize,I=this.originalPosition;return{left:I.left+F,width:G.width-F}},n:function(H,F,E){var J=this.options,G=this.originalSize,I=this.originalPosition;return{top:I.top+E,height:G.height-E}},s:function(G,F,E){return{height:this.originalSize.height+E}},se:function(G,F,E){return C.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},sw:function(G,F,E){return C.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[G,F,E]))},ne:function(G,F,E){return C.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},nw:function(G,F,E){return C.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[G,F,E]))}},_propagate:function(F,E){C.ui.plugin.call(this,F,[E,this.ui()]);(F!="resize"&&this._trigger(F,E,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});C.extend(C.ui.resizable,{version:"1.8.24"});C.ui.plugin.add("resizable","alsoResize",{start:function(F,G){var E=C(this).data("resizable"),I=E.options;var H=function(J){C(J).each(function(){var K=C(this);K.data("resizable-alsoresize",{width:parseInt(K.width(),10),height:parseInt(K.height(),10),left:parseInt(K.css("left"),10),top:parseInt(K.css("top"),10)})})};if(typeof (I.alsoResize)=="object"&&!I.alsoResize.parentNode){if(I.alsoResize.length){I.alsoResize=I.alsoResize[0];H(I.alsoResize)}else{C.each(I.alsoResize,function(J){H(J)})}}else{H(I.alsoResize)}},resize:function(G,I){var F=C(this).data("resizable"),J=F.options,H=F.originalSize,L=F.originalPosition;var K={height:(F.size.height-H.height)||0,width:(F.size.width-H.width)||0,top:(F.position.top-L.top)||0,left:(F.position.left-L.left)||0},E=function(M,N){C(M).each(function(){var Q=C(this),R=C(this).data("resizable-alsoresize"),P={},O=N&&N.length?N:Q.parents(I.originalElement[0]).length?["width","height"]:["width","height","top","left"];C.each(O,function(S,U){var T=(R[U]||0)+(K[U]||0);if(T&&T>=0){P[U]=T||null}});Q.css(P)})};if(typeof (J.alsoResize)=="object"&&!J.alsoResize.nodeType){C.each(J.alsoResize,function(M,N){E(M,N)})}else{E(J.alsoResize)}},stop:function(E,F){C(this).removeData("resizable-alsoresize")}});C.ui.plugin.add("resizable","animate",{stop:function(I,N){var O=C(this).data("resizable"),J=O.options;var H=O._proportionallyResizeElements,E=H.length&&(/textarea/i).test(H[0].nodeName),F=E&&C.ui.hasScroll(H[0],"left")?0:O.sizeDiff.height,L=E?0:O.sizeDiff.width;var G={width:(O.size.width-L),height:(O.size.height-F)},K=(parseInt(O.element.css("left"),10)+(O.position.left-O.originalPosition.left))||null,M=(parseInt(O.element.css("top"),10)+(O.position.top-O.originalPosition.top))||null;O.element.animate(C.extend(G,M&&K?{top:M,left:K}:{}),{duration:J.animateDuration,easing:J.animateEasing,step:function(){var P={width:parseInt(O.element.css("width"),10),height:parseInt(O.element.css("height"),10),top:parseInt(O.element.css("top"),10),left:parseInt(O.element.css("left"),10)};if(H&&H.length){C(H[0]).css({width:P.width,height:P.height})}O._updateCache(P);O._propagate("resize",I)}})}});C.ui.plugin.add("resizable","containment",{start:function(F,P){var R=C(this).data("resizable"),J=R.options,L=R.element;var G=J.containment,K=(G instanceof C)?G.get(0):(/parent/.test(G))?L.parent().get(0):G;if(!K){return }R.containerElement=C(K);if(/document/.test(G)||G==document){R.containerOffset={left:0,top:0};R.containerPosition={left:0,top:0};R.parentData={element:C(document),left:0,top:0,width:C(document).width(),height:C(document).height()||document.body.parentNode.scrollHeight}}else{var N=C(K),I=[];C(["Top","Right","Left","Bottom"]).each(function(T,S){I[T]=B(N.css("padding"+S))});R.containerOffset=N.offset();R.containerPosition=N.position();R.containerSize={height:(N.innerHeight()-I[3]),width:(N.innerWidth()-I[1])};var O=R.containerOffset,E=R.containerSize.height,M=R.containerSize.width,H=(C.ui.hasScroll(K,"left")?K.scrollWidth:M),Q=(C.ui.hasScroll(K)?K.scrollHeight:E);R.parentData={element:K,left:O.left,top:O.top,width:H,height:Q}}},resize:function(G,P){var S=C(this).data("resizable"),I=S.options,F=S.containerSize,O=S.containerOffset,M=S.size,N=S.position,Q=S._aspectRatio||G.shiftKey,E={top:0,left:0},H=S.containerElement;if(H[0]!=document&&(/static/).test(H.css("position"))){E=O}if(N.left<(S._helper?O.left:0)){S.size.width=S.size.width+(S._helper?(S.position.left-O.left):(S.position.left-E.left));if(Q){S.size.height=S.size.width/S.aspectRatio}S.position.left=I.helper?O.left:0}if(N.top<(S._helper?O.top:0)){S.size.height=S.size.height+(S._helper?(S.position.top-O.top):S.position.top);if(Q){S.size.width=S.size.height*S.aspectRatio}S.position.top=S._helper?O.top:0}S.offset.left=S.parentData.left+S.position.left;S.offset.top=S.parentData.top+S.position.top;var L=Math.abs((S._helper?S.offset.left-E.left:(S.offset.left-E.left))+S.sizeDiff.width),R=Math.abs((S._helper?S.offset.top-E.top:(S.offset.top-O.top))+S.sizeDiff.height);var K=S.containerElement.get(0)==S.element.parent().get(0),J=/relative|absolute/.test(S.containerElement.css("position"));if(K&&J){L-=S.parentData.left}if(L+S.size.width>=S.parentData.width){S.size.width=S.parentData.width-L;if(Q){S.size.height=S.size.width/S.aspectRatio}}if(R+S.size.height>=S.parentData.height){S.size.height=S.parentData.height-R;if(Q){S.size.width=S.size.height*S.aspectRatio}}},stop:function(F,M){var O=C(this).data("resizable"),G=O.options,K=O.position,L=O.containerOffset,E=O.containerPosition,H=O.containerElement;var I=C(O.helper),P=I.offset(),N=I.outerWidth()-O.sizeDiff.width,J=I.outerHeight()-O.sizeDiff.height;if(O._helper&&!G.animate&&(/relative/).test(H.css("position"))){C(this).css({left:P.left-E.left-L.left,width:N,height:J})}if(O._helper&&!G.animate&&(/static/).test(H.css("position"))){C(this).css({left:P.left-E.left-L.left,width:N,height:J})}}});C.ui.plugin.add("resizable","ghost",{start:function(G,H){var E=C(this).data("resizable"),I=E.options,F=E.size;E.ghost=E.originalElement.clone();E.ghost.css({opacity:0.25,display:"block",position:"relative",height:F.height,width:F.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof I.ghost=="string"?I.ghost:"");E.ghost.appendTo(E.helper)},resize:function(F,G){var E=C(this).data("resizable"),H=E.options;if(E.ghost){E.ghost.css({position:"relative",height:E.size.height,width:E.size.width})}},stop:function(F,G){var E=C(this).data("resizable"),H=E.options;if(E.ghost&&E.helper){E.helper.get(0).removeChild(E.ghost.get(0))}}});C.ui.plugin.add("resizable","grid",{resize:function(E,M){var O=C(this).data("resizable"),H=O.options,K=O.size,I=O.originalSize,J=O.originalPosition,N=O.axis,L=H._aspectRatio||E.shiftKey;H.grid=typeof H.grid=="number"?[H.grid,H.grid]:H.grid;var G=Math.round((K.width-I.width)/(H.grid[0]||1))*(H.grid[0]||1),F=Math.round((K.height-I.height)/(H.grid[1]||1))*(H.grid[1]||1);if(/^(se|s|e)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F}else{if(/^(ne)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F;O.position.top=J.top-F}else{if(/^(sw)$/.test(N)){O.size.width=I.width+G;O.size.height=I.height+F;O.position.left=J.left-G}else{O.size.width=I.width+G;O.size.height=I.height+F;O.position.top=J.top-F;O.position.left=J.left-G}}}}});var B=function(E){return parseInt(E,10)||0};var A=function(E){return !isNaN(parseInt(E,10))}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.selectable.js' */
/*
 * jQuery UI Selectable 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.selectable",A.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var C=this;this.element.addClass("ui-selectable");this.dragged=false;var D;this.refresh=function(){D=A(C.options.filter,C.element[0]);D.addClass("ui-selectee");D.each(function(){var E=A(this);var F=E.offset();A.data(this,"selectable-item",{element:this,$element:E,left:F.left,top:F.top,right:F.left+E.outerWidth(),bottom:F.top+E.outerHeight(),startselected:false,selected:E.hasClass("ui-selected"),selecting:E.hasClass("ui-selecting"),unselecting:E.hasClass("ui-unselecting")})})};this.refresh();this.selectees=D.addClass("ui-selectee");this._mouseInit();this.helper=A("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(E){var C=this;this.opos=[E.pageX,E.pageY];if(this.options.disabled){return }var D=this.options;this.selectees=A(D.filter,this.element[0]);this._trigger("start",E);A(D.appendTo).append(this.helper);this.helper.css({left:E.clientX,top:E.clientY,width:0,height:0});if(D.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var F=A.data(this,"selectable-item");F.startselected=true;if(!E.metaKey&&!E.ctrlKey){F.$element.removeClass("ui-selected");F.selected=false;F.$element.addClass("ui-unselecting");F.unselecting=true;C._trigger("unselecting",E,{unselecting:F.element})}});A(E.target).parents().andSelf().each(function(){var G=A.data(this,"selectable-item");if(G){var F=(!E.metaKey&&!E.ctrlKey)||!G.$element.hasClass("ui-selected");G.$element.removeClass(F?"ui-unselecting":"ui-selected").addClass(F?"ui-selecting":"ui-unselecting");G.unselecting=!F;G.selecting=F;G.selected=F;if(F){C._trigger("selecting",E,{selecting:G.element})}else{C._trigger("unselecting",E,{unselecting:G.element})}return false}})},_mouseDrag:function(J){var D=this;this.dragged=true;if(this.options.disabled){return }var F=this.options;var E=this.opos[0],I=this.opos[1],C=J.pageX,H=J.pageY;if(E>C){var G=C;C=E;E=G}if(I>H){var G=H;H=I;I=G}this.helper.css({left:E,top:I,width:C-E,height:H-I});this.selectees.each(function(){var K=A.data(this,"selectable-item");if(!K||K.element==D.element[0]){return }var L=false;if(F.tolerance=="touch"){L=(!(K.left>C||K.right<E||K.top>H||K.bottom<I))}else{if(F.tolerance=="fit"){L=(K.left>E&&K.right<C&&K.top>I&&K.bottom<H)}}if(L){if(K.selected){K.$element.removeClass("ui-selected");K.selected=false}if(K.unselecting){K.$element.removeClass("ui-unselecting");K.unselecting=false}if(!K.selecting){K.$element.addClass("ui-selecting");K.selecting=true;D._trigger("selecting",J,{selecting:K.element})}}else{if(K.selecting){if((J.metaKey||J.ctrlKey)&&K.startselected){K.$element.removeClass("ui-selecting");K.selecting=false;K.$element.addClass("ui-selected");K.selected=true}else{K.$element.removeClass("ui-selecting");K.selecting=false;if(K.startselected){K.$element.addClass("ui-unselecting");K.unselecting=true}D._trigger("unselecting",J,{unselecting:K.element})}}if(K.selected){if(!J.metaKey&&!J.ctrlKey&&!K.startselected){K.$element.removeClass("ui-selected");K.selected=false;K.$element.addClass("ui-unselecting");K.unselecting=true;D._trigger("unselecting",J,{unselecting:K.element})}}}});return false},_mouseStop:function(E){var C=this;this.dragged=false;var D=this.options;A(".ui-unselecting",this.element[0]).each(function(){var F=A.data(this,"selectable-item");F.$element.removeClass("ui-unselecting");F.unselecting=false;F.startselected=false;C._trigger("unselected",E,{unselected:F.element})});A(".ui-selecting",this.element[0]).each(function(){var F=A.data(this,"selectable-item");F.$element.removeClass("ui-selecting").addClass("ui-selected");F.selecting=false;F.selected=true;F.startselected=true;C._trigger("selected",E,{selected:F.element})});this._trigger("stop",E);this.helper.remove();return false}});A.extend(A.ui.selectable,{version:"1.8.24"})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.accordion.js' */
/*
 * jQuery UI Accordion 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var C=this,D=C.options;C.running=0;C.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");C.headers=C.element.find(D.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){if(D.disabled){return }A(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){if(D.disabled){return }A(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){if(D.disabled){return }A(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){if(D.disabled){return }A(this).removeClass("ui-state-focus")});C.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(D.navigation){var E=C.element.find("a").filter(D.navigationFilter).eq(0);if(E.length){var F=E.closest(".ui-accordion-header");if(F.length){C.active=F}else{C.active=E.closest(".ui-accordion-content").prev()}}}C.active=C._findActive(C.active||D.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");C.active.next().addClass("ui-accordion-content-active");C._createIcons();C.resize();C.element.attr("role","tablist");C.headers.attr("role","tab").bind("keydown.accordion",function(G){return C._keydown(G)}).next().attr("role","tabpanel");C.headers.not(C.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();if(!C.active.length){C.headers.eq(0).attr("tabIndex",0)}else{C.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0})}if(!A.browser.safari){C.headers.find("a").attr("tabIndex",-1)}if(D.event){C.headers.bind(D.event.split(" ").join(".accordion ")+".accordion",function(G){C._clickHandler.call(C,G,this);G.preventDefault()})}},_createIcons:function(){var C=this.options;if(C.icons){A("<span></span>").addClass("ui-icon "+C.icons.header).prependTo(this.headers);this.active.children(".ui-icon").toggleClass(C.icons.header).toggleClass(C.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var C=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var D=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");if(C.autoHeight||C.fillHeight){D.css("height","")}return A.Widget.prototype.destroy.call(this)},_setOption:function(C,D){A.Widget.prototype._setOption.apply(this,arguments);if(C=="active"){this.activate(D)}if(C=="icons"){this._destroyIcons();if(D){this._createIcons()}}if(C=="disabled"){this.headers.add(this.headers.next())[D?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")}},_keydown:function(F){if(this.options.disabled||F.altKey||F.ctrlKey){return }var G=A.ui.keyCode,E=this.headers.length,C=this.headers.index(F.target),D=false;switch(F.keyCode){case G.RIGHT:case G.DOWN:D=this.headers[(C+1)%E];break;case G.LEFT:case G.UP:D=this.headers[(C-1+E)%E];break;case G.SPACE:case G.ENTER:this._clickHandler({target:F.target},F.target);F.preventDefault()}if(D){A(F.target).attr("tabIndex",-1);A(D).attr("tabIndex",0);D.focus();return false}return true},resize:function(){var C=this.options,E;if(C.fillSpace){if(A.browser.msie){var D=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}E=this.element.parent().height();if(A.browser.msie){this.element.parent().css("overflow",D)}this.headers.each(function(){E-=A(this).outerHeight(true)});this.headers.next().each(function(){A(this).height(Math.max(0,E-A(this).innerHeight()+A(this).height()))}).css("overflow","auto")}else{if(C.autoHeight){E=0;this.headers.next().each(function(){E=Math.max(E,A(this).height("").height())}).height(E)}}return this},activate:function(C){this.options.active=C;var D=this._findActive(C)[0];this._clickHandler({target:D},D);return this},_findActive:function(C){return C?typeof C==="number"?this.headers.filter(":eq("+C+")"):this.headers.not(this.headers.not(C)):C===false?A([]):this.headers.filter(":eq(0)")},_clickHandler:function(C,G){var L=this.options;if(L.disabled){return }if(!C.target){if(!L.collapsible){return }this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(L.icons.headerSelected).addClass(L.icons.header);this.active.next().addClass("ui-accordion-content-active");var I=this.active.next(),F={options:L,newHeader:A([]),oldHeader:L.active,newContent:A([]),oldContent:I},D=(this.active=A([]));this._toggle(D,I,F);return }var H=A(C.currentTarget||G),J=H[0]===this.active[0];L.active=L.collapsible&&J?false:this.headers.index(H);if(this.running||(!L.collapsible&&J)){return }var E=this.active,D=H.next(),I=this.active.next(),F={options:L,newHeader:J&&L.collapsible?A([]):H,oldHeader:this.active,newContent:J&&L.collapsible?A([]):D,oldContent:I},K=this.headers.index(this.active[0])>this.headers.index(H[0]);this.active=J?A([]):H;this._toggle(D,I,F,J,K);E.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(L.icons.headerSelected).addClass(L.icons.header);if(!J){H.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(L.icons.header).addClass(L.icons.headerSelected);H.next().addClass("ui-accordion-content-active")}return },_toggle:function(C,I,G,J,K){var M=this,N=M.options;M.toShow=C;M.toHide=I;M.data=G;var D=function(){if(!M){return }return M._completed.apply(M,arguments)};M._trigger("changestart",null,M.data);M.running=I.size()===0?C.size():I.size();if(N.animated){var F={};if(N.collapsible&&J){F={toShow:A([]),toHide:I,complete:D,down:K,autoHeight:N.autoHeight||N.fillSpace}}else{F={toShow:C,toHide:I,complete:D,down:K,autoHeight:N.autoHeight||N.fillSpace}}if(!N.proxied){N.proxied=N.animated}if(!N.proxiedDuration){N.proxiedDuration=N.duration}N.animated=A.isFunction(N.proxied)?N.proxied(F):N.proxied;N.duration=A.isFunction(N.proxiedDuration)?N.proxiedDuration(F):N.proxiedDuration;var L=A.ui.accordion.animations,E=N.duration,H=N.animated;if(H&&!L[H]&&!A.easing[H]){H="slide"}if(!L[H]){L[H]=function(O){this.slide(O,{easing:H,duration:E||700})}}L[H](F)}else{if(N.collapsible&&J){C.toggle()}else{I.hide();C.show()}D(true)}I.prev().attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).blur();C.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(C){this.running=C?0:--this.running;if(this.running){return }if(this.options.clearStyle){this.toShow.add(this.toHide).css({height:"",overflow:""})}this.toHide.removeClass("ui-accordion-content-active");if(this.toHide.length){this.toHide.parent()[0].className=this.toHide.parent()[0].className}this._trigger("change",null,this.data)}});A.extend(A.ui.accordion,{version:"1.8.24",animations:{slide:function(K,I){K=A.extend({easing:"swing",duration:300},K,I);if(!K.toHide.size()){K.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},K);return }if(!K.toShow.size()){K.toHide.animate({height:"hide",paddingTop:"hide",paddingBottom:"hide"},K);return }var D=K.toShow.css("overflow"),H=0,E={},G={},F=["height","paddingTop","paddingBottom"],C;var J=K.toShow;C=J[0].style.width;J.width(J.parent().width()-parseFloat(J.css("paddingLeft"))-parseFloat(J.css("paddingRight"))-(parseFloat(J.css("borderLeftWidth"))||0)-(parseFloat(J.css("borderRightWidth"))||0));A.each(F,function(L,N){G[N]="hide";var M=(""+A.css(K.toShow[0],N)).match(/^([\d+-.]+)(.*)$/);E[N]={value:M[1],unit:M[2]||"px"}});K.toShow.css({height:0,overflow:"hidden"}).show();K.toHide.filter(":hidden").each(K.complete).end().filter(":visible").animate(G,{step:function(L,M){if(M.prop=="height"){H=(M.end-M.start===0)?0:(M.now-M.start)/(M.end-M.start)}K.toShow[0].style[M.prop]=(H*E[M.prop].value)+E[M.prop].unit},duration:K.duration,easing:K.easing,complete:function(){if(!K.autoHeight){K.toShow.css("height","")}K.toShow.css({width:C,overflow:D});K.complete()}})},bounceslide:function(C){this.slide(C,{easing:C.down?"easeOutBounce":"swing",duration:C.down?1000:200})}}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.autocomplete.js' */
/*
 * jQuery UI Autocomplete 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */
(function(A,B){var C=0;A.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var D=this,F=this.element[0].ownerDocument,E;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(G){if(D.options.disabled||D.element.propAttr("readOnly")){return }E=false;var H=A.ui.keyCode;switch(G.keyCode){case H.PAGE_UP:D._move("previousPage",G);break;case H.PAGE_DOWN:D._move("nextPage",G);break;case H.UP:D._keyEvent("previous",G);break;case H.DOWN:D._keyEvent("next",G);break;case H.ENTER:case H.NUMPAD_ENTER:if(D.menu.active){E=true;G.preventDefault()}case H.TAB:if(!D.menu.active){return }D.menu.select(G);break;case H.ESCAPE:D.element.val(D.term);D.close(G);break;default:clearTimeout(D.searching);D.searching=setTimeout(function(){if(D.term!=D.element.val()){D.selectedItem=null;D.search(null,G)}},D.options.delay);break}}).bind("keypress.autocomplete",function(G){if(E){E=false;G.preventDefault()}}).bind("focus.autocomplete",function(){if(D.options.disabled){return }D.selectedItem=null;D.previous=D.element.val()}).bind("blur.autocomplete",function(G){if(D.options.disabled){return }clearTimeout(D.searching);D.closing=setTimeout(function(){D.close(G);D._change(G)},150)});this._initSource();this.menu=A("<ul></ul>").addClass("ui-autocomplete").appendTo(A(this.options.appendTo||"body",F)[0]).mousedown(function(G){var H=D.menu.element[0];if(!A(G.target).closest(".ui-menu-item").length){setTimeout(function(){A(document).one("mousedown",function(I){if(I.target!==D.element[0]&&I.target!==H&&!A.ui.contains(H,I.target)){D.close()}})},1)}setTimeout(function(){clearTimeout(D.closing)},13)}).menu({focus:function(H,I){var G=I.item.data("item.autocomplete");if(false!==D._trigger("focus",H,{item:G})){if(/^key/.test(H.originalEvent.type)){D.element.val(G.value)}}},selected:function(I,J){var H=J.item.data("item.autocomplete"),G=D.previous;if(D.element[0]!==F.activeElement){D.element.focus();D.previous=G;setTimeout(function(){D.previous=G;D.selectedItem=H},1)}if(false!==D._trigger("select",I,{item:H})){D.element.val(H.value)}D.term=D.element.val();D.close(I);D.selectedItem=H},blur:function(G,H){if(D.menu.element.is(":visible")&&(D.element.val()!==D.term)){D.element.val(D.term)}}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");if(A.fn.bgiframe){this.menu.element.bgiframe()}D.beforeunloadHandler=function(){D.element.removeAttr("autocomplete")};A(window).bind("beforeunload",D.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();A(window).unbind("beforeunload",this.beforeunloadHandler);A.Widget.prototype.destroy.call(this)},_setOption:function(D,E){A.Widget.prototype._setOption.apply(this,arguments);if(D==="source"){this._initSource()}if(D==="appendTo"){this.menu.element.appendTo(A(E||"body",this.element[0].ownerDocument)[0])}if(D==="disabled"&&E&&this.xhr){this.xhr.abort()}},_initSource:function(){var D=this,F,E;if(A.isArray(this.options.source)){F=this.options.source;this.source=function(H,G){G(A.ui.autocomplete.filter(F,H.term))}}else{if(typeof this.options.source==="string"){E=this.options.source;this.source=function(H,G){if(D.xhr){D.xhr.abort()}D.xhr=A.ajax({url:E,data:H,dataType:"json",success:function(J,I){G(J)},error:function(){G([])}})}}else{this.source=this.options.source}}},search:function(E,D){E=E!=null?E:this.element.val();this.term=this.element.val();if(E.length<this.options.minLength){return this.close(D)}clearTimeout(this.closing);if(this._trigger("search",D)===false){return }return this._search(E)},_search:function(D){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:D},this._response())},_response:function(){var E=this,D=++C;return function(F){if(D===C){E.__response(F)}E.pending--;if(!E.pending){E.element.removeClass("ui-autocomplete-loading")}}},__response:function(D){if(!this.options.disabled&&D&&D.length){D=this._normalize(D);this._suggest(D);this._trigger("open")}else{this.close()}},close:function(D){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.deactivate();this._trigger("close",D)}},_change:function(D){if(this.previous!==this.element.val()){this._trigger("change",D,{item:this.selectedItem})}},_normalize:function(D){if(D.length&&D[0].label&&D[0].value){return D}return A.map(D,function(E){if(typeof E==="string"){return{label:E,value:E}}return A.extend({label:E.label||E.value,value:E.value||E.label},E)})},_suggest:function(D){var E=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(E,D);this.menu.deactivate();this.menu.refresh();E.show();this._resizeMenu();E.position(A.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next(new A.Event("mouseover"))}},_resizeMenu:function(){var D=this.menu.element;D.outerWidth(Math.max(D.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(F,E){var D=this;A.each(E,function(G,H){D._renderItem(F,H)})},_renderItem:function(D,E){return A("<li></li>").data("item.autocomplete",E).append(A("<a></a>").text(E.label)).appendTo(D)},_move:function(E,D){if(!this.menu.element.is(":visible")){this.search(null,D);return }if(this.menu.first()&&/^previous/.test(E)||this.menu.last()&&/^next/.test(E)){this.element.val(this.term);this.menu.deactivate();return }this.menu[E](D)},widget:function(){return this.menu.element},_keyEvent:function(E,D){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(E,D);D.preventDefault()}}});A.extend(A.ui.autocomplete,{escapeRegex:function(D){return D.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(F,D){var E=new RegExp(A.ui.autocomplete.escapeRegex(D),"i");return A.grep(F,function(G){return E.test(G.label||G.value||G)})}})}(jQuery));(function(A){A.widget("ui.menu",{_create:function(){var B=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(C){if(!A(C.target).closest(".ui-menu-item a").length){return }C.preventDefault();B.select(C)});this.refresh()},refresh:function(){var C=this;var B=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");B.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(D){C.activate(D,A(this).parent())}).mouseleave(function(){C.deactivate()})},activate:function(E,D){this.deactivate();if(this.hasScroll()){var F=D.offset().top-this.element.offset().top,B=this.element.scrollTop(),C=this.element.height();if(F<0){this.element.scrollTop(B+F)}else{if(F>=C){this.element.scrollTop(B+F-C+D.height())}}}this.active=D.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",E,{item:D})},deactivate:function(){if(!this.active){return }this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(B){this.move("next",".ui-menu-item:first",B)},previous:function(B){this.move("prev",".ui-menu-item:last",B)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(E,D,C){if(!this.active){this.activate(C,this.element.children(D));return }var B=this.active[E+"All"](".ui-menu-item").eq(0);if(B.length){this.activate(C,B)}else{this.activate(C,this.element.children(D))}},nextPage:function(D){if(this.hasScroll()){if(!this.active||this.last()){this.activate(D,this.element.children(".ui-menu-item:first"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children(".ui-menu-item").filter(function(){var F=A(this).offset().top-E-C+A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(".ui-menu-item:last")}this.activate(D,B)}else{this.activate(D,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))}},previousPage:function(D){if(this.hasScroll()){if(!this.active||this.first()){this.activate(D,this.element.children(".ui-menu-item:last"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children(".ui-menu-item").filter(function(){var F=A(this).offset().top-E+C-A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(".ui-menu-item:first")}this.activate(D,B)}else{this.activate(D,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element[A.fn.prop?"prop":"attr"]("scrollHeight")},select:function(B){this._trigger("selected",B,{item:this.active})}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.button.js' */
/*
 * jQuery UI Button 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(F,B){var K,E,A,H,I="ui-button ui-widget ui-state-default ui-corner-all",C="ui-state-hover ui-state-active ",G="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",J=function(){var L=F(this).find(":ui-button");setTimeout(function(){L.button("refresh")},1)},D=function(M){var L=M.name,N=M.form,O=F([]);if(L){if(N){O=F(N).find("[name='"+L+"']")}else{O=F("[name='"+L+"']",M.ownerDocument).filter(function(){return !this.form})}}return O};F.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",J);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.propAttr("disabled")}else{this.element.propAttr("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var L=this,N=this.options,O=this.type==="checkbox"||this.type==="radio",P="ui-state-hover"+(!O?" ui-state-active":""),M="ui-state-focus";if(N.label===null){N.label=this.buttonElement.html()}this.buttonElement.addClass(I).attr("role","button").bind("mouseenter.button",function(){if(N.disabled){return }F(this).addClass("ui-state-hover");if(this===K){F(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){if(N.disabled){return }F(this).removeClass(P)}).bind("click.button",function(Q){if(N.disabled){Q.preventDefault();Q.stopImmediatePropagation()}});this.element.bind("focus.button",function(){L.buttonElement.addClass(M)}).bind("blur.button",function(){L.buttonElement.removeClass(M)});if(O){this.element.bind("change.button",function(){if(H){return }L.refresh()});this.buttonElement.bind("mousedown.button",function(Q){if(N.disabled){return }H=false;E=Q.pageX;A=Q.pageY}).bind("mouseup.button",function(Q){if(N.disabled){return }if(E!==Q.pageX||A!==Q.pageY){H=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(N.disabled||H){return false}F(this).toggleClass("ui-state-active");L.buttonElement.attr("aria-pressed",L.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(N.disabled||H){return false}F(this).addClass("ui-state-active");L.buttonElement.attr("aria-pressed","true");var Q=L.element[0];D(Q).not(Q).map(function(){return F(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown.button",function(){if(N.disabled){return false}F(this).addClass("ui-state-active");K=this;F(document).one("mouseup",function(){K=null})}).bind("mouseup.button",function(){if(N.disabled){return false}F(this).removeClass("ui-state-active")}).bind("keydown.button",function(Q){if(N.disabled){return false}if(Q.keyCode==F.ui.keyCode.SPACE||Q.keyCode==F.ui.keyCode.ENTER){F(this).addClass("ui-state-active")}}).bind("keyup.button",function(){F(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(Q){if(Q.keyCode===F.ui.keyCode.SPACE){F(this).click()}})}}}this._setOption("disabled",N.disabled);this._resetButton()},_determineButtonType:function(){if(this.element.is(":checkbox")){this.type="checkbox"}else{if(this.element.is(":radio")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){var L=this.element.parents().filter(":last"),N="label[for='"+this.element.attr("id")+"']";this.buttonElement=L.find(N);if(!this.buttonElement.length){L=L.length?L.siblings():this.element.siblings();this.buttonElement=L.filter(N);if(!this.buttonElement.length){this.buttonElement=L.find(N)}}this.element.addClass("ui-helper-hidden-accessible");var M=this.element.is(":checked");if(M){this.buttonElement.addClass("ui-state-active")}this.buttonElement.attr("aria-pressed",M)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(I+" "+C+" "+G).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}F.Widget.prototype.destroy.call(this)},_setOption:function(L,M){F.Widget.prototype._setOption.apply(this,arguments);if(L==="disabled"){if(M){this.element.propAttr("disabled",true)}else{this.element.propAttr("disabled",false)}return }this._resetButton()},refresh:function(){var L=this.element.is(":disabled");if(L!==this.options.disabled){this._setOption("disabled",L)}if(this.type==="radio"){D(this.element[0]).each(function(){if(F(this).is(":checked")){F(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{F(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return }var P=this.buttonElement.removeClass(G),N=F("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(P.empty()).text(),M=this.options.icons,L=M.primary&&M.secondary,O=[];if(M.primary||M.secondary){if(this.options.text){O.push("ui-button-text-icon"+(L?"s":(M.primary?"-primary":"-secondary")))}if(M.primary){P.prepend("<span class='ui-button-icon-primary ui-icon "+M.primary+"'></span>")}if(M.secondary){P.append("<span class='ui-button-icon-secondary ui-icon "+M.secondary+"'></span>")}if(!this.options.text){O.push(L?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){P.attr("title",N)}}}else{O.push("ui-button-text-only")}P.addClass(O.join(" "))}});F.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(L,M){if(L==="disabled"){this.buttons.button("option",L,M)}F.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var L=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return F(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(L?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(L?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return F(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");F.Widget.prototype.destroy.call(this)}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.datepicker.js' */
/*
 * jQuery UI Datepicker 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Datepicker
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function($,undefined){$.extend($.ui,{datepicker:{version:"1.8.24"}});var PROP_NAME="datepicker";var dpuuid=new Date().getTime();var instActive;function Datepicker(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){if(this.debug){console.log.apply("",arguments)}},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase();var inline=(nodeName=="div"||nodeName=="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{});if(nodeName=="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return }this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var appendText=this._get(inst,"appendText");var isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$('<span class="'+this._appendClass+'">'+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}var showOn=this._get(inst,"showOn");if(showOn=="focus"||showOn=="both"){input.focus(this._showDatepicker)}if(showOn=="button"||showOn=="both"){var buttonText=this._get(inst,"buttonText");var buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$('<button type="button"></button>').addClass(this._triggerClass).html(buttonImage==""?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput==input[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!=input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var date=new Date(2009,12-1,20);var dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){var findMax=function(names){var max=0;var maxI=0;for(var i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return }divSpan.addClass(this.markerClassName).append(inst.dpDiv).bind("setData.datepicker",function(event,key,value){inst.settings[key]=value}).bind("getData.datepicker",function(event,key){return this._get(inst,key)});$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var inst=this._dialogInst;if(!inst){this.uuid+=1;var id="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+id+'" style="position: absolute; top: -100px; width: 0px;"/>');this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor==Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){var browserWidth=document.documentElement.clientWidth;var browserHeight=document.documentElement.clientHeight;var scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;var scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName=="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName=="div"||nodeName=="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)})},_disableDatepicker:function(target){var $target=$(target);var inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return }var nodeName=target.nodeName.toLowerCase();if(nodeName=="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName=="div"||nodeName=="span"){var inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled","disabled")}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value==target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]==target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var inst=this._getInst(target);if(arguments.length==2&&typeof name=="string"){return(name=="defaults"?$.extend({},$.datepicker._defaults):(inst?(name=="all"?$.extend({},inst.settings):this._get(inst,name)):null))}var settings=name||{};if(typeof name=="string"){settings={};settings[name]=value}if(inst){if(this._curInst==inst){this._hideDatepicker()}var date=this._getDateDatepicker(target,true);var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var inst=$.datepicker._getInst(event.target);var handled=true;var isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:var sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}var onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){var dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;break;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode==36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){var chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));var chr=String.fromCharCode(event.charCode==undefined?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var inst=$.datepicker._getInst(event.target);if(inst.input.val()!=inst.lastVal){try{var date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){$.datepicker.log(err)}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput==input){return }var inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!=inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}var beforeShow=$.datepicker._get(inst,"beforeShow");var beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return }extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}var isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")=="fixed";return !isFixed});if(isFixed&&$.browser.opera){$.datepicker._pos[0]-=document.documentElement.scrollLeft;$.datepicker._pos[1]-=document.documentElement.scrollTop}var offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){var showAnim=$.datepicker._get(inst,"showAnim");var duration=$.datepicker._get(inst,"duration");var postProcess=function(){var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){var borders=$.datepicker._getBorders(inst.dpDiv);cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}};inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[showAnim||"show"]((showAnim?duration:null),postProcess)}if(!showAnim||!duration){postProcess()}if(inst.input.is(":visible")&&!inst.input.is(":disabled")){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){var self=this;self.maxRows=4;var borders=$.datepicker._getBorders(inst.dpDiv);instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);var cover=inst.dpDiv.find("iframe.ui-datepicker-cover");if(!!cover.length){cover.css({left:-borders[0],top:-borders[1],width:inst.dpDiv.outerWidth(),height:inst.dpDiv.outerHeight()})}inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var numMonths=this._getNumberOfMonths(inst);var cols=numMonths[1];var width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!=1||numMonths[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst==$.datepicker._curInst&&$.datepicker._datepickerShowing&&inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&inst.input[0]!=document.activeElement){inst.input.focus()}if(inst.yearshtml){var origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_getBorders:function(elem){var convert=function(value){return{thin:1,medium:2,thick:3}[value]||value};return[parseFloat(convert(elem.css("border-left-width"))),parseFloat(convert(elem.css("border-top-width")))]},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth();var dpHeight=inst.dpDiv.outerHeight();var inputWidth=inst.input?inst.input.outerWidth():0;var inputHeight=inst.input?inst.input.outerHeight():0;var viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft());var viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left==inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top==(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var inst=this._getInst(obj);var isRTL=this._get(inst,"isRTL");while(obj&&(obj.type=="hidden"||obj.nodeType!=1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}var position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var inst=this._curInst;if(!inst||(input&&inst!=$.data(input,PROP_NAME))){return }if(this._datepickerShowing){var showAnim=this._get(inst,"showAnim");var duration=this._get(inst,"duration");var postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&$.effects[showAnim]){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim=="slideDown"?"slideUp":(showAnim=="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;var onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return }var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!=$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length==0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=inst)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id);var inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return }this._adjustInstDate(inst,offset+(period=="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var target=$(id);var inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{var date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id);var inst=this._getInst(target[0]);inst["selected"+(period=="M"?"Month":"Year")]=inst["draw"+(period=="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return }var inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);var inst=this._getInst(target[0]);this._selectDate(target,"")},_selectDate:function(id,dateStr){var target=$(id);var inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);var onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof (inst.input[0])!="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altField=this._get(inst,"altField");if(altField){var altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");var date=this._getDate(inst);var dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));var time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value=="object"?value.toString():value+"");if(value==""){return null}var shortYearCutoff=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff;shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var year=-1;var month=-1;var day=-1;var doy=-1;var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var getNumber=function(match){var isDoubled=lookAhead(match);var size=(match=="@"?14:(match=="!"?20:(match=="y"&&isDoubled?4:(match=="o"?3:2))));var digits=new RegExp("^\\d{1,"+size+"}");var num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)};var getName=function(match,shortNames,longNames){var names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});var index=-1;$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()==name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!=-1){return index+1}else{throw"Unknown name at position "+iValue}};var checkLiteral=function(){if(value.charAt(iValue)!=format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};var iValue=0;for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":var date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":var date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){throw"Extra/unparsed characters found in date: "+value.substring(iValue)}if(year==-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{var dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}var date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!=year||date.getMonth()+1!=month||date.getDate()!=day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort;var dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames;var monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort;var monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};var formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num};var formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])};var output="";var literal=false;if(date){for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var chars="";var literal=false;var lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)==match);if(matches){iFormat++}return matches};for(var iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)=="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()==inst.lastVal){return }var dateFormat=this._get(inst,"dateFormat");var dates=inst.lastVal=inst.input?inst.input.val():null;var date,defaultDate;date=defaultDate=this._getDefaultDate(inst);var settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){this.log(event);dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date};var offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date();var year=date.getFullYear();var month=date.getMonth();var day=date.getDate();var pattern=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;var matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)};var newDate=(date==null||date===""?defaultDate:(typeof date=="string"?offsetString(date):(typeof date=="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()=="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date;var origMonth=inst.selectedMonth;var origYear=inst.selectedYear;var newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!=inst.selectedMonth||origYear!=inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()=="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths");var id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,-stepMonths,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(id)},selectDay:function(){window["DP_jQuery_"+dpuuid].datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var today=new Date();today=this._daylightSavingAdjust(new Date(today.getFullYear(),today.getMonth(),today.getDate()));var isRTL=this._get(inst,"isRTL");var showButtonPanel=this._get(inst,"showButtonPanel");var hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext");var navigationAsDateFormat=this._get(inst,"navigationAsDateFormat");var numMonths=this._getNumberOfMonths(inst);var showCurrentAtPos=this._get(inst,"showCurrentAtPos");var stepMonths=this._get(inst,"stepMonths");var isMultiMonth=(numMonths[0]!=1||numMonths[1]!=1);var currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var drawMonth=inst.drawMonth-showCurrentAtPos;var drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){var maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;var prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));var prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+prevText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"e":"w")+'">'+prevText+"</span></a>"));var nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));var next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>":(hideIfNoPrevNext?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+nextText+'"><span class="ui-icon ui-icon-circle-triangle-'+(isRTL?"w":"e")+'">'+nextText+"</span></a>"));var currentText=this._get(inst,"currentText");var gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));var controls=(!inst.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(inst,"closeText")+"</button>":"");var buttonPanel=(showButtonPanel)?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";var firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);var showWeek=this._get(inst,"showWeek");var dayNames=this._get(inst,"dayNames");var dayNamesShort=this._get(inst,"dayNamesShort");var dayNamesMin=this._get(inst,"dayNamesMin");var monthNames=this._get(inst,"monthNames");var monthNamesShort=this._get(inst,"monthNamesShort");var beforeShowDay=this._get(inst,"beforeShowDay");var showOtherMonths=this._get(inst,"showOtherMonths");var selectOtherMonths=this._get(inst,"selectOtherMonths");var calculateWeek=this._get(inst,"calculateWeek")||this.iso8601Week;var defaultDate=this._getDefaultDate(inst);var html="";for(var row=0;row<numMonths[0];row++){var group="";this.maxRows=4;for(var col=0;col<numMonths[1];col++){var selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));var cornerClass=" ui-corner-all";var calender="";if(isMultiMonth){calender+='<div class="ui-datepicker-group';if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+='">'}calender+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+cornerClass+'">'+(/all|left/.test(cornerClass)&&row==0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row==0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var thead=(showWeek?'<th class="ui-datepicker-week-col">'+this._get(inst,"weekHeader")+"</th>":"");for(var dow=0;dow<7;dow++){var day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+dayNames[day]+'">'+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";var daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear==inst.selectedYear&&drawMonth==inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}var leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;var curRows=Math.ceil((leadDays+daysInMonth)/7);var numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;var printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(var dRow=0;dRow<numRows;dRow++){calender+="<tr>";var tbody=(!showWeek?"":'<td class="ui-datepicker-week-col">'+this._get(inst,"calculateWeek")(printDate)+"</td>");for(var dow=0;dow<7;dow++){var daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);var otherMonth=(printDate.getMonth()!=drawMonth);var unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+='<td class="'+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()==selectedDate.getTime()&&drawMonth==inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()==printDate.getTime()&&defaultDate.getTime()==selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()==currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()==today.getTime()?" ui-datepicker-today":""))+'"'+((!otherMonth||showOtherMonths)&&daySettings[2]?' title="'+daySettings[2]+'"':"")+(unselectable?"":' data-handler="selectDay" data-event="click" data-month="'+printDate.getMonth()+'" data-year="'+printDate.getFullYear()+'"')+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?'<span class="ui-state-default">'+printDate.getDate()+"</span>":'<a class="ui-state-default'+(printDate.getTime()==today.getTime()?" ui-state-highlight":"")+(printDate.getTime()==currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+'" href="#">'+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col==numMonths[1]-1)?'<div class="ui-datepicker-row-break"></div>':""):"");group+=calender}html+=group}html+=buttonPanel+($.browser.msie&&parseInt($.browser.version,10)<7&&!inst.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var changeMonth=this._get(inst,"changeMonth");var changeYear=this._get(inst,"changeYear");var showMonthAfterYear=this._get(inst,"showMonthAfterYear");var html='<div class="ui-datepicker-title">';var monthHtml="";if(secondary||!changeMonth){monthHtml+='<span class="ui-datepicker-month">'+monthNames[drawMonth]+"</span>"}else{var inMinYear=(minDate&&minDate.getFullYear()==drawYear);var inMaxYear=(maxDate&&maxDate.getFullYear()==drawYear);monthHtml+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+='<option value="'+month+'"'+(month==drawMonth?' selected="selected"':"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+='<span class="ui-datepicker-year">'+drawYear+"</span>"}else{var years=this._get(inst,"yearRange").split(":");var thisYear=new Date().getFullYear();var determineYear=function(value){var year=(value.match(/c[+-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};var year=determineYear(years[0]);var endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;year<=endYear;year++){inst.yearshtml+='<option value="'+year+'"'+(year==drawYear?' selected="selected"':"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period=="Y"?offset:0);var month=inst.drawMonth+(period=="M"?offset:0);var day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period=="D"?offset:0);var date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period=="M"||period=="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");var newDate=(minDate&&date<minDate?minDate:date);newDate=(maxDate&&newDate>maxDate?maxDate:newDate);return newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths=="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst);var date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var minDate=this._getMinMaxDate(inst,"min");var maxDate=this._getMinMaxDate(inst,"max");return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime()))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day=="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.bind("mouseout",function(event){var elem=$(event.target).closest(selector);if(!elem.length){return }elem.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(event){var elem=$(event.target).closest(selector);if($.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])||!elem.length){return }elem.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");elem.addClass("ui-state-hover");if(elem.hasClass("ui-datepicker-prev")){elem.addClass("ui-datepicker-prev-hover")}if(elem.hasClass("ui-datepicker-next")){elem.addClass("ui-datepicker-next-hover")}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null||props[name]==undefined){target[name]=props[name]}}return target}function isArray(a){return(a&&(($.browser.safari&&typeof a=="object"&&a.length)||(a.constructor&&a.constructor.toString().match(/\Array\(\)/))))}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick).find("body").append($.datepicker.dpDiv);$.datepicker.initialized=true}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options=="string"&&(options=="isDisabled"||options=="getDate"||options=="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options=="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.8.24";window["DP_jQuery_"+dpuuid]=$})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.dialog.js' */
/*
 * jQuery UI Dialog 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(D,E){var B="ui-dialog ui-widget ui-widget-content ui-corner-all ",A={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},C={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};D.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(G){var F=D(this).css(G).offset().top;if(F<0){D(this).css("top",G.top-F)}}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string"){this.originalTitle=""}this.options.title=this.options.title||this.originalTitle;var N=this,O=N.options,L=O.title||"&#160;",G=D.ui.dialog.getTitleId(N.element),M=(N.uiDialog=D("<div></div>")).appendTo(document.body).hide().addClass(B+O.dialogClass).css({zIndex:O.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(P){if(O.closeOnEscape&&!P.isDefaultPrevented()&&P.keyCode&&P.keyCode===D.ui.keyCode.ESCAPE){N.close(P);P.preventDefault()}}).attr({role:"dialog","aria-labelledby":G}).mousedown(function(P){N.moveToTop(false,P)}),I=N.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(M),H=(N.uiDialogTitlebar=D("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(M),K=D('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){K.addClass("ui-state-hover")},function(){K.removeClass("ui-state-hover")}).focus(function(){K.addClass("ui-state-focus")}).blur(function(){K.removeClass("ui-state-focus")}).click(function(P){N.close(P);return false}).appendTo(H),J=(N.uiDialogTitlebarCloseText=D("<span></span>")).addClass("ui-icon ui-icon-closethick").text(O.closeText).appendTo(K),F=D("<span></span>").addClass("ui-dialog-title").attr("id",G).html(L).prependTo(H);if(D.isFunction(O.beforeclose)&&!D.isFunction(O.beforeClose)){O.beforeClose=O.beforeclose}H.find("*").add(H).disableSelection();if(O.draggable&&D.fn.draggable){N._makeDraggable()}if(O.resizable&&D.fn.resizable){N._makeResizable()}N._createButtons(O.buttons);N._isOpen=false;if(D.fn.bgiframe){M.bgiframe()}},_init:function(){if(this.options.autoOpen){this.open()}},destroy:function(){var F=this;if(F.overlay){F.overlay.destroy()}F.uiDialog.hide();F.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");F.uiDialog.remove();if(F.originalTitle){F.element.attr("title",F.originalTitle)}return F},widget:function(){return this.uiDialog},close:function(I){var F=this,H,G;if(false===F._trigger("beforeClose",I)){return }if(F.overlay){F.overlay.destroy()}F.uiDialog.unbind("keypress.ui-dialog");F._isOpen=false;if(F.options.hide){F.uiDialog.hide(F.options.hide,function(){F._trigger("close",I)})}else{F.uiDialog.hide();F._trigger("close",I)}D.ui.dialog.overlay.resize();if(F.options.modal){H=0;D(".ui-dialog").each(function(){if(this!==F.uiDialog[0]){G=D(this).css("z-index");if(!isNaN(G)){H=Math.max(H,G)}}});D.ui.dialog.maxZ=H}return F},isOpen:function(){return this._isOpen},moveToTop:function(J,I){var F=this,H=F.options,G;if((H.modal&&!J)||(!H.stack&&!H.modal)){return F._trigger("focus",I)}if(H.zIndex>D.ui.dialog.maxZ){D.ui.dialog.maxZ=H.zIndex}if(F.overlay){D.ui.dialog.maxZ+=1;F.overlay.$el.css("z-index",D.ui.dialog.overlay.maxZ=D.ui.dialog.maxZ)}G={scrollTop:F.element.scrollTop(),scrollLeft:F.element.scrollLeft()};D.ui.dialog.maxZ+=1;F.uiDialog.css("z-index",D.ui.dialog.maxZ);F.element.attr(G);F._trigger("focus",I);return F},open:function(){if(this._isOpen){return }var G=this,H=G.options,F=G.uiDialog;G.overlay=H.modal?new D.ui.dialog.overlay(G):null;G._size();G._position(H.position);F.show(H.show);G.moveToTop(true);if(H.modal){F.bind("keydown.ui-dialog",function(K){if(K.keyCode!==D.ui.keyCode.TAB){return }var J=D(":tabbable",this),L=J.filter(":first"),I=J.filter(":last");if(K.target===I[0]&&!K.shiftKey){L.focus(1);return false}else{if(K.target===L[0]&&K.shiftKey){I.focus(1);return false}}})}D(G.element.find(":tabbable").get().concat(F.find(".ui-dialog-buttonpane :tabbable").get().concat(F.get()))).eq(0).focus();G._isOpen=true;G._trigger("open");return G},_createButtons:function(I){var H=this,F=false,G=D("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),J=D("<div></div>").addClass("ui-dialog-buttonset").appendTo(G);H.uiDialog.find(".ui-dialog-buttonpane").remove();if(typeof I==="object"&&I!==null){D.each(I,function(){return !(F=true)})}if(F){D.each(I,function(K,M){M=D.isFunction(M)?{click:M,text:K}:M;var L=D('<button type="button"></button>').click(function(){M.click.apply(H.element[0],arguments)}).appendTo(J);D.each(M,function(N,O){if(N==="click"){return }if(N in L){L[N](O)}else{L.attr(N,O)}});if(D.fn.button){L.button()}});G.appendTo(H.uiDialog)}},_makeDraggable:function(){var F=this,I=F.options,J=D(document),H;function G(K){return{position:K.position,offset:K.offset}}F.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(K,L){H=I.height==="auto"?"auto":D(this).height();D(this).height(D(this).height()).addClass("ui-dialog-dragging");F._trigger("dragStart",K,G(L))},drag:function(K,L){F._trigger("drag",K,G(L))},stop:function(K,L){I.position=[L.position.left-J.scrollLeft(),L.position.top-J.scrollTop()];D(this).removeClass("ui-dialog-dragging").height(H);F._trigger("dragStop",K,G(L));D.ui.dialog.overlay.resize()}})},_makeResizable:function(K){K=(K===E?this.options.resizable:K);var G=this,J=G.options,F=G.uiDialog.css("position"),I=(typeof K==="string"?K:"n,e,s,w,se,sw,ne,nw");function H(L){return{originalPosition:L.originalPosition,originalSize:L.originalSize,position:L.position,size:L.size}}G.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:G.element,maxWidth:J.maxWidth,maxHeight:J.maxHeight,minWidth:J.minWidth,minHeight:G._minHeight(),handles:I,start:function(L,M){D(this).addClass("ui-dialog-resizing");G._trigger("resizeStart",L,H(M))},resize:function(L,M){G._trigger("resize",L,H(M))},stop:function(L,M){D(this).removeClass("ui-dialog-resizing");J.height=D(this).height();J.width=D(this).width();G._trigger("resizeStop",L,H(M));D.ui.dialog.overlay.resize()}}).css("position",F).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var F=this.options;if(F.height==="auto"){return F.minHeight}else{return Math.min(F.minHeight,F.height)}},_position:function(G){var H=[],I=[0,0],F;if(G){if(typeof G==="string"||(typeof G==="object"&&"0" in G)){H=G.split?G.split(" "):[G[0],G[1]];if(H.length===1){H[1]=H[0]}D.each(["left","top"],function(K,J){if(+H[K]===H[K]){I[K]=H[K];H[K]=J}});G={my:H.join(" "),at:H.join(" "),offset:I.join(" ")}}G=D.extend({},D.ui.dialog.prototype.options.position,G)}else{G=D.ui.dialog.prototype.options.position}F=this.uiDialog.is(":visible");if(!F){this.uiDialog.show()}this.uiDialog.css({top:0,left:0}).position(D.extend({of:window},G));if(!F){this.uiDialog.hide()}},_setOptions:function(I){var G=this,F={},H=false;D.each(I,function(J,K){G._setOption(J,K);if(J in A){H=true}if(J in C){F[J]=K}});if(H){this._size()}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option",F)}},_setOption:function(I,J){var G=this,F=G.uiDialog;switch(I){case"beforeclose":I="beforeClose";break;case"buttons":G._createButtons(J);break;case"closeText":G.uiDialogTitlebarCloseText.text(""+J);break;case"dialogClass":F.removeClass(G.options.dialogClass).addClass(B+J);break;case"disabled":if(J){F.addClass("ui-dialog-disabled")}else{F.removeClass("ui-dialog-disabled")}break;case"draggable":var H=F.is(":data(draggable)");if(H&&!J){F.draggable("destroy")}if(!H&&J){G._makeDraggable()}break;case"position":G._position(J);break;case"resizable":var K=F.is(":data(resizable)");if(K&&!J){F.resizable("destroy")}if(K&&typeof J==="string"){F.resizable("option","handles",J)}if(!K&&J!==false){G._makeResizable(J)}break;case"title":D(".ui-dialog-title",G.uiDialogTitlebar).html(""+(J||"&#160;"));break}D.Widget.prototype._setOption.apply(G,arguments)},_size:function(){var J=this.options,G,I,F=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(J.minWidth>J.width){J.width=J.minWidth}G=this.uiDialog.css({height:"auto",width:J.width}).height();I=Math.max(0,J.minHeight-G);if(J.height==="auto"){if(D.support.minHeight){this.element.css({minHeight:I,height:"auto"})}else{this.uiDialog.show();var H=this.element.css("height","auto").height();if(!F){this.uiDialog.hide()}this.element.height(Math.max(H,I))}}else{this.element.height(Math.max(J.height-G,0))}if(this.uiDialog.is(":data(resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}}});D.extend(D.ui.dialog,{version:"1.8.24",uuid:0,maxZ:0,getTitleId:function(F){var G=F.attr("id");if(!G){this.uuid+=1;G=this.uuid}return"ui-dialog-title-"+G},overlay:function(F){this.$el=D.ui.dialog.overlay.create(F)}});D.extend(D.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:D.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(F){return F+".dialog-overlay"}).join(" "),create:function(G){if(this.instances.length===0){setTimeout(function(){if(D.ui.dialog.overlay.instances.length){D(document).bind(D.ui.dialog.overlay.events,function(H){if(D(H.target).zIndex()<D.ui.dialog.overlay.maxZ){return false}})}},1);D(document).bind("keydown.dialog-overlay",function(H){if(G.options.closeOnEscape&&!H.isDefaultPrevented()&&H.keyCode&&H.keyCode===D.ui.keyCode.ESCAPE){G.close(H);H.preventDefault()}});D(window).bind("resize.dialog-overlay",D.ui.dialog.overlay.resize)}var F=(this.oldInstances.pop()||D("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});if(D.fn.bgiframe){F.bgiframe()}this.instances.push(F);return F},destroy:function(F){var G=D.inArray(F,this.instances);if(G!=-1){this.oldInstances.push(this.instances.splice(G,1)[0])}if(this.instances.length===0){D([document,window]).unbind(".dialog-overlay")}F.remove();var H=0;D.each(this.instances,function(){H=Math.max(H,this.css("z-index"))});this.maxZ=H},height:function(){var G,F;if(D.browser.msie&&D.browser.version<7){G=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);F=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);if(G<F){return D(window).height()+"px"}else{return G+"px"}}else{return D(document).height()+"px"}},width:function(){var F,G;if(D.browser.msie){F=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);G=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);if(F<G){return D(window).width()+"px"}else{return F+"px"}}else{return D(document).width()+"px"}},resize:function(){var F=D([]);D.each(D.ui.dialog.overlay.instances,function(){F=F.add(this)});F.css({width:0,height:0}).css({width:D.ui.dialog.overlay.width(),height:D.ui.dialog.overlay.height()})}});D.extend(D.ui.dialog.overlay.prototype,{destroy:function(){D.ui.dialog.overlay.destroy(this.$el)}})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.progressbar.js' */
/*
 * jQuery UI Progressbar 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */
(function(A,B){A.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=A("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();A.Widget.prototype.destroy.apply(this,arguments)},value:function(C){if(C===B){return this._value()}this._setOption("value",C);return this},_setOption:function(C,D){if(C==="value"){this.options.value=D;this._refreshValue();if(this._value()===this.options.max){this._trigger("complete")}}A.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var C=this.options.value;if(typeof C!=="number"){C=0}return Math.min(this.options.max,Math.max(this.min,C))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var D=this.value();var C=this._percentage();if(this.oldValue!==D){this.oldValue=D;this._trigger("change")}this.valueDiv.toggle(D>this.min).toggleClass("ui-corner-right",D===this.options.max).width(C.toFixed(0)+"%");this.element.attr("aria-valuenow",D)}});A.extend(A.ui.progressbar,{version:"1.8.24"})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.slider.js' */
/*
 * jQuery UI Slider 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(B,C){var A=5;B.widget("ui.slider",B.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var E=this,J=this.options,I=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),H="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",D=(J.values&&J.values.length)||1,G=[];this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(J.disabled?" ui-slider-disabled ui-disabled":""));this.range=B([]);if(J.range){if(J.range===true){if(!J.values){J.values=[this._valueMin(),this._valueMin()]}if(J.values.length&&J.values.length!==2){J.values=[J.values[0],J.values[0]]}}this.range=B("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+((J.range==="min"||J.range==="max")?" ui-slider-range-"+J.range:""))}for(var F=I.length;F<D;F+=1){G.push(H)}this.handles=I.add(B(G.join("")).appendTo(E.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(K){K.preventDefault()}).hover(function(){if(!J.disabled){B(this).addClass("ui-state-hover")}},function(){B(this).removeClass("ui-state-hover")}).focus(function(){if(!J.disabled){B(".ui-slider .ui-state-focus").removeClass("ui-state-focus");B(this).addClass("ui-state-focus")}else{B(this).blur()}}).blur(function(){B(this).removeClass("ui-state-focus")});this.handles.each(function(K){B(this).data("index.ui-slider-handle",K)});this.handles.keydown(function(O){var L=B(this).data("index.ui-slider-handle"),P,M,K,N;if(E.options.disabled){return }switch(O.keyCode){case B.ui.keyCode.HOME:case B.ui.keyCode.END:case B.ui.keyCode.PAGE_UP:case B.ui.keyCode.PAGE_DOWN:case B.ui.keyCode.UP:case B.ui.keyCode.RIGHT:case B.ui.keyCode.DOWN:case B.ui.keyCode.LEFT:O.preventDefault();if(!E._keySliding){E._keySliding=true;B(this).addClass("ui-state-active");P=E._start(O,L);if(P===false){return }}break}N=E.options.step;if(E.options.values&&E.options.values.length){M=K=E.values(L)}else{M=K=E.value()}switch(O.keyCode){case B.ui.keyCode.HOME:K=E._valueMin();break;case B.ui.keyCode.END:K=E._valueMax();break;case B.ui.keyCode.PAGE_UP:K=E._trimAlignValue(M+((E._valueMax()-E._valueMin())/A));break;case B.ui.keyCode.PAGE_DOWN:K=E._trimAlignValue(M-((E._valueMax()-E._valueMin())/A));break;case B.ui.keyCode.UP:case B.ui.keyCode.RIGHT:if(M===E._valueMax()){return }K=E._trimAlignValue(M+N);break;case B.ui.keyCode.DOWN:case B.ui.keyCode.LEFT:if(M===E._valueMin()){return }K=E._trimAlignValue(M-N);break}E._slide(O,L,K)}).keyup(function(L){var K=B(this).data("index.ui-slider-handle");if(E._keySliding){E._keySliding=false;E._stop(L,K);E._change(L,K);B(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(F){var G=this.options,J,L,E,H,N,K,M,I,D;if(G.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();J={x:F.pageX,y:F.pageY};L=this._normValueFromMouse(J);E=this._valueMax()-this._valueMin()+1;N=this;this.handles.each(function(O){var P=Math.abs(L-N.values(O));if(E>P){E=P;H=B(this);K=O}});if(G.range===true&&this.values(1)===G.min){K+=1;H=B(this.handles[K])}M=this._start(F,K);if(M===false){return false}this._mouseSliding=true;N._handleIndex=K;H.addClass("ui-state-active").focus();I=H.offset();D=!B(F.target).parents().andSelf().is(".ui-slider-handle");this._clickOffset=D?{left:0,top:0}:{left:F.pageX-I.left-(H.width()/2),top:F.pageY-I.top-(H.height()/2)-(parseInt(H.css("borderTopWidth"),10)||0)-(parseInt(H.css("borderBottomWidth"),10)||0)+(parseInt(H.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(F,K,L)}this._animateOff=true;return true},_mouseStart:function(D){return true},_mouseDrag:function(F){var D={x:F.pageX,y:F.pageY},E=this._normValueFromMouse(D);this._slide(F,this._handleIndex,E);return false},_mouseStop:function(D){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(D,this._handleIndex);this._change(D,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(E){var D,H,G,F,I;if(this.orientation==="horizontal"){D=this.elementSize.width;H=E.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{D=this.elementSize.height;H=E.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}G=(H/D);if(G>1){G=1}if(G<0){G=0}if(this.orientation==="vertical"){G=1-G}F=this._valueMax()-this._valueMin();I=this._valueMin()+G*F;return this._trimAlignValue(I)},_start:function(F,E){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}return this._trigger("start",F,D)},_slide:function(H,G,F){var D,E,I;if(this.options.values&&this.options.values.length){D=this.values(G?0:1);if((this.options.values.length===2&&this.options.range===true)&&((G===0&&F>D)||(G===1&&F<D))){F=D}if(F!==this.values(G)){E=this.values();E[G]=F;I=this._trigger("slide",H,{handle:this.handles[G],value:F,values:E});D=this.values(G?0:1);if(I!==false){this.values(G,F,true)}}}else{if(F!==this.value()){I=this._trigger("slide",H,{handle:this.handles[G],value:F});if(I!==false){this.value(F)}}}},_stop:function(F,E){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}this._trigger("stop",F,D)},_change:function(F,E){if(!this._keySliding&&!this._mouseSliding){var D={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){D.value=this.values(E);D.values=this.values()}this._trigger("change",F,D)}},value:function(D){if(arguments.length){this.options.value=this._trimAlignValue(D);this._refreshValue();this._change(null,0);return }return this._value()},values:function(E,H){var G,D,F;if(arguments.length>1){this.options.values[E]=this._trimAlignValue(H);this._refreshValue();this._change(null,E);return }if(arguments.length){if(B.isArray(arguments[0])){G=this.options.values;D=arguments[0];for(F=0;F<G.length;F+=1){G[F]=this._trimAlignValue(D[F]);this._change(null,F)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(E)}else{return this.value()}}}else{return this._values()}},_setOption:function(E,F){var D,G=0;if(B.isArray(this.options.values)){G=this.options.values.length}B.Widget.prototype._setOption.apply(this,arguments);switch(E){case"disabled":if(F){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.propAttr("disabled",true);this.element.addClass("ui-disabled")}else{this.handles.propAttr("disabled",false);this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(D=0;D<G;D+=1){this._change(null,D)}this._animateOff=false;break}},_value:function(){var D=this.options.value;D=this._trimAlignValue(D);return D},_values:function(D){var G,F,E;if(arguments.length){G=this.options.values[D];G=this._trimAlignValue(G);return G}else{F=this.options.values.slice();for(E=0;E<F.length;E+=1){F[E]=this._trimAlignValue(F[E])}return F}},_trimAlignValue:function(G){if(G<=this._valueMin()){return this._valueMin()}if(G>=this._valueMax()){return this._valueMax()}var D=(this.options.step>0)?this.options.step:1,F=(G-this._valueMin())%D,E=G-F;if(Math.abs(F)*2>=D){E+=(F>0)?D:(-D)}return parseFloat(E.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var G=this.options.range,F=this.options,M=this,E=(!this._animateOff)?F.animate:false,H,D={},I,K,J,L;if(this.options.values&&this.options.values.length){this.handles.each(function(O,N){H=(M.values(O)-M._valueMin())/(M._valueMax()-M._valueMin())*100;D[M.orientation==="horizontal"?"left":"bottom"]=H+"%";B(this).stop(1,1)[E?"animate":"css"](D,F.animate);if(M.options.range===true){if(M.orientation==="horizontal"){if(O===0){M.range.stop(1,1)[E?"animate":"css"]({left:H+"%"},F.animate)}if(O===1){M.range[E?"animate":"css"]({width:(H-I)+"%"},{queue:false,duration:F.animate})}}else{if(O===0){M.range.stop(1,1)[E?"animate":"css"]({bottom:(H)+"%"},F.animate)}if(O===1){M.range[E?"animate":"css"]({height:(H-I)+"%"},{queue:false,duration:F.animate})}}}I=H})}else{K=this.value();J=this._valueMin();L=this._valueMax();H=(L!==J)?(K-J)/(L-J)*100:0;D[M.orientation==="horizontal"?"left":"bottom"]=H+"%";this.handle.stop(1,1)[E?"animate":"css"](D,F.animate);if(G==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[E?"animate":"css"]({width:H+"%"},F.animate)}if(G==="max"&&this.orientation==="horizontal"){this.range[E?"animate":"css"]({width:(100-H)+"%"},{queue:false,duration:F.animate})}if(G==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[E?"animate":"css"]({height:H+"%"},F.animate)}if(G==="max"&&this.orientation==="vertical"){this.range[E?"animate":"css"]({height:(100-H)+"%"},{queue:false,duration:F.animate})}}}});B.extend(B.ui.slider,{version:"1.8.24"})}(jQuery));
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.ui.tabs.js' */
/*
 * jQuery UI Tabs 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(D,F){var C=0,B=0;function E(){return ++C}function A(){return ++B}D.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(true)},_setOption:function(G,H){if(G=="selected"){if(this.options.collapsible&&H==this.options.selected){return }this.select(H)}else{this.options[G]=H;this._tabify()}},_tabId:function(G){return G.title&&G.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+E()},_sanitizeSelector:function(G){return G.replace(/:/g,"\\:")},_cookie:function(){var G=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+A());return D.cookie.apply(null,[G].concat(D.makeArray(arguments)))},_ui:function(H,G){return{tab:H,panel:G,index:this.anchors.index(H)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var G=D(this);G.html(G.data("label.tabs")).removeData("label.tabs")})},_tabify:function(R){var S=this,I=this.options,H=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=D(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return D("a",this)[0]});this.panels=D([]);this.anchors.each(function(V,T){var U=D(T).attr("href");var W=U.split("#")[0],X;if(W&&(W===location.toString().split("#")[0]||(X=D("base")[0])&&W===X.href)){U=T.hash;T.href=U}if(H.test(U)){S.panels=S.panels.add(S.element.find(S._sanitizeSelector(U)))}else{if(U&&U!=="#"){D.data(T,"href.tabs",U);D.data(T,"load.tabs",U.replace(/#.*$/,""));var Z=S._tabId(T);T.href="#"+Z;var Y=S.element.find("#"+Z);if(!Y.length){Y=D(I.panelTemplate).attr("id",Z).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(S.panels[V-1]||S.list);Y.data("destroy.tabs",true)}S.panels=S.panels.add(Y)}else{I.disabled.push(V)}}});if(R){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(I.selected===F){if(location.hash){this.anchors.each(function(U,T){if(T.hash==location.hash){I.selected=U;return false}})}if(typeof I.selected!=="number"&&I.cookie){I.selected=parseInt(S._cookie(),10)}if(typeof I.selected!=="number"&&this.lis.filter(".ui-tabs-selected").length){I.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}I.selected=I.selected||(this.lis.length?0:-1)}else{if(I.selected===null){I.selected=-1}}I.selected=((I.selected>=0&&this.anchors[I.selected])||I.selected<0)?I.selected:0;I.disabled=D.unique(I.disabled.concat(D.map(this.lis.filter(".ui-state-disabled"),function(U,T){return S.lis.index(U)}))).sort();if(D.inArray(I.selected,I.disabled)!=-1){I.disabled.splice(D.inArray(I.selected,I.disabled),1)}this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(I.selected>=0&&this.anchors.length){S.element.find(S._sanitizeSelector(S.anchors[I.selected].hash)).removeClass("ui-tabs-hide");this.lis.eq(I.selected).addClass("ui-tabs-selected ui-state-active");S.element.queue("tabs",function(){S._trigger("show",null,S._ui(S.anchors[I.selected],S.element.find(S._sanitizeSelector(S.anchors[I.selected].hash))[0]))});this.load(I.selected)}D(window).bind("unload",function(){S.lis.add(S.anchors).unbind(".tabs");S.lis=S.anchors=S.panels=null})}else{I.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[I.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");if(I.cookie){this._cookie(I.selected,I.cookie)}for(var L=0,Q;(Q=this.lis[L]);L++){D(Q)[D.inArray(L,I.disabled)!=-1&&!D(Q).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}if(I.cache===false){this.anchors.removeData("cache.tabs")}this.lis.add(this.anchors).unbind(".tabs");if(I.event!=="mouseover"){var K=function(U,T){if(T.is(":not(.ui-state-disabled)")){T.addClass("ui-state-"+U)}};var N=function(U,T){T.removeClass("ui-state-"+U)};this.lis.bind("mouseover.tabs",function(){K("hover",D(this))});this.lis.bind("mouseout.tabs",function(){N("hover",D(this))});this.anchors.bind("focus.tabs",function(){K("focus",D(this).closest("li"))});this.anchors.bind("blur.tabs",function(){N("focus",D(this).closest("li"))})}var G,M;if(I.fx){if(D.isArray(I.fx)){G=I.fx[0];M=I.fx[1]}else{G=M=I.fx}}function J(T,U){T.css("display","");if(!D.support.opacity&&U.opacity){T[0].style.removeAttribute("filter")}}var O=M?function(T,U){D(T).closest("li").addClass("ui-tabs-selected ui-state-active");U.hide().removeClass("ui-tabs-hide").animate(M,M.duration||"normal",function(){J(U,M);S._trigger("show",null,S._ui(T,U[0]))})}:function(T,U){D(T).closest("li").addClass("ui-tabs-selected ui-state-active");U.removeClass("ui-tabs-hide");S._trigger("show",null,S._ui(T,U[0]))};var P=G?function(U,T){T.animate(G,G.duration||"normal",function(){S.lis.removeClass("ui-tabs-selected ui-state-active");T.addClass("ui-tabs-hide");J(T,G);S.element.dequeue("tabs")})}:function(U,T,V){S.lis.removeClass("ui-tabs-selected ui-state-active");T.addClass("ui-tabs-hide");S.element.dequeue("tabs")};this.anchors.bind(I.event+".tabs",function(){var U=this,W=D(U).closest("li"),T=S.panels.filter(":not(.ui-tabs-hide)"),V=S.element.find(S._sanitizeSelector(U.hash));if((W.hasClass("ui-tabs-selected")&&!I.collapsible)||W.hasClass("ui-state-disabled")||W.hasClass("ui-state-processing")||S.panels.filter(":animated").length||S._trigger("select",null,S._ui(this,V[0]))===false){this.blur();return false}I.selected=S.anchors.index(this);S.abort();if(I.collapsible){if(W.hasClass("ui-tabs-selected")){I.selected=-1;if(I.cookie){S._cookie(I.selected,I.cookie)}S.element.queue("tabs",function(){P(U,T)}).dequeue("tabs");this.blur();return false}else{if(!T.length){if(I.cookie){S._cookie(I.selected,I.cookie)}S.element.queue("tabs",function(){O(U,V)});S.load(S.anchors.index(this));this.blur();return false}}}if(I.cookie){S._cookie(I.selected,I.cookie)}if(V.length){if(T.length){S.element.queue("tabs",function(){P(U,T)})}S.element.queue("tabs",function(){O(U,V)});S.load(S.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}if(D.browser.msie){this.blur()}});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(G){if(typeof G=="string"){G=this.anchors.index(this.anchors.filter("[href$='"+G+"']"))}return G},destroy:function(){var G=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var H=D.data(this,"href.tabs");if(H){this.href=H}var I=D(this).unbind(".tabs");D.each(["href","load","cache"],function(J,K){I.removeData(K+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){if(D.data(this,"destroy.tabs")){D(this).remove()}else{D(this).removeClass(["ui-state-default","ui-corner-top","ui-tabs-selected","ui-state-active","ui-state-hover","ui-state-focus","ui-state-disabled","ui-tabs-panel","ui-widget-content","ui-corner-bottom","ui-tabs-hide"].join(" "))}});if(G.cookie){this._cookie(null,G.cookie)}return this},add:function(J,I,H){if(H===F){H=this.anchors.length}var G=this,L=this.options,N=D(L.tabTemplate.replace(/#\{href\}/g,J).replace(/#\{label\}/g,I)),M=!J.indexOf("#")?J.replace("#",""):this._tabId(D("a",N)[0]);N.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var K=G.element.find("#"+M);if(!K.length){K=D(L.panelTemplate).attr("id",M).data("destroy.tabs",true)}K.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(H>=this.lis.length){N.appendTo(this.list);K.appendTo(this.list[0].parentNode)}else{N.insertBefore(this.lis[H]);K.insertBefore(this.panels[H])}L.disabled=D.map(L.disabled,function(P,O){return P>=H?++P:P});this._tabify();if(this.anchors.length==1){L.selected=0;N.addClass("ui-tabs-selected ui-state-active");K.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){G._trigger("show",null,G._ui(G.anchors[0],G.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[H],this.panels[H]));return this},remove:function(G){G=this._getIndex(G);var I=this.options,J=this.lis.eq(G).remove(),H=this.panels.eq(G).remove();if(J.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(G+(G+1<this.anchors.length?1:-1))}I.disabled=D.map(D.grep(I.disabled,function(L,K){return L!=G}),function(L,K){return L>=G?--L:L});this._tabify();this._trigger("remove",null,this._ui(J.find("a")[0],H[0]));return this},enable:function(G){G=this._getIndex(G);var H=this.options;if(D.inArray(G,H.disabled)==-1){return }this.lis.eq(G).removeClass("ui-state-disabled");H.disabled=D.grep(H.disabled,function(J,I){return J!=G});this._trigger("enable",null,this._ui(this.anchors[G],this.panels[G]));return this},disable:function(H){H=this._getIndex(H);var G=this,I=this.options;if(H!=I.selected){this.lis.eq(H).addClass("ui-state-disabled");I.disabled.push(H);I.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[H],this.panels[H]))}return this},select:function(G){G=this._getIndex(G);if(G==-1){if(this.options.collapsible&&this.options.selected!=-1){G=this.options.selected}else{return this}}this.anchors.eq(G).trigger(this.options.event+".tabs");return this},load:function(J){J=this._getIndex(J);var H=this,L=this.options,G=this.anchors.eq(J)[0],I=D.data(G,"load.tabs");this.abort();if(!I||this.element.queue("tabs").length!==0&&D.data(G,"cache.tabs")){this.element.dequeue("tabs");return }this.lis.eq(J).addClass("ui-state-processing");if(L.spinner){var K=D("span",G);K.data("label.tabs",K.html()).html(L.spinner)}this.xhr=D.ajax(D.extend({},L.ajaxOptions,{url:I,success:function(N,M){H.element.find(H._sanitizeSelector(G.hash)).html(N);H._cleanup();if(L.cache){D.data(G,"cache.tabs",true)}H._trigger("load",null,H._ui(H.anchors[J],H.panels[J]));try{L.ajaxOptions.success(N,M)}catch(O){}},error:function(O,M,N){H._cleanup();H._trigger("load",null,H._ui(H.anchors[J],H.panels[J]));try{L.ajaxOptions.error(O,M,J,G)}catch(N){}}}));H.element.dequeue("tabs");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(H,G){this.anchors.eq(H).removeData("cache.tabs").data("load.tabs",G);return this},length:function(){return this.anchors.length}});D.extend(D.ui.tabs,{version:"1.8.24"});D.extend(D.ui.tabs.prototype,{rotation:null,rotate:function(I,K){var G=this,L=this.options;var H=G._rotate||(G._rotate=function(M){clearTimeout(G.rotation);G.rotation=setTimeout(function(){var N=L.selected;G.select(++N<G.anchors.length?N:0)},I);if(M){M.stopPropagation()}});var J=G._unrotate||(G._unrotate=!K?function(M){if(M.clientX){G.rotate(null)}}:function(M){H()});if(I){this.element.bind("tabsshow",H);this.anchors.bind(L.event+".tabs",J);H()}else{clearTimeout(G.rotation);this.element.unbind("tabsshow",H);this.anchors.unbind(L.event+".tabs",J);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.core.js' */
/*
 * jQuery UI Effects 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||(function(H,E){H.effects={};H.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","borderColor","color","outlineColor"],function(O,N){H.fx.step[N]=function(P){if(!P.colorInit){P.start=M(P.elem,N);P.end=K(P.end);P.colorInit=true}P.elem.style[N]="rgb("+Math.max(Math.min(parseInt((P.pos*(P.end[0]-P.start[0]))+P.start[0],10),255),0)+","+Math.max(Math.min(parseInt((P.pos*(P.end[1]-P.start[1]))+P.start[1],10),255),0)+","+Math.max(Math.min(parseInt((P.pos*(P.end[2]-P.start[2]))+P.start[2],10),255),0)+")"}});function K(O){var N;if(O&&O.constructor==Array&&O.length==3){return O}if(N=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(O)){return[parseInt(N[1],10),parseInt(N[2],10),parseInt(N[3],10)]}if(N=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(O)){return[parseFloat(N[1])*2.55,parseFloat(N[2])*2.55,parseFloat(N[3])*2.55]}if(N=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(O)){return[parseInt(N[1],16),parseInt(N[2],16),parseInt(N[3],16)]}if(N=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(O)){return[parseInt(N[1]+N[1],16),parseInt(N[2]+N[2],16),parseInt(N[3]+N[3],16)]}if(N=/rgba\(0, 0, 0, 0\)/.exec(O)){return A.transparent}return A[H.trim(O).toLowerCase()]}function M(P,N){var O;do{O=(H.curCSS||H.css)(P,N);if(O!=""&&O!="transparent"||H.nodeName(P,"body")){break}N="backgroundColor"}while(P=P.parentNode);return K(O)}var A={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var F=["add","remove","toggle"],C={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function G(){var Q=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,R={},O,P;if(Q&&Q.length&&Q[0]&&Q[Q[0]]){var N=Q.length;while(N--){O=Q[N];if(typeof Q[O]=="string"){P=O.replace(/\-(\w)/g,function(S,T){return T.toUpperCase()});R[P]=Q[O]}}}else{for(O in Q){if(typeof Q[O]==="string"){R[O]=Q[O]}}}return R}function B(O){var N,P;for(N in O){P=O[N];if(P==null||H.isFunction(P)||N in C||(/scrollbar/).test(N)||(!(/color/i).test(N)&&isNaN(parseFloat(P)))){delete O[N]}}return O}function I(N,P){var Q={_:0},O;for(O in P){if(N[O]!=P[O]){Q[O]=P[O]}}return Q}H.effects.animateClass=function(N,O,Q,P){if(H.isFunction(Q)){P=Q;Q=null}return this.queue(function(){var U=H(this),R=U.attr("style")||" ",V=B(G.call(this)),T,S=U.attr("class")||"";H.each(F,function(W,X){if(N[X]){U[X+"Class"](N[X])}});T=B(G.call(this));U.attr("class",S);U.animate(I(V,T),{queue:false,duration:O,easing:Q,complete:function(){H.each(F,function(W,X){if(N[X]){U[X+"Class"](N[X])}});if(typeof U.attr("style")=="object"){U.attr("style").cssText="";U.attr("style").cssText=R}else{U.attr("style",R)}if(P){P.apply(this,arguments)}H.dequeue(this)}})})};H.fn.extend({_addClass:H.fn.addClass,addClass:function(O,N,Q,P){return N?H.effects.animateClass.apply(this,[{add:O},N,Q,P]):this._addClass(O)},_removeClass:H.fn.removeClass,removeClass:function(O,N,Q,P){return N?H.effects.animateClass.apply(this,[{remove:O},N,Q,P]):this._removeClass(O)},_toggleClass:H.fn.toggleClass,toggleClass:function(P,O,N,R,Q){if(typeof O=="boolean"||O===E){if(!N){return this._toggleClass(P,O)}else{return H.effects.animateClass.apply(this,[(O?{add:P}:{remove:P}),N,R,Q])}}else{return H.effects.animateClass.apply(this,[{toggle:P},O,N,R])}},switchClass:function(N,P,O,R,Q){return H.effects.animateClass.apply(this,[{add:P,remove:N},O,R,Q])}});H.extend(H.effects,{version:"1.8.24",save:function(O,P){for(var N=0;N<P.length;N++){if(P[N]!==null){O.data("ec.storage."+P[N],O[0].style[P[N]])}}},restore:function(O,P){for(var N=0;N<P.length;N++){if(P[N]!==null){O.css(P[N],O.data("ec.storage."+P[N]))}}},setMode:function(N,O){if(O=="toggle"){O=N.is(":hidden")?"show":"hide"}return O},getBaseline:function(O,P){var Q,N;switch(O[0]){case"top":Q=0;break;case"middle":Q=0.5;break;case"bottom":Q=1;break;default:Q=O[0]/P.height}switch(O[1]){case"left":N=0;break;case"center":N=0.5;break;case"right":N=1;break;default:N=O[1]/P.width}return{x:N,y:Q}},createWrapper:function(N){if(N.parent().is(".ui-effects-wrapper")){return N.parent()}var O={width:N.outerWidth(true),height:N.outerHeight(true),"float":N.css("float")},R=H("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),Q=document.activeElement;try{Q.id}catch(P){Q=document.body}N.wrap(R);if(N[0]===Q||H.contains(N[0],Q)){H(Q).focus()}R=N.parent();if(N.css("position")=="static"){R.css({position:"relative"});N.css({position:"relative"})}else{H.extend(O,{position:N.css("position"),zIndex:N.css("z-index")});H.each(["top","left","bottom","right"],function(S,T){O[T]=N.css(T);if(isNaN(parseInt(O[T],10))){O[T]="auto"}});N.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return R.css(O).show()},removeWrapper:function(N){var O,P=document.activeElement;if(N.parent().is(".ui-effects-wrapper")){O=N.parent().replaceWith(N);if(N[0]===P||H.contains(N[0],P)){H(P).focus()}return O}return N},setTransition:function(O,Q,N,P){P=P||{};H.each(Q,function(S,R){var T=O.cssUnit(R);if(T[0]>0){P[R]=T[0]*N+T[1]}});return P}});function D(O,N,P,Q){if(typeof O=="object"){Q=N;P=null;N=O;O=N.effect}if(H.isFunction(N)){Q=N;P=null;N={}}if(typeof N=="number"||H.fx.speeds[N]){Q=P;P=N;N={}}if(H.isFunction(P)){Q=P;P=null}N=N||{};P=P||N.duration;P=H.fx.off?0:typeof P=="number"?P:P in H.fx.speeds?H.fx.speeds[P]:H.fx.speeds._default;Q=Q||N.complete;return[O,N,P,Q]}function L(N){if(!N||typeof N==="number"||H.fx.speeds[N]){return true}if(typeof N==="string"&&!H.effects[N]){return true}return false}H.fn.extend({effect:function(Q,P,S,U){var O=D.apply(this,arguments),R={options:O[1],duration:O[2],callback:O[3]},T=R.options.mode,N=H.effects[Q];if(H.fx.off||!N){if(T){return this[T](R.duration,R.callback)}else{return this.each(function(){if(R.callback){R.callback.call(this)}})}}return N.call(this,R)},_show:H.fn.show,show:function(O){if(L(O)){return this._show.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="show";return this.effect.apply(this,N)}},_hide:H.fn.hide,hide:function(O){if(L(O)){return this._hide.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="hide";return this.effect.apply(this,N)}},__toggle:H.fn.toggle,toggle:function(O){if(L(O)||typeof O==="boolean"||H.isFunction(O)){return this.__toggle.apply(this,arguments)}else{var N=D.apply(this,arguments);N[1].mode="toggle";return this.effect.apply(this,N)}},cssUnit:function(N){var O=this.css(N),P=[];H.each(["em","px","%","pt"],function(Q,R){if(O.indexOf(R)>0){P=[parseFloat(O),R]}});return P}});var J={};H.each(["Quad","Cubic","Quart","Quint","Expo"],function(O,N){J[N]=function(P){return Math.pow(P,O+2)}});H.extend(J,{Sine:function(N){return 1-Math.cos(N*Math.PI/2)},Circ:function(N){return 1-Math.sqrt(1-N*N)},Elastic:function(N){return N===0||N===1?N:-Math.pow(2,8*(N-1))*Math.sin(((N-1)*80-7.5)*Math.PI/15)},Back:function(N){return N*N*(3*N-2)},Bounce:function(P){var N,O=4;while(P<((N=Math.pow(2,--O))-1)/11){}return 1/Math.pow(4,3-O)-7.5625*Math.pow((N*3-2)/22-P,2)}});H.each(J,function(O,N){H.easing["easeIn"+O]=N;H.easing["easeOut"+O]=function(P){return 1-N(1-P)};H.easing["easeInOut"+O]=function(P){return P<0.5?N(P*2)/2:N(P*-2+2)/-2+1}})})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.blind.js' */
/*
 * jQuery UI Effects Blind 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.blind=function(C){return this.queue(function(){var E=A(this),D=["position","top","bottom","left","right"];var I=A.effects.setMode(E,C.options.mode||"hide");var H=C.options.direction||"vertical";A.effects.save(E,D);E.show();var K=A.effects.createWrapper(E).css({overflow:"hidden"});var F=(H=="vertical")?"height":"width";var J=(H=="vertical")?K.height():K.width();if(I=="show"){K.css(F,0)}var G={};G[F]=I=="show"?J:0;K.animate(G,C.duration,C.options.easing,function(){if(I=="hide"){E.hide()}A.effects.restore(E,D);A.effects.removeWrapper(E);if(C.callback){C.callback.apply(E[0],arguments)}E.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.bounce.js' */
/*
 * jQuery UI Effects Bounce 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.bounce=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var K=A.effects.setMode(F,C.options.mode||"effect");var N=C.options.direction||"up";var D=C.options.distance||20;var E=C.options.times||5;var H=C.duration||250;if(/show|hide/.test(K)){L.push("opacity")}A.effects.save(F,L);F.show();A.effects.createWrapper(F);var G=(N=="up"||N=="down")?"top":"left";var P=(N=="up"||N=="left")?"pos":"neg";var D=C.options.distance||(G=="top"?F.outerHeight(true)/3:F.outerWidth(true)/3);if(K=="show"){F.css("opacity",0).css(G,P=="pos"?-D:D)}if(K=="hide"){D=D/(E*2)}if(K!="hide"){E--}if(K=="show"){var I={opacity:1};I[G]=(P=="pos"?"+=":"-=")+D;F.animate(I,H/2,C.options.easing);D=D/2;E--}for(var J=0;J<E;J++){var O={},M={};O[G]=(P=="pos"?"-=":"+=")+D;M[G]=(P=="pos"?"+=":"-=")+D;F.animate(O,H/2,C.options.easing).animate(M,H/2,C.options.easing);D=(K=="hide")?D*2:D/2}if(K=="hide"){var I={opacity:0};I[G]=(P=="pos"?"-=":"+=")+D;F.animate(I,H/2,C.options.easing,function(){F.hide();A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}})}else{var O={},M={};O[G]=(P=="pos"?"-=":"+=")+D;M[G]=(P=="pos"?"+=":"-=")+D;F.animate(O,H/2,C.options.easing).animate(M,H/2,C.options.easing,function(){A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}})}F.queue("fx",function(){F.dequeue()});F.dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.clip.js' */
/*
 * jQuery UI Effects Clip 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.clip=function(C){return this.queue(function(){var G=A(this),K=["position","top","bottom","left","right","height","width"];var J=A.effects.setMode(G,C.options.mode||"hide");var L=C.options.direction||"vertical";A.effects.save(G,K);G.show();var D=A.effects.createWrapper(G).css({overflow:"hidden"});var F=G[0].tagName=="IMG"?D:G;var H={size:(L=="vertical")?"height":"width",position:(L=="vertical")?"top":"left"};var E=(L=="vertical")?F.height():F.width();if(J=="show"){F.css(H.size,0);F.css(H.position,E/2)}var I={};I[H.size]=J=="show"?E:0;I[H.position]=J=="show"?0:E/2;F.animate(I,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){G.hide()}A.effects.restore(G,K);A.effects.removeWrapper(G);if(C.callback){C.callback.apply(G[0],arguments)}G.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.drop.js' */
/*
 * jQuery UI Effects Drop 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.drop=function(C){return this.queue(function(){var F=A(this),E=["position","top","bottom","left","right","opacity"];var J=A.effects.setMode(F,C.options.mode||"hide");var I=C.options.direction||"left";A.effects.save(F,E);F.show();A.effects.createWrapper(F);var G=(I=="up"||I=="down")?"top":"left";var D=(I=="up"||I=="left")?"pos":"neg";var K=C.options.distance||(G=="top"?F.outerHeight(true)/2:F.outerWidth(true)/2);if(J=="show"){F.css("opacity",0).css(G,D=="pos"?-K:K)}var H={opacity:J=="show"?1:0};H[G]=(J=="show"?(D=="pos"?"+=":"-="):(D=="pos"?"-=":"+="))+K;F.animate(H,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){F.hide()}A.effects.restore(F,E);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}F.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.explode.js' */
/*
 * jQuery UI Effects Explode 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.explode=function(C){return this.queue(function(){var J=C.options.pieces?Math.round(Math.sqrt(C.options.pieces)):3;var F=C.options.pieces?Math.round(Math.sqrt(C.options.pieces)):3;C.options.mode=C.options.mode=="toggle"?(A(this).is(":visible")?"hide":"show"):C.options.mode;var I=A(this).show().css("visibility","hidden");var K=I.offset();K.top-=parseInt(I.css("marginTop"),10)||0;K.left-=parseInt(I.css("marginLeft"),10)||0;var H=I.outerWidth(true);var D=I.outerHeight(true);for(var G=0;G<J;G++){for(var E=0;E<F;E++){I.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-E*(H/F),top:-G*(D/J)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:H/F,height:D/J,left:K.left+E*(H/F)+(C.options.mode=="show"?(E-Math.floor(F/2))*(H/F):0),top:K.top+G*(D/J)+(C.options.mode=="show"?(G-Math.floor(J/2))*(D/J):0),opacity:C.options.mode=="show"?0:1}).animate({left:K.left+E*(H/F)+(C.options.mode=="show"?0:(E-Math.floor(F/2))*(H/F)),top:K.top+G*(D/J)+(C.options.mode=="show"?0:(G-Math.floor(J/2))*(D/J)),opacity:C.options.mode=="show"?1:0},C.duration||500)}}setTimeout(function(){C.options.mode=="show"?I.css({visibility:"visible"}):I.css({visibility:"visible"}).hide();if(C.callback){C.callback.apply(I[0])}I.dequeue();A("div.ui-effects-explode").remove()},C.duration||500)})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.fade.js' */
/*
 * jQuery UI Effects Fade 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.fade=function(C){return this.queue(function(){var D=A(this),E=A.effects.setMode(D,C.options.mode||"hide");D.animate({opacity:E},{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){(C.callback&&C.callback.apply(this,arguments));D.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.fold.js' */
/*
 * jQuery UI Effects Fold 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.fold=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var I=A.effects.setMode(F,C.options.mode||"hide");var P=C.options.size||15;var O=!(!C.options.horizFirst);var H=C.duration?C.duration/2:A.fx.speeds._default/2;A.effects.save(F,L);F.show();var E=A.effects.createWrapper(F).css({overflow:"hidden"});var J=((I=="show")!=O);var G=J?["width","height"]:["height","width"];var D=J?[E.width(),E.height()]:[E.height(),E.width()];var K=/([0-9]+)%/.exec(P);if(K){P=parseInt(K[1],10)/100*D[I=="hide"?0:1]}if(I=="show"){E.css(O?{height:0,width:P}:{height:P,width:0})}var N={},M={};N[G[0]]=I=="show"?D[0]:P;M[G[1]]=I=="show"?D[1]:0;E.animate(N,H,C.options.easing).animate(M,H,C.options.easing,function(){if(I=="hide"){F.hide()}A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(F[0],arguments)}F.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.highlight.js' */
/*
 * jQuery UI Effects Highlight 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.highlight=function(C){return this.queue(function(){var E=A(this),D=["backgroundImage","backgroundColor","opacity"],G=A.effects.setMode(E,C.options.mode||"show"),F={backgroundColor:E.css("backgroundColor")};if(G=="hide"){F.opacity=0}A.effects.save(E,D);E.show().css({backgroundImage:"none",backgroundColor:C.options.color||"#ffff99"}).animate(F,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){(G=="hide"&&E.hide());A.effects.restore(E,D);(G=="show"&&!A.support.opacity&&this.style.removeAttribute("filter"));(C.callback&&C.callback.apply(this,arguments));E.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.pulsate.js' */
/*
 * jQuery UI Effects Pulsate 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.pulsate=function(C){return this.queue(function(){var G=A(this),J=A.effects.setMode(G,C.options.mode||"show"),I=((C.options.times||5)*2)-1,H=C.duration?C.duration/2:A.fx.speeds._default/2,D=G.is(":visible"),E=0;if(!D){G.css("opacity",0).show();E=1}if((J=="hide"&&D)||(J=="show"&&!D)){I--}for(var F=0;F<I;F++){G.animate({opacity:E},H,C.options.easing);E=(E+1)%2}G.animate({opacity:E},H,C.options.easing,function(){if(E==0){G.hide()}(C.callback&&C.callback.apply(this,arguments))});G.queue("fx",function(){G.dequeue()}).dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.scale.js' */
/*
 * jQuery UI Effects Scale 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.puff=function(C){return this.queue(function(){var G=A(this),H=A.effects.setMode(G,C.options.mode||"hide"),F=parseInt(C.options.percent,10)||150,E=F/100,D={height:G.height(),width:G.width()};A.extend(C.options,{fade:true,mode:H,percent:H=="hide"?F:100,from:H=="hide"?D:{height:D.height*E,width:D.width*E}});G.effect("scale",C.options,C.duration,C.callback);G.dequeue()})};A.effects.scale=function(C){return this.queue(function(){var H=A(this);var E=A.extend(true,{},C.options);var K=A.effects.setMode(H,C.options.mode||"effect");var I=parseInt(C.options.percent,10)||(parseInt(C.options.percent,10)==0?0:(K=="hide"?0:100));var J=C.options.direction||"both";var D=C.options.origin;if(K!="effect"){E.origin=D||["middle","center"];E.restore=true}var G={height:H.height(),width:H.width()};H.from=C.options.from||(K=="show"?{height:0,width:0}:G);var F={y:J!="horizontal"?(I/100):1,x:J!="vertical"?(I/100):1};H.to={height:G.height*F.y,width:G.width*F.x};if(C.options.fade){if(K=="show"){H.from.opacity=0;H.to.opacity=1}if(K=="hide"){H.from.opacity=1;H.to.opacity=0}}E.from=H.from;E.to=H.to;E.mode=K;H.effect("size",E,C.duration,C.callback);H.dequeue()})};A.effects.size=function(C){return this.queue(function(){var D=A(this),O=["position","top","bottom","left","right","width","height","overflow","opacity"];var N=["position","top","bottom","left","right","overflow","opacity"];var K=["width","height","overflow"];var Q=["fontSize"];var L=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];var G=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];var H=A.effects.setMode(D,C.options.mode||"effect");var J=C.options.restore||false;var F=C.options.scale||"both";var P=C.options.origin;var E={height:D.height(),width:D.width()};D.from=C.options.from||E;D.to=C.options.to||E;if(P){var I=A.effects.getBaseline(P,E);D.from.top=(E.height-D.from.height)*I.y;D.from.left=(E.width-D.from.width)*I.x;D.to.top=(E.height-D.to.height)*I.y;D.to.left=(E.width-D.to.width)*I.x}var M={from:{y:D.from.height/E.height,x:D.from.width/E.width},to:{y:D.to.height/E.height,x:D.to.width/E.width}};if(F=="box"||F=="both"){if(M.from.y!=M.to.y){O=O.concat(L);D.from=A.effects.setTransition(D,L,M.from.y,D.from);D.to=A.effects.setTransition(D,L,M.to.y,D.to)}if(M.from.x!=M.to.x){O=O.concat(G);D.from=A.effects.setTransition(D,G,M.from.x,D.from);D.to=A.effects.setTransition(D,G,M.to.x,D.to)}}if(F=="content"||F=="both"){if(M.from.y!=M.to.y){O=O.concat(Q);D.from=A.effects.setTransition(D,Q,M.from.y,D.from);D.to=A.effects.setTransition(D,Q,M.to.y,D.to)}}A.effects.save(D,J?O:N);D.show();A.effects.createWrapper(D);D.css("overflow","hidden").css(D.from);if(F=="content"||F=="both"){L=L.concat(["marginTop","marginBottom"]).concat(Q);G=G.concat(["marginLeft","marginRight"]);K=O.concat(L).concat(G);D.find("*[width]").each(function(){var S=A(this);if(J){A.effects.save(S,K)}var R={height:S.height(),width:S.width()};S.from={height:R.height*M.from.y,width:R.width*M.from.x};S.to={height:R.height*M.to.y,width:R.width*M.to.x};if(M.from.y!=M.to.y){S.from=A.effects.setTransition(S,L,M.from.y,S.from);S.to=A.effects.setTransition(S,L,M.to.y,S.to)}if(M.from.x!=M.to.x){S.from=A.effects.setTransition(S,G,M.from.x,S.from);S.to=A.effects.setTransition(S,G,M.to.x,S.to)}S.css(S.from);S.animate(S.to,C.duration,C.options.easing,function(){if(J){A.effects.restore(S,K)}})})}D.animate(D.to,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(D.to.opacity===0){D.css("opacity",D.from.opacity)}if(H=="hide"){D.hide()}A.effects.restore(D,J?O:N);A.effects.removeWrapper(D);if(C.callback){C.callback.apply(this,arguments)}D.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.shake.js' */
/*
 * jQuery UI Effects Shake 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.shake=function(C){return this.queue(function(){var F=A(this),L=["position","top","bottom","left","right"];var K=A.effects.setMode(F,C.options.mode||"effect");var N=C.options.direction||"left";var D=C.options.distance||20;var E=C.options.times||3;var H=C.duration||C.options.duration||140;A.effects.save(F,L);F.show();A.effects.createWrapper(F);var G=(N=="up"||N=="down")?"top":"left";var P=(N=="up"||N=="left")?"pos":"neg";var I={},O={},M={};I[G]=(P=="pos"?"-=":"+=")+D;O[G]=(P=="pos"?"+=":"-=")+D*2;M[G]=(P=="pos"?"-=":"+=")+D*2;F.animate(I,H,C.options.easing);for(var J=1;J<E;J++){F.animate(O,H,C.options.easing).animate(M,H,C.options.easing)}F.animate(O,H,C.options.easing).animate(I,H/2,C.options.easing,function(){A.effects.restore(F,L);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}});F.queue("fx",function(){F.dequeue()});F.dequeue()})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.slide.js' */
/*
 * jQuery UI Effects Slide 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.slide=function(C){return this.queue(function(){var F=A(this),E=["position","top","bottom","left","right"];var J=A.effects.setMode(F,C.options.mode||"show");var I=C.options.direction||"left";A.effects.save(F,E);F.show();A.effects.createWrapper(F).css({overflow:"hidden"});var G=(I=="up"||I=="down")?"top":"left";var D=(I=="up"||I=="left")?"pos":"neg";var K=C.options.distance||(G=="top"?F.outerHeight(true):F.outerWidth(true));if(J=="show"){F.css(G,D=="pos"?(isNaN(K)?"-"+K:-K):K)}var H={};H[G]=(J=="show"?(D=="pos"?"+=":"-="):(D=="pos"?"-=":"+="))+K;F.animate(H,{queue:false,duration:C.duration,easing:C.options.easing,complete:function(){if(J=="hide"){F.hide()}A.effects.restore(F,E);A.effects.removeWrapper(F);if(C.callback){C.callback.apply(this,arguments)}F.dequeue()}})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery-ui/jquery.effects.transfer.js' */
/*
 * jQuery UI Effects Transfer 1.8.24
 *
 * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(A,B){A.effects.transfer=function(C){return this.queue(function(){var G=A(this),I=A(C.options.to),F=I.offset(),H={top:F.top,left:F.left,height:I.innerHeight(),width:I.innerWidth()},E=G.offset(),D=A('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(C.options.className).css({top:E.top,left:E.left,height:G.innerHeight(),width:G.innerWidth(),position:"absolute"}).animate(H,C.duration,C.options.easing,function(){D.remove();(C.callback&&C.callback.apply(G[0],arguments));G.dequeue()})})}})(jQuery);
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'js-vendor/jquery/jquery.ui.menu.js' */
(function(A){A.widget("ui.menu",{_create:function(){var B=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(C){if(!A(C.target).closest(".ui-menu-item a").length){return }C.preventDefault();B.select(C)});this.refresh()},refresh:function(){var C=this;var B=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");B.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(D){C.activate(D,A(this).parent())}).mouseleave(function(){C.deactivate()})},activate:function(E,D){this.deactivate();if(this.hasScroll()){var F=D.offset().top-this.element.offset().top,B=this.element.attr("scrollTop"),C=this.element.height();if(F<0){this.element.attr("scrollTop",B+F)}else{if(F>C){this.element.attr("scrollTop",B+F-C+D.height())}}}this.active=D.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",E,{item:D})},deactivate:function(){if(!this.active){return }this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null},next:function(B){this.move("next",".ui-menu-item:first",B)},previous:function(B){this.move("prev",".ui-menu-item:last",B)},first:function(){return this.active&&!this.active.prev().length},last:function(){return this.active&&!this.active.next().length},move:function(E,D,C){if(!this.active){this.activate(C,this.element.children(D));return }var B=this.active[E+"All"](".ui-menu-item").eq(0);if(B.length){this.activate(C,B)}else{this.activate(C,this.element.children(D))}},nextPage:function(D){if(this.hasScroll()){if(!this.active||this.last()){this.activate(D,this.element.children(":first"));return }var E=this.active.offset().top,C=this.element.height(),B=this.element.children("li").filter(function(){var F=A(this).offset().top-E-C+A(this).height();return F<10&&F>-10});if(!B.length){B=this.element.children(":last")}this.activate(D,B)}else{this.activate(D,this.element.children(!this.active||this.last()?":first":":last"))}},previousPage:function(C){if(this.hasScroll()){if(!this.active||this.first()){this.activate(C,this.element.children(":last"));return }var D=this.active.offset().top,B=this.element.height();result=this.element.children("li").filter(function(){var E=A(this).offset().top-D+B-A(this).height();return E<10&&E>-10});if(!result.length){result=this.element.children(":first")}this.activate(C,result)}else{this.activate(C,this.element.children(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(B){this._trigger("selected",B,{item:this.active})}})}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d-api', location = 'js/lib/draw2d/draw2d.js' */
var draw2d={geo:{},io:{json:{},png:{},svg:{}},util:{spline:{}},shape:{basic:{},arrow:{},node:{},note:{},diagram:{},analog:{},icon:{},layout:{},pert:{},state:{},widget:{}},policy:{canvas:{},port:{},figure:{}},command:{},decoration:{connection:{}},layout:{connection:{},anchor:{},mesh:{},locator:{}},ui:{},isTouchDevice:((navigator.platform.indexOf("iPhone")!=-1)||(navigator.platform.indexOf("iPod")!=-1)||(navigator.platform.indexOf("iPad")!=-1))};(function(){Raphael.fn.group=function(D,C){var A=document.getElementsByTagName("svg").length>0;if(!A){return{add:function(){}}}var B;this.svg="http://www.w3.org/2000/svg";this.defs=document.getElementsByTagName("defs")[D];this.svgcanv=document.getElementsByTagName("svg")[D];this.group=document.createElementNS(this.svg,"g");for(B=0;B<C.length;B++){this.group.appendChild(C[B].node)}this.svgcanv.appendChild(this.group);this.group.translate=function(F,E){this.setAttribute("transform","translate("+F+","+E+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+")")};this.group.rotate=function(G,E,F){this.setAttribute("transform","translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+") rotate("+G+","+E+","+F+")")};this.group.scale=function(F,E){this.setAttribute("transform","scale("+F+","+E+") translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+")")};this.group.push=function(E){this.appendChild(E.node)};this.group.getAttr=function(L){this.previous=this.getAttribute("transform")?this.getAttribute("transform"):"";var F=[],J,I,H;F=this.previous.split(" ");for(B=0;B<F.length;B++){if(F[B].substring(0,1)=="t"){var K=F[B],E=[];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=[];E=K.split(",");J=E.length===0?{x:0,y:0}:{x:E[0],y:E[1]}}else{if(F[B].substring(0,1)==="r"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");I=E.length===0?{x:0,y:0,z:0}:{x:E[0],y:E[1],z:E[2]}}else{if(F[B].substring(0,1)==="s"){K=F[B];E=K.split("(");K=E[1].substring(0,E[1].length-1);E=K.split(",");H=E.length===0?{x:1,y:1}:{x:E[0],y:E[1]}}}}}if(typeof J==="undefined"){J={x:0,y:0}}if(typeof I==="undefined"){I={x:0,y:0,z:0}}if(typeof H==="undefined"){H={x:1,y:1}}if(L=="translate"){var G=J}else{if(L=="rotate"){G=I}else{if(L=="scale"){G=H}}}return G};this.group.copy=function(E){this.copy=E.node.cloneNode(true);this.appendChild(this.copy)};return this.group}})();Math.sign=function(){if(this<0){return -1}return 1};
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/shifty-0.6.1.js' */
(function ($) {(function(){var A;(function(D){var E,H="linear",K;if(typeof SHIFTY_DEBUG_NOW==="function"){E=SHIFTY_DEBUG_NOW}else{E=function(){return +new Date()}}function N(R,Q){var S;for(S in R){if(R.hasOwnProperty(S)){Q(R,S)}}}function L(R,Q){N(Q,function(S,T){R[T]=S[T]});return R}function G(R,Q){N(Q,function(S,T){if(typeof R[T]==="undefined"){R[T]=S[T]}});return R}function B(S,T,R){var U,Q;Q=(S-T.timestamp)/T.duration;for(U in R.current){if(R.current.hasOwnProperty(U)&&T.to.hasOwnProperty(U)){R.current[U]=J(T.originalState[U],T.to[U],K[T.easing[U]],Q)}}return R.current}function J(T,S,R,Q){return T+(S-T)*R(Q)}function F(Q,R){return setTimeout(Q,1000/R)}function M(T,Q,U,R){var S;for(S=0;S<Q[T].length;S++){Q[T][S].apply(U,R)}}function I(R,S,Q){N(A.prototype.filter,function(U,T){if(U[T][R]){U[T][R].apply(S,Q)}})}function P(U,T){var R=U.timestamp+U.duration,S=Math.min(E(),R),Q=S>=R;if(T.isTweening){if(!Q){T.loopId=F(function(){P(U,T)},U.owner.fps)}I("beforeTween",U.owner,[T.current,U.originalState,U.to]);B(S,U,T);I("afterTween",U.owner,[T.current,U.originalState,U.to]);if(U.hook.step){M("step",U.hook,U.owner,[T.current])}if(U.step){U.step.call(T.current,T.current)}}if(Q||!T.isTweening){U.owner.stop(true)}}if(typeof SHIFTY_DEBUG_NOW==="function"){D.timeoutHandler=P}function C(S,R){var Q;Q={};if(typeof R==="string"){N(S,function(T,U){Q[U]=R})}else{N(S,function(T,U){if(!Q[U]){Q[U]=R[U]||H}})}return Q}A=function(Q){Q=Q||{};this._hook={};this._tweenParams={owner:this,hook:this._hook,data:{}};this._state={};this._state.current=Q.initialState||{};this.fps=Q.fps||30;this.easing=Q.easing||H;this.duration=Q.duration||500;return this};A.prototype.tween=function(X,W,S,V,U){var Q,T,R;if(this._state.isTweening){return }Q=this;T=this._tweenParams;R=this._state;this._state.loopId=0;this._state.pausedAtTime=null;if(W){T.to=W||{};T.duration=S||this.duration;T.callback=V;T.easing=U||this.easing;R.current=X||{}}else{T.step=X.step;T.callback=X.callback;T.to=X.to||X.target||{};T.duration=X.duration||this.duration;T.easing=X.easing||this.easing;R.current=X.from||{}}T.timestamp=E();G(R.current,T.to);G(T.to,R.current);T.easing=C(R.current,T.easing);I("tweenCreated",T.owner,[R.current,T.originalState,T.to]);T.originalState=L({},R.current);R.isTweening=true;this.resume();if(X.start){X.start()}return this};A.prototype.to=function O(R,Q,T,S){if(arguments.length===1){if("to" in R){R.from=this.get();this.tween(R)}else{this.tween(this.get(),R)}}else{this.tween(this.get(),R,Q,T,S)}return this};A.prototype.get=function(){return this._state.current};A.prototype.set=function(Q){this._state.current=Q||{};return this};A.prototype.stop=function(Q){clearTimeout(this._state.loopId);this._state.isTweening=false;if(Q){L(this._state.current,this._tweenParams.to);I("afterTweenEnd",this,[this._state.current,this._tweenParams.originalState,this._tweenParams.to]);if(this._tweenParams.callback){this._tweenParams.callback.call(this._state.current,this._state.current)}}return this};A.prototype.pause=function(){clearTimeout(this._state.loopId);this._state.pausedAtTime=E();this._state.isPaused=true;return this};A.prototype.resume=function(){var Q;Q=this;if(this._state.isPaused){this._tweenParams.timestamp+=E()-this._state.pausedAtTime}P(Q._tweenParams,Q._state);return this};A.prototype.hookAdd=function(Q,R){if(!this._hook.hasOwnProperty(Q)){this._hook[Q]=[]}this._hook[Q].push(R)};A.prototype.hookRemove=function(R,S){var Q;if(!this._hook.hasOwnProperty(R)){return }if(!S){this._hook[R]=[];return }for(Q=this._hook[R].length;Q>=0;Q++){if(this._hook[R][Q]===S){this._hook[R].splice(Q,1)}}};A.prototype.filter={};A.util={now:E,each:N,tweenProps:B,tweenProp:J,applyFilter:I,simpleCopy:L,weakCopy:G,composeEasingObject:C};K=A.prototype.formula={linear:function(Q){return Q}};if(typeof exports==="object"){module.exports=A}else{if(typeof define==="function"&&define.amd){define(function(){return A})}else{if(typeof D.Tweenable==="undefined"){D.Tweenable=A}}}}(this));(function(){A.util.simpleCopy(A.prototype.formula,{easeInQuad:function(B){return Math.pow(B,2)},easeOutQuad:function(B){return -(Math.pow((B-1),2)-1)},easeInOutQuad:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,2)}return -0.5*((B-=2)*B-2)},easeInCubic:function(B){return Math.pow(B,3)},easeOutCubic:function(B){return(Math.pow((B-1),3)+1)},easeInOutCubic:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,3)}return 0.5*(Math.pow((B-2),3)+2)},easeInQuart:function(B){return Math.pow(B,4)},easeOutQuart:function(B){return -(Math.pow((B-1),4)-1)},easeInOutQuart:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeInQuint:function(B){return Math.pow(B,5)},easeOutQuint:function(B){return(Math.pow((B-1),5)+1)},easeInOutQuint:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,5)}return 0.5*(Math.pow((B-2),5)+2)},easeInSine:function(B){return -Math.cos(B*(Math.PI/2))+1},easeOutSine:function(B){return Math.sin(B*(Math.PI/2))},easeInOutSine:function(B){return(-0.5*(Math.cos(Math.PI*B)-1))},easeInExpo:function(B){return(B==0)?0:Math.pow(2,10*(B-1))},easeOutExpo:function(B){return(B==1)?1:-Math.pow(2,-10*B)+1},easeInOutExpo:function(B){if(B==0){return 0}if(B==1){return 1}if((B/=0.5)<1){return 0.5*Math.pow(2,10*(B-1))}return 0.5*(-Math.pow(2,-10*--B)+2)},easeInCirc:function(B){return -(Math.sqrt(1-(B*B))-1)},easeOutCirc:function(B){return Math.sqrt(1-Math.pow((B-1),2))},easeInOutCirc:function(B){if((B/=0.5)<1){return -0.5*(Math.sqrt(1-B*B)-1)}return 0.5*(Math.sqrt(1-(B-=2)*B)+1)},easeOutBounce:function(B){if((B)<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeInBack:function(C){var B=1.70158;return(C)*C*((B+1)*C-B)},easeOutBack:function(C){var B=1.70158;return(C=C-1)*C*((B+1)*C+B)+1},easeInOutBack:function(C){var B=1.70158;if((C/=0.5)<1){return 0.5*(C*C*(((B*=(1.525))+1)*C-B))}return 0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},elastic:function(B){return -1*Math.pow(4,-8*B)*Math.sin((B*6-1)*(2*Math.PI)/2)+1},swingFromTo:function(C){var B=1.70158;return((C/=0.5)<1)?0.5*(C*C*(((B*=(1.525))+1)*C-B)):0.5*((C-=2)*C*(((B*=(1.525))+1)*C+B)+2)},swingFrom:function(C){var B=1.70158;return C*C*((B+1)*C-B)},swingTo:function(C){var B=1.70158;return(C-=1)*C*((B+1)*C+B)+1},bounce:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},bouncePast:function(B){if(B<(1/2.75)){return(7.5625*B*B)}else{if(B<(2/2.75)){return 2-(7.5625*(B-=(1.5/2.75))*B+0.75)}else{if(B<(2.5/2.75)){return 2-(7.5625*(B-=(2.25/2.75))*B+0.9375)}else{return 2-(7.5625*(B-=(2.625/2.75))*B+0.984375)}}}},easeFromTo:function(B){if((B/=0.5)<1){return 0.5*Math.pow(B,4)}return -0.5*((B-=2)*Math.pow(B,3)-2)},easeFrom:function(B){return Math.pow(B,4)},easeTo:function(B){return Math.pow(B,0.25)}})}());(function(){var C=function(){};function E(F){F.shift();if(F.length){F[0]()}else{F.running=false}}function D(G,F){return function(){G();E(F)}}function B(F,K,J,G,I,H){return function(){if(J){F.tween(K,J,G,I,H)}else{K.callback=I;if(K.from){F.tween(K)}else{F.to(K)}}}}A.prototype.queue=function(K,J,F,I,H){var G;if(!this._tweenQueue){this._tweenQueue=[]}I=I||K.callback||C;G=D(I,this._tweenQueue);this._tweenQueue.push(B(this,K,J,F,G,H));return this};A.prototype.queueStart=function(){if(!this._tweenQueue.running&&this._tweenQueue.length>0){this._tweenQueue[0]();this._tweenQueue.running=true}return this};A.prototype.queueShift=function(){this._tweenQueue.shift();return this};A.prototype.queuePop=function(){this._tweenQueue.pop();return this};A.prototype.queueEmpty=function(){this._tweenQueue.length=0;return this};A.prototype.queueLength=function(){return this._tweenQueue.length}}());(function(){var B=/^#([0-9]|[a-f]){3}$/i,M=/^#([0-9]|[a-f]){6}$/i,E=/^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)\s*$/i,Q;if(!A){return }function P(R){return parseInt(R,16)}function G(R){R=R.replace(/#/g,"");if(R.length===3){R=R.split("");R=R[0]+R[0]+R[1]+R[1]+R[2]+R[2]}return[P(R.substr(0,2)),P(R.substr(2,2)),P(R.substr(4,2))]}function N(S){var T,R;T=G(S);R="rgb("+T[0]+","+T[1]+","+T[2]+")";return R}function J(R){return(typeof R==="string")&&(B.test(R)||M.test(R)||E.test(R))}function H(R){return(typeof R==="string")&&(B.test(R)||M.test(R))}function I(R){A.util.each(R,function(S,T){if(H(S[T])){S[T]=N(S[T])}})}function D(S){var R;R=[];A.util.each(S,function(T,U){if(J(T[U])){R.push(U)}});return R}function K(R){return R.match(/(\d+)/g)}function F(V,T){var U,S,R;S=T.length;for(U=0;U<S;U++){R=K(V[T[U]]);V["__r__"+T[U]]=+R[0];V["__g__"+T[U]]=+R[1];V["__b__"+T[U]]=+R[2];delete V[T[U]]}}function C(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U[S[T]]="rgb("+parseInt(U["__r__"+S[T]],10)+","+parseInt(U["__g__"+S[T]],10)+","+parseInt(U["__b__"+S[T]],10)+")";delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}function O(U,S){var T,R;R=S.length;for(T=0;T<R;T++){U["__r__"+S[T]]=U[S[T]];U["__g__"+S[T]]=U[S[T]];U["__b__"+S[T]]=U[S[T]]}}function L(U,S){var T,R;R=S.length;for(T=0;T<R;T++){delete U["__r__"+S[T]];delete U["__g__"+S[T]];delete U["__b__"+S[T]]}}A.prototype.filter.color={tweenCreated:function(S,T,R){I(S);I(T);I(R)},beforeTween:function(S,T,R){Q=D(T);F(S,Q);F(T,Q);F(R,Q);O(this._tweenParams.easing,Q)},afterTween:function(S,T,R){C(S,Q);C(T,Q);C(R,Q);L(this._tweenParams.easing,Q)}}}());(function(){var D=/\D+/g;var G;function B(I){return typeof I==="string"&&I.match(D)}function F(I){return I.replace(/\(/g,"\\(").replace(/\)/g,"\\)")}function H(I){var J;J={};A.util.each(I,function(M,N){var L=M[N];if(B(L)){var K=L.match(D);if(K.length===1){K.unshift("")}J[N]=K}});return J}function C(J,I){A.util.each(I,function(P,L){var M=I[L];var O;var K=F(M[0]);var N=F(M[1]);if(M[0]===""){O=new RegExp(N,"g")}else{O=new RegExp("("+K+"|"+N+")","g")}J[L]=+(J[L].replace(O,""))})}function E(J,I){A.util.each(I,function(M,L){var K=M[L];J[L]=K[0]+J[L]+K[1]})}A.prototype.filter.token={beforeTween:function(J,K,I){G=H(K);C(J,G);C(K,G);C(I,G)},afterTween:function(J,K,I){E(J,G);E(K,G);E(I,G)}}}());(function(){if(!A){return }function B(H,D,G,C,F){var E;E=A.util.composeEasingObject(H,F);return A.util.tweenProps(C,{originalState:H,to:G,timestamp:0,duration:1,easing:E},{current:D})}A.util.interpolate=function(I,H,C,G){var F,E,D;if(I&&I.from){H=I.to;C=I.position;G=I.easing;I=I.from}D=new A();D._tweenParams.easing=G||"linear";F=A.util.simpleCopy({},I);A.util.applyFilter("tweenCreated",D,[F,I,H]);A.util.applyFilter("beforeTween",D,[F,I,H]);E=B(I,F,H,C,D._tweenParams.easing);A.util.applyFilter("afterTween",D,[E,I,H]);return E};A.prototype.interpolate=function(F,C,E){var D;D=A.util.interpolate(this.get(),F,C,E);this.set(D);return D}}());(function(){var B=false;A.util.enableRounding=function(){B=true};A.util.disableRounding=function(){B=false};A.util.isRoundingEnabled=function(){return B};A.prototype.filter.round={afterTween:function(D,E,C){if(B){A.util.each(D,function(F,G){if(!F[G].replace){F[G]=Math.round(F[G])}})}}}}())}());}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/Color.js' */
(function ($) {draw2d.util.Color=Class.extend({init:function(D,C,A){this.hashString=null;if(typeof D==="undefined"||D===null){this.hashString="none"}else{if(D instanceof draw2d.util.Color){this.red=D.red;this.green=D.green;this.blue=D.blue}else{if(typeof C==="undefined"){var B=this.hex2rgb(D);this.red=B[0];this.green=B[1];this.blue=B[2]}else{this.red=D;this.green=C;this.blue=A}}}},getHTMLStyle:function(){return"rgb("+this.red+","+this.green+","+this.blue+")"},getRed:function(){return this.red},getGreen:function(){return this.green},getBlue:function(){return this.blue},getIdealTextColor:function(){var A=105;var B=(this.red*0.299)+(this.green*0.587)+(this.blue*0.114);return(255-B<A)?new draw2d.util.Color(0,0,0):new draw2d.util.Color(255,255,255)},hex2rgb:function(A){A=A.replace("#","");return({0:parseInt(A.substr(0,2),16),1:parseInt(A.substr(2,2),16),2:parseInt(A.substr(4,2),16)})},hex:function(){return(this.int2hex(this.red)+this.int2hex(this.green)+this.int2hex(this.blue))},hash:function(){if(this.hashString===null){this.hashString="#"+this.hex()}return this.hashString},int2hex:function(A){A=Math.round(Math.min(Math.max(0,A),255));return("0123456789ABCDEF".charAt((A-A%16)/16)+"0123456789ABCDEF".charAt(A%16))},darker:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1-B)));var C=parseInt(Math.round(this.getGreen()*(1-B)));var A=parseInt(Math.round(this.getBlue()*(1-B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},lighter:function(B){if(this.hashString==="none"){return this}var D=parseInt(Math.round(this.getRed()*(1+B)));var C=parseInt(Math.round(this.getGreen()*(1+B)));var A=parseInt(Math.round(this.getBlue()*(1+B)));if(D<0){D=0}else{if(D>255){D=255}}if(C<0){C=0}else{if(C>255){C=255}}if(A<0){A=0}else{if(A>255){A=255}}return new draw2d.util.Color(D,C,A)},fadeTo:function(B,C){var E=Math.floor(this.red+(C*(B.red-this.red))+0.5);var D=Math.floor(this.green+(C*(B.green-this.green))+0.5);var A=Math.floor(this.blue+(C*(B.blue-this.blue))+0.5);return new draw2d.util.Color(E,D,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/ArrayList.js' */
(function ($) {draw2d.util.ArrayList=Class.extend({init:function(A){this.increment=10;this.size=0;this.data=new Array(this.increment);if(typeof A!=="undefined"){$.each(A,$.proxy(function(B,C){this.add(C)},this))}},reverse:function(){var B=new Array(this.size);for(var A=0;A<this.size;A++){B[A]=this.data[this.size-A-1]}this.data=B;return this},getCapacity:function(){return this.data.length},getSize:function(){return this.size},isEmpty:function(){return this.getSize()===0},getLastElement:function(){if(this.data[this.getSize()-1]!==null){return this.data[this.getSize()-1]}return null},asArray:function(){this.trimToSize();return this.data},getFirstElement:function(){if(this.data[0]!==null&&typeof this.data[0]!=="undefined"){return this.data[0]}return null},get:function(A){return this.data[A]},add:function(A){if(this.getSize()==this.data.length){this.resize()}this.data[this.size++]=A;return this},grep:function(A){this.data=$.grep(this.data,A);this.data=$.grep(this.data,function(B){return(typeof B!=="undefined")});this.size=this.data.length;return this},addAll:function(B){if(!(B instanceof draw2d.util.ArrayList)){throw"Unable to handle unknown object type in ArrayList.addAll"}for(var A=0;A<B.getSize();A++){this.add(B.get(A))}return this},pop:function(){return this.removeElementAt(this.getSize()-1)},push:function(A){this.add(A)},remove:function(B){var A=this.indexOf(B);if(A>=0){return this.removeElementAt(A)}return null},insertElementAt:function(C,A){if(this.size==this.capacity){this.resize()}for(var B=this.getSize();B>A;B--){this.data[B]=this.data[B-1]}this.data[A]=C;this.size++;return this},removeElementAt:function(A){var C=this.data[A];for(var B=A;B<(this.size-1);B++){this.data[B]=this.data[B+1]}this.data[this.size-1]=null;this.size--;return C},removeAll:function(A){$.each(A,$.proxy(function(B,C){this.remove(C)},this));return this},indexOf:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return A}}return -1},contains:function(B){for(var A=0;A<this.getSize();A++){if(this.data[A]==B){return true}}return false},resize:function(){newData=new Array(this.data.length+this.increment);for(var A=0;A<this.data.length;A++){newData[A]=this.data[A]}this.data=newData;return this},trimToSize:function(){if(this.data.length==this.size){return this}var A=new Array(this.getSize());for(var B=0;B<this.getSize();B++){A[B]=this.data[B]}this.size=A.length;this.data=A;return this},sort:function(F){var D,C;var E;var B;var G;var A;for(D=1;D<this.getSize();D++){B=this.data[D];E=B[F];C=D-1;G=this.data[C];A=G[F];while(C>=0&&A>E){this.data[C+1]=this.data[C];C--;if(C>=0){G=this.data[C];A=G[F]}}this.data[C+1]=B}return this},clone:function(){var A=new draw2d.util.ArrayList();for(var B=0;B<this.size;B++){A.add(this.data[B])}return A},each:function(B){for(var A=0;A<this.size;A++){if(B(A,this.data[A])===false){break}}},overwriteElementAt:function(B,A){this.data[A]=B;return this},getPersistentAttributes:function(){return{data:this.data,increment:this.increment,size:this.getSize()}},setPersistentAttributes:function(A){this.data=A.data;this.increment=A.increment;this.size=A.size}});draw2d.util.ArrayList.EMPTY_LIST=new draw2d.util.ArrayList();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/SVGUtil.js' */
(function ($) {Raphael.fn.polygon=function(F){var D=["M"],A=F.split(" ");for(var C=0;C<A.length;C++){var G=A[C].split(",");for(var B=0;B<G.length;B++){var E=parseFloat(G[B]);if(E){D.push(E)}}if(C==0){D.push("L")}}D.push("Z");return this.path(D)};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/UUID.js' */
(function ($) {draw2d.util.UUID=function(){};draw2d.util.UUID.create=function(){var A=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(A()+A()+"-"+A()+"-"+A()+"-"+A()+"-"+A()+A()+A())};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/Spline.js' */
(function ($) {draw2d.util.spline.Spline=Class.extend({NAME:"draw2d.util.spline.Spline",init:function(){},generate:function(A,B){throw"inherit classes must implement the method 'draw2d.util.spline.Spline.generate()'"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CubicSpline.js' */
(function ($) {draw2d.util.spline.CubicSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.CubicSpline",init:function(){this._super()},generate:function(A,E){var D=new draw2d.util.ArrayList();D.add(A.get(0));D.addAll(A);D.add(A.get(A.getSize()-1));var G=D.getSize();var F=new draw2d.util.ArrayList();F.add(A.get(0));F.add(this.p(1,0,D));for(var C=1;C<G-2;C++){for(var B=1;B<=E;B++){F.add(this.p(C,B/E,D))}}F.add(A.get(A.getSize()-1));return F},p:function(D,I,E){var H=0;var F=0;var B=D-1;for(var C=-2;C<=1;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B===-2){return(((-A+3)*A-3)*A+1)/6}else{if(B===-1){return(((3*A-6)*A)*A+4)/6}else{if(B===0){return(((-3*A+3)*A+3)*A+1)/6}}}return(A*A*A)/6}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/CatmullRomSpline.js' */
(function ($) {draw2d.util.spline.CatmullRomSpline=draw2d.util.spline.CubicSpline.extend({NAME:"draw2d.util.spline.CatmullRomSpline",init:function(){this._super()},blend:function(B,A){if(B==-2){return((-A+2)*A-1)*A/2}else{if(B==-1){return(((3*A-5)*A)*A+2)/2}else{if(B==0){return((-3*A+4)*A+1)*A/2}else{return((A-1)*A*A)/2}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/util/spline/BezierSpline.js' */
(function ($) {draw2d.util.spline.BezierSpline=draw2d.util.spline.Spline.extend({NAME:"draw2d.util.spline.BezierSpline",init:function(){this._super()},generate:function(A,D){var F=A.getSize();var E=new draw2d.util.ArrayList();E.add(this.p(0,0,A));for(var C=0;C<F-3;C+=3){for(var B=1;B<=D;B++){E.add(this.p(C,B/D,A))}}return E},p:function(D,I,E){var H=0;var F=0;var B=D;for(var C=0;C<=3;C++){var G=this.blend(C,I);var A=E.get(B++);H+=G*A.x;F+=G*A.y}return new draw2d.geo.Point(H,F)},blend:function(B,A){if(B==0){return(1-A)*(1-A)*(1-A)}else{if(B==1){return 3*A*(1-A)*(1-A)}else{if(B==2){return 3*A*A*(1-A)}else{return A*A*A}}}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/PositionConstants.js' */
(function ($) {draw2d.geo.PositionConstants=function(){};draw2d.geo.PositionConstants.NORTH=1;draw2d.geo.PositionConstants.SOUTH=4;draw2d.geo.PositionConstants.WEST=8;draw2d.geo.PositionConstants.EAST=16;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Point.js' */
(function ($) {draw2d.geo.Point=Class.extend({NAME:"draw2d.geo.Point",init:function(A,B){this.x=A;this.y=B;this.bx=null;this.by=null;this.bw=null;this.bh=null},setBoundary:function(C,B,D,A){if(C instanceof draw2d.geo.Rectangle){this.bx=C.x;this.by=C.y;this.bw=C.w;this.bh=C.h}else{this.bx=C;this.by=B;this.bw=D;this.bh=A}this.adjustBoundary();return this},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw);this.y=Math.min(Math.max(this.by,this.y),this.bh);return this},translate:function(B,A){this.x+=B;this.y+=A;this.adjustBoundary();return this},getX:function(){return this.x},getY:function(){return this.y},setX:function(A){this.x=A;this.adjustBoundary();return this},setY:function(A){this.y=A;this.adjustBoundary();return this},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.adjustBoundary();return this},getPosition:function(C){var B=C.x-this.x;var A=C.y-this.y;if(Math.abs(B)>Math.abs(A)){if(B<0){return draw2d.geo.PositionConstants.WEST}return draw2d.geo.PositionConstants.EAST}if(A<0){return draw2d.geo.PositionConstants.NORTH}return draw2d.geo.PositionConstants.SOUTH},equals:function(A){return this.x===A.x&&this.y===A.y},getDistance:function(A){return Math.sqrt((this.x-A.x)*(this.x-A.x)+(this.y-A.y)*(this.y-A.y))},getTranslated:function(A){return new draw2d.geo.Point(this.x+A.x,this.y+A.y)},getPersistentAttributes:function(){return{x:this.x,y:this.y}},setPersistentAttributes:function(A){this.x=A.x;this.y=A.y},subtract:function(A){return new draw2d.geo.Point(this.x-A.x,this.y-A.y)},dot:function(A){return this.x*A.x+this.y*A.y},cross:function(A){return this.x*A.y-this.y*A.x},lerp:function(B,A){return new draw2d.geo.Point(this.x+(B.x-this.x)*A,this.y+(B.y-this.y)*A)},clone:function(){return new draw2d.geo.Point(this.x,this.y)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/geo/Rectangle.js' */
(function ($) {draw2d.geo.Rectangle=draw2d.geo.Point.extend({NAME:"draw2d.geo.Rectangle",init:function(A,D,B,C){this._super(A,D);this.w=B;this.h=C},adjustBoundary:function(){if(this.bx===null){return }this.x=Math.min(Math.max(this.bx,this.x),this.bw-this.w);this.y=Math.min(Math.max(this.by,this.y),this.bh-this.h);this.w=Math.min(this.w,this.bw);this.h=Math.min(this.h,this.bh)},resize:function(A,B){this.w+=A;this.h+=B;this.adjustBoundary();return this},scale:function(A,B){this.w+=(A);this.h+=(B);this.x-=(A/2);this.y-=(B/2);this.adjustBoundary();return this},setBounds:function(A){this.setPosition(A.x,A.y);this.w=A.w;this.h=A.h;return this},isEmpty:function(){return this.w<=0||this.h<=0},getWidth:function(){return this.w},setWidth:function(A){this.w=A;this.adjustBoundary();return this},getHeight:function(){return this.h},setHeight:function(A){this.h=A;this.adjustBoundary();return this},getLeft:function(){return this.x},getRight:function(){return this.x+this.w},getTop:function(){return this.y},getBottom:function(){return this.y+this.h},getTopLeft:function(){return new draw2d.geo.Point(this.x,this.y)},getTopCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y)},getTopRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y)},getBottomLeft:function(){return new draw2d.geo.Point(this.x,this.y+this.h)},getBottomCenter:function(){return new draw2d.geo.Point(this.x+(this.w/2),this.y+this.h)},getCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y+this.h/2)},getBottomRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y+this.h)},getPoints:function(){var A=new draw2d.util.ArrayList();A.add(this.getTopLeft());A.add(this.getTopRight());A.add(this.getBottomRight());A.add(this.getBottomLeft());return A},moveInside:function(B){var A=new draw2d.geo.Rectangle(B.x,B.y,B.w,B.h);A.x=Math.max(A.x,this.x);A.y=Math.max(A.y,this.y);if(A.w<this.w){A.x=Math.min(A.x+A.w,this.x+this.w)-A.w}else{A.x=this.x}if(A.h<this.h){A.y=Math.min(A.y+A.h,this.y+this.h)-A.h}else{A.y=this.y}return A},getDistance:function(H){var F=this.x;var E=this.y;var G=this.w;var A=this.h;var C=H.getX();var B=H.getY();var D=1;var J=1;if(H instanceof draw2d.geo.Rectangle){D=H.getWidth();J=H.getHeight()}var I=9;if(F+G<=C){if((E+A)<=B){I=0}else{if(E>=(B+J)){I=6}else{I=7}}}else{if(F>=C+D){if(E+A<=B){I=2}else{if(E>=B+J){I=4}else{I=3}}}else{if(E+A<=B){I=1}else{if(E>=B+J){I=5}else{return 0}}}}switch(I){case 0:F=(F+G)-C;E=(E+A)-B;return -(F+E);case 1:return -((E+A)-B);case 2:F=(C+D)-F;E=(E+A)-B;return -(F+E);case 3:return -((C+D)-F);case 4:F=(C+D)-F;E=(B+J)-E;return -(F+E);case 5:return -((B+J)-E);case 6:F=(F+G)-C;E=(B+J)-E;return -(F+E);case 7:return -((F+G)-C)}throw"Unknown data type of parameter for distance calculation in draw2d.geo.Rectangle.getDistnace(..)"},determineOctant:function(D){var J=3;var C=this.x+J;var B=this.y+J;var E=this.w-(J*2);var K=this.h-(J*2);var G=D.x;var F=D.y;var H=2;var A=2;if(D instanceof draw2d.geo.Rectangle){H=D.w;A=D.h}var I=0;if(G+H<=C){if((F+A)<=B){I=0}else{if(F>=(B+K)){I=6}else{I=7}}}else{if(G>=C+E){if(F+A<=B){I=2}else{if(F>=B+K){I=4}else{I=3}}}else{if(F+A<=B){I=1}else{if(F>=B+K){I=5}else{I=8}}}}return I},getDirection:function(A){var B=this.getTopLeft();switch(this.determineOctant(A)){case 0:if((B.x-A.x)<(B.y-A.y)){return 0}return 3;case 1:return 0;case 2:B=this.getTopRight();if((A.x-B.x)<(B.y-A.y)){return 0}return 1;case 3:return 1;case 4:B=this.getBottomRight();if((A.x-B.x)<(A.y-B.y)){return 2}return 1;case 5:return 2;case 6:B=this.getBottomLeft();if((B.x-A.x)<(A.y-B.y)){return 2}return 3;case 7:return 3;case 8:if(A.y>this.y){return 2}return 0}return 0},equals:function(A){return this.x==A.x&&this.y==A.y&&this.w==A.w&&this.h==A.h},hitTest:function(A,D){if(A instanceof draw2d.geo.Point){D=A.y;A=A.x}var B=this.x+this.getWidth();var C=this.y+this.getHeight();return(A>=this.x&&A<=B&&D>=this.y&&D<=C)},isInside:function(A){return A.hitTest(this.getTopLeft())&&A.hitTest(this.getTopRight())&&A.hitTest(this.getBottomLeft())&&A.hitTest(this.getBottomRight())},intersects:function(A){x11=A.x,y11=A.y,x12=A.x+A.w,y12=A.y+A.h,x21=this.x,y21=this.y,x22=this.x+this.w,y22=this.y+this.h;x_overlap=Math.max(0,Math.min(x12,x22)-Math.max(x11,x21));y_overlap=Math.max(0,Math.min(y12,y22)-Math.max(y11,y21));return x_overlap*y_overlap!==0},toJSON:function(){return{width:this.w,height:this.h,x:this.x,y:this.y}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandType.js' */
(function ($) {draw2d.command.CommandType=Class.extend({NAME:"draw2d.command.CommandType",init:function(A){this.policy=A},getPolicy:function(){return this.policy}});draw2d.command.CommandType.DELETE="DELETE";draw2d.command.CommandType.MOVE="MOVE";draw2d.command.CommandType.CONNECT="CONNECT";draw2d.command.CommandType.MOVE_BASEPOINT="MOVE_BASEPOINT";draw2d.command.CommandType.RESIZE="RESIZE";draw2d.command.CommandType.RESET="RESET";}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/Command.js' */
(function ($) {draw2d.command.Command=Class.extend({NAME:"draw2d.command.Command",init:function(A){this.label=A},getLabel:function(){return this.label},canExecute:function(){return true},execute:function(){},cancel:function(){},undo:function(){},redo:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandCollection.js' */
(function ($) {draw2d.command.CommandCollection=draw2d.command.Command.extend({NAME:"draw2d.command.CommandCollection",init:function(){this._super("Execute Commands");this.commands=new draw2d.util.ArrayList()},add:function(A){this.commands.add(A)},execute:function(){this.commands.each(function(A,B){B.execute()})},redo:function(){this.commands.each(function(A,B){B.redo()})},undo:function(){this.commands.reverse();this.commands.each(function(A,B){B.undo()});this.commands.reverse()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStack.js' */
(function ($) {draw2d.command.CommandStack=Class.extend({NAME:"draw2d.command.CommandStack",init:function(){this.undostack=[];this.redostack=[];this.maxundo=50;this.transactionCommand=null;this.eventListeners=new draw2d.util.ArrayList()},setUndoLimit:function(A){this.maxundo=A},markSaveLocation:function(){this.undostack=[];this.redostack=[];this.notifyListeners(new draw2d.command.Command(),draw2d.command.CommandStack.POST_EXECUTE)},execute:function(A){if(A===null){return }if(typeof A==="undefined"){throw"Missing parameter [command] for method call CommandStack.execute"}if(A.canExecute()===false){return }if(this.transactionCommand!==null){this.transactionCommand.add(A);return }this.notifyListeners(A,draw2d.command.CommandStack.PRE_EXECUTE);this.undostack.push(A);A.execute();this.redostack=[];if(this.undostack.length>this.maxundo){this.undostack=this.undostack.slice(this.undostack.length-this.maxundo)}this.notifyListeners(A,draw2d.command.CommandStack.POST_EXECUTE)},startTransaction:function(){this.transactionCommand=new draw2d.command.CommandCollection()},commitTransaction:function(){if(this.transactionCommand===null){return }var A=this.transactionCommand;this.transactionCommand=null;this.execute(A)},undo:function(){var A=this.undostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_UNDO);this.redostack.push(A);A.undo();this.notifyListeners(A,draw2d.command.CommandStack.POST_UNDO)}},redo:function(){var A=this.redostack.pop();if(A){this.notifyListeners(A,draw2d.command.CommandStack.PRE_REDO);this.undostack.push(A);A.redo();this.notifyListeners(A,draw2d.command.CommandStack.POST_REDO)}},getRedoLabel:function(){if(this.redostack.lenght===0){return""}var A=this.redostack[this.redostack.length-1];if(A){return A.getLabel()}return""},getUndoLabel:function(){if(this.undostack.lenght===0){return""}var A=this.undostack[this.undostack.length-1];if(A){return A.getLabel()}return""},canRedo:function(){return this.redostack.length>0},canUndo:function(){return this.undostack.length>0},addEventListener:function(A){if(A instanceof draw2d.command.CommandStackEventListener){this.eventListeners.add(A)}else{if(typeof A.stackChanged==="function"){this.eventListeners.add(A)}else{if(typeof A==="function"){this.eventListeners.add({stackChanged:A})}else{throw"Object doesn't implement required callback interface [draw2d.command.CommandStackListener]"}}}},removeEventListener:function(C){for(var A=0;A<size;A++){var B=this.eventListeners.get(A);if(B===C||B.stackChanged===C){this.eventListeners.remove(B);return }}},notifyListeners:function(E,D){var C=new draw2d.command.CommandStackEvent(this,E,D);var B=this.eventListeners.getSize();for(var A=0;A<B;A++){this.eventListeners.get(A).stackChanged(C)}}});draw2d.command.CommandStack.PRE_EXECUTE=1;draw2d.command.CommandStack.PRE_REDO=2;draw2d.command.CommandStack.PRE_UNDO=4;draw2d.command.CommandStack.POST_EXECUTE=8;draw2d.command.CommandStack.POST_REDO=16;draw2d.command.CommandStack.POST_UNDO=32;draw2d.command.CommandStack.POST_INIT=64;draw2d.command.CommandStack.POST_MASK=draw2d.command.CommandStack.POST_EXECUTE|draw2d.command.CommandStack.POST_UNDO|draw2d.command.CommandStack.POST_REDO;draw2d.command.CommandStack.PRE_MASK=draw2d.command.CommandStack.PRE_EXECUTE|draw2d.command.CommandStack.PRE_UNDO|draw2d.command.CommandStack.PRE_REDO;}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEvent.js' */
(function ($) {draw2d.command.CommandStackEvent=Class.extend({NAME:"draw2d.command.CommandStackEvent",init:function(A,C,B){this.stack=A;this.command=C;this.details=B},getStack:function(){return this.stack},getCommand:function(){return this.command},getDetails:function(){return this.details},isPostChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.POST_MASK)},isPreChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.PRE_MASK)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandStackEventListener.js' */
(function ($) {draw2d.command.CommandStackEventListener=Class.extend({NAME:"draw2d.command.CommandStackEventListener",init:function(){},stackChanged:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMove.js' */
(function ($) {draw2d.command.CommandMove=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMove",init:function(B,A,C){this._super("Shape moved");this.figure=B;if(typeof A==="undefined"){this.oldX=B.getX();this.oldY=B.getY()}else{this.oldX=A;this.oldY=C}},setStartPosition:function(A,B){this.oldX=A;this.oldY=B},setPosition:function(A,B){this.newX=A;this.newY=B},canExecute:function(){return this.newX!=this.oldX||this.newY!=this.oldY},execute:function(){this.redo()},undo:function(){this.figure.setPosition(this.oldX,this.oldY)},redo:function(){this.figure.setPosition(this.newX,this.newY)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandMoveLine.js' */
(function ($) {draw2d.command.CommandMoveLine=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveLine",init:function(B,C,A,E,D){this._super("Line moved");this.line=B;this.startX1=C;this.startY1=A;this.endX1=E;this.endY1=D;this.startX2=-1;this.startY2=-1;this.endX2=-1;this.endY2=-1},canExecute:function(){return this.startX1!=this.startX2||this.startY1!=this.startY2||this.endX1!=this.endX2||this.endY1!=this.endY2},execute:function(){this.startX2=this.line.getStartX();this.startY2=this.line.getStartY();this.endX2=this.line.getEndX();this.endY2=this.line.getEndY();this.redo()},undo:function(){this.line.setStartPoint(this.startX1,this.startY1);this.line.setEndPoint(this.endX1,this.endY1)},redo:function(){this.line.setStartPoint(this.startX2,this.startY2);this.line.setEndPoint(this.endX2,this.endY2)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandResize.js' */
(function ($) {draw2d.command.CommandResize=draw2d.command.Command.extend({NAME:"draw2d.command.CommandResize",init:function(B,C,A){this._super("Resize Shape");this.figure=B;if(typeof C==="undefined"){this.oldWidth=B.getWidth();this.oldHeight=B.getHeight()}else{this.oldWidth=C;this.oldHeight=A}},setDimension:function(B,A){this.newWidth=B|0;this.newHeight=A|0},canExecute:function(){return this.newWidth!=this.oldWidth||this.newHeight!=this.oldHeight},execute:function(){this.redo()},undo:function(){this.figure.setDimension(this.oldWidth,this.oldHeight)},redo:function(){this.figure.setDimension(this.newWidth,this.newHeight)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandConnect.js' */
(function ($) {draw2d.command.CommandConnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandConnect",init:function(A,B,C){this._super("Connecting Ports");this.canvas=A;this.source=B;this.target=C;this.connection=null},setConnection:function(A){this.connection=A},execute:function(){if(this.connection===null){this.connection=draw2d.Connection.createConnection(this.source,this.target)}this.connection.setSource(this.source);this.connection.setTarget(this.target);this.canvas.addFigure(this.connection);this.canvas.onNewConnection(this.connection)},redo:function(){this.canvas.addFigure(this.connection);this.connection.reconnect()},undo:function(){this.canvas.removeFigure(this.connection)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandReconnect.js' */
(function ($) {draw2d.command.CommandReconnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandReconnect",init:function(A){this._super("Connecting Ports");this.con=A;this.oldSourcePort=A.getSource();this.oldTargetPort=A.getTarget();this.oldRouter=A.getRouter()},canExecute:function(){return true},setNewPorts:function(A,B){this.newSourcePort=A;this.newTargetPort=B},execute:function(){this.redo()},cancel:function(){this.con.calculatePath();this.con.setRouter(this.oldRouter)},undo:function(){this.con.setSource(this.oldSourcePort);this.con.setTarget(this.oldTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())},redo:function(){this.con.setSource(this.newSourcePort);this.con.setTarget(this.newTargetPort);this.con.setRouter(this.oldRouter);this.con.onReconnect(this.con.getSource(),this.con.getTarget())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandDelete.js' */
(function ($) {draw2d.command.CommandDelete=draw2d.command.Command.extend({init:function(A){this._super("Deleting Shape");this.parent=A.getParent();this.figure=A;this.canvas=A.getCanvas();this.connections=null},execute:function(){this.redo()},undo:function(){this.canvas.addFigure(this.figure);if(this.figure instanceof draw2d.Connection){this.figure.reconnect()}this.canvas.setCurrentSelection(this.figure);if(this.parent!==null){this.parent.addChild(this.figure)}for(var A=0;A<this.connections.getSize();++A){this.canvas.addFigure(this.connections.get(A));this.connections.get(A).reconnect()}},redo:function(){this.canvas.setCurrentSelection(null);if(this.figure instanceof draw2d.shape.node.Node&&this.connections===null){this.connections=new draw2d.util.ArrayList();var E=this.figure.getPorts();for(var C=0;C<E.getSize();C++){var A=E.get(C);for(var D=0,B=A.getConnections().getSize();D<B;D++){if(!this.connections.contains(A.getConnections().get(D))){this.connections.add(A.getConnections().get(D))}}}for(var C=0;C<E.getSize();C++){var A=E.get(C);A.setCanvas(null)}}this.canvas.removeFigure(this.figure);if(this.connections===null){this.connections=new draw2d.util.ArrayList()}if(this.parent!==null){this.parent.removeChild(this.figure)}for(var C=0;C<this.connections.getSize();++C){this.canvas.removeFigure(this.connections.get(C))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/command/CommandAdd.js' */
(function ($) {draw2d.command.CommandAdd=draw2d.command.Command.extend({init:function(C,B,A,D){this._super("Add Shape");this.figure=B;this.canvas=C;this.x=A;this.y=D},execute:function(){this.canvas.addFigure(this.figure,this.x,this.y)},redo:function(){this.execute()},undo:function(){this.canvas.removeFigure(this.figure)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ConnectionRouter=Class.extend({NAME:"draw2d.layout.connection.ConnectionRouter",init:function(){},route:function(A){throw"subclasses must implement the method [ConnectionRouter.route]"}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/DirectRouter.js' */
(function ($) {draw2d.layout.connection.DirectRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.DirectRouter",init:function(){},invalidate:function(){},route:function(B){var D=B.getStartPoint();var A=B.getEndPoint();B.addPoint(D);B.addPoint(A);var C=["M",D.x," ",D.y];C.push("L",A.x," ",A.y);B.svgPathString=C.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanConnectionRouter",MINDIST:20,TOL:0.1,TOLxTOL:0.01,TOGGLE_DIST:5,init:function(){},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(D,E,F,N,C){var M=0;var G=1;var K=2;var A=3;var J=E.x-N.x;var H=E.y-N.y;var L;var B;if(((J*J)<(this.TOLxTOL))&&((H*H)<(this.TOLxTOL))){D.addPoint(new draw2d.geo.Point(N.x,N.y));return }if(F===A){if((J>0)&&((H*H)<this.TOL)&&(C===G)){L=N;B=C}else{if(J<0){L=new draw2d.geo.Point(E.x-this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F==C){var I=Math.min(E.x,N.x)-this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===G){if((J<0)&&((H*H)<this.TOL)&&(C===A)){L=N;B=C}else{if(J>0){L=new draw2d.geo.Point(E.x+this.MINDIST,E.y)}else{if(((H>0)&&(C===K))||((H<0)&&(C===M))){L=new draw2d.geo.Point(N.x,E.y)}else{if(F===C){var I=Math.max(E.x,N.x)+this.MINDIST;L=new draw2d.geo.Point(I,E.y)}else{L=new draw2d.geo.Point(E.x-(J/2),E.y)}}}if(H>0){B=M}else{B=K}}}else{if(F===K){if(((J*J)<this.TOL)&&(H<0)&&(C===M)){L=N;B=C}else{if(H>0){L=new draw2d.geo.Point(E.x,E.y+this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.max(E.y,N.y)+this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}else{if(F===M){if(((J*J)<this.TOL)&&(H>0)&&(C===K)){L=N;B=C}else{if(H<0){L=new draw2d.geo.Point(E.x,E.y-this.MINDIST)}else{if(((J>0)&&(C===G))||((J<0)&&(C===A))){L=new draw2d.geo.Point(E.x,N.y)}else{if(F===C){var I=Math.min(E.y,N.y)-this.MINDIST;L=new draw2d.geo.Point(E.x,I)}else{L=new draw2d.geo.Point(E.x,E.y-(H/2))}}}if(J>0){B=A}else{B=G}}}}}}this._route(D,L,B,N,C);D.addPoint(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/ManhattanBridgedConnectionRouter.js' */
(function ($) {draw2d.layout.connection.ManhattanBridgedConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanBridgedConnectionRouter",BRIDGE_HORIZONTAL_LR:" r 0 0 3 -4 7 -4 10 0 13 0 ",BRIDGE_HORIZONTAL_RL:" r 0 0 -3 -4 -7 -4 -10 0 -13 0 ",init:function(){},route:function(E){var F=E.getStartPoint();var K=E.getSource().getConnectionDirection(E,E.getTarget());var N=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,N,D,F,K);var O=E.getCanvas().getIntersection(E).sort("x");var L=O.clone().reverse();var G=O;var I=0;var A=E.getPoints();var B=A.get(0);var M=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;for(I=1;I<A.getSize();I++){B=A.get(I);var J=5;var H=this.BRIDGE_HORIZONTAL_LR;if(C.x>B.x){G=L;H=this.BRIDGE_HORIZONTAL_RL;J=-J}G.each(function(P,Q){if(Q.justTouching==false&&draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,Q.x,Q.y)===true){if(B.y===Q.y){M.push(" L",((Q.x-J)|0)+0.5," ",(Q.y|0)+0.5);M.push(H)}}});M.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=M.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/CircuitConnectionRouter.js' */
(function ($) {draw2d.layout.connection.CircuitConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.CircuitConnectionRouter",init:function(){this.setBridgeRadius(4);this.setJunctionRadius(2);this.abortRoutingOnFirstJunctionNode=false},setJunctionRadius:function(A){this.junctionRadius=A},setBridgeRadius:function(A){this.bridgeRadius=A;this.bridge_LR=[" r",0.5,-0.5,A-(A/2),-(A-A/4),A,-A,A+(A/2),-(A-A/4),A*2,"0 "].join(" ");this.bridge_RL=[" r",-0.5,-0.5,-(A-(A/2)),-(A-A/4),-A,-A,-(A+(A/2)),-(A-A/4),-A*2,"0 "].join(" ")},route:function(E){var F=E.getStartPoint();var L=E.getSource().getConnectionDirection(E,E.getTarget());var O=E.getEndPoint();var D=E.getTarget().getConnectionDirection(E,E.getSource());this._route(E,O,D,F,L);var P=E.getCanvas().getIntersection(E).sort("x");var M=P.clone().reverse();var G=P;var J=0;if(typeof E.junctionNodes!=="undefined"&&E.junctionNodes!==null){E.junctionNodes.remove()}E.junctionNodes=E.canvas.paper.set();var A=E.getPoints();var B=A.get(0);var N=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];var C=B;var K=null;var I=null;var H=null;for(J=1;J<A.getSize();J++){B=A.get(J);if(C.x>B.x){G=M;I=this.bridge_RL;K=-this.bridgeRadius}else{G=P;I=this.bridge_LR;K=this.bridgeRadius}G.each($.proxy(function(S,U){if(draw2d.shape.basic.Line.hit(1,C.x,C.y,B.x,B.y,U.x,U.y)===true){if(E.sharingPorts(U.other)){var Q=U.other;var V=Q.getZOrder();var R=E.getZOrder();if(R<V){var T=E.canvas.paper.ellipse(U.x,U.y,this.junctionRadius,this.junctionRadius).attr({fill:E.lineColor.hash()});E.junctionNodes.push(T);if(this.abortRoutingOnFirstJunctionNode===true){if(E.getSource()==Q.getSource()||E.getSource()==Q.getTarget()){N=["M",(U.x|0)+0.5," ",(U.y|0)+0.5];if(H!==null){H.remove();E.junctionNodes.exclude(H)}}H=T}}}else{if(B.y===U.y){N.push(" L",((U.x-K)|0)+0.5," ",(U.y|0)+0.5);N.push(I)}}}},this));N.push(" L",(B.x|0)+0.5," ",(B.y|0)+0.5);C=B}E.svgPathString=N.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SplineConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SplineConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.SplineConnectionRouter",init:function(){this.spline=new draw2d.util.spline.CubicSpline();this.MINDIST=50,this.cheapRouter=null},route:function(D){var F=0;var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var J=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,J,C,E,G);var A=D.getPoints();D.oldPoint=null;D.lineSegments=new draw2d.util.ArrayList();D.basePoints=new draw2d.util.ArrayList();var H=this.spline.generate(A,8);H.each(function(K,L){D.addPoint(L)});var A=D.getPoints();length=A.getSize();var B=A.get(0);var I=["M",B.x," ",B.y];for(F=1;F<length;F++){B=A.get(F);I.push("L",B.x," ",B.y)}D.svgPathString=I.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/FanConnectionRouter.js' */
(function ($) {draw2d.layout.connection.FanConnectionRouter=draw2d.layout.connection.DirectRouter.extend({NAME:"gdraw2d.layout.connection.FanConnectionRouter",init:function(){},route:function(F){var B=F.getSource().getConnections();var E=new draw2d.util.ArrayList();var C=0;for(var D=0;D<B.getSize();D++){var A=B.get(D);if(A.getTarget()===F.getTarget()||A.getSource()===F.getTarget()){E.add(A);if(F===A){C=E.getSize()}}}if(E.getSize()>1){this.routeCollision(F,C)}else{this._super(F)}},routeCollision:function(F,L){var C=F.getStartPoint();var I=F.getEndPoint();var H=15;var N=new draw2d.geo.Point((I.x+C.x)/2,(I.y+C.y)/2);var K=I.getPosition(C);var O;if(K==draw2d.geo.PositionConstants.SOUTH||K==draw2d.geo.PositionConstants.EAST){O=new draw2d.geo.Point(I.x-C.x,I.y-C.y)}else{O=new draw2d.geo.Point(C.x-I.x,C.y-I.y)}var D=Math.sqrt(O.x*O.x+O.y*O.y);var M=H*O.x/D;var G=H*O.y/D;var E;if(L%2===0){E=new draw2d.geo.Point(N.x+(L/2)*(-1*G),N.y+(L/2)*M)}else{E=new draw2d.geo.Point(N.x+(L/2)*G,N.y+(L/2)*(-1*M))}F.addPoint(C);F.addPoint(E);F.addPoint(I);var A=F.getPoints();var B=A.get(0);var P=["M",B.x," ",B.y];for(var J=1;J<A.getSize();J++){B=A.get(J);P.push("L",B.x," ",B.y)}F.svgPathString=P.join("")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/MazeConnectionRouter.js' */
(function ($) {var ROUTER_RECTS=null;draw2d.layout.connection.MazeConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.MazeConnectionRouter",init:function(){this.useSpline=false;this.useSimplify=true;this.useSimplifyValue=2;this.useDebug=false;this.useShift=4;this.portOutletOffset=15;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})},route:function(D){var E=D.getStartPoint();var G=D.getSource().getConnectionDirection(D,D.getTarget());var H=D.getEndPoint();var C=D.getTarget().getConnectionDirection(D,D.getSource());this._route(D,H,C,E,G);var A=D.getPoints();var B=A.get(0);var I=["M",(B.x|0)+0.5," ",(B.y|0)+0.5];for(var F=1;F<A.getSize();F++){B=A.get(F);I.push("L",(B.x|0)+0.5," ",(B.y|0)+0.5)}D.svgPathString=I.join("")},_route:function(E,F,J,M,D){var C=this.useShift;oldToPt=M;oldFromPt=F;F=this.getAddjustedPoint(F,J,this.portOutletOffset);M=this.getAddjustedPoint(M,D,this.portOutletOffset);var A=this.generateNoGoGrid(E,F,J,M,D);var N=this.finder.findPath(F.x>>C,F.y>>C,M.x>>C,M.y>>C,A);$.each(N,function(O,P){P.x=P[0]=P[0]<<C;P.y=P[1]=P[1]<<C});if(this.useDebug){if(ROUTER_RECTS!==null){ROUTER_RECTS.remove()}ROUTER_RECTS=E.canvas.paper.set();for(var H=0;H<A.width;H++){for(var G=0;G<A.height;G++){if(!A.isWalkableAt(H,G)){ROUTER_RECTS.push(E.canvas.paper.rect(H<<C,G<<C,1<<C,1<<C).attr({fill:"red",opacity:"0.1"}))}}}ROUTER_RECTS.push(E.canvas.paper.rect(F.x-3,F.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));ROUTER_RECTS.push(E.canvas.paper.rect(M.x-3,M.y-3,6,6).attr({fill:"#ff0000",opacity:"0.8"}));$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#0000ff",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#0000ff"}))}this.adjustPath(F,N,J);N.reverse();this.adjustPath(M,N,D);N.reverse();$.each(N,function(O,P){P.x=P[0];P.y=P[1]});if(this.useSpline){var B=new draw2d.util.ArrayList();B.add(oldFromPt);$.each(N,function(O,P){B.add(new draw2d.geo.Point(P[0],P[1]))});B.add(oldToPt);if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var L=N[0];var K=["M",L.x," ",L.y];for(var H=1;H<N.length;H++){L=N[H];K.push("L",L.x," ",L.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}this.spline=new draw2d.util.spline.CubicSpline();var I=this.spline.generate(B,8);if(this.useSimplify){N=[];I.each(function(O,P){N.push({x:P.x,y:P.y})});N=this.simplify(N,this.useSimplifyValue,true);$.each(N,function(O,P){E.addPoint(P.x,P.y)})}else{I.each(function(O,P){E.addPoint(P)})}}else{if(this.useSimplify){N=this.simplify(N,this.useSimplifyValue,true)}if(this.useDebug){$.each(N,function(O,P){ROUTER_RECTS.push(E.canvas.paper.rect(P.x-3,P.y-3,6,6).attr({fill:"#00ff00",opacity:"0.8"}))});var B=N[0];var K=["M",B.x," ",B.y];for(var H=1;H<N.length;H++){B=N[H];K.push("L",B.x," ",B.y)}K=K.join("");ROUTER_RECTS.push(E.canvas.paper.path(K).attr({stroke:"#00ff00"}))}E.addPoint(oldFromPt);$.each(N,function(O,P){E.addPoint(P[0],P[1])});E.addPoint(oldToPt)}},generateNoGoGrid:function(F,G,C,I,B){var Q=this.useShift;var L=(1<<Q)/2;var R=F.getCanvas().paper.width>>Q;var D=F.getCanvas().paper.height>>Q;var A=new PF.Grid(R,D);var E=F.getCanvas().getFigures();E.each(function(V,Y){var X=Y.getBoundingBox();if(X.hitTest(G.x,G.y)===true||X.hitTest(I.x,I.y)){return }var T=X.x>>Q;var Z=X.y>>Q;if(T<1||Z<1){return }var W=(X.x+X.w+L)>>Q;var S=(X.y+X.h+L)>>Q;for(var V=T;V<=W;V++){for(var U=Z;U<=S;U++){A.setWalkableAt(V,U,false)}}});var K=F.getSource().getParent().getBoundingBox();if(B===1||B===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(I.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(I.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}K=F.getTarget().getParent().getBoundingBox();if(C===1||C===3){var H=K.y>>Q;if(H>0){var M=K.y+K.h;var P=(G.x>>Q);for(var N=H-1;N<<Q<=M;N++){A.setWalkableAt(P,N,true)}}}else{var J=K.x>>Q;if(J>0){var O=K.x+K.w;var N=(G.x>>Q);for(var P=J-1;P<<Q<=O;P++){A.setWalkableAt(P,N,true)}}}return A},getAddjustedPoint:function(C,B,A){switch(B){case 0:return new draw2d.geo.Point(C.x,C.y-A);case 1:return new draw2d.geo.Point(C.x+A,C.y);case 2:return new draw2d.geo.Point(C.x,C.y+A);case 3:return new draw2d.geo.Point(C.x-A,C.y)}},adjustPath:function(E,D,C){var B=this.useShift;var A=E.x>>B;var F=E.y>>B;$.each(D,function(G,H){if(F===(H[1]>>B)){H[1]=E.y}else{return false}});$.each(D,function(G,H){if(A===(H[0]>>B)){H[0]=E.x}else{return false}})},getSquareDistance:function(D,C){var B=D.x-C.x,A=D.y-C.y;return B*B+A*A},getSquareSegmentDistance:function(F,G,E){var A=G.x,H=G.y,C=E.x-A,B=E.y-H,D;if(C!==0||B!==0){D=((F.x-A)*C+(F.y-H)*B)/(C*C+B*B);if(D>1){A=E.x;H=E.y}else{if(D>0){A+=C*D;H+=B*D}}}C=F.x-A;B=F.y-H;return C*C+B*B},simplifyRadialDistance:function(F,D){var E,B=F.length,A,C=F[0],G=[C];for(E=1;E<B;E++){A=F[E];if(this.getSquareDistance(A,C)>D){G.push(A);C=A}}if(C!==A){G.push(A)}return G},simplifyDouglasPeucker:function(M,A){var I=M.length,K=(typeof Uint8Array!==undefined+"")?Uint8Array:Array,C=new K(I),G=0,L=I-1,E,D,F,H,B=[],J=[],N=[];C[G]=C[L]=1;while(L){D=0;for(E=G+1;E<L;E++){F=this.getSquareSegmentDistance(M[E],M[G],M[L]);if(F>D){H=E;D=F}}if(D>A){C[H]=1;B.push(G);J.push(H);B.push(H);J.push(L)}G=B.pop();L=J.pop()}for(E=0;E<I;E++){if(C[E]){N.push(M[E])}}return N},simplify:function(C,A,D){var B=(A!==undefined)?A*A:1;if(!D){C=this.simplifyRadialDistance(C,B)}C=this.simplifyDouglasPeucker(C,B);return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/connection/SketchConnectionRouter.js' */
(function ($) {draw2d.layout.connection.SketchConnectionRouter=draw2d.layout.connection.MazeConnectionRouter.extend({NAME:"draw2d.layout.connection.SketchConnectionRouter",init:function(){this._super();this.useSpline=true;this.useShift=5;this.useSimplifyValue=0.2;this.finder=new PF.JumpPointFinder({allowDiagonal:false,dontCrossCorners:true})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/MeshLayouter.js' */
(function ($) {draw2d.layout.mesh.MeshLayouter=Class.extend({init:function(){},add:function(B,A){return new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ExplodeLayouter.js' */
(function ($) {draw2d.layout.mesh.ExplodeLayouter=draw2d.layout.mesh.MeshLayouter.extend({MIN_MARGIN:40,init:function(){},add:function(A,E){var J=[];J[0]={x:0,y:0};J[1]={x:0,y:0};J[2]={x:0,y:0};J[3]={x:0,y:0};J[4]={x:0,y:0};J[5]={x:0,y:0};J[6]={x:0,y:0};J[7]={x:0,y:0};J[8]={x:0,y:0};var C=E.getBoundingBox();var H=A.getFigures();var I=null;var B=0;var G=0;var F=null;var D=0;for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){B=I.getBoundingBox().getDistance(C);if(B<this.MIN_MARGIN){G=this.determineOctant(C,I.getBoundingBox());switch(G){case 2:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 3:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);break;case 4:J[2].x=Math.max(J[2].x,this.MIN_MARGIN-B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN-B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN-B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 5:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 6:J[4].y=Math.max(J[4].y,this.MIN_MARGIN-B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN-B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN-B);break;case 8:B=(C.getBottomRight().getDistance(I.getBoundingBox().getTopLeft()))|0;J[2].x=Math.max(J[2].x,this.MIN_MARGIN+B);J[3].x=Math.max(J[3].x,this.MIN_MARGIN+B);J[4].x=Math.max(J[4].x,this.MIN_MARGIN+B);J[4].y=Math.max(J[4].y,this.MIN_MARGIN+B);J[5].y=Math.max(J[5].y,this.MIN_MARGIN+B);J[6].y=Math.max(J[6].y,this.MIN_MARGIN+B);J[8].x=Math.max(J[8].x,this.MIN_MARGIN+B)}}}}var K=new draw2d.util.ArrayList();for(D=0;D<H.getSize();D++){I=H.get(D);if(I!==E){G=this.determineOctant(C,I.getBoundingBox());F=J[G];if(F.x!==0||F.y!==0){K.add(new draw2d.layout.mesh.ProposedMeshChange(I,F.x,F.y))}}}return K},determineOctant:function(F,D){var C=F.x;var B=F.y;var E=F.w;var K=F.h;var H=D.x;var G=D.y;var I=D.w;var A=D.h;var J=0;if(H+I<=C){if((G+A)<=B){J=0}else{if(G>=(B+K)){J=6}else{J=7}}}else{if(H>=C+E){if(G+A<=B){J=2}else{if(G>=B+K){J=4}else{J=3}}}else{if(G+A<=B){J=1}else{if(G>=B+K){J=5}else{J=8}}}}return J}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/mesh/ProposedMeshChange.js' */
(function ($) {draw2d.layout.mesh.ProposedMeshChange=Class.extend({init:function(B,A,C){this.figure=B;this.x=A;this.y=C},getFigure:function(){return this.figure},getX:function(){return this.x},getY:function(){return this.y}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/Locator.js' */
(function ($) {draw2d.layout.locator.Locator=Class.extend({NAME:"draw2d.layout.locator.Locator",init:function(A){this.parent=A},getParent:function(){return this.parent},setParent:function(A){this.parent=A},relocate:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PortLocator.js' */
(function ($) {draw2d.layout.locator.PortLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.PortLocator",init:function(){this._super()},applyConsiderRotation:function(A,G,F){var H=A.getParent();var I=H.getWidth()/2;var D=H.getHeight()/2;var C=H.getRotationAngle();var B=Raphael.matrix();B.rotate(C,I,D);if(C===90||C===270){var E=H.getHeight()/H.getWidth();B.scale(E,1/E,I,D)}A.setPosition(B.x(G,F),B.y(G,F))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/InputPortLocator.js' */
(function ($) {draw2d.layout.locator.InputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.InputPortLocator",init:function(){this._super()},relocate:function(B,A){var D=A.getParent();var C=D.getHeight();var E=C/(D.getInputPorts().getSize()+1);this.applyConsiderRotation(A,0,E*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/OutputPortLocator.js' */
(function ($) {draw2d.layout.locator.OutputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.OutputPortLocator",init:function(){this._super()},relocate:function(B,A){var C=A.getParent();var D=C.getHeight()/(C.getOutputPorts().getSize()+1);this.applyConsiderRotation(A,C.getWidth(),D*(B+1))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ConnectionLocator.js' */
(function ($) {draw2d.layout.locator.ConnectionLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.ConnectionLocator",init:function(A){this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/ManhattanMidpointLocator.js' */
(function ($) {draw2d.layout.locator.ManhattanMidpointLocator=draw2d.layout.locator.ConnectionLocator.extend({NAME:"draw2d.layout.locator.ManhattanMidpointLocator",init:function(A){this._super(A)},relocate:function(C,D){var A=this.getParent();var H=A.getPoints();var B=Math.floor((H.getSize()-2)/2);if(H.getSize()<=B+1){return }var I=H.get(B);var G=H.get(B+1);if(!I||!G){return }var F=((G.x-I.x)/2+I.x-D.getWidth()/2)|0;var E=((G.y-I.y)/2+I.y-D.getHeight()/2)|0;D.setPosition(F,E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/PolylineMidpointLocator.js' */
(function ($) {draw2d.layout.locator.PolylineMidpointLocator=draw2d.layout.locator.ManhattanMidpointLocator.extend({NAME:"draw2d.layout.locator.PolylineMidpointLocator",init:function(A){this._super(A)},relocate:function(A,D){var C=this.getParent();var B=C.getPoints();if(B.getSize()%2===0){this._super(A,D)}else{var A=Math.floor(B.getSize()/2);var E=B.get(A);D.setPosition(E.x-(D.getWidth()/2),E.y-(D.getHeight()/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/TopLocator.js' */
(function ($) {draw2d.layout.locator.TopLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.TopLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,2)}else{D.setPosition(A.w/2-(E.w/2),-(E.h+2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/BottomLocator.js' */
(function ($) {draw2d.layout.locator.BottomLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.BottomLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h-2)}else{D.setPosition(A.w/2-E.w/2,2+A.h)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/LeftLocator.js' */
(function ($) {draw2d.layout.locator.LeftLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.LeftLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(2,A.h/2)}else{D.setPosition(-E.w-5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/RightLocator.js' */
(function ($) {draw2d.layout.locator.RightLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.RightLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();var E=D.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w-2,A.h/2)}else{D.setPosition(A.w+5,(A.h/2)-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/locator/CenterLocator.js' */
(function ($) {draw2d.layout.locator.CenterLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.CenterLocator",init:function(A){this._super(A)},relocate:function(B,D){var C=this.getParent();var A=C.getBoundingBox();if(D instanceof draw2d.Port){D.setPosition(A.w/2,A.h/2)}else{var E=D.getBoundingBox();D.setPosition(A.w/2-E.w/2,A.h/2-(E.h/2))}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/EditPolicy.js' */
(function ($) {draw2d.policy.EditPolicy=Class.extend({NAME:"draw2d.policy.EditPolicy",init:function(){},onInstall:function(A){},onUninstall:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CanvasPolicy.js' */
(function ($) {draw2d.policy.canvas.CanvasPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.canvas.CanvasPolicy",init:function(){this._super()},onInstall:function(A){},onUninstall:function(A){},onClick:function(A,B){},onMouseMove:function(B,A,C){},snap:function(C,A,B){return B},onMouseDown:function(B,A,C){},onMouseDrag:function(D,C,B,E,A){},onMouseUp:function(B,A,C){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SelectionPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SelectionPolicy",init:function(){this._super()},unselect:function(B,A){A.unselect();B.getSelection().remove(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SingleSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.SingleSelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.SingleSelectionPolicy",init:function(){this._super();this.mouseMovedDuringMouseDown=false;this.mouseDraggingElement=null;this.mouseDownElement=null},select:function(C,A){var B=C.getSelection().getPrimary();if(C.getSelection().getAll().contains(A)){return }C.getSelection().setPrimary(A);if(B!==null){this.unselect(C,B)}if(A!==null){A.select(true)}C.selectionListeners.each(function(E,D){D.onSelectionChanged(A,B)})},onMouseDown:function(C,B,E){this.mouseMovedDuringMouseDown=false;var D=true;var A=C.getBestFigure(B,E);while((A!==null&&A.getParent()!==null)&&!(A instanceof draw2d.Port)){A=A.getParent()}if(A!==null&&A.isDraggable()){D=A.onDragStart(B-A.getAbsoluteX(),E-A.getAbsoluteY());if(D===false){this.mouseDraggingElement=null;this.mouseDownElement=A}else{this.mouseDraggingElement=A;this.mouseDownElement=A}}if(A!==C.getSelection().getPrimary()&&A!==null&&A.isSelectable()===true){this.select(C,A);if(A instanceof draw2d.shape.basic.Line){if(!(A instanceof draw2d.Connection)){C.draggingLineCommand=A.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(C.draggingLineCommand!==null){C.draggingLine=A}}}else{if(D===false){A.unselect()}}}},onMouseDrag:function(D,J,I,H,E){this.mouseMovedDuringMouseDown=true;if(this.mouseDraggingElement!==null){if(D.linesToRepaintAfterDragDrop.isEmpty()===true&&(this.mouseDraggingElement instanceof draw2d.shape.node.Node)){var F=this.mouseDraggingElement.getConnections();var A=D.lineIntersections.clone();D.lineIntersections.each($.proxy(function(L,K){if(F.contains(K.line)||F.contains(K.other)){A.remove(K);D.linesToRepaintAfterDragDrop.add(K.line);D.linesToRepaintAfterDragDrop.add(K.other)}},this));D.lineIntersections=A;D.linesToRepaintAfterDragDrop.each($.proxy(function(L,K){this.repaintLineAfterDragDrop(K)},this))}var C=D.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDrag(J,I)}else{C.each(function(L,K){K.onDrag(J,I)})}var B=D.fromDocumentToCanvasCoordinate(D.mouseDownX,D.mouseDownY).translate(J,I);var G=D.getBestFigure(B.x,B.y,this.mouseDraggingElement);if(G!==D.currentDropTarget){if(D.currentDropTarget!==null){D.currentDropTarget.onDragLeave(this.mouseDraggingElement);D.currentDropTarget=null}if(G!==null){D.currentDropTarget=G.onDragEnter(this.mouseDraggingElement)}}}else{if(this.mouseDownElement!==null&&!(this.mouseDownElement instanceof draw2d.Connection)){this.mouseDownElement.onPanning(J,I)}}},repaintLineAfterDragDrop:function(A){A.svgPathString=null;A.repaint()},onMouseUp:function(B,A,D){if(this.mouseDraggingElement!==null){var C=B.getSelection().getAll();if(!C.contains(this.mouseDraggingElement)){this.mouseDraggingElement.onDragEnd()}else{B.getCommandStack().startTransaction();B.getSelection().getAll().each(function(F,E){E.onDragEnd()});B.getCommandStack().commitTransaction()}if(B.currentDropTarget!==null){this.mouseDraggingElement.onDrop(B.currentDropTarget);B.currentDropTarget.onDragLeave(this.mouseDraggingElement);B.currentDropTarget=null}this.mouseDraggingElement=null}if((this.mouseDownElement===null||this.mouseDownElement.isSelectable()===false)&&this.mouseMovedDuringMouseDown===false){this.select(B,null)}this.mouseDownElement=null;this.mouseMovedDuringMouseDown=false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/PanningSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.PanningSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.PanningSelectionPolicy",init:function(){this._super()},onMouseDrag:function(D,C,B,F,A){this._super(D,C,B,F,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/BoundingBoxSelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.BoundingboxSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.BoundingboxSelectionPolicy",init:function(){this._super();this.boundingBoxFigure1=null;this.boundingBoxFigure2=null;this.x=0;this.y=0},select:function(B,A){if(B.getSelection().getAll().contains(A)){return }if(A!==null){A.select(true)}B.getSelection().setPrimary(A);B.selectionListeners.each(function(D,C){C.onSelectionChanged(A)})},onMouseDown:function(B,A,D){this.x=A;this.y=D;var C=B.getSelection().getAll();this._super(B,A,D);if(this.mouseDownElement!==null&&this.mouseDownElement.isResizeHandle===false&&!C.contains(this.mouseDownElement)){C.each($.proxy(function(F,E){this.unselect(B,E)},this))}C=B.getSelection().getAll();C.each($.proxy(function(F,E){var G=E.onDragStart(E.getAbsoluteX(),E.getAbsoluteY());if(E instanceof draw2d.shape.basic.Line){}else{if(G===false){this.unselect(B,E)}}},this))},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDraggingElement===null&&this.mouseDownElement===null&&this.boundingBoxFigure1===null){this.boundingBoxFigure1=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure1.setPosition(this.x,this.y);this.boundingBoxFigure1.setCanvas(D);this.boundingBoxFigure1.setBackgroundColor("#0f0f0f");this.boundingBoxFigure1.setAlpha(0.1);this.boundingBoxFigure2=new draw2d.shape.basic.Rectangle(1,1);this.boundingBoxFigure2.setPosition(this.x,this.y);this.boundingBoxFigure2.setCanvas(D);this.boundingBoxFigure2.setDashArray("- ");this.boundingBoxFigure2.setStroke(1);this.boundingBoxFigure2.setColor(new draw2d.util.Color(84,151,220));this.boundingBoxFigure2.setBackgroundColor(null)}if(this.boundingBoxFigure1!==null){this.boundingBoxFigure1.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure1.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B));this.boundingBoxFigure2.setDimension(Math.abs(C),Math.abs(B));this.boundingBoxFigure2.setPosition(this.x+Math.min(0,C),this.y+Math.min(0,B))}},onMouseUp:function(B,A,F){if(this.mouseDownElement===null){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}else{if(this.mouseDownElement!==null&&this.mouseMovedDuringMouseDown===false){var E=B.getSelection().getAll();if(!E.contains(this.mouseDownElement)){B.getSelection().getAll().each($.proxy(function(H,G){this.unselect(B,G)},this))}}}this._super(B,A,F);if(this.boundingBoxFigure1!==null){var D=this.boundingBoxFigure1.getBoundingBox();B.getFigures().each($.proxy(function(H,G){if(G.getBoundingBox().isInside(D)){var I=G.onDragStart(G.getAbsoluteX(),G.getAbsoluteY());if(I===true){this.select(B,G,false)}}},this));var C=B.getSelection();B.getLines().each($.proxy(function(H,G){if(G instanceof draw2d.Connection){if(C.contains(G.getSource().getParent())&&C.contains(G.getTarget().getParent())){this.select(B,G,false)}}},this));this.boundingBoxFigure1.setCanvas(null);this.boundingBoxFigure1=null;this.boundingBoxFigure2.setCanvas(null);this.boundingBoxFigure2=null}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ReadOnlySelectionPolicy.js' */
(function ($) {draw2d.policy.canvas.ReadOnlySelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ReadOnlySelectionPolicy",init:function(){this._super()},onInstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(false)},this))},onUninstall:function(A){A.getAllPorts().each($.proxy(function(C,B){B.setVisible(true)},this))},onMouseDrag:function(D,C,B,F,A){var E=D.getScrollArea();E.scrollTop(E.scrollTop()+A);E.scrollLeft(E.scrollLeft()+F)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/DecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.DecorationPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.DecorationPolicy",init:function(){this._super()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/FadeoutDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.FadeoutDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.FadeoutDecorationPolicy",DEFAULT_FADEOUT_DURATION:30,TARGET_COLOR:new draw2d.util.Color("#707070"),init:function(){this._super();this.alpha=1;this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION;this.canvas=null},onInstall:function(A){this.canvas=A;this.timerId=window.setInterval($.proxy(this.onTimer,this),100);this.hidePortsCounter=1;this.alpha=0.1},onUninstall:function(A){window.clearInterval(this.timerId);this.canvas.getAllPorts().each($.proxy(function(C,B){B.setAlpha(1)},this))},onTimer:function(){this.hidePortsCounter--;if(this.hidePortsCounter<=0&&this.alpha>0){this.alpha=Math.max(0,this.alpha-0.05);this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}else{if(this.hidePortsCounter>0&&this.alpha!==1){this.alpha=1;this.duringHide=false;this.canvas.getAllPorts().each($.proxy(function(B,A){A.setAlpha(this.alpha)},this));this.canvas.getSelection().getAll().each($.proxy(function(B,A){A.selectionHandles.each($.proxy(function(C,D){D.setAlpha(this.alpha)},this))},this))}}},onMouseDown:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseMove:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseDrag:function(D,C,B,E,A){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseUp:function(B,A,C){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/CoronaDecorationPolicy.js' */
(function ($) {draw2d.policy.canvas.CoronaDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.CoronaDecorationPolicy",init:function(){this._super();this.startDragX=0;this.startDragY=0},onInstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(false)})})},onUninstall:function(A){var B=A.getFigures();B.each(function(D,C){C.getPorts().each(function(E,F){F.setVisible(true)})})},onMouseDown:function(B,A,C){this.startDragX=A;this.startDragY=C},onMouseMove:function(B,A,C){this.updatePorts(B,A,C)},onMouseDrag:function(D,C,B,E,A){this.updatePorts(D,this.startDragX+C,this.startDragY+B)},updatePorts:function(B,A,D){var C=B.getFigures();C.each(function(F,E){if(E.isVisible()===true&&E.hitTest(A,D,50)===true&&E instanceof draw2d.shape.node.Node){E.getPorts().each(function(G,H){H.setVisible(true)})}else{E.getPorts().each(function(G,H){H.setVisible(false)})}})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SnapToEditPolicy",init:function(A){this._super();this.grid=A},snap:function(C,A,B){return B}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.SnapToGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,D){var C=A.getSnapToGridAnchor();D.x=D.x+C.x;D.y=D.y+C.y;D.x=this.grid*Math.floor(((D.x+this.grid/2)/this.grid));D.y=this.grid*Math.floor(((D.y+this.grid/2)/this.grid));D.x=D.x-C.x;D.y=D.y-C.y;return D},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/ShowGridEditPolicy.js' */
(function ($) {draw2d.policy.canvas.ShowGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.ShowGridEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(A){this._super();this.canvas=null;this.lines=null;if(A){this.grid=A}else{this.grid=this.GRID_WIDTH}},onInstall:function(A){this.canvas=A;this.showGrid()},onUninstall:function(A){this.canvas=null;this.lines.remove()},snap:function(B,A,C){return C},showGrid:function(){var B=this.canvas.initialWidth;var C=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var A=this.grid;A<B;A+=this.grid){this.lines.push(this.canvas.paper.path("M "+A+" 0 l 0 "+C))}for(var D=this.grid;D<C;D+=this.grid){this.lines.push(this.canvas.paper.path("M 0 "+D+" l "+B+" 0"))}this.lines.attr({stroke:this.GRID_COLOR});this.lines.toBack()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/canvas/SnapToGeometryEditPolicy.js' */
(function ($) {draw2d.SnapToHelper={};draw2d.SnapToHelper.NORTH=1;draw2d.SnapToHelper.SOUTH=4;draw2d.SnapToHelper.WEST=8;draw2d.SnapToHelper.EAST=16;draw2d.SnapToHelper.CENTER=32;draw2d.SnapToHelper.NORTH_EAST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.NORTH_WEST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.SOUTH_EAST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.EAST;draw2d.SnapToHelper.SOUTH_WEST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NORTH_SOUTH=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.SOUTH;draw2d.SnapToHelper.EAST_WEST=draw2d.SnapToHelper.EAST|draw2d.SnapToHelper.WEST;draw2d.SnapToHelper.NSEW=draw2d.SnapToHelper.NORTH_SOUTH|draw2d.SnapToHelper.EAST_WEST;draw2d.policy.canvas.SnapToGeometryEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGeometryEditPolicy",SNAP_THRESHOLD:3,LINE_COLOR:"#1387E6",FADEOUT_DURATION:300,init:function(){this._super();this.rows=null;this.cols=null;this.vline=null;this.hline=null;this.canvas=null},onInstall:function(A){this.canvas=A},onUninstall:function(A){this.canvas=null},onMouseUp:function(B,A,C){this.rows=null;this.cols=null;this.hideVerticalLine();this.hideHorizontalLine()},snap:function(E,B,H){if(B instanceof draw2d.ResizeHandle){var F=B.getSnapToGridAnchor();H.x+=F.x;H.y+=F.y;var A=new draw2d.geo.Point(H.x,H.y);var D=B.getSnapToDirection();var G=this.snapPoint(D,H,A);if((D&draw2d.SnapToHelper.EAST_WEST)&&!(G&draw2d.SnapToHelper.EAST_WEST)){this.showVerticalLine(A.x)}else{this.hideVerticalLine()}if((D&draw2d.SnapToHelper.NORTH_SOUTH)&&!(G&draw2d.SnapToHelper.NORTH_SOUTH)){this.showHorizontalLine(A.y)}else{this.hideHorizontalLine()}A.x-=F.x;A.y-=F.y;return A}else{var C=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var A=new draw2d.geo.Rectangle(H.x,H.y,B.getWidth(),B.getHeight());var D=draw2d.SnapToHelper.NSEW;var G=this.snapRectangle(C,A);if((D&draw2d.SnapToHelper.WEST)&&!(G&draw2d.SnapToHelper.WEST)){this.showVerticalLine(A.x)}else{if((D&draw2d.SnapToHelper.EAST)&&!(G&draw2d.SnapToHelper.EAST)){this.showVerticalLine(A.getX()+A.getWidth())}else{this.hideVerticalLine()}}if((D&draw2d.SnapToHelper.NORTH)&&!(G&draw2d.SnapToHelper.NORTH)){this.showHorizontalLine(A.y)}else{if((D&draw2d.SnapToHelper.SOUTH)&&!(G&draw2d.SnapToHelper.SOUTH)){this.showHorizontalLine(A.getY()+A.getHeight())}else{this.hideHorizontalLine()}}return A.getTopLeft()}return H},snapRectangle:function(A,F){var E=A.getTopLeft();var D=A.getBottomRight();var B=this.snapPoint(draw2d.SnapToHelper.NORTH_WEST,A.getTopLeft(),E);F.x=E.x;F.y=E.y;var C=this.snapPoint(draw2d.SnapToHelper.SOUTH_EAST,A.getBottomRight(),D);if(B&draw2d.SnapToHelper.WEST){F.x=D.x-A.getWidth()}if(B&draw2d.SnapToHelper.NORTH){F.y=D.y-A.getHeight()}return B|C},snapPoint:function(D,C,E){if(this.rows===null||this.cols===null){this.populateRowsAndCols()}if((D&draw2d.SnapToHelper.EAST)!==0){var G=this.getCorrectionFor(this.cols,C.getX()-1,1);if(G!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.EAST;E.x+=G}}if((D&draw2d.SnapToHelper.WEST)!==0){var B=this.getCorrectionFor(this.cols,C.getX(),-1);if(B!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.WEST;E.x+=B}}if((D&draw2d.SnapToHelper.SOUTH)!==0){var F=this.getCorrectionFor(this.rows,C.getY()-1,1);if(F!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.SOUTH;E.y+=F}}if((D&draw2d.SnapToHelper.NORTH)!==0){var A=this.getCorrectionFor(this.rows,C.getY(),-1);if(A!==this.SNAP_THRESHOLD){D&=~draw2d.SnapToHelper.NORTH;E.y+=A}}return D},populateRowsAndCols:function(){var E=this.canvas.getSelection();this.rows=[];this.cols=[];var D=this.canvas.getFigures();var B=0;for(var C=0;C<D.getSize();C++){var A=D.get(C);if(!E.contains(A)){var F=A.getBoundingBox();this.cols[B*3]={type:-1,location:F.getX()};this.rows[B*3]={type:-1,location:F.getY()};this.cols[B*3+1]={type:0,location:F.x+(F.getWidth()-1)/2};this.rows[B*3+1]={type:0,location:F.y+(F.getHeight()-1)/2};this.cols[B*3+2]={type:1,location:F.getRight()-1};this.rows[B*3+2]={type:1,location:F.getBottom()-1};B++}}},getCorrectionFor:function(B,H,E){var C=this.SNAP_THRESHOLD;var A=this.SNAP_THRESHOLD;for(var D=0;D<B.length;D++){var F=B[D];var G;if(F.type===-1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===0&&E===0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}else{if(F.type===1&&E!==0){G=Math.abs(H-F.location);if(G<C){C=G;A=F.location-H}}}}}return A},showVerticalLine:function(A){if(this.vline!=null){return }this.vline=this.canvas.paper.path("M "+A+" 0 l 0 "+this.canvas.getHeight()).attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideVerticalLine:function(A){if(this.vline==null){return }var B=this.vline;B.animate({opacity:0.1},this.FADEOUT_DURATION,function(){B.remove()});this.vline=null},showHorizontalLine:function(A){if(this.hline!=null){return }this.hline=this.canvas.paper.path("M 0 "+A+" l "+this.canvas.getWidth()+" 0").attr({stroke:this.LINE_COLOR,"stroke-width":1})},hideHorizontalLine:function(){if(this.hline==null){return }var A=this.hline;A.animate({opacity:0.1},this.FADEOUT_DURATION,function(){A.remove()});this.hline=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/DragDropEditPolicy.js' */
(function ($) {draw2d.policy.figure.DragDropEditPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.figure.DragDropEditPolicy",init:function(){this._super()},onDragStart:function(B,A){A.shape.attr({cursor:"move"})},onDrag:function(B,A){},onDragEnd:function(B,A){A.shape.attr({cursor:"default"})},adjustPosition:function(B,A,C){if(A instanceof draw2d.geo.Point){return A}return new draw2d.geo.Point(A,C)},adjustDimension:function(A,B,C){return new draw2d.geo.Rectangle(0,0,B,C)},moved:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RegionEditPolicy.js' */
(function ($) {draw2d.policy.figure.RegionEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.RegionEditPolicy",init:function(A,D,B,C){this._super();if(A instanceof draw2d.geo.Rectangle){this.constRect=A}else{if(typeof C==="number"){this.constRect=new draw2d.geo.Rectangle(A,D,B,C)}else{throw"Invalid parameter. RegionConstraintPolicy need a rectangle as parameter in the constructor"}}},adjustPosition:function(B,A,D){var C=null;if(A instanceof draw2d.geo.Point){C=new draw2d.geo.Rectangle(A.x,A.y,B.getWidth(),B.getHeight())}else{C=new draw2d.geo.Rectangle(A,D,B.getWidth(),B.getHeight())}C=this.constRect.moveInside(C);return C.getTopLeft()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HorizontalEditPolicy.js' */
(function ($) {draw2d.policy.figure.HorizontalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.HorizontalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(A,B.getY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VerticalEditPolicy.js' */
(function ($) {draw2d.policy.figure.VerticalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.VerticalEditPolicy",init:function(){this._super()},adjustPosition:function(B,A,C){return new draw2d.geo.Point(B.getX(),C)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SelectionFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.SelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){},onUnselect:function(B,A){A.selectionHandles.each(function(C,D){D.hide()});A.selectionHandles=new draw2d.util.ArrayList()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/LineSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.LineSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.LineSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){A.selectionHandles.add(this.createLineStartResizeHandle(A));A.selectionHandles.add(this.createLineEndResizeHandle(A));A.selectionHandles.each(function(D,E){E.setDraggable(A.isResizeable());E.show(B)})}this.moved(B,A)},createLineStartResizeHandle:function(A){return new draw2d.shape.basic.LineStartResizeHandle(A)},createLineEndResizeHandle:function(A){return new draw2d.shape.basic.LineEndResizeHandle(A)},moved:function(C,A){if(A.selectionHandles.isEmpty()){return }var G=A.selectionHandles.get(0);var B=A.selectionHandles.get(1);var H=G.getWidth()/2;var E=G.getHeight()/2;var F=A.getStartPoint();var D=A.getEndPoint();G.setPosition(F.x-H,F.y-E);B.setPosition(D.x-H,D.y-E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RectangleSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(D,I,G){if(I.selectionHandles.isEmpty()){var H=new draw2d.shape.basic.Rectangle();H.setBackgroundColor(null);H.setDashArray("- ");H.setColor("#2096fc");H.setStroke(0.5);H.hide=function(){H.setCanvas(null)};H.show=function(M){H.setCanvas(M);H.shape.toFront()};H.show(D);var F=new draw2d.ResizeHandle(I,1);var E=new draw2d.ResizeHandle(I,2);var C=new draw2d.ResizeHandle(I,3);var B=new draw2d.ResizeHandle(I,4);var A=new draw2d.ResizeHandle(I,5);var L=new draw2d.ResizeHandle(I,6);var K=new draw2d.ResizeHandle(I,7);var J=new draw2d.ResizeHandle(I,8);I.selectionHandles.add(F);I.selectionHandles.add(E);I.selectionHandles.add(C);I.selectionHandles.add(B);I.selectionHandles.add(A);I.selectionHandles.add(L);I.selectionHandles.add(K);I.selectionHandles.add(J);F.show(D);C.show(D);A.show(D);K.show(D);F.setDraggable(I.isResizeable());C.setDraggable(I.isResizeable());A.setDraggable(I.isResizeable());K.setDraggable(I.isResizeable());if(I.isResizeable()===true){F.setBackgroundColor(F.DEFAULT_COLOR);C.setBackgroundColor(C.DEFAULT_COLOR);A.setBackgroundColor(A.DEFAULT_COLOR);K.setBackgroundColor(K.DEFAULT_COLOR)}else{F.setBackgroundColor(null);C.setBackgroundColor(null);A.setBackgroundColor(null);K.setBackgroundColor(null)}if(I.isStrechable()&&I.isResizeable()){E.setDraggable(I.isResizeable());B.setDraggable(I.isResizeable());L.setDraggable(I.isResizeable());J.setDraggable(I.isResizeable());E.show(D);B.show(D);L.show(D);J.show(D)}I.selectionHandles.add(H)}this.moved(D,I)},moved:function(E,J){if(J.selectionHandles.isEmpty()){return }var L=J.getHeight();var K=J.getWidth();var I=J.getX();var F=J.getY();var G=J.selectionHandles.get(0);var C=J.selectionHandles.get(2);var A=J.selectionHandles.get(4);var N=J.selectionHandles.get(6);G.setPosition(I-G.getWidth(),F-G.getHeight());C.setPosition(I+K,F-C.getHeight());A.setPosition(I+K,F+L);N.setPosition(I-N.getWidth(),F+L);if(J.isStrechable()){var D=J.selectionHandles.get(1);var B=J.selectionHandles.get(3);var O=J.selectionHandles.get(5);var M=J.selectionHandles.get(7);D.setPosition(I+(K/2)-(D.getWidth()/2),F-D.getHeight());B.setPosition(I+K,F+(L/2)-(B.getHeight()/2));O.setPosition(I+(K/2)-(O.getWidth()/2),F+L);M.setPosition(I-M.getWidth(),F+(L/2)-(M.getHeight()/2))}var H=J.selectionHandles.get(8);H.setPosition(J.getPosition().translate(-2,-2));H.setDimension(J.getWidth()+4,J.getHeight()+4);H.setRotationAngle(J.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BigRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BigRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(15,15)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/RoundRectangleSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RoundRectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(12,12);E.setRadius(4)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/BusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.BusSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.BusSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(C,A,D){if(A.selectionHandles.isEmpty()){var B=new draw2d.ResizeHandle(A,2);var G=new draw2d.ResizeHandle(A,4);var F=new draw2d.ResizeHandle(A,6);var E=new draw2d.ResizeHandle(A,8);A.selectionHandles.add(B);A.selectionHandles.add(G);A.selectionHandles.add(F);A.selectionHandles.add(E);B.setDraggable(A.isResizeable());G.setDraggable(A.isResizeable());F.setDraggable(A.isResizeable());E.setDraggable(A.isResizeable());B.show(C);G.show(C);F.show(C);E.show(C)}this.moved(C,A)},moved:function(B,F){if(F.selectionHandles.isEmpty()){return }var C=F.selectionHandles.get(0);var A=F.selectionHandles.get(1);var J=F.selectionHandles.get(2);var I=F.selectionHandles.get(3);var H=F.getHeight();var G=F.getWidth();var E=F.getX();var D=F.getY();C.setPosition(E+(G/2)-(C.getWidth()/2),D-C.getHeight());A.setPosition(E+G,D+(H/2)-(A.getHeight()/2));J.setPosition(E+(G/2)-(J.getWidth()/2),D+H);I.setPosition(E-I.getWidth(),D+(H/2)-(I.getHeight()/2))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/VBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.VBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.VBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(D,B){if(B.selectionHandles.isEmpty()){return }var C=B.selectionHandles.get(0);var E=B.selectionHandles.get(2);var A=B.getWidth();C.setDimension(A,C.getHeight());E.setDimension(A,E.getHeight());this._super(D,B)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/HBusSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.HBusSelectionFeedbackPolicy=draw2d.policy.figure.BusSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.HBusSelectionFeedbackPolicy",init:function(){this._super()},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var D=A.selectionHandles.get(1);var C=A.selectionHandles.get(3);D.setDimension(D.getWidth(),A.getHeight());C.setDimension(D.getWidth(),A.getHeight());this._super(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/AntSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.AntSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.AntSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){if(A.selectionHandles.isEmpty()){var D=new draw2d.shape.basic.Rectangle();D.setBackgroundColor(null);D.setDashArray("- ");D.setColor("#00bdee");D.hide=function(){D.setCanvas(null)};D.show=function(E){D.setCanvas(E);D.shape.toFront()};D.show(B);A.selectionHandles.add(D)}this.moved(B,A)},moved:function(B,A){if(A.selectionHandles.isEmpty()){return }var C=A.selectionHandles.get(0);C.setPosition(A.getPosition().translate(-2,-2));C.setDimension(A.getWidth()+4,A.getHeight()+4);C.setRotationAngle(A.getRotationAngle())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/GlowSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.GlowSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.GlowSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){A.setGlow(true);this.moved(B,A)},onUnselect:function(B,A){this._super(B,A);A.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/figure/SlimSelectionFeedbackPolicy.js' */
(function ($) {draw2d.policy.figure.SlimSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.SlimSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(B,A,C){this._super(B,A,C);if(!A.selectionHandles.isEmpty()){A.selectionHandles.each(function(D,E){E.setDimension(6,6);E.setRadius(0)})}this.moved(B,A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/PortFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.PortFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.port.PortFeedbackPolicy",init:function(){this._super()},onHoverEnter:function(B,C,A){},onHoverLeave:function(B,C,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/ElasticStrapFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.ElasticStrapFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.ElasticStrapFeedbackPolicy",init:function(){this._super();this.connectionLine=null},onDragStart:function(B,A){this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(B);this.connectionLine.getShapeElement();this.onDrag(B,A)},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(B,A){this.connectionLine.setCanvas(null);this.connectionLine=null},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/policy/port/IntrusivePortsFeedbackPolicy.js' */
(function ($) {draw2d.policy.port.IntrusivePortsFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.IntrusivePortsFeedbackPolicy",init:function(){this._super();this.connectionLine=null;this.tweenable=null},onDragStart:function(D,B){var E=0;B.getDropTargets().each(function(G,F){F.__beforeInflate=F.getWidth();E=F.__beforeInflate});var C=B.getDropTargets();C.grep(function(F){return(F.NAME!=B.NAME&&F.parent!==B.parent)||(F instanceof draw2d.HybridPort)||(B instanceof draw2d.HybridPort)});this.prepareDropTargetsForDrag(C);var A=this;this.tweenable=new Tweenable();this.tweenable.tween({from:{size:E/2},to:{size:E},duration:200,easing:"easeOutSine",step:function(F){C.each(function(H,G){A.alterDropTargetOnDrag(G,F)})}});this.connectionLine=new draw2d.shape.basic.Line();this.connectionLine.setCanvas(D);this.connectionLine.getShapeElement();this.connectionLine.setDashArray("- ");this.connectionLine.setColor(this.getConnectionLineColour());this.onDrag(D,B)},getConnectionLineColour:function(){return"#30c48a"},prepareDropTargetsForDrag:function(A){},alterDropTargetOnDrag:function(A,B){A.shape.attr({rx:B.size,ry:B.size});A.width=A.height=B.size*2},onDrag:function(C,A){var B=A.ox+A.getParent().getAbsoluteX();var D=A.oy+A.getParent().getAbsoluteY();this.connectionLine.setStartPoint(B,D);this.connectionLine.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},onDragEnd:function(C,B){this.tweenable.stop(false);this.tweenable=null;var A=this;var D=B.getDropTargets();this.prepareDropTargetsForDragEnd(D);D.each(function(F,E){A.alterDropTargetOnDragEnd(E)});this.connectionLine.setCanvas(null);this.connectionLine=null},prepareDropTargetsForDragEnd:function(A){},alterDropTargetOnDragEnd:function(A){A.shape.attr({rx:A.__beforeInflate/2,ry:A.__beforeInflate/2});A.width=A.height=A.__beforeInflate},onHoverEnter:function(A,B,C){this.connectionLine.setGlow(true);C.setGlow(true)},onHoverLeave:function(A,B,C){C.setGlow(false);this.connectionLine.setGlow(false)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Canvas.js' */
(function ($) {draw2d.Canvas=Class.extend({NAME:"draw2d.Canvas",init:function(A){if($.browser.msie&&parseInt($.browser.version,10)===8){this.fromDocumentToCanvasCoordinate=this._fromDocumentToCanvasCoordinate_IE8_HACK}this.setScrollArea(document.body);this.canvasId=A;this.html=$("#"+A);this.html.css({cursor:"default"});this.initialWidth=this.getWidth();this.initialHeight=this.getHeight();this.html.css({"-webkit-tap-highlight-color":"rgba(0,0,0,0)"});this.html.droppable({accept:".draw2d_droppable",over:$.proxy(function(B,C){this.onDragEnter(C.draggable)},this),out:$.proxy(function(B,C){this.onDragLeave(C.draggable)},this),drop:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrop(C.draggable,D.getX(),D.getY())},this)});$(".draw2d_droppable").draggable({appendTo:"body",stack:"body",zIndex:27000,helper:"clone",drag:$.proxy(function(B,C){B=this._getEvent(B);var D=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDrag(C.draggable,D.getX(),D.getY())},this),stop:function(C,B){this.isInExternalDragOperation=false},start:function(C,B){this.isInExternalDragOperation=true;$(B.helper).addClass("shadow")}});this.paper=Raphael(A,this.getWidth(),this.getHeight());this.paper.canvas.style.position="absolute";this.zoomFactor=1;this.selection=new draw2d.Selection();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.currentHoverFigure=null;this.editPolicy=new draw2d.util.ArrayList();this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.resizeHandles=new draw2d.util.ArrayList();this.selectionListeners=new draw2d.util.ArrayList();this.viewBoxListeners=new draw2d.util.ArrayList();this.commandStack=new draw2d.command.CommandStack();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.canvas.BoundingboxSelectionPolicy());this.commandStack.addEventListener($.proxy(function(B){if(B.isPostChangeEvent()===true){this.calculateConnectionIntersection();this.linesToRepaintAfterDragDrop.each(function(D,C){C.svgPathString=null;C.repaint()});this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList()}},this));this.mouseDown=false;this.mouseDownX=0;this.mouseDownY=0;this.mouseDragDiffX=0;this.mouseDragDiffY=0;$(document).bind("mouseup touchend",$.proxy(function(B){if(this.mouseDown===false){return }B=this._getEvent(B);this.calculateConnectionIntersection();this.mouseDown=false;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.editPolicy.each($.proxy(function(D,E){E.onMouseUp(this,C.x,C.y)},this));this.mouseDragDiffX=0;this.mouseDragDiffY=0},this));this.html.bind("mousemove touchmove",$.proxy(function(D){D=this._getEvent(D);if(this.mouseDown===false){var E=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);try{var C=this.getBestFigure(E.x,E.y);if(C!==this.currentHoverFigure&&this.currentHoverFigure!==null){this.currentHoverFigure.onMouseLeave(C)}if(C!==this.currentHoverFigure&&C!==null){C.onMouseEnter(this.currentHoverFigure)}this.currentHoverFigure=C}catch(B){console.log(B)}this.editPolicy.each($.proxy(function(F,G){G.onMouseMove(this,E.x,E.y)},this))}},this));$(document).bind("mousemove touchmove",$.proxy(function(D){if(this.mouseDown){var C=this.fromDocumentToCanvasCoordinate(this.mouseDownX,this.mouseDownY);var F=this.fromDocumentToCanvasCoordinate(D.clientX,D.clientY);var E=F.x-C.x;var B=F.y-C.y;this.editPolicy.each($.proxy(function(G,H){H.onMouseDrag(this,E,B,this.mouseDragDiffX-E,this.mouseDragDiffY-B)},this));this.mouseDragDiffX=E;this.mouseDragDiffY=B}},this));this.html.bind("mousedown touchstart",$.proxy(function(B){var C=null;switch(B.which){case 1:case 0:B.preventDefault();B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;this.mouseDragDiffX=0;this.mouseDragDiffY=0;C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.mouseDown=true;this.editPolicy.each($.proxy(function(D,E){E.onMouseDown(this,C.x,C.y)},this));break;case 3:B.preventDefault();B=this._getEvent(B);C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onRightMouseDown(C.x,C.y);break;case 2:break;default:}},this));this.html.bind("dblclick",$.proxy(function(B){B=this._getEvent(B);this.mouseDownX=B.clientX;this.mouseDownY=B.clientY;var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onDoubleClick(C.x,C.y)},this));$(document).bind("click",$.proxy(function(B){B=this._getEvent(B);if(this.mouseDownX===B.clientX||this.mouseDownY===B.clientY){var C=this.fromDocumentToCanvasCoordinate(B.clientX,B.clientY);this.onClick(C.x,C.y)}},this));$(document).bind("keydown",$.proxy(function(B){if(!$(B.target).is("input")){var C=B.ctrlKey;this.onKeyDown(B.keyCode,C)}},this))},calculateConnectionIntersection:function(){this.lineIntersections=new draw2d.util.ArrayList();var B=this.getLines().clone();while(B.getSize()>0){var A=B.removeElementAt(0);B.each($.proxy(function(E,C){var D=A.intersection(C);if(D.getSize()>0){this.lineIntersections.add({line:A,other:C,intersection:D});this.lineIntersections.add({line:C,other:A,intersection:D})}},this))}},clear:function(){this.lines.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.figures.clone().each($.proxy(function(A,B){this.removeFigure(B)},this));this.zoomFactor=1;this.selection.clear();this.currentDropTarget=null;this.isInExternalDragOperation=false;this.figures=new draw2d.util.ArrayList();this.lines=new draw2d.util.ArrayList();this.commonPorts=new draw2d.util.ArrayList();this.dropTargets=new draw2d.util.ArrayList();this.commandStack.markSaveLocation();this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList();this.lineIntersections=new draw2d.util.ArrayList()},installEditPolicy:function(A){if(A instanceof draw2d.policy.canvas.SelectionPolicy){this.getSelection().getAll().each(function(C,B){B.unselect()});this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SelectionPolicy);if(B===false){C.onUninstall(this)}return B},this))}else{if(A instanceof draw2d.policy.canvas.SnapToEditPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.canvas.SnapToEditPolicy);if(B===false){C.onUninstall(this)}return B},this))}}A.onInstall(this);this.editPolicy.add(A)},uninstallEditPolicy:function(A){if(!(A instanceof draw2d.policy.EditPolicy)){return }this.editPolicy.grep($.proxy(function(B){if(B===A){B.onUninstall(this);return false}return true},this))},setViewBox:function(A){this.paper.setViewBox(A.getX(),A.getY(),A.getWidth(),A.getHeight());this.viewBoxListeners.each(function(B,C){C()})},setZoom:function(C,B){var A=$.proxy(function(G){this.zoomFactor=Math.min(Math.max(0.01,G),10);var F=(this.initialWidth*this.zoomFactor)|0;var E=(this.initialHeight*this.zoomFactor)|0;this.paper.setViewBox(0,0,F,E)},this);if(B){var D=new Tweenable();D.tween({from:{x:this.zoomFactor},to:{x:C},duration:300,easing:"easeOutSine",step:function(E){A(E.x)}})}else{A(C)}},getZoom:function(){return this.zoomFactor},fromDocumentToCanvasCoordinate:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX()+this.getScrollLeft())*this.zoomFactor,(B-this.getAbsoluteY()+this.getScrollTop())*this.zoomFactor)},_fromDocumentToCanvasCoordinate_IE8_HACK:function(A,B){return new draw2d.geo.Point((A-this.getAbsoluteX())*this.zoomFactor,(B-this.getAbsoluteY())*this.zoomFactor)},fromCanvasToDocumentCoordinate:function(A,B){return new draw2d.geo.Point((A+this.getAbsoluteX()-this.getScrollLeft())*this.zoomFactor,(B+this.getAbsoluteY()-this.getScrollTop())*this.zoomFactor)},getHtmlContainer:function(){return this.html},_getEvent:function(A){if(typeof A.originalEvent!=="undefined"){if(A.originalEvent.touches&&A.originalEvent.touches.length){return A.originalEvent.touches[0]}else{if(A.originalEvent.changedTouches&&A.originalEvent.changedTouches.length){return A.originalEvent.changedTouches[0]}}}return A},setScrollArea:function(A){this.scrollArea=$(A)},getScrollArea:function(){return this.scrollArea},getScrollLeft:function(){return this.scrollArea.scrollLeft()},getScrollTop:function(){return this.scrollArea.scrollTop()},getAbsoluteX:function(){return this.html.offset().left},getAbsoluteY:function(){return this.html.offset().top},getWidth:function(){return this.html.width()},getHeight:function(){return this.html.height()},addFigure:function(B,A,C){if(B.getCanvas()===this){return }B.setCanvas(this);B.getShapeElement();if(B instanceof draw2d.shape.basic.Line){this.lines.add(B);this.linesToRepaintAfterDragDrop=this.lines}else{this.figures.add(B);if(typeof C!=="undefined"){B.setPosition(A,C)}}B.repaint();B.fireMoveEvent()},removeFigure:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.unselect==="function"){C.unselect(this,A)}},this));if(A===this.currentHoverFigure){this.currentHoverFigure=null}if(A instanceof draw2d.shape.basic.Line){this.lines.remove(A)}else{this.figures.remove(A)}A.setCanvas(null);if(A instanceof draw2d.Connection){A.disconnect()}A.onRemove()},getLines:function(){return this.lines},getFigures:function(){return this.figures},getLine:function(D){var C=this.lines.getSize();for(var B=0;B<C;B++){var A=this.lines.get(B);if(A.getId()===D){return A}}return null},getFigure:function(B){var A=null;this.figures.each(function(C,D){if(D.id===B){A=D;return false}});return A},getIntersection:function(B){var A=new draw2d.util.ArrayList();this.lineIntersections.each($.proxy(function(C,D){if(D.line===B){D.intersection.each(function(E,F){A.add({x:F.x,y:F.y,justTouching:F.justTouching,other:D.other})})}},this));return A},snapToHelper:function(A,B){this.editPolicy.each($.proxy(function(C,D){B=D.snap(this,A,B)},this));return B},registerPort:function(A){A.targets=this.dropTargets;this.commonPorts.add(A);this.dropTargets.add(A)},unregisterPort:function(A){A.targets=null;this.commonPorts.remove(A);this.dropTargets.remove(A)},getAllPorts:function(){return this.commonPorts},getCommandStack:function(){return this.commandStack},getCurrentSelection:function(){return this.selection.getPrimary()},getSelection:function(){return this.selection},setCurrentSelection:function(A){this.editPolicy.each($.proxy(function(B,C){if(typeof C.select==="function"){C.select(this,A)}},this))},addSelectionListener:function(A){if(A!==null){if(typeof A==="function"){this.selectionListeners.add({onSelectionChanged:A})}else{if(typeof A.onSelectionChanged==="function"){this.selectionListeners.add(A)}else{throw"Object doesn't implement required callback method [onSelectionChanged]"}}}},removeSelectionListener:function(A){this.selectionListeners=this.selectionListeners.grep(function(B){return B&&B!==A&&B.onSelectionChanged!==A})},addViewBoxListener:function(A){this.viewBoxListeners.add(A)},removeViewBoxListener:function(A){this.viewBoxListeners=this.viewBoxListeners.grep(function(B){return B!==A})},getBestFigure:function(I,H,A){var K=null;var E=null;var D=0;var B=null;for(D=0,len=this.resizeHandles.getSize();D<len;D++){E=this.resizeHandles.get(D);if(E.isVisible()===true&&E.hitTest(I,H)===true&&E!==A){return E}}for(D=0,len=this.commonPorts.getSize();D<len;D++){E=this.commonPorts.get(D);if(E!==A){if(E.isVisible()===true&&E.hitTest(I,H)===true){return E}}}K=this.getBestLine(I,H,A);if(K!==null){return K}for(D=(this.figures.getSize()-1);D>=0;D--){var G=this.figures.get(D);var C=function(L){L.each(function(M,N){C(N.getChildren());if(K===null&&N.isVisible()===true&&N.hitTest(I,H)===true){K=N}return K===null})};C(G.getChildren());if(K===null&&G.isVisible()===true&&G.hitTest(I,H)===true&&G!==A){if(K===null){K=G}else{if(K.getZOrder()<G.getZOrder()){K=G}}}if(K!==null){return K}}var F=this.lines.getSize();for(D=0;D<F;D++){var J=this.lines.get(D);B=J.getChildren();B.each(function(L,M){if(M.isVisible()===true&&M.hitTest(I,H)===true){K=M;return false}return true})}return K},getBestLine:function(B,G,E){var A=null;var F=this.lines.getSize();for(var D=0;D<F;D++){var C=this.lines.get(D);if(C.isVisible()===true&&C.hitTest(B,G)===true&&C!==E){if(A===null){A=C;break}}}return A},hideSnapToHelperLines:function(){this.hideSnapToHelperLineHorizontal();this.hideSnapToHelperLineVertical()},hideSnapToHelperLineHorizontal:function(){},hideSnapToHelperLineVertical:function(){},onDragEnter:function(A){},onDrag:function(B,A,C){},onDragLeave:function(A){},onDrop:function(B,A,C){},onKeyDown:function(B,A){if(B==46&&this.selection.getPrimary()!==null){this.commandStack.execute(this.selection.getPrimary().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.DELETE)))}else{if(B==90&&A){this.commandStack.undo()}else{if(B==89&&A){this.commandStack.redo()}else{if(B===107){this.setZoom(this.zoomFactor*0.95)}else{if(B===109){this.setZoom(this.zoomFactor*1.05)}}}}}},onDoubleClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onDoubleClick()}},onClick:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onClick()}},onRightMouseDown:function(B,C){var A=this.getBestFigure(B,C);if(A!==null){A.onContextMenu(B,C)}},onNewConnection:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Selection.js' */
(function ($) {draw2d.Selection=Class.extend({NAME:"draw2d.Selection",init:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},clear:function(){this.primary=null;this.all=new draw2d.util.ArrayList()},getPrimary:function(){return this.primary},setPrimary:function(A){this.primary=A;if(A!==null&&!this.all.contains(A)){this.all.add(A)}},remove:function(A){this.all.remove(A);if(this.primary===A){this.primary=null}},contains:function(A){return this.all.contains(A)},getAll:function(){return this.all.clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Figure.js' */
(function ($) {draw2d.Figure=Class.extend({NAME:"draw2d.Figure",MIN_TIMER_INTERVAL:50,init:function(B,A){this.id=draw2d.util.UUID.create();this.isResizeHandle=false;this.command=null;this.canvas=null;this.shape=null;this.children=new draw2d.util.ArrayList();this.selectable=true;this.deleteable=true;this.resizeable=true;this.draggable=true;this.visible=true;this.canSnapToHelper=true;this.snapToGridAnchor=new draw2d.geo.Point(0,0);this.editPolicy=new draw2d.util.ArrayList();this.timerId=-1;this.timerInterval=0;this.parent=null;this.x=0;this.y=0;this.minHeight=5;this.minWidth=5;this.rotationAngle=0;if(typeof A!=="undefined"){this.width=B;this.height=A}else{this.width=this.getMinWidth();this.height=this.getMinHeight()}this.alpha=1;this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.alpha;this.ox=0;this.oy=0;this.repaintBlocked=false;this.selectionHandles=new draw2d.util.ArrayList();this.moveListener=new draw2d.util.ArrayList();this.resizeListener=new draw2d.util.ArrayList();this.installEditPolicy(new draw2d.policy.figure.RectangleSelectionFeedbackPolicy())},select:function(A){if(typeof A==="undefined"){A=true}this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy){C.onSelect(this.canvas,this,A)}},this));this.onSelect&&this.onSelect();return this},unselect:function(){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.SelectionFeedbackPolicy){B.onUnselect(this.canvas,this)}},this));this.onDeselect&&this.onDeselect();return this},getId:function(){return this.id},setId:function(A){this.id=A;return this},setCanvas:function(A){if(A===null&&this.shape!==null){this.unselect();this.shape.remove();this.shape=null}this.canvas=A;if(this.canvas!==null){this.getShapeElement()}if(A===null){this.stopTimer()}else{if(this.timerInterval>=this.MIN_TIMER_INTERVAL){this.startTimer(this.timerInterval)}}this.children.each(function(B,C){C.figure.setCanvas(A)})},getCanvas:function(){return this.canvas},startTimer:function(A){this.stopTimer();this.timerInterval=Math.max(this.MIN_TIMER_INTERVAL,A);if(this.canvas!==null){this.timerId=window.setInterval($.proxy(this.onTimer,this),this.timerInterval)}return this},stopTimer:function(){if(this.timerId>=0){window.clearInterval(this.timerId);this.timerId=-1}},onTimer:function(){},installEditPolicy:function(A){if(A instanceof draw2d.policy.figure.SelectionFeedbackPolicy){this.editPolicy.grep($.proxy(function(C){var B=!(C instanceof draw2d.policy.figure.SelectionFeedbackPolicy);if(!B){C.onUninstall(this)}return B},this))}A.onInstall(this);this.editPolicy.add(A)},addFigure:function(B,A){B.setDraggable(false);B.setSelectable(false);B.setParent(this);this.children.add({figure:B,locator:A});if(this.canvas!==null){B.setCanvas(this.canvas)}this.repaint();return this},getChildren:function(){var A=new draw2d.util.ArrayList();this.children.each(function(B,C){A.add(C.figure)});return A},resetChildren:function(){this.children.each(function(A,B){B.figure.setCanvas(null)});this.children=new draw2d.util.ArrayList();this.repaint()},getShapeElement:function(){if(this.shape!==null){return this.shape}this.shape=this.createShapeElement();return this.shape},createShapeElement:function(){throw"Inherited class ["+this.NAME+"] must override the abstract method createShapeElement"},repaint:function(A){if(this.visible===true){this.shape.show()}else{this.shape.hide();return }A.opacity=this.alpha;this.shape.attr(A);this.applyTransformation();this.children.each(function(B,C){C.locator.relocate(B,C.figure)})},applyTransformation:function(){},setGlow:function(A){return this},onDragStart:function(B,A){this.isInDragDrop=false;this.isMoving=false;this.originalAlpha=this.getAlpha();this.command=this.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));if(this.command!==null){this.ox=this.x;this.oy=this.y;this.isInDragDrop=true;this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.onDragStart(this.canvas,this)}},this));return true}return false},onDrag:function(B,A){this.editPolicy.each($.proxy(function(E,F){if(F instanceof draw2d.policy.figure.DragDropEditPolicy){var D=F.adjustPosition(this,this.ox+B,this.oy+A);B=D.x-this.ox;A=D.y-this.oy}},this));this.x=this.ox+B;this.y=this.oy+A;if(this.getCanSnapToHelper()){var C=new draw2d.geo.Point(this.x,this.y);C=this.getCanvas().snapToHelper(this,C);this.x=C.x;this.y=C.y}this.setPosition(this.x,this.y);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){E.onDrag(this.canvas,this)}},this));if(this.isMoving===false){this.isMoving=true;this.setAlpha(this.originalAlpha*0.7)}},onPanning:function(B,A){},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.command.setPosition(this.x,this.y);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},onDragEnter:function(A){return null},onDragLeave:function(A){},onDrop:function(A){},onMouseEnter:function(){},onMouseLeave:function(){},onDoubleClick:function(){},onClick:function(){},onContextMenu:function(A,B){},setAlpha:function(A){A=Math.min(1,Math.max(0,parseFloat(A)));if(A===this.alpha){return }this.alpha=A;this.repaint();return this},getAlpha:function(){return this.alpha},setRotationAngle:function(A){this.rotationAngle=A;this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.repaint();return this},getRotationAngle:function(){return this.rotationAngle},setVisible:function(A){this.visible=!!A;this.repaint();return this},isVisible:function(){return this.visible&&this.shape!==null},getZOrder:function(){if(this.shape===null){return -1}var A=0;var B=this.shape.node;while((B=B.previousSibling)!==null){A++}return A},setCanSnapToHelper:function(A){this.canSnapToHelper=!!A;return this},getCanSnapToHelper:function(){return this.canSnapToHelper},getSnapToGridAnchor:function(){return this.snapToGridAnchor},setSnapToGridAnchor:function(A){this.snapToGridAnchor=A},getWidth:function(){return this.width},getHeight:function(){return this.height},getMinWidth:function(){return this.minWidth},setMinWidth:function(A){this.minWidth=parseFloat(A);return this},getMinHeight:function(){return this.minHeight;return this},setMinHeight:function(A){this.minHeight=parseFloat(A);return this},getX:function(){return this.x},getY:function(){return this.y},getAbsoluteX:function(){if(this.parent===null){return this.x||0}return this.x+this.parent.getAbsoluteX()},getAbsoluteY:function(){if(this.parent===null){return this.y||0}return this.y+this.parent.getAbsoluteY()},getAbsolutePosition:function(){return new draw2d.geo.Point(this.getAbsoluteX(),this.getAbsoluteY())},getAbsoluteBounds:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));this.fireMoveEvent();return this},getPosition:function(){return new draw2d.geo.Point(this.x,this.y)},translate:function(B,A){this.setPosition(this.x+B,this.y+A);return this},setDimension:function(A,B){A=Math.max(this.getMinWidth(),A);B=Math.max(this.getMinHeight(),B);if(this.width===A&&this.height===B){return }this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.figure.DragDropEditPolicy){var C=E.adjustDimension(this,A,B);A=C.w;B=C.h}},this));this.width=Math.max(this.getMinWidth(),A);this.height=Math.max(this.getMinHeight(),B);this.repaint();this.fireResizeEvent();this.fireMoveEvent();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getBoundingBox:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},hitTest:function(A,C,B){if(typeof B==="number"){return this.getBoundingBox().scale(B,B).hitTest(A,C)}return this.getBoundingBox().hitTest(A,C)},setDraggable:function(A){this.draggable=!!A;return this},isDraggable:function(){return this.draggable},isResizeable:function(){return this.resizeable},setResizeable:function(A){this.resizeable=!!A;return this},isSelectable:function(){return this.selectable},setSelectable:function(A){this.selectable=!!A;return this},isStrechable:function(){return true},isDeleteable:function(){return this.deleteable},setDeleteable:function(A){this.deleteable=!!A;return this},setParent:function(A){this.parent=A;return this},getParent:function(){return this.parent},attachResizeListener:function(A){if(A===null){return }this.resizeListener.add(A);return this},detachResizeListener:function(A){if(A===null){return }this.resizeListener.remove(A);return this},fireResizeEvent:function(){this.resizeListener.each($.proxy(function(A,B){B.onOtherFigureIsResizing(this)},this));return this},onOtherFigureIsResizing:function(A){},attachMoveListener:function(A){if(A===null){return }if(!this.moveListener.contains(A)){this.moveListener.add(A)}return this},detachMoveListener:function(A){if(A===null){return }this.moveListener.remove(A);return this},fireMoveEvent:function(){this.moveListener.each($.proxy(function(A,B){B.onOtherFigureIsMoving(this)},this));return this},onOtherFigureIsMoving:function(A){},createCommand:function(A){if(A===null){return null}if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMove(this)}if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(!this.isDeleteable()){return null}return new draw2d.command.CommandDelete(this)}if(A.getPolicy()===draw2d.command.CommandType.RESIZE){if(!this.isResizeable()){return null}return new draw2d.command.CommandResize(this)}return null},getPersistentAttributes:function(){var A={type:this.NAME,id:this.id,x:this.x,y:this.y,width:this.width,height:this.height};return A},setPersistentAttributes:function(A){this.id=A.id;this.x=A.x;this.y=A.y;if(typeof A.width!=="undefined"){this.width=A.width}if(typeof A.height!=="undefined"){this.height=A.height}return this},onRemove:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Node.js' */
(function ($) {draw2d.shape.node.Node=draw2d.Figure.extend({NAME:"draw2d.shape.node.Node",init:function(B,A){this.inputPorts=new draw2d.util.ArrayList();this.outputPorts=new draw2d.util.ArrayList();this.hybridPorts=new draw2d.util.ArrayList();this.portRelayoutRequired=true;this.cachedPorts=null;this._super(B,A)},onDoubleClick:function(){var A=this.getWidth();var B=this.getHeight();this.setRotationAngle((this.getRotationAngle()+90)%360);this.setDimension(B,A);this.portRelayoutRequired=true},getPorts:function(){if(this.cachedPorts===null){this.cachedPorts=new draw2d.util.ArrayList();this.cachedPorts.addAll(this.inputPorts);this.cachedPorts.addAll(this.outputPorts);this.cachedPorts.addAll(this.hybridPorts);this.children.each($.proxy(function(A,B){this.cachedPorts.addAll(B.figure.getPorts())},this))}return this.cachedPorts},getInputPorts:function(){return this.inputPorts.clone().addAll(this.hybridPorts)},getOutputPorts:function(){return this.outputPorts.clone().addAll(this.hybridPorts)},getPort:function(B){var A=null;this.getPorts().each(function(C,D){if(D.getName()===B){A=D;return false}});return A},getInputPort:function(C){if(typeof C==="number"){return this.inputPorts.get(C)}for(var B=0;B<this.inputPorts.getSize();B++){var A=this.inputPorts.get(B);if(A.getName()===C){return A}}return null},getOutputPort:function(C){if(typeof C==="number"){return this.outputPorts.get(C)}for(var B=0;B<this.outputPorts.getSize();B++){var A=this.outputPorts.get(B);if(A.getName()===C){return A}}return null},getHybridPort:function(C){if(typeof C==="number"){return this.hybridPorts.get(C)}for(var B=0;B<this.hybridPorts.getSize();B++){var A=this.hybridPorts.get(B);if(A.getName()===C){return A}}return null},addPort:function(B,A){if(!(B instanceof draw2d.Port)){throw"Argument is not typeof 'draw2d.Port'. \nFunction: draw2d.shape.node.Node#addPort"}this.cachedPorts=null;this.portRelayoutRequired=true;if(B instanceof draw2d.InputPort){this.inputPorts.add(B)}else{if(B instanceof draw2d.OutputPort){this.outputPorts.add(B)}else{if(B instanceof draw2d.HybridPort){this.hybridPorts.add(B)}}}if((typeof A!=="undefined")&&(A instanceof draw2d.layout.locator.Locator)){B.setLocator(A)}B.setParent(this);B.setCanvas(this.canvas);B.setDeleteable(false);if(this.canvas!==null){B.getShapeElement();this.canvas.registerPort(B)}},removePort:function(A){this.portRelayoutRequired=true;this.inputPorts.remove(A);this.outputPorts.remove(A);this.hybridPorts.remove(A);if(A.getCanvas()!==null){A.getCanvas().unregisterPort(A);var C=A.getConnections();for(var B=0;B<C.getSize();++B){A.getCanvas().removeFigure(C.get(B))}}A.setCanvas(null)},createPort:function(C,B){var A=null;var D=0;switch(C){case"input":A=new draw2d.InputPort();D=this.inputPorts.getSize();break;case"output":A=new draw2d.OutputPort();D=this.outputPorts.getSize();break;case"hybrid":A=new draw2d.HybridPort();D=this.hybridPorts.getSize();break;default:throw"Unknown type ["+C+"] of port requested"}A.setName(C+D);this.addPort(A,B);this.setDimension(this.width,this.height);return A},getConnections:function(){var D=new draw2d.util.ArrayList();var F=this.getPorts();for(var C=0;C<F.getSize();C++){var A=F.get(C);for(var E=0,B=A.getConnections().getSize();E<B;E++){if(!D.contains(A.getConnections().get(E))){D.add(A.getConnections().get(E))}}}return D},setCanvas:function(B){var A=this.canvas;this._super(B);var C=this.getPorts();if(A!==null){C.each(function(E,D){A.unregisterPort(D)})}if(B!==null){C.each(function(E,D){D.setCanvas(B);B.registerPort(D)});this.setDimension(this.width,this.height)}else{C.each(function(E,D){D.setCanvas(null)})}},setRotationAngle:function(A){this.portRelayoutRequired=true;this._super(A);this.layoutPorts()},setDimension:function(A,B){this.portRelayoutRequired=true;this._super(A,B)},onPortValueChanged:function(A){},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this._super(A);this.layoutPorts()},layoutPorts:function(){if(this.portRelayoutRequired===false){return }this.portRelayoutRequired=false;this.outputPorts.each(function(B,A){A.locator.relocate(B,A)});this.inputPorts.each(function(B,A){A.locator.relocate(B,A)});this.hybridPorts.each(function(B,A){A.locator.relocate(B,A)})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/VectorFigure.js' */
(function ($) {draw2d.VectorFigure=draw2d.shape.node.Node.extend({NAME:"draw2d.VectorFigure",init:function(){this.stroke=1;this.bgColor=new draw2d.util.Color(255,255,255);this.lineColor=new draw2d.util.Color(128,128,255);this.color=new draw2d.util.Color(128,128,128);this.strokeBeforeGlow=this.stroke;this.glowIsActive=false;this._super()},setGlow:function(A){if(A===this.glowIsActive){return this}this.glowIsActive=A;if(A===true){this.strokeBeforeGlow=this.getStroke();this.setStroke(this.strokeBeforeGlow*2.5)}else{this.setStroke(this.strokeBeforeGlow)}return this},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();if(typeof A.stroke==="undefined"){if(this.color===null||this.stroke===0){A.stroke="none"}else{A.stroke=this.color.hash()}}A["stroke-width"]=this.stroke;if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)},setBackgroundColor:function(A){this.bgColor=new draw2d.util.Color(A);this.repaint();return this},getBackgroundColor:function(){return this.bgColor},setStroke:function(A){this.stroke=A;this.repaint();return this},getStroke:function(){return this.stroke},setColor:function(A){this.color=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.color}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Rectangle.js' */
(function ($) {draw2d.shape.basic.Rectangle=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Rectangle",init:function(B,A){this.radius=2;this.dasharray=null;this._super();this.setBackgroundColor(new draw2d.util.Color(100,100,100));this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}A.width=this.getWidth();A.height=this.getHeight();A.r=this.radius;this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);if(this.getRotationAngle()===90||this.getRotationAngle()===270){var B=this.getHeight()/this.getWidth();var A="...S"+B+","+1/B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.shape.transform(A)}},createShapeElement:function(){return this.canvas.paper.rect(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setRadius:function(A){this.radius=A;this.repaint()},getRadius:function(){return this.radius},setDashArray:function(A){this.dasharray=A},getPersistentAttributes:function(){var A=this._super();A.radius=this.radius;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.radius==="number"){this.radius=A.radius}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SetFigure.js' */
(function ($) {draw2d.SetFigure=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.SetFigure",init:function(B,A){this.svgNodes=null;this.originalWidth=null;this.originalHeight=null;this.scaleX=1;this.scaleY=1;this._super(B,A);this.setStroke(0);this.setBackgroundColor(null)},setCanvas:function(A){if(A===null&&this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=null}this._super(A)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.originalWidth!==null){this.scaleX=this.width/this.originalWidth;this.scaleY=this.height/this.originalHeight}if(typeof A==="undefined"){A={}}if(this.visible===true){this.svgNodes.show()}else{this.svgNodes.hide()}this._super(A)},applyTransformation:function(){var D="S"+this.scaleX+","+this.scaleY+",0,0 R"+this.rotationAngle+","+((this.getWidth()/2)|0)+","+((this.getHeight()/2)|0)+"T"+this.getAbsoluteX()+","+this.getAbsoluteY()+"";this.svgNodes.transform(D);if(this.rotationAngle===90||this.rotationAngle===270){var E=this.svgNodes.getBBox(true);var C=E.height/E.width;var B=E.width/E.height;var A="...S"+C+","+B+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.svgNodes.transform(A)}},createShapeElement:function(){var A=this.canvas.paper.rect(this.getX(),this.getY(),this.getWidth(),this.getHeight());this.svgNodes=this.createSet();var B=this.svgNodes.getBBox();this.originalWidth=B.width;this.originalHeight=B.height;return A},createSet:function(){return this.canvas.paper.set()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/SVGFigure.js' */
(function ($) {draw2d.SVGFigure=draw2d.SetFigure.extend({NAME:"draw2d.SVGFigure",init:function(B,A){this._super(B,A)},createSet:function(){return this.importSVG(this.canvas,this.getSVG())},importSVG:function(C,A){var F=C.paper.set();try{if(typeof A==="undefined"){throw"No data was provided."}var E=$(A);if(E.attr("width")&&E.attr("height")){this.setDimension(E.attr("width"),E.attr("height"))}var D=new RegExp("([a-z0-9-]+) ?: ?([^ ;]+)[ ;]?","gi");E.children().each(function(K,L){var N=null;var G=null;var O={};var I=L.tagName;var M=I.indexOf(":");if(M!=-1){I=I.substr(M+1)}$(L.attributes).each(function(){switch(this.nodeName){case"stroke-dasharray":O[this.nodeName]="- ";break;case"style":G=this.nodeValue;break;case"id":case"xml:space":break;default:O[this.nodeName]=this.nodeValue;break}});if(G!==null){while(D.exec(G)){O[RegExp.$1]=RegExp.$2}}if(typeof O["stroke-width"]==="undefined"){O["stroke-width"]=(typeof O.stroke==="undefined"?0:1.2)}switch(I){case"rect":N=C.paper.rect();break;case"circle":N=C.paper.circle();break;case"ellipse":N=C.paper.ellipse();break;case"path":O.fill="none";N=C.paper.path(O.d);break;case"line":O.d="M "+O.x1+" "+O.y1+"L"+O.x2+" "+O.y2;O.fill="none";N=C.paper.path(O.d);break;case"polyline":var Q=O.points;O.d="M "+Q.replace(" "," L");N=C.paper.path(O.d);break;case"polygon":N=C.paper.polygon(O.points);break;case"image":N=C.paper.image();break;case"tspan":case"text":if(L.childNodes.length>0){var H=L.firstChild;do{switch(H.nodeType){case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:return ;case 1:}var J=C.paper.text(0,0,$(H).text());var P={x:parseFloat(H.attributes.x.value),y:parseFloat(H.attributes.y.value)};P["text-anchor"]="start";if(typeof H.attributes["font-size"]!=="undefined"){P["font-size"]=parseInt(H.attributes["font-size"].value)}else{if(typeof O["font-size"]!=="undefined"){P["font-size"]=parseInt(O["font-size"])}}if(typeof H.attributes["font-family"]!=="undefined"){P["font-family"]=H.attributes["family-family"].value}else{if(typeof O["font-family"]!=="undefined"){P["font-family"]=O["font-family"]}}P.fill="#000000";if(typeof H.attributes.fill!=="undefined"){P.fill=H.attributes.fill.value}else{if(typeof O.fill!=="undefined"){P.fill=O.fill}}P.y=P.y+J.getBBox().height/2;J.attr(P);F.push(J)}while(H=H.nextSibling)}else{N=C.paper.text(0,0,$(L).html());if(typeof O.fill==="undefined"){O.fill="#000000"}if(typeof O["text-anchor"]==="undefined"){O["text-anchor"]="start"}if(typeof O["font-size"]!=="undefined"){O["font-size"]=parseInt(O["font-size"])}if(typeof O["font-family"]!=="undefined"){O["font-family"]=parseInt(O["font-family"])}O.y=parseFloat(O.y)+N.getBBox().height/2}break}if(N!==null){N.attr(O);F.push(N)}})}catch(B){alert("The SVG data you entered was invalid! ("+B+")")}return F}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Hub.js' */
(function ($) {draw2d.shape.node.Hub=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Hub",DEFAULT_COLOR:new draw2d.util.Color("#4DF0FE"),BACKGROUND_COLOR:new draw2d.util.Color("#29AA77"),init:function(C,A,B){this.label=null;this._super(C,A);this.port=this.createPort("hybrid",new draw2d.layout.locator.CenterLocator(this));this.CONNECTION_DIR_STRATEGY=[$.proxy(function(E,D){return this.getParent().getBoundingBox().getDirection(D.getAbsolutePosition())},this.port),$.proxy(function(E,D){return this.getAbsoluteY()>D.getAbsoluteY()?0:2},this.port),$.proxy(function(E,D){return this.getAbsoluteX()>D.getAbsoluteX()?3:1},this.port)];this.port.setGlow=$.proxy(this.setGlow,this);this.port._orig_hitTest=this.port.hitTest;this.port.hitTest=$.proxy(this.hitTest,this);this.port.setConnectionAnchor(new draw2d.layout.anchor.ShortesPathConnectionAnchor(this.port));this.port.setVisible(false);if(typeof A==="undefined"){this.setDimension(150,50)}this.setConnectionDirStrategy(0);this.setColor(this.DEFAULT_COLOR.darker());this.setBackgroundColor(this.BACKGROUND_COLOR);if(typeof B!=="undefined"){this.label=new draw2d.shape.basic.Label(B);this.label.setColor("#0d0d0d");this.label.setFontColor("#0d0d0d");this.label.setStroke(0);this.addFigure(this.label,new draw2d.layout.locator.CenterLocator(this))}},onDragEnter:function(A){return this.getHybridPort(0).onDragEnter(A)},getMinWidth:function(){if(this.label!==null){return Math.max(this.label.getMinWidth(),this._super())}else{return this._super()}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){if(this.bgColor!==null){A.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95"}else{A.fill="none"}}this._super(A)},setConnectionDirStrategy:function(A){switch(A){case 0:case 1:case 2:this.port.getConnectionDirection=this.CONNECTION_DIR_STRATEGY[A];break}},getPersistentAttributes:function(){var A=this._super();A.dirStrategy=this.CONNECTION_DIR_STRATEGY.indexOf(this.port.getConnectionDirection);return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.dirStrategy==="number"){this.setConnectionDirStrategy(A.dirStrategy)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/HorizontalBus.js' */
(function ($) {draw2d.shape.node.HorizontalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.HorizontalBus",init:function(C,A,B){this._super(C,A,B);this.setConnectionDirStrategy(1);this.installEditPolicy(new draw2d.policy.figure.HBusSelectionFeedbackPolicy())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/VerticalBus.js' */
(function ($) {draw2d.shape.node.VerticalBus=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.VerticalBus",init:function(C,A,B){this._super(C,A,B);if(this.label!==null){this.label.setRotationAngle(90)}this.setConnectionDirStrategy(2);this.installEditPolicy(new draw2d.policy.figure.VBusSelectionFeedbackPolicy())},getMinHeight:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinWidth()},getMinWidth:function(){if(this.shape===null&&this.label===null){return 0}return this.label.getMinHeight()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Fulcrum.js' */
(function ($) {draw2d.shape.node.Fulcrum=draw2d.shape.node.Hub.extend({NAME:"draw2d.shape.node.Fulcrum",init:function(){this._super(40,40);this.port.setConnectionAnchor(new draw2d.layout.anchor.ConnectionAnchor(this.port));this.port.setVisible(true);this.port.hitTest=this.port._orig_hitTest;this.setConnectionDirStrategy(0);this.setColor(null);this.setRadius(10);this.setBackgroundColor(null);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill=this.bgColor.hash()}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Oval.js' */
(function ($) {draw2d.shape.basic.Oval=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Oval",init:function(B,A){this._super();this.setBackgroundColor("#C02B1D");this.setColor("#1B1B1B");if((typeof A==="number")&&(typeof B==="number")){this.setDimension(B,A)}else{this.setDimension(50,50)}},createShapeElement:function(){var A=this.getWidth()/2;var B=this.getHeight()/2;return this.canvas.paper.ellipse(this.getAbsoluteX()+A,this.getAbsoluteY()+B,A,B)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(typeof A.rx==="undefined"){A.rx=this.width/2;A.ry=this.height/2}if(typeof A.cx==="undefined"){A.cx=this.getAbsoluteX()+A.rx;A.cy=this.getAbsoluteY()+A.ry}this._super(A)},intersectionWithLine:function(S,Q){var D=this.getWidth()/2;var C=this.getHeight()/2;var G=new draw2d.util.ArrayList();var R=new draw2d.geo.Point(S.x,S.y);var J=Q.subtract(S);var O=new draw2d.geo.Point(this.getAbsoluteX()+D,this.getAbsoluteY()+C);var I=R.subtract(O);var B=new draw2d.geo.Point(J.x/(D*D),J.y/(C*C));var A=new draw2d.geo.Point(I.x/(D*D),I.y/(C*C));var P=J.dot(B);var N=J.dot(A);var M=I.dot(A)-1;var L=N*N-P*M;if(L<0){}else{if(L>0){var K=Math.sqrt(L);var F=(-N-K)/P;var E=(-N+K)/P;if((F<0||1<F)&&(E<0||1<E)){if((F<0&&E<0)||(F>1&&E>1)){}else{}}else{if(0<=F&&F<=1){G.add(S.lerp(Q,F))}if(0<=E&&E<=1){G.add(S.lerp(Q,E))}}}else{var H=-N/P;if(0<=H&&H<=1){G.add(S.lerp(Q,H))}else{}}}return G}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Circle.js' */
(function ($) {draw2d.shape.basic.Circle=draw2d.shape.basic.Oval.extend({NAME:"draw2d.shape.basic.Circle",init:function(A){this._super();if(typeof A==="number"){this.setDimension(A,A)}else{this.setDimension(40,40)}},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}},isStrechable:function(){return false}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Label.js' */
(function ($) {draw2d.shape.basic.Label=draw2d.SetFigure.extend({NAME:"draw2d.shape.basic.Label",FONT_FALLBACK:{Georgia:"Georgia, serif","Palatino Linotype":'"Palatino Linotype", "Book Antiqua", Palatino, serif',"Times New Roman":'"Times New Roman", Times, serif',Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Gadget, sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',Impact:"Impact, Charcoal, sans-serif","Lucida Sans Unicode":'"Lucida Sans Unicode", "Lucida Grande", sans-serif',"Tahoma, Geneva":"Tahoma, Geneva, sans-seri","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',Verdana:"Verdana, Geneva, sans-serif","Courier New":'"Courier New", Courier, monospace',"Lucida Console":'"Lucida Console", Monaco, monospace'},init:function(A){this._super();if(typeof A==="string"){this.text=A}else{this.text=""}this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=12;this.fontColor=new draw2d.util.Color("#080808");this.fontFamily=null;this.padding=4;this.bold=false;this.setStroke(1);this.setDimension(10,10);this.editor=null;this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},createSet:function(){return this.canvas.paper.text(0,0,this.text)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;var B={};B.text=this.text;B.x=this.padding+this.getStroke();B.y=this.getHeight()/2;B["font-weight"]=(this.bold===true)?"bold":"normal";B["text-anchor"]="start";B["font-size"]=this.fontSize;if(this.fontFamily!==null){B["font-family"]=this.fontFamily}B.fill=this.fontColor.hash();this.svgNodes.attr(B);this._super(A)},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle);this.svgNodes.transform("R"+this.rotationAngle+"T"+this.getAbsoluteX()+","+this.getAbsoluteY())},isResizeable:function(){return false},setFontSize:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.fontSize=A;this.repaint()},setBold:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.bold=A;this.repaint()},setFontColor:function(A){this.fontColor=new draw2d.util.Color(A);this.repaint()},getFontColor:function(){return this.fontColor},setPadding:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;this.padding=A;this.repaint()},setFontFamily:function(A){this.cachedMinWidth=null;this.cachedMinHeight=null;this.cachedWidth=null;this.cachedHeight=null;if(this.FONT_FALLBACK[A]!=="undefined"){A=this.FONT_FALLBACK[A]}this.fontFamily=A;this.repaint()},setDimension:function(A,B){this.cachedWidth=null;this.cachedHeight=null;this._super(A,B)},getMinWidth:function(){if(this.shape===null){return 0}if(this.cachedMinWidth===null){this.cachedMinWidth=this.svgNodes.getBBox(true).width+2*this.padding+2*this.getStroke()}return this.cachedMinWidth},getMinHeight:function(){if(this.shape===null){return 0}if(this.cachedMinHeight===null){this.cachedMinHeight=this.svgNodes.getBBox(true).height+2*this.padding+2*this.getStroke()}return this.cachedMinHeight},getWidth:function(){if(this.shape===null){return 0}if(this.cachedWidth===null){this.cachedWidth=Math.max(this.width,this.getMinWidth())}return this.cachedWidth},getHeight:function(){if(this.shape===null){return 0}if(this.cachedHeight===null){this.cachedHeight=Math.max(this.height,this.getMinHeight())}return this.cachedHeight},installEditor:function(A){this.editor=A},onDoubleClick:function(){if(this.editor!==null){this.editor.start(this)}},getText:function(){return this.text},setText:function(A){this.cachedWidth=null;this.cachedHeight=null;this.cachedMinWidth=null;this.cachedMinHeight=null;this.text=A;this.repaint();this.editPolicy.each($.proxy(function(B,C){if(C instanceof draw2d.policy.figure.DragDropEditPolicy){C.moved(this.canvas,this)}},this));this.fireResizeEvent();if(this.parent!==null){this.parent.repaint()}},hitTest:function(I,F){if(this.rotationAngle===0){return this._super(I,F)}var H=this.shape.matrix;var J=this.getBoundingBox().getPoints();J.each(function(M,L){var K=H.x(L.x,L.y);var N=H.y(L.x,L.y);L.x=K;L.y=N});var A=4;var D=0;var B=A-1;var G=false;for(D=0;D<A;D++){var E=J.get(D);var C=J.get(B);if((E.y<F&&C.y>=F||C.y<F&&E.y>=F)&&(E.x<=I||C.x<=I)){if(E.x+(F-E.y)/(C.y-E.y)*(C.x-E.x)<I){G=!G}}B=D}return G},getPersistentAttributes:function(){var A=this._super();A.text=this.text;A.fontSize=this.fontSize;A.fontColor=this.fontColor.hash();A.fontFamily=this.fontFamily;return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.text!=="undefined"){this.setText(A.text)}if(typeof A.fontFamily!=="undefined"){this.setFontFamily(A.fontFamily)}if(typeof A.fontSize!=="undefined"){this.setFontSize(A.fontSize)}if(typeof A.fontColor!=="undefined"){this.setFontColor(A.fontColor)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Line.js' */
(function ($) {draw2d.shape.basic.Line=draw2d.Figure.extend({NAME:"draw2d.shape.basic.Line",DEFAULT_COLOR:new draw2d.util.Color(0,0,0),init:function(B,A,D,C){this.repaintBlocked=false;this.corona=10;this.isGlowing=false;this.lineColor=this.DEFAULT_COLOR;this.stroke=1;this.dasharray=null;if(typeof C==="number"){this.startX=B;this.startY=A;this.endX=D;this.endY=C}else{this.startX=30;this.startY=30;this.endX=100;this.endY=100}this._super();this.installEditPolicy(new draw2d.policy.figure.LineSelectionFeedbackPolicy());this.setSelectable(true);this.setDeleteable(true)},onDragEnd:function(){this.setAlpha(this.originalAlpha);this.isInDragDrop=false;this.canvas.getCommandStack().execute(this.command);this.command=null;this.isMoving=false;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.fireMoveEvent()},setDashArray:function(A){this.dasharray=A;return this},setCoronaWidth:function(A){this.corona=A;return this},createShapeElement:function(){return this.canvas.paper.path("M"+this.getStartX()+" "+this.getStartY()+"L"+this.getEndX()+" "+this.getEndY())},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={stroke:"#"+this.lineColor.hex(),"stroke-width":this.stroke,path:["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}}else{if(typeof A.path==="undefined"){A.path=["M",this.getStartX(),this.getStartY(),"L",this.getEndX(),this.getEndY()].join(" ")}A.stroke=this.lineColor.hash();A["stroke-width"]=this.stroke}if(this.dasharray!==null){A["stroke-dasharray"]=this.dasharray}this._super(A)},setGlow:function(A){if(this.isGlowing===A){return }if(A===true){this._lineColor=this.lineColor;this._stroke=this.stroke;this.setColor(draw2d.util.Color("#3f72bf"));this.setStroke((this.stroke*4)|0)}else{this.setColor(this._lineColor);this.setStroke(this._stroke)}this.isGlowing=A;return this},isResizeable:function(){return true},setStroke:function(A){this.stroke=A;this.repaint();return this},setColor:function(A){this.lineColor=new draw2d.util.Color(A);this.repaint();return this},getColor:function(){return this.lineColor},setStartPoint:function(A,B){if(this.startX===A&&this.startY===B){return }this.startX=A;this.startY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},setEndPoint:function(A,B){if(this.endX===A&&this.endY===B){return }this.endX=A;this.endY=B;this.repaint();this.editPolicy.each($.proxy(function(C,D){if(D instanceof draw2d.policy.figure.DragDropEditPolicy){D.moved(this.canvas,this)}},this));return this},getStartX:function(){return this.startX},getStartY:function(){return this.startY},getStartPoint:function(){return new draw2d.geo.Point(this.startX,this.startY)},getEndX:function(){return this.endX},getEndY:function(){return this.endY},getEndPoint:function(){return new draw2d.geo.Point(this.endX,this.endY)},getSegments:function(){var A=new draw2d.util.ArrayList();A.add({start:this.getStartPoint(),end:this.getEndPoint()});return A},getLength:function(){if(this.shape!==null){return this.shape.getTotalLength()}return Math.sqrt((this.startX-this.endX)*(this.startX-this.endX)+(this.startY-this.endY)*(this.startY-this.endY))},getAngle:function(){var A=this.getLength();var B=-(180/Math.PI)*Math.asin((this.startY-this.endY)/A);if(B<0){if(this.endX<this.startX){B=Math.abs(B)+180}else{B=360-Math.abs(B)}}else{if(this.endX<this.startX){B=180-B}}return B},createCommand:function(E){if(E.getPolicy()===draw2d.command.CommandType.MOVE){var B=this.getStartX();var D=this.getStartY();var A=this.getEndX();var C=this.getEndY();return new draw2d.command.CommandMoveLine(this,B,D,A,C)}if(E.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===false){return null}return new draw2d.command.CommandDelete(this)}return null},hitTest:function(B,A){return draw2d.shape.basic.Line.hit(this.corona,this.startX,this.startY,this.endX,this.endY,B,A)},intersection:function(B){var A=new draw2d.util.ArrayList();if(B===this){return A}var D=this.getSegments();var C=B.getSegments();D.each(function(F,E){C.each(function(H,G){var I=draw2d.shape.basic.Line.intersection(E.start,E.end,G.start,G.end);if(I!==null){A.add(I)}})});return A},getPersistentAttributes:function(){var A=this._super();delete A.x;delete A.y;delete A.width;delete A.height;A.stroke=this.stroke;A.color=this.getColor().hash();return A},setPersistentAttributes:function(A){this._super(A);if(typeof A.stroke!=="undefined"){this.setStroke(parseInt(A.stroke))}if(typeof A.color!=="undefined"){this.setColor(A.color)}}});draw2d.shape.basic.Line.intersection=function(E,C,I,H){var J=null;var F=(H.x-I.x)*(E.y-I.y)-(H.y-I.y)*(E.x-I.x);var G=(C.x-E.x)*(E.y-I.y)-(C.y-E.y)*(E.x-I.x);var D=(H.y-I.y)*(C.x-E.x)-(H.x-I.x)*(C.y-E.y);if(D!=0){var B=F/D;var A=G/D;if(0<=B&&B<=1&&0<=A&&A<=1){J=new draw2d.geo.Point((E.x+B*(C.x-E.x))|0,(E.y+B*(C.y-E.y))|0);J.justTouching=(0==B||B==1||0==A||A==1)}}return J};draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){A=0}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){A=0}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D};}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/PolyLine.js' */
(function ($) {draw2d.shape.basic.PolyLine=draw2d.shape.basic.Line.extend({NAME:"draw2d.shape.basic.PolyLine",init:function(){this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this._super()},setStartPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},setEndPoint:function(A,B){this.repaintBlocked=true;this._super(A,B);this.calculatePath();this.repaintBlocked=false;this.repaint()},calculatePath:function(){if(this.shape===null){return }this.svgPathString=null;this.oldPoint=null;this.lineSegments=new draw2d.util.ArrayList();this.basePoints=new draw2d.util.ArrayList();this.router.route(this);this.routingRequired=false},repaint:function(){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgPathString===null||this.routingRequired===true){this.calculatePath()}this._super({path:this.svgPathString,"stroke-linejoin":"round"})},onDragEnter:function(A){this.setGlow(true);return this},onDragLeave:function(A){this.setGlow(false)},getPoints:function(){return this.basePoints},getSegments:function(){return this.lineSegments},addPoint:function(A,B){if(typeof B!=="undefined"){A=new draw2d.geo.Point(A,B)}this.basePoints.add(A);if(this.oldPoint!==null){this.lineSegments.add({start:this.oldPoint,end:A})}this.svgPathString=null;this.oldPoint=A},onOtherFigureIsMoving:function(A){this.repaintBlocked=true;this._super(A);this.calculatePath();this.repaintBlocked=false;this.repaint()},hitTest:function(D,B){for(var C=0;C<this.lineSegments.getSize();C++){var A=this.lineSegments.get(C);if(draw2d.shape.basic.Line.hit(this.corona,A.start.x,A.start.y,A.end.x,A.end.y,D,B)){return true}}return false},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===true){return new draw2d.command.CommandDelete(this)}}return null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Diamond.js' */
(function ($) {draw2d.shape.basic.Diamond=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Diamond",init:function(B,A){this._super();this.setBackgroundColor("#00a3f6");this.setColor("#1B1B1B");if(typeof B==="undefined"){this.setDimension(50,90)}else{this.setDimension(B,A)}},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}var B=this.getBoundingBox();var C=["M",B.x+(B.w/2)," ",B.y];C.push("L",B.x+B.w," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y+B.h);C.push("L",B.x," ",B.y+B.h/2);C.push("L",B.x+B.w/2," ",B.y);A.path=C.join("");this._super(A)},createShapeElement:function(){return this.canvas.paper.path("M0 0L1 1")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/basic/Image.js' */
(function ($) {draw2d.shape.basic.Image=draw2d.shape.node.Node.extend({NAME:"draw2d.shape.basic.Image",init:function(C,B,A){this._super(B,A);this.path=C},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.x=this.getAbsoluteX();A.y=this.getAbsoluteY();A.width=this.getWidth();A.height=this.getHeight();this._super(A)},createShapeElement:function(){return this.canvas.paper.image(this.path,this.getX(),this.getY(),this.getWidth(),this.getHeight())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Connection.js' */
(function ($) {draw2d.Connection=draw2d.shape.basic.PolyLine.extend({NAME:"draw2d.Connection",init:function(A){this._super();this.sourcePort=null;this.targetPort=null;this.oldPoint=null;this.sourceDecorator=null;this.targetDecorator=null;this.sourceDecoratorNode=null;this.targetDecoratorNode=null;this.router=A||draw2d.Connection.DEFAULT_ROUTER;this.setColor("#1B1B1B");this.setStroke(1)},disconnect:function(){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.fireTargetPortRouteEvent()}},reconnect:function(){if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.fireSourcePortRouteEvent()}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.fireTargetPortRouteEvent()}this.onReconnect(this.getSourcePort(),this.getTargetPort());this.routingRequired=true;this.repaint()},isResizeable:function(){return this.isDraggable()},addFigure:function(B,A){if(!(A instanceof draw2d.layout.locator.ConnectionLocator)){throw"Locator must implement the class draw2d.layout.locator.ConnectionLocator"}this._super(B,A)},setSourceDecorator:function(A){this.sourceDecorator=A;this.routingRequired=true;if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}this.repaint()},getSourceDecorator:function(){return this.sourceDecorator},setTargetDecorator:function(A){this.targetDecorator=A;this.routingRequired=true;if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}this.repaint()},getTargetDecorator:function(){return this.targetDecorator},setRouter:function(A){if(typeof A==="undefined"||A===null){this.router=new draw2d.layout.connection.NullRouter()}else{this.router=A}this.routingRequired=true;this.repaint()},getRouter:function(){return this.router},calculatePath:function(){if(this.sourcePort===null||this.targetPort===null){return }this._super()},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(this.sourcePort===null||this.targetPort===null){return }this._super(B);if(this.getSource().getParent().isMoving===false&&this.getTarget().getParent().isMoving===false){if(this.targetDecorator!==null&&this.targetDecoratorNode===null){this.targetDecoratorNode=this.targetDecorator.paint(this.getCanvas().paper)}if(this.sourceDecorator!==null&&this.sourceDecoratorNode===null){this.sourceDecoratorNode=this.sourceDecorator.paint(this.getCanvas().paper)}}if(this.sourceDecoratorNode!==null){var C=this.getPoints().get(0);this.sourceDecoratorNode.transform("r"+this.getStartAngle()+","+C.x+","+C.y+" t"+C.x+","+C.y)}if(this.targetDecoratorNode!==null){var A=this.getPoints().getLastElement();this.targetDecoratorNode.transform("r"+this.getEndAngle()+","+A.x+","+A.y+" t"+A.x+","+A.y)}},getAbsoluteX:function(){return 0},getAbsoluteY:function(){return 0},postProcess:function(A){this.router.postProcess(this,this.getCanvas(),A)},onDragEnter:function(A){if(A instanceof draw2d.shape.basic.LineResizeHandle){return null}return this},onDragLeave:function(A){},getStartPoint:function(){if(this.isMoving===false){return this.sourcePort.getConnectionAnchorLocation(this.targetPort.getConnectionAnchorReferencePoint())}else{return this._super()}},getEndPoint:function(){if(this.isMoving===false){return this.targetPort.getConnectionAnchorLocation(this.sourcePort.getConnectionAnchorReferencePoint())}else{return this._super()}},setSource:function(A){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}this.sourcePort=A;if(this.sourcePort===null){return }this.routingRequired=true;this.fireSourcePortRouteEvent();this.sourcePort.attachMoveListener(this);if(this.canvas!==null){this.sourcePort.onConnect(this)}this.setStartPoint(A.getAbsoluteX(),A.getAbsoluteY())},getSource:function(){return this.sourcePort},setTarget:function(A){if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}this.targetPort=A;if(this.targetPort===null){return }this.routingRequired=true;this.fireTargetPortRouteEvent();this.targetPort.attachMoveListener(this);if(this.canvas!==null){this.targetPort.onConnect(this)}this.setEndPoint(A.getAbsoluteX(),A.getAbsoluteY())},getTarget:function(){return this.targetPort},sharingPorts:function(A){return this.sourcePort==A.sourcePort||this.sourcePort==A.targetPort||this.targetPort==A.sourcePort||this.targetPort==A.targetPort},setCanvas:function(A){this._super(A);if(this.sourceDecoratorNode!==null){this.sourceDecoratorNode.remove();this.sourceDecoratorNode=null}if(this.targetDecoratorNode!==null){this.targetDecoratorNode.remove();this.targetDecoratorNode=null}if(this.canvas===null){if(this.sourcePort!==null){this.sourcePort.detachMoveListener(this);this.sourcePort.onDisconnect(this)}if(this.targetPort!==null){this.targetPort.detachMoveListener(this);this.targetPort.onDisconnect(this)}}else{if(this.sourcePort!==null){this.sourcePort.attachMoveListener(this);this.sourcePort.onConnect(this)}if(this.targetPort!==null){this.targetPort.attachMoveListener(this);this.targetPort.onConnect(this)}}},onOtherFigureIsMoving:function(A){if(A===this.sourcePort){this.setStartPoint(this.sourcePort.getAbsoluteX(),this.sourcePort.getAbsoluteY())}else{this.setEndPoint(this.targetPort.getAbsoluteX(),this.targetPort.getAbsoluteY())}this._super(A)},getStartAngle:function(){if(this.lineSegments.getSize()===0){return 0}var D=this.lineSegments.get(0).start;var B=this.lineSegments.get(0).end;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},getEndAngle:function(){if(this.lineSegments.getSize()===0){return 90}var D=this.lineSegments.get(this.lineSegments.getSize()-1).end;var B=this.lineSegments.get(this.lineSegments.getSize()-1).start;if(this.router instanceof draw2d.layout.connection.SplineConnectionRouter){B=this.lineSegments.get(this.lineSegments.getSize()-5).end}var A=Math.sqrt((D.x-B.x)*(D.x-B.x)+(D.y-B.y)*(D.y-B.y));var C=-(180/Math.PI)*Math.asin((D.y-B.y)/A);if(C<0){if(B.x<D.x){C=Math.abs(C)+180}else{C=360-Math.abs(C)}}else{if(B.x<D.x){C=180-C}}return C},fireSourcePortRouteEvent:function(){var B=this.sourcePort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},fireTargetPortRouteEvent:function(){var B=this.targetPort.getConnections();for(var A=0;A<B.getSize();A++){B.get(A).repaint()}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE_BASEPOINT){return new draw2d.command.CommandReconnect(this)}return this._super(A)},getPersistentAttributes:function(){var B=this._super();var A=this.getSource().getParent();while(A.getParent()!==null){A=A.getParent()}B.source={node:A.getId(),port:this.getSource().getName()};var A=this.getTarget().getParent();while(A.getParent()!==null){A=A.getParent()}B.target={node:A.getId(),port:this.getTarget().getName()};B.router=this.router.NAME;return B},setPersistentAttributes:function(memento){this._super(memento);if(typeof memento.router!=="undefined"){this.setRouter(eval("new "+memento.router+"()"))}},onReconnect:function(A,B){}});draw2d.Connection.createConnection=function(A,B){return new draw2d.Connection()};draw2d.Connection.DEFAULT_ROUTER=new draw2d.layout.connection.ManhattanConnectionRouter();}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ResizeHandle.js' */
(function ($) {draw2d.ResizeHandle=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.ResizeHandle",DEFAULT_COLOR:"#00bdee",init:function(A,B){this._super();this.isResizeHandle=true;this.owner=A;this.type=B;this.command=null;this.commandMove=null;this.commandResize=null;this.setDimension();this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor("#7A7A7A");this.setStroke(1);this.setSelectable(false);this.setRadius(0)},select:function(A){},unselect:function(){},getSnapToDirection:function(){switch(this.type){case 1:return draw2d.SnapToHelper.NORTH_WEST;case 2:return draw2d.SnapToHelper.NORTH;case 3:return draw2d.SnapToHelper.NORTH_EAST;case 4:return draw2d.SnapToHelper.EAST;case 5:return draw2d.SnapToHelper.SOUTH_EAST;case 6:return draw2d.SnapToHelper.SOUTH;case 7:return draw2d.SnapToHelper.SOUTH_WEST;case 8:return draw2d.SnapToHelper.WEST;case 9:return draw2d.SnapToHelper.NSEW;default:return draw2d.SnapToHelper.EAST}},createShapeElement:function(){var A=this._super();switch(this.type){case 1:A.attr({cursor:"nw-resize"});break;case 2:A.attr({cursor:"n-resize"});break;case 3:A.attr({cursor:"ne-resize"});break;case 4:A.attr({cursor:"e-resize"});break;case 5:A.attr({cursor:"se-resize"});break;case 6:A.attr({cursor:"s-resize"});break;case 7:A.attr({cursor:"sw-resize"});break;case 8:A.attr({cursor:"w-resize"});break}return A},onDragStart:function(){if(!this.isDraggable()){return false}this.ox=this.getAbsoluteX();this.oy=this.getAbsoluteY();this.commandMove=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE));this.commandResize=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.RESIZE));return true},onDrag:function(K,J){if(this.isDraggable()===false){return }var I=this.getAbsoluteX();var H=this.getAbsoluteY();this._super(K,J);var F=this.getAbsoluteX()-I;var D=this.getAbsoluteY()-H;var A=this.owner;var C=A.getAbsoluteX();var B=A.getAbsoluteY();var E=A.getWidth();var G=A.getHeight();switch(this.type){case 1:A.setDimension(E-F,G-D);A.setPosition(C+(E-A.getWidth()),B+(G-A.getHeight()));break;case 2:A.setDimension(E,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 3:A.setDimension(E+F,G-D);A.setPosition(C,B+(G-A.getHeight()));break;case 4:A.setDimension(E+F,G);break;case 5:A.setDimension(E+F,G+D);break;case 6:A.setDimension(E,G+D);break;case 7:A.setDimension(E-F,G+D);A.setPosition(C+(E-A.getWidth()),B);break;case 8:A.setDimension(E-F,G);A.setPosition(C+(E-A.getWidth()),B);break}},onDragEnd:function(){if(!this.isDraggable()){return }if(this.commandMove!==null){this.commandMove.setPosition(this.owner.getX(),this.owner.getY());this.canvas.getCommandStack().execute(this.commandMove);this.commandMove=null}if(this.commandResize!==null){this.commandResize.setDimension(this.owner.getWidth(),this.owner.getHeight());this.canvas.getCommandStack().execute(this.commandResize);this.commandResize=null}this.canvas.hideSnapToHelperLines()},setPosition:function(A,B){if(A instanceof draw2d.geo.Point){this.x=A.x;this.y=A.y}else{this.x=A;this.y=B}this.repaint()},setDimension:function(C,A){if(typeof A!=="undefined"){this._super(C,A)}else{if(draw2d.isTouchDevice){this._super(15,15)}else{this._super(8,8)}}var D=this.getWidth();var B=D/2;switch(this.type){case 1:this.setSnapToGridAnchor(new draw2d.geo.Point(D,D));break;case 2:this.setSnapToGridAnchor(new draw2d.geo.Point(B,D));break;case 3:this.setSnapToGridAnchor(new draw2d.geo.Point(0,D));break;case 4:this.setSnapToGridAnchor(new draw2d.geo.Point(0,B));break;case 5:this.setSnapToGridAnchor(new draw2d.geo.Point(0,0));break;case 6:this.setSnapToGridAnchor(new draw2d.geo.Point(B,0));break;case 7:this.setSnapToGridAnchor(new draw2d.geo.Point(D,0));break;case 8:this.setSnapToGridAnchor(new draw2d.geo.Point(D,B));break;case 9:this.setSnapToGridAnchor(new draw2d.geo.Point(B,B));break}},show:function(A){this.setCanvas(A);this.canvas.resizeHandles.add(this);this.shape.toFront()},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill="#e6e6e8"}else{A.fill="90-#b8c8ec-#e6e6e8"}this._super(A)},supportsSnapToHelper:function(){return true},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineResizeHandle=draw2d.shape.basic.Circle.extend({NAME:"draw2d.shape.basic.LineResizeHandle",init:function(A){this._super();this.owner=A;this.isResizeHandle=true;if(draw2d.isTouchDevice){this.setDimension(14,14)}else{this.setDimension(7,7)}this.setBackgroundColor("#d04437");this.setColor("#d04437");this.setStroke(1);this.setSelectable(false);this.currentTarget=null},select:function(A){},unselect:function(){},getRelatedPort:function(){return null},getOppositePort:function(){return null},getOppositePortTo:function(A){return _.without([this.owner.getSource(),this.owner.getTarget()],A)[0]},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(!("fill" in A)){if(this.getAlpha()<0.9){A.fill="#d04437"}else{A.fill="r(.4,.3)#d04437:40-#d04437:60-#d04437"}}this._super(A)},onDragStart:function(){this.ox=this.x;this.oy=this.y;this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_BASEPOINT));return true},onDrag:function(D,A){this.setPosition(this.ox+D,this.oy+A);var C=this.getRelatedPort();var B=this.getBoundingBox().getCenter();var E=(C!==null)?this._getDropTarget(B.x,B.y,C):null;if(E!==this.currentTarget&&E!==this.getOppositePortTo(C)){if(this.currentTarget!==null){this.currentTarget.onDragLeave(C);this.currentTarget.setGlow(false)}if(E!==null){this.currentTarget=E.onDragEnter(C);if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}else{this.currentTarget=C}}else{if(this.currentTarget!==null){this.currentTarget.setGlow(true)}}return true},_getDropTarget:function(A,C,B){return B.getDropTarget(A,C)},onDragEnd:function(){if(!this.isDraggable()){return false}var A=this.getRelatedPort();if(A!==null){if(this.currentTarget!==null){this.onDrop(this.currentTarget);this.currentTarget.onDragLeave(A);this.currentTarget.setGlow(false);this.currentTarget=null}}if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){if(this.command!==null){this.command.cancel()}}else{if(this.command!==null){this.getCanvas().getCommandStack().execute(this.command)}}this.command=null;this.getCanvas().hideSnapToHelperLines();return true},supportsSnapToHelper:function(){if(this.getCanvas().getCurrentSelection() instanceof draw2d.Connection){return false}return true},show:function(B,A,C){this.setCanvas(B);this.setPosition(A,C);this.shape.toFront();this.canvas.resizeHandles.add(this)},hide:function(){if(this.shape===null){return }this.canvas.resizeHandles.remove(this);this.setCanvas(null)},onKeyDown:function(B,A){this.canvas.onKeyDown(B,A)},fireMoveEvent:function(){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineStartResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineStartResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineStartResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getStartPoint();this.owner.setStartPoint(B.x-E,B.y-C);this.owner.isMoving=true;return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(A,this.owner.getTarget());this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/LineEndResizeHandle.js' */
(function ($) {draw2d.shape.basic.LineEndResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineEndResizeHandle",init:function(A){this._super(A)},getRelatedPort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getTarget()}return null},getOppositePort:function(){if(this.owner instanceof draw2d.Connection){return this.owner.getSource()}return null},onDrag:function(D,A){var G=this.getX();var F=this.getY();this._super(D,A);var E=G-this.getX();var C=F-this.getY();var B=this.owner.getEndPoint();this.owner.setEndPoint(B.x-E,B.y-C);this.owner.isMoving=true;this.detachMoveListener(this.owner);return true},onDrop:function(A){this.owner.isMoving=false;if(this.owner instanceof draw2d.Connection&&this.command!==null){this.command.setNewPorts(this.owner.getSource(),A);this.getCanvas().getCommandStack().execute(this.command)}this.command=null}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/Port.js' */
(function ($) {draw2d.Port=draw2d.shape.basic.Circle.extend({NAME:"draw2d.Port",DEFAULT_BORDER_COLOR:new draw2d.util.Color("#1B1B1B"),init:function(A){this.locator=null;this.lighterBgColor=null;this._super();if(draw2d.isTouchDevice){this.setDimension(25,25)}else{this.setDimension(10,10)}this.ox=this.x;this.oy=this.y;this.coronaWidth=5;this.corona=null;this.currentTargetPort=null;this.currentTarget=null;this.setBackgroundColor("#4f6870");this.setStroke(1);this.setColor(this.DEFAULT_BORDER_COLOR);this.setSelectable(false);if(typeof A==="undefined"){this.name=null}else{this.name=A}this.connectionAnchor=new draw2d.layout.anchor.ConnectionAnchor(this);this.value=null;this.maxFanOut=Number.MAX_VALUE;this.setCanSnapToHelper(false);this.installEditPolicy(new draw2d.policy.port.IntrusivePortsFeedbackPolicy())},setMaxFanOut:function(A){this.maxFanOut=Math.max(1,A);return this},getMaxFanOut:function(){return this.maxFanOut},setConnectionAnchor:function(A){if(typeof A==="undefined"||A===null){A=new draw2d.layout.anchor.ConnectionAnchor()}this.connectionAnchor=A;this.connectionAnchor.setOwner(this);return this},getConnectionAnchorLocation:function(A){return this.connectionAnchor.getLocation(A)},getConnectionAnchorReferencePoint:function(){return this.connectionAnchor.getReferencePoint()},getConnectionDirection:function(B,A){return this.getParent().getBoundingBox().getDirection(this.getAbsolutePosition())},setLocator:function(A){this.locator=A;return this},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.3).hash();return this},setValue:function(A){this.value=A;if(this.getParent()!==null){this.getParent().onPortValueChanged(this)}return this},getValue:function(){return this.value},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.cx=this.getAbsoluteX();A.cy=this.getAbsoluteY();A.rx=this.width/2;A.ry=A.rx;A.cursor="move";if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)},onMouseEnter:function(){this.setStroke(2)},onMouseLeave:function(){this.setStroke(1)},getConnections:function(){var A=new draw2d.util.ArrayList();var C=this.moveListener.getSize();for(var B=0;B<C;B++){var D=this.moveListener.get(B);if(D instanceof draw2d.Connection){A.add(D)}}return A},setParent:function(A){this._super(A);if(this.parent!==null){this.parent.detachMoveListener(this)}if(this.parent!==null){this.parent.attachMoveListener(this)}},getCoronaWidth:function(){return this.coronaWidth},setCoronaWidth:function(A){this.coronaWidth=A},onDragStart:function(){if(this.getConnections().getSize()>=this.maxFanOut){return false}this.getShapeElement().toFront();this.ox=this.x;this.oy=this.y;this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragStart(this.canvas,this)}},this));return true},onDrag:function(B,A){this.isInDragDrop=true;this._super(B,A);var C=this.getDropTarget(this.getAbsoluteX(),this.getAbsoluteY(),this);if(C!==this.currentTarget){if(this.currentTarget!==null){this.currentTarget.onDragLeave(this);this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}if(C!==null){this.currentTarget=C.onDragEnter(this);if(this.currentTarget!==null){this.currentTargetPort=C;this.editPolicy.each($.proxy(function(D,E){if(E instanceof draw2d.policy.port.PortFeedbackPolicy){E.onHoverEnter(this.canvas,this,this.currentTarget)}},this))}}else{this.currentTarget=null}}},onDragEnd:function(){this.setAlpha(1);this.setPosition(this.ox,this.oy);this.isInDragDrop=false;if(this.currentTarget){this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.port.PortFeedbackPolicy){B.onHoverLeave(this.canvas,this,this.currentTarget)}},this))}this.editPolicy.each($.proxy(function(A,B){if(B instanceof draw2d.policy.figure.DragDropEditPolicy){B.onDragEnd(this.canvas,this)}},this));this.currentTarget=null},onDragEnter:function(B){if(!(B instanceof draw2d.Port)){return null}if(this.getConnections().getSize()>=this.maxFanOut){return null}var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=B;A.target=this;var C=this.createCommand(A);if(C===null){return null}return this},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }},onDrop:function(C){if(!(C instanceof draw2d.Port)){return }var A=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);A.canvas=this.parent.getCanvas();A.source=C;A.target=this;var B=this.createCommand(A);if(B!==null){this.parent.getCanvas().getCommandStack().execute(B)}this.setGlow(false)},onConnect:function(A){},onDisconnect:function(A){},onOtherFigureIsMoving:function(A){this.repaint();this.fireMoveEvent()},getName:function(){return this.name},setName:function(A){this.name=A},hitTest:function(B,F){var A=this.getAbsoluteX()-(this.coronaWidth*2)-this.getWidth()/2;var E=this.getAbsoluteY()-(this.coronaWidth*2)-this.getHeight()/2;var C=A+this.width+(this.coronaWidth*4);var D=E+this.height+(this.coronaWidth*4);return(B>=A&&B<=C&&F>=E&&F<=D)},setGlow:function(A){if(A===true&&this.corona===null){this.corona=new draw2d.Corona();this.corona.setDimension(this.getWidth()+(this.getCoronaWidth()*2),this.getWidth()+(this.getCoronaWidth()*2));this.corona.setPosition(this.getAbsoluteX()-this.getCoronaWidth()-this.getWidth()/2,this.getAbsoluteY()-this.getCoronaWidth()-this.getHeight()/2);this.corona.setCanvas(this.getCanvas());this.corona.getShapeElement();this.corona.repaint()}else{if(A===false&&this.corona!==null){this.corona.setCanvas(null);this.parent.getCanvas().removeFigure(this.corona);this.corona=null}}return this},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.MOVE){if(!this.isDraggable()){return null}return new draw2d.command.CommandMovePort(this)}if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.parent.id===A.target.parent.id){return null}else{return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}}return null},fireMoveEvent:function(){if(this.isInDragDrop===true){return }this._super()},getDropTarget:function(A,E,B){for(var C=0;C<this.targets.getSize();C++){var D=this.targets.get(C);if(D!==B){if(D.hitTest(A,E)===true){return D}}}return null},getDropTargets:function(){return this.targets.clone().grep($.proxy(function(A){return A!==this},this))}});draw2d.Corona=draw2d.shape.basic.Circle.extend({init:function(){this._super();this.setAlpha(0.3);this.setBackgroundColor(new draw2d.util.Color(178,225,255));this.setColor(new draw2d.util.Color(102,182,252))},setAlpha:function(A){this._super(Math.min(0.3,A));this.setDeleteable(false);this.setDraggable(false);this.setResizeable(false);this.setSelectable(false);return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/InputPort.js' */
(function ($) {draw2d.InputPort=draw2d.Port.extend({NAME:"draw2d.InputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.OutputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.OutputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/OutputPort.js' */
(function ($) {draw2d.OutputPort=draw2d.Port.extend({NAME:"draw2d.OutputPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.OutputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.InputPort){return this._super(A)}if(A instanceof draw2d.HybridPort){return this._super(A)}return null},onDragLeave:function(A){if(A instanceof draw2d.InputPort){this._super(A)}else{if(A instanceof draw2d.HybridPort){this._super(A)}}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source.getParent().getId()===A.target.getParent().getId()){return null}if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/HybridPort.js' */
(function ($) {draw2d.HybridPort=draw2d.Port.extend({NAME:"draw2d.HybridPort",init:function(A){this._super(A);this.locator=new draw2d.layout.locator.InputPortLocator()},onDragEnter:function(A){if(A instanceof draw2d.Port){return this._super(A)}return null},onDragLeave:function(A){if(!(A instanceof draw2d.Port)){return }if(A instanceof draw2d.Port){this._super(A)}},createCommand:function(A){if(A.getPolicy()===draw2d.command.CommandType.CONNECT){if(A.source instanceof draw2d.InputPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}else{if(A.source instanceof draw2d.OutputPort){return new draw2d.command.CommandConnect(A.canvas,A.source,A.target)}else{if(A.source instanceof draw2d.HybridPort){return new draw2d.command.CommandConnect(A.canvas,A.target,A.source)}}}return null}return this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ConnectionAnchor=Class.extend({NAME:"draw2d.layout.anchor.ConnectionAnchor",init:function(A){this.owner=A},getLocation:function(A){return this.getReferencePoint()},getOwner:function(){return this.owner},setOwner:function(A){if(typeof A==="undefined"){throw"Missing parameter for 'owner' in ConnectionAnchor.setOwner"}this.owner=A},getBox:function(){return this.getOwner().getAbsoluteBounds()},getReferencePoint:function(){return this.getOwner().getAbsolutePosition()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ChopboxConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ChopboxConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ChopboxConnectionAnchor",init:function(A){this._super(A)},getLocation:function(B){var E=new draw2d.geo.Rectangle(0,0);E.setBounds(this.getBox());E.translate(-1,-1);E.resize(1,1);var A=E.getCenter();if(E.isEmpty()||(B.x==A.x&&B.y==A.y)){return A}var D=B.x-A.x;var C=B.y-A.y;var F=0.5/Math.max(Math.abs(D)/E.w,Math.abs(C)/E.h);D*=F;C*=F;A.translate(D,C);return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/ShortesPathConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.ShortesPathConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.ShortesPathConnectionAnchor",init:function(A){this._super(A)},getLocation:function(E){var D=this.getOwner().getParent().getBoundingBox();var B=D.getCenter();if(this.getOwner().getParent() instanceof draw2d.shape.basic.Oval){var A=this.getOwner().getParent().intersectionWithLine(E,B);if(A.getSize()==1){return A.get(0)}}var C=D.determineOctant(new draw2d.geo.Rectangle(E.x,E.y,2,2));switch(C){case 0:return D.getTopLeft();case 1:return new draw2d.geo.Point(E.x,D.getTop());case 2:return D.getTopRight();case 3:return new draw2d.geo.Point(D.getRight(),E.y);case 4:return D.getBottomRight();case 5:return new draw2d.geo.Point(E.x,D.getBottom());case 6:return D.getBottomLeft();case 7:return new draw2d.geo.Point(D.getLeft(),E.y)}return D.getTopLeft()},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/layout/anchor/CenterEdgeConnectionAnchor.js' */
(function ($) {draw2d.layout.anchor.CenterEdgeConnectionAnchor=draw2d.layout.anchor.ConnectionAnchor.extend({NAME:"draw2d.layout.anchor.CenterEdgeConnectionAnchor",init:function(A){this._super(A)},getLocation:function(D){var C=this.getOwner().getParent().getBoundingBox();var B=C.getDirection(D);var A=C.getCenter();switch(B){case 0:A.y=C.y;break;case 1:A.x=C.x+C.w;break;case 2:A.y=C.y+C.h;break;case 3:A.x=C.x}return A},getBox:function(){return this.getOwner().getParent().getBoundingBox()},getReferencePoint:function(){return this.getBox().getCenter()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowLeft",init:function(){this._super()},getSVG:function(){return'<svg width="230" height="60" xmlns="http://www.w3.org/2000/svg" version="1.1">  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3024" d="m 218.87943,27.464763 c -1.21088,-0.0563 -2.42064,-0.14616 -3.63262,-0.16893 c -5.82495,-0.10948 -18.61676,-0.0226 -22.97385,0.0122 c -7.12848,0.057 -14.25673,0.14021 -21.38495,0.22333 c -9.03765,0.10539 -18.07511,0.22813 -27.11266,0.3422 c -10.2269,0.11878 -20.4538,0.23756 -30.6807,0.35634 c -35.488759,0.4089 -70.975849,0.82793 -106.4669238,0.95195 c 0,0 7.9718628,-5.70244 7.9718628,-5.70244 l 0,0 c 6.374241,0.28694 12.745594,0.64561 19.122722,0.86083 c 28.09499,0.94816 56.21338,0.92473 84.315959,0.32205 c 10.51273,-0.32805 21.0288,-0.56402 31.53819,-0.98412 c 27.47361,-1.09824 54.91405,-2.91665 82.28177,-5.53697 c 0,0 -12.9788,9.32351 -12.9788,9.32351 z" inkscape:connector-curvature="0" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3026" d="m 100.75066,1.6309831 c -7.165239,3.9571 -14.284929,7.47866 -22.036659,10.2707299 c -5.00195,1.80163 -10.10374,3.31886 -15.2402,4.79424 c -8.25878,2.37815 -16.55626,4.65805 -24.9012,6.79479 c -2.89107,0.71593 -5.74687,1.56407 -8.66266,2.20424 c -3.211679,0.70512 -6.49468,1.17333 -9.752959,1.6747 c -5.447101,0.92112 -10.9044008,1.81762 -16.3983488,2.50082 c -1.608931,0.0814 -0.850754,0.10697 -2.275834,-0.0365 C 20.004071,21.041553 19.256899,21.517873 32.515691,19.216243 c 6.21537,-1.05913 12.34875,-2.37668 18.3945,-4.03234 c 8.12719,-2.02803 16.23765,-4.1157 24.26421,-6.4321199 c 5.23574,-1.55053 10.41682,-3.15473 15.46857,-5.12875 c 1.38953,-0.54295 2.7579,-1.12682 4.12253,-1.71603 c 0.98421,-0.42496 3.86537,-1.81801999 2.92296,-1.32600999 C 93.642191,2.6934931 89.529511,4.7073031 85.450031,6.7704531 l 15.300629,-5.1394 z" inkscape:connector-curvature="0" sodipodi:nodetypes="csccsccccccsssccc" />  <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3028" d="m 80.764281,58.068863 c -2.45498,-3.50762 -6.58178,-6.10525 -10.40324,-8.66732 c -4.30614,-2.72676 -7.93958,-6.28283 -12.6021,-8.28702 c -7.39912,-4.50257 -11.70055,-7.85592 -20.85866,-9.23429 c -4.9257,-0.85706 -17.294247,-1.32043 -22.226462,-2.15427 c -3.445882,-0.42869 -6.2035918,0.70541 -9.6845138,0.57715 c -1.496337,-0.0586 -2.99355,-0.0965 -4.491229,-0.12472 l 13.9525278,-6.24562 l 3.25,-1.17153 c 1.441459,0.0813 -1.116338,0.15309 0.325505,0.23016 c 3.574557,0.17902 7.211864,0.0695 10.712655,0.73822 c 4.723107,1.08097 9.443947,2.1624 14.234177,3.05317 c 2.76739,0.64203 3.92627,0.87082 6.64127,1.66289 c 4.42146,1.28993 8.60075,3.01513 12.86503,4.58129 c 1.90199,0.73446 5.05193,1.93181 6.89302,2.7216 c 4.92005,2.11061 9.5916,4.57045 13.9716,7.31023 c 4.16708,2.62011 8.48023,5.20033 11.72012,8.56863 z" inkscape:connector-curvature="0" sodipodi:nodetypes="ccccccccccccscsccc" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/arrow/CalligrapherArrowDownLeft.js' */
(function ($) {draw2d.shape.arrow.CalligrapherArrowDownLeft=draw2d.SVGFigure.extend({NAME:"draw2d.shape.arrow.CalligrapherArrowDownLeft",init:function(){this._super()},getSVG:function(){return'<svg width="180" height="300" xmlns="http://www.w3.org/2000/svg" version="1.1">     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3084" d="m 159.63578,17.846597 c 0.43137,9.44641 -0.0636,18.88035 -0.8284,28.30165 c -1.73211,18.38336 -4.05381,36.71698 -6.08253,55.075313 c -1.61738,13.7075 -3.03402,27.43467 -3.97611,41.19113 c -1.09101,11.16584 -1.31019,22.36559 -1.28541,33.56466 c -0.1328,4.82188 0.3218,9.6468 0.14332,14.46812 c -0.0888,2.39977 -0.28315,3.73625 -0.55012,6.12095 c -0.85848,4.73147 -2.27416,9.40019 -4.7769,13.68272 c -1.47003,2.51544 -3.78493,5.6647 -5.47739,8.05048 c -5.02888,6.66256 -11.08555,12.65652 -18.10552,17.75963 c -4.23302,3.07716 -7.74942,5.12065 -12.22081,7.86298 c -13.253319,6.72606 -25.889792,15.11686 -40.84124,18.60576 c -3.016829,0.7039 -4.431417,0.8157 -7.450859,1.2076 c -6.983246,0.5774 -14.009174,0.3375 -21.010676,0.2509 c -3.278795,-0.033 -6.55749,0.01 -9.835897,0.045 c 0,0 20.838833,-13.2364 20.838833,-13.2364 l 0,0 c 3.147056,0.093 6.294483,0.1852 9.443646,0.2007 c 6.966697,0.011 13.971433,0.1301 20.897176,-0.6344 c 3.732439,-0.5577 7.321215,-1.2431 10.881203,-2.4145 c 1.517208,-0.4992 5.830867,-2.43339 4.487902,-1.6386 c -6.098183,3.6088 -25.104875,12.8748 -9.52514,5.223 c 4.40875,-2.5927 8.262057,-4.7459 12.425175,-7.65986 c 6.839117,-4.78709 12.633657,-10.50427 17.500607,-16.86761 c 2.53518,-3.56692 5.24684,-7.12748 7.07617,-11.03446 c 1.42357,-3.0404 2.21532,-6.28727 2.91146,-9.50152 c 0.91919,-6.88822 1.03991,-13.81392 1.25118,-20.74151 c 0.47683,-11.27871 0.96259,-22.55877 1.61689,-33.83062 c 1.21127,-14.03392 3.64191,-27.94339 5.46543,-41.92167 c 2.26899,-18.186603 4.6835,-36.384373 5.4487,-54.679643 c 0.0788,-2.46092 0.23808,-4.92087 0.23618,-7.38276 c -0.005,-6.45916 -0.62194,-13.00218 -2.13821,-19.32664 c 0,0 23.48134,-10.73998 23.48134,-10.73998 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3086" d="m 41.271518,252.40239 c 2.465518,-0.7264 4.879503,-1.7726 7.145328,-2.9859 c 0.955597,-0.5117 3.736822,-2.1986 2.791991,-1.6673 c -5.218817,2.9348 -10.409826,5.9187 -15.61474,8.878 c 5.366557,-3.4898 10.227818,-7.6685 14.119927,-12.75576 c 3.507157,-5.09382 4.097613,-11.17122 4.301158,-17.17644 c 0.02635,-3.95844 -0.31227,-7.90612 -0.635377,-11.84752 c 0,0 19.920693,-10.3059 19.920693,-10.3059 l 0,0 c 0.171761,4.05015 0.409899,8.09777 0.50079,12.15101 c -0.185739,6.23619 -0.347804,12.66862 -3.492579,18.24747 c -0.503375,0.75197 -0.961922,1.53596 -1.510126,2.25591 c -3.478528,4.56826 -8.226837,8.04586 -12.757403,11.47443 c -7.345206,4.3297 -14.671333,8.692 -22.035619,12.9891 c -3.551305,2.0723 -7.368692,3.8726 -11.394645,4.7773 c 0,0 18.660602,-14.0344 18.660602,-14.0344 z" inkscape:connector-curvature="0" />     <path style="fill:#000000;fill-opacity:1;fill-rule:nonzero;stroke:none" id="path3088" d="m 37.815923,255.49919 c 3.41111,0.1581 6.814569,0.2213 10.182693,0.8184 c 6.92998,2.6928 13.533527,6.2357 20.043462,9.8162 c 3.912139,2.1362 7.91195,4.4644 10.690321,8.0298 c 1.039962,1.2802 1.510411,2.7604 1.893523,4.3313 c 0,0 -20.370847,10.9259 -20.370847,10.9259 l 0,0 c -0.225419,-1.2711 -0.55067,-2.4558 -1.329618,-3.5184 c -2.332229,-3.3633 -5.869056,-5.6279 -9.247191,-7.8233 c -6.335066,-3.7106 -12.98611,-7.1834 -20.232784,-8.6836 c -3.497247,-0.3814 -7.011372,-0.4307 -10.521829,-0.1703 c 0,0 18.89227,-13.726 18.89227,-13.726 z" inkscape:connector-curvature="0" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(this.svgNodes!==null){this.svgNodes.attr({fill:this.color.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Start.js' */
(function ($) {draw2d.shape.node.Start=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Start",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("output");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/End.js' */
(function ($) {draw2d.shape.node.End=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.End",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.createPort("input");this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/node/Between.js' */
(function ($) {draw2d.shape.node.Between=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Between",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),init:function(){this._super();this.setDimension(50,50);this.setBackgroundColor(this.DEFAULT_COLOR);this.setColor(this.DEFAULT_COLOR.darker());this.createPort("output");this.createPort("input")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/note/PostIt.js' */
(function ($) {draw2d.shape.note.PostIt=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.PostIt",init:function(A){this._super(A);this.setStroke(1);this.setBackgroundColor("#5b5b5b");this.setColor("#FFFFFF");this.setFontColor("#ffffff");this.setFontSize(14);this.setPadding(5);this.setRadius(5)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Widget.js' */
(function ($) {draw2d.shape.widget.Widget=draw2d.SetFigure.extend({init:function(B,A){this._super(B,A)},getWidth:function(){return this.width},getHeight:function(){return this.height}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/widget/Slider.js' */
(function ($) {draw2d.shape.widget.Slider=draw2d.shape.widget.Widget.extend({NAME:"draw2d.shape.widget.Slider",DEFAULT_COLOR_THUMB:new draw2d.util.Color("#bddf69"),DEFAULT_COLOR_BG:new draw2d.util.Color("#d3d3d3"),init:function(B,A){if(typeof B==="undefined"){B=120;A=15}this.currentValue=0;this.slideBoundingBox=new draw2d.geo.Rectangle(0,0,10,20);this._super(B,A);this.setBackgroundColor(this.DEFAULT_COLOR_BG);this.setColor(this.DEFAULT_COLOR_THUMB);this.setStroke(1);this.setRadius(4);this.setResizeable(true);this.setMinHeight(10);this.setMinWidth(80)},createSet:function(){var A=this.canvas.paper.set();var B=this.canvas.paper.rect(5,5,10,20);B.node.style.cursor="col-resize";A.push(B);return A},setDimension:function(A,B){this._super(A,B);this.slideBoundingBox.setBoundary(0,0,this.getWidth()-10,this.getHeight());this.slideBoundingBox.setHeight(this.getHeight()+1);this.repaint()},onValueChange:function(A){},onDragStart:function(B,A){if(this.slideBoundingBox.hitTest(B,A)){this.origX=this.slideBoundingBox.getX();this.origY=this.slideBoundingBox.getY();return false}return this._super(B,A)},onPanning:function(B,A){this.slideBoundingBox.setPosition(this.origX+B,this.origY+A);this.setValue(100/(this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())*this.slideBoundingBox.getX())},setValue:function(A){this.currentValue=Math.min(Math.max(0,(A|0)),100);this.repaint();this.onValueChange(this.currentValue)},repaint:function(B){if(this.repaintBlocked===true||this.shape===null){return }if(typeof B==="undefined"){B={}}var C=((this.slideBoundingBox.bw-this.slideBoundingBox.getWidth())/100*this.currentValue)|0;this.slideBoundingBox.setX(C);if(this.svgNodes!==null){var A=this.slideBoundingBox.toJSON();A.y=A.y-5;A.height=A.height+10;A.fill=this.getColor().hash();A.stroke=this.getColor().darker(0.2).hash();A.r=4;this.svgNodes.attr(A)}B.fill="90-"+this.bgColor.hash()+":5-"+this.bgColor.lighter(0.3).hash()+":95";B.stroke=this.bgColor.darker(0.1).hash();this._super(B)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Diagram.js' */
(function ($) {draw2d.shape.diagram.Diagram=draw2d.SetFigure.extend({init:function(B,A){this.data=[];this.padding=5;this.cache={};this._super(B,A);this.setBackgroundColor("#8dabf2");this.setStroke(1);this.setColor("#f0f0f0");this.setRadius(2);this.setResizeable(true)},setData:function(A){this.data=A;this.cache={};if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},setDimension:function(A,B){this.cache={};this._super(A,B)},getWidth:function(){return this.width},getHeight:function(){return this.height},repaint:function(A){if(this.repaintBlocked===true||this.shape==null){return }if(typeof A==="undefined"){A={}}if(typeof A.fill==="undefined"){A.fill="none"}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+this.getAbsoluteX()+","+this.getAbsoluteY())}else{this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Pie.js' */
(function ($) {draw2d.shape.diagram.Pie=draw2d.shape.diagram.Diagram.extend({COLORS:["#00A8F0","#b9dd69","#f3546a","#4DA74D","#9440ED"],TWO_PI:Math.PI*2,init:function(A){this._super(A,A);this.setStroke(0)},setData:function(B){this.sum=0;$.each(B,$.proxy(function(C,D){this.sum+=D},this));var A=1/this.sum;$.each(B,$.proxy(function(C,D){B[C]=A*D},this));this._super(B)},createSet:function(){var A=this.getWidth()/2;var F=this.data.length;var C=this.canvas.paper.set();var H=0;for(var E=0;E<F;E++){var G=this.TWO_PI*this.data[E];var D=this.COLORS[E%F];var B=this.drawSegment(A,G,H,0.1);B.attr({stroke:this.color.hash(),fill:D});C.push(B);H+=G}return C},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}if(this.svgNodes!==null){this.svgNodes.remove();this.svgNodes=this.createSet()}this.repaint()},polarPath:function(B,D,C){var A,E;A=B*Math.cos(D+C)+B;E=B*Math.sin(D+C)+B;return"L "+A+" "+E+" "},drawSegment:function(A,E,D,B){var F="M "+A+" "+A;for(var C=0;C<E;C+=B){F+=this.polarPath(A,C,D)}F+=this.polarPath(A,E,D);F+="L "+A+" "+A;return this.getCanvas().paper.path(F)},applyTransformation:function(){this.svgNodes.transform("T"+this.getAbsoluteX()+","+this.getAbsoluteY())}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/diagram/Sparkline.js' */
(function ($) {draw2d.shape.diagram.Sparkline=draw2d.shape.diagram.Diagram.extend({init:function(B,A){this.min=0;this.max=10;if(typeof B==="undefined"){B=180;A=50}this._super(B,A)},setData:function(A){this.min=Math.min.apply(Math,A);this.max=Math.max.apply(Math,A);if(this.max==this.min){this.max=this.min+1}this._super(A)},createSet:function(){return this.canvas.paper.path("M0 0 l0 0")},repaint:function(E){if(this.repaintBlocked===true||this.shape===null){return }if(typeof E==="undefined"){E={}}E.fill="90-#000:5-#4d4d4d:95";var H=this.padding;var A=this.getWidth()-2*+this.padding;var I=this.getHeight()-2*+this.padding;var C=this.data.length;var D=this.min;var G=this.max;var B=function(L,J){var K=1;if(C>1){K=(A/(C-1))}return{y:-((L-D)/(G-D)*I)+I+H,x:H+J*K}};if(this.svgNodes!==null&&(typeof this.cache.pathString==="undefined")){var F=null;$.each(this.data,$.proxy(function(J,K){var L=B(K,J);if(F===null){this.cache.pathString=["M",L.x,L.y].join(" ")}else{this.cache.pathString=[this.cache.pathString,"L",L.x,L.y].join(" ")}F=L},this));this.svgNodes.attr({path:this.cache.pathString,stroke:"#f0f0f0"})}this._super(E)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/OpAmp.js' */
(function ($) {draw2d.shape.analog.OpAmp=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.OpAmp",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,B){var D=B.getParent();var A=(8+18.5*C)*D.scaleY;this.applyConsiderRotation(B,1,A)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.createPort("input",this.inputLocator);this.createPort("input",this.inputLocator);this.createPort("output");this.setBackgroundColor("#f0f0ff")},getSVG:function(){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m8.2627,0l0,35.36035l31.23926,-17.76025l-31.23926,-17.60011l0,0l0,0.00001zm2.27832,27.36719l4.08105,0m-2.10449,-2.20703l0,4.27979m2.26367,-21.35938l-4.15918,0"  stroke="#1B1B1B" fill="none"/><line x1="0.53516"  y1="8"  x2="8.21191"  y2="8"  stroke="#010101"/><line x1="39.14941" y1="18" x2="45.81055" y2="18" stroke="#010101" /><line x1="0.53516"  y1="27" x2="8.21191"  y2="27" stroke="#010101" /></svg>'},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.bgColor!=null){this.svgNodes[0].attr({fill:this.bgColor.hash()})}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorBridge.js' */
(function ($) {draw2d.shape.analog.ResistorBridge=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.ResistorBridge",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2+1,D*C)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B*(C-2),D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12322" d="m47.62207,22.71094l0,0c0.73145,0.73242 0.71777,1.93359 -0.03027,2.68164c-0.74805,0.74951 -1.94922,0.76123 -2.68073,0.0293c-0.73138,-0.73242 -0.71967,-1.93211 0.03033,-2.68115c0.74707,-0.74803 1.94727,-0.76219 2.68066,-0.02979l0,0z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12324" d="m25.84082,0.93115l0,0c0.73145,0.73096 0.71875,1.93359 -0.02832,2.68066c-0.75,0.74951 -1.94922,0.76123 -2.68164,0.0293c-0.73242,-0.73241 -0.71973,-1.93164 0.0293,-2.68065c0.74805,-0.74756 1.94922,-0.76172 2.68066,-0.0293l0,0l0,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12326" d="m25.75098,44.58203l0,0c0.73145,0.73193 0.71875,1.93311 -0.02832,2.68115c-0.75,0.74902 -1.94922,0.76074 -2.68262,0.0293c-0.73145,-0.73193 -0.71973,-1.93262 0.03033,-2.68164c0.74707,-0.74756 1.94922,-0.76123 2.68066,-0.02879l0,0l-0.00006,-0.00002z"/><path fill="#010101" stroke="#010101" stroke-miterlimit="14.3" id="path12328" d="m3.9707,22.80127l0,0c0.73242,0.73193 0.71777,1.93359 -0.0293,2.68115c-0.74902,0.74951 -1.94922,0.76172 -2.68164,0.0293c-0.73145,-0.73242 -0.71973,-1.93164 0.03027,-2.68115c0.74707,-0.74707 1.94922,-0.76074 2.68066,-0.0293l0,0z"/><polyline fill="none" stroke="#010101" id="polyline12334" points="24.908203125,45.49267578125 31.71875,38.68310546875 31.2119140625,36.98876953125 34.892578125,37.95703125 33.953125,34.22265625 37.6650390625,35.18359375 36.6767578125,31.52490234375 40.3759765625,32.47314453125 39.873046875,30.52783203125 45.884765625,24.51708984375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12338" points="36.3408203125,23.98876953125 38.146484375,29.55810546875 33.630859375,29.55810546875 35.435546875,23.98779296875 "/><line fill="none" stroke="#010101" id="line12340" y2="28.90967" x2="35.8877" y1="41.13428" x1="35.88867" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12346" points="3.2109375,23.79248046875 10.01953125,16.98388671875 9.513671875,15.2890625 13.193359375,16.25732421875 12.251953125,12.5234375 15.9658203125,13.48486328125 14.9775390625,9.82568359375 18.6767578125,10.7734375 18.173828125,8.82958984375 24.185546875,2.81787109375 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12350" points="13.126953125,23.80419921875 11.3212890625,18.236328125 15.8369140625,18.236328125 14.0322265625,23.806640625 "/><line fill="none" stroke="#010101" id="line12352" y2="18.8833" x2="13.58008" y1="6.65967" x1="13.5791" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12358" points="46.65625,24.33642578125 39.84765625,17.52783203125 38.154296875,18.033203125 39.1220703125,14.353515625 35.3876953125,15.29345703125 36.34765625,11.58056640625 32.689453125,12.56884765625 33.6376953125,8.86865234375 31.6923828125,9.373046875 24.322265625,2.00341796875 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12362" points="36.578125,1.87109375 38.3828125,7.439453125 33.8681640625,7.439453125 35.6728515625,1.869140625 "/><line fill="none" stroke="#010101" id="line12364" y2="6.7915" x2="36.125" y1="19.01758" x1="36.125" stroke-miterlimit="14.3"/><polyline fill="none" stroke="#010101" id="polyline12370" points="24.494140625,46.49951171875 17.685546875,39.69091796875 15.9921875,40.1953125 16.958984375,36.515625 13.2265625,37.45556640625 14.185546875,33.7421875 10.52734375,34.73193359375 11.474609375,31.03125 9.529296875,31.53515625 2.1611328125,24.166015625 " stroke-miterlimit="14.3"/><polyline fill="#010101" id="polyline12374" points="12.150390625,44.80029296875 10.34765625,39.23193359375 14.861328125,39.23095703125 13.0556640625,44.80224609375 "/><line fill="none" stroke="#010101" id="line12376" y2="39.87891" x2="12.60352" y1="27.6543" x1="12.60352" stroke-miterlimit="14.3"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/ResistorVertical.js' */
(function ($) {draw2d.shape.analog.ResistorVertical=draw2d.SetFigure.extend({NAME:"draw2d.shape.analog.ResistorVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},createSet:function(){var A=this._super();A.push(this.canvas.paper.path("M15,0 L15,5 L0,7.5 L30,10 L0,15 L30,20 L0,25 L30,30 L15,32.5 L15,40"));return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyHorizontal.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyHorizontal=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyHorizontal",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(B,A){var C=A.getParent().getHeight();this.applyConsiderRotation(A,0,C/2)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B,D/2)}}),init:function(B,A){if(typeof B==="undefined"){B=50;A=30}this._super(B,A);this.createPort("hybrid",new this.MyInputPortLocator());this.createPort("hybrid",new this.MyOutputPortLocator())},getSVG:function(){return'<svg width="49" height="28" xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m24.99933,18.95592l0,-9.54576m-5.78374,-9.40907l0,28.35939m-5.78718,-9.40457l0,-9.54576m-5.78374,-9.40907l0,28.35939" id="path10566" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m26.79878,14.13039l6.90583,0m-33.22691,0l6.90583,0" id="path10568" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/analog/VoltageSupplyVertical.js' */
(function ($) {draw2d.shape.analog.VoltageSupplyVertical=draw2d.SVGFigure.extend({NAME:"draw2d.shape.analog.VoltageSupplyVertical",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();var D=A.getParent().getHeight();this.applyConsiderRotation(A,B/2,D)}}),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(C,A){var B=A.getParent().getWidth();this.applyConsiderRotation(A,B/2,0)}}),init:function(B,A){if(typeof B==="undefined"){B=30;A=50}this._super(B,A);this.inputLocator=new this.MyInputPortLocator();this.outputLocator=new this.MyOutputPortLocator();this.createPort("hybrid",this.inputLocator);this.createPort("hybrid",this.outputLocator)},getSVG:function(){return'<svg  xmlns="http://www.w3.org/2000/svg" version="1.1"><path d="m19.62398,12.37594l-9.87926,0m-9.74355,8.22145l29.36289,0m-9.74007,8.22469l-9.87927,0m-9.74355,8.22145l29.36289,0" id="path10560" stroke-miterlimit="14.3" stroke="#010101" fill="none"/><path d="m14.63157,9.81646l0,-9.81646m0,47.2328l0,-9.81646" id="path10562" stroke-miterlimit="14.3" stroke-linecap="square" stroke="#010101" fill="none"/></svg>'}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/Layout.js' */
(function ($) {draw2d.shape.layout.Layout=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.layout.Layout",init:function(){this._super();this.setBackgroundColor(null);this.setRadius(0);this.setStroke(0);this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy())},addFigure:function(B,A){this._super(B,this.locator);B.attachResizeListener(this)},onOtherFigureIsResizing:function(A){if(this.getParent() instanceof draw2d.shape.layout.Layout){this.fireResizeEvent()}else{this.setDimension(1,1)}},onDoubleClick:function(A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/HorizontalLayout.js' */
(function ($) {draw2d.shape.layout.HorizontalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.HorizontalLayout",init:function(){this._super();var A=this;this.locator={relocate:function(B,E){var D=A.getStroke();var F=D;for(var C=0;C<B;C++){var G=A.children.get(C).figure;F+=G.getWidth()+A.gap}E.setPosition(F,D)}};this.setDimension(1,1);this.gap=0},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=this.stroke*2+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinWidth()});return A},getMinHeight:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinHeight())});return A+this.stroke*2},setDimension:function(A,B){this._super(A,B);var C=this.width-this.getMinWidth();if(C>0){C=(C/this.children.getSize())|0;this.children.each(function(D,E){E.figure.setDimension(E.figure.getMinWidth()+C,E.figure.getHeight())})}else{this.children.each(function(D,E){E.figure.setDimension(1,1)})}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/layout/VerticalLayout.js' */
(function ($) {draw2d.shape.layout.VerticalLayout=draw2d.shape.layout.Layout.extend({NAME:"draw2d.shape.layout.VerticalLayout",init:function(){this._super();this.gap=0;var A=this;this.locator={relocate:function(B,F){var E=A.getStroke()/2;var D=E;for(var C=0;C<B;C++){var G=A.children.get(C).figure;D=D+G.getHeight()+A.gap}F.setPosition(E,D)}};this.setDimension(10,10)},setGap:function(A){this.gap=A;this.setDimension(1,1)},getMinWidth:function(){var A=10;this.children.each(function(B,C){A=Math.max(A,C.figure.getMinWidth())});return A+this.stroke},getMinHeight:function(){var A=+this.stroke+Math.max(0,this.children.getSize()-1)*this.gap;this.children.each(function(B,C){A+=C.figure.getMinHeight()});return A},setDimension:function(A,C){this._super(A,C);var B=this.width-this.stroke;this.children.each(function(D,E){E.figure.setDimension(B,E.figure.getHeight())})}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/pert/Activity.js' */
(function ($) {draw2d.shape.pert.Activity=draw2d.shape.layout.VerticalLayout.extend({NAME:"draw2d.shape.pert.Activity",init:function(){this._super();var C=this;this.mementoValues={duration:null};this.lighterBgColor=null;this.darkerBgColor=null;this.setBackgroundColor("#f3f3f3");this.setStroke(2);this.setColor(this.darkerBgColor);this.setRadius(5);var B=new draw2d.shape.layout.HorizontalLayout();B.setStroke(0);this.earlyStartLabel=this.createLabel("Early Start").setStroke(0);this.durationLabel=new draw2d.shape.basic.Label("Duration");this.durationLabel.setStroke(1);this.durationLabel.setColor(this.darkerBgColor);this.durationLabel.setRadius(0);this.durationLabel.setBackgroundColor(null);this.durationLabel.setPadding(5);this.durationLabel.setColor(this.bgColor.darker(0.2));this.durationLabel.installEditor(new draw2d.ui.LabelEditor({onCommit:function(D){C.setDuration(parseFloat(D))}}));this.earlyEndLabel=this.createLabel("Early End").setStroke(0);B.addFigure(this.earlyStartLabel);B.addFigure(this.durationLabel);B.addFigure(this.earlyEndLabel);this.activityLabel=new draw2d.shape.basic.Label("Activity Name");this.activityLabel.setRadius(0);this.activityLabel.setPadding(10);this.activityLabel.setColor(this.darkerBgColor);this.activityLabel.setBackgroundColor(null);this.activityLabel.installEditor(new draw2d.ui.LabelInplaceEditor());this.inputPort=this.activityLabel.createPort("input");this.inputPort.getActivity=function(){return C};this.inputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};this.inputPort.setValue=function(D){C.setDuration(C.mementoValues.duration)};this.outputPort=this.activityLabel.createPort("output");this.outputPort.getActivity=function(){return C};this.outputPort.onConnect=function(){C.setDuration(C.mementoValues.duration)};this.outputPort.onDisconnect=function(){C.setDuration(C.mementoValues.duration)};var A=new draw2d.shape.layout.HorizontalLayout();A.setStroke(0);this.lateStartLabel=this.createLabel("Late Start").setStroke(0);this.stackLabel=this.createLabel("Stack");this.lateEndLabel=this.createLabel("Late End").setStroke(0);A.addFigure(this.lateStartLabel);A.addFigure(this.stackLabel);A.addFigure(this.lateEndLabel);this.addFigure(B);this.addFigure(this.activityLabel);this.addFigure(A);this.setDuration(1)},setDuration:function(C){if(this.mementoValues.duration!==C){this.mementoValues.duration=C;this.durationLabel.setText(this.mementoValues.duration)}var D=this.getEarlyStart();this.earlyStartLabel.setText(D);this.earlyEndLabel.setText(D+this.mementoValues.duration);var B=this.outputPort.getConnections();B.each($.proxy(function(F,G){var E=G.getTarget();E.setValue()},this));if(B.getSize()===0){var A=parseFloat(this.earlyEndLabel.getText());this.setLateFinish(A)}},getEarlyEnd:function(){return this.getEarlyStart()+this.mementoValues.duration},getEarlyStart:function(){var A=0;this.inputPort.getConnections().each(function(B,D){var C=D.getSource().getActivity();A=Math.max(A,C.getEarlyEnd())});return A},setLateFinish:function(C){var A=C-this.mementoValues.duration;this.lateEndLabel.setText(C);this.lateStartLabel.setText(A);this.stackLabel.setText(A-parseFloat(this.earlyStartLabel.getText()));var B=this.inputPort.getConnections();B.each($.proxy(function(E,F){var D=F.getSource();D.getActivity().setLateFinish(A)},this))},createLabel:function(A){var B=new draw2d.shape.basic.Label(A);B.setStroke(1);B.setColor(this.darkerBgColor);B.setRadius(0);B.setBackgroundColor(null);B.setPadding(5);B.setColor(this.bgColor.darker(0.2));B.onDoubleClick=function(C){};return B},setBackgroundColor:function(A){this._super(A);this.lighterBgColor=this.bgColor.lighter(0.2).hash();this.darkerBgColor=this.bgColor.darker(0.2).hash()},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}if(this.getAlpha()<0.9){A.fill=this.bgColor.hash()}else{A.fill=["90",this.bgColor.hash(),this.lighterBgColor].join("-")}this._super(A)}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelEditor.js' */
(function ($) {draw2d.ui.LabelEditor=Class.extend({init:function(A){this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(A){var B=prompt("Label: ",A.getText());if(B){A.setText(B);this.listener.onCommit(A.getText())}else{this.listener.onCancel()}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/ui/LabelInplaceEditor.js' */
(function ($) {draw2d.ui.LabelInplaceEditor=draw2d.ui.LabelEditor.extend({init:function(A){this._super();this.listener=$.extend({onCommit:function(){},onCancel:function(){}},A)},start:function(B){this.label=B;this.commitCallback=$.proxy(this.commit,this);$("body").bind("click",this.commitCallback);this.html=$('<input id="inplaceeditor">');this.html.val(B.getText());this.html.hide();$("body").append(this.html);this.html.autoResize({animate:false});this.html.bind("keyup",$.proxy(function(E){switch(E.which){case 13:this.commit();break;case 27:this.cancel();break}},this));this.html.bind("blur",this.commitCallback);this.html.bind("click",function(E){E.stopPropagation();E.preventDefault()});var A=this.label.getCanvas();var C=this.label.getBoundingBox();C.setPosition(A.fromCanvasToDocumentCoordinate(C.x,C.y));var D=A.getScrollArea();if(D.is($("body"))){C.translate(A.getScrollLeft(),A.getScrollTop())}C.translate(-1,-1);C.resize(2,2);this.html.css({position:"absolute",top:C.y,left:C.x,"min-width":C.w,height:C.h});this.html.fadeIn($.proxy(function(){this.html.focus()},this))},commit:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);var A=this.html.val();this.label.setText(A);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCommit(this.label.getText())},this))},cancel:function(){this.html.unbind("blur",this.commitCallback);$("body").unbind("click",this.commitCallback);this.html.fadeOut($.proxy(function(){this.html.remove();this.html=null;this.listener.onCancel()},this))}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/Decorator.js' */
(function ($) {draw2d.decoration.connection.Decorator=Class.extend({NAME:"draw2d.decoration.connection.Decorator",init:function(B,A){if(typeof B==="undefined"||B<1){this.width=20}if(typeof A==="undefined"||A<1){this.height=15}this.color=new draw2d.util.Color(0,0,0);this.backgroundColor=new draw2d.util.Color(250,250,250)},paint:function(A){},setColor:function(A){this.color=new draw2d.util.Color(A);return this},setBackgroundColor:function(A){this.backgroundColor=new draw2d.util.Color(A);return this},setDimension:function(B,A){this.width=B;this.height=A;return this}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/ArrowDecorator.js' */
(function ($) {draw2d.decoration.connection.ArrowDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.ArrowDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M0 0","L",this.width," ",-this.height/2,"L",this.width," ",this.height/2,"L0 0"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/DiamondDecorator.js' */
(function ($) {draw2d.decoration.connection.DiamondDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.DiamondDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.set();A.push(B.path(["M",this.width/2," ",-this.height/2,"L",this.width," ",0,"L",this.width/2," ",this.height/2,"L",0," ",0,"L",this.width/2," ",-this.height/2,"Z"].join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/CircleDecorator.js' */
(function ($) {draw2d.decoration.connection.CircleDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.CircleDecorator",init:function(B,A){this._super(B,A)},paint:function(B){var A=B.circle(0,0,this.width/2);A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/decoration/connection/BarDecorator.js' */
(function ($) {draw2d.decoration.connection.BarDecorator=draw2d.decoration.connection.Decorator.extend({NAME:"draw2d.decoration.connection.BarDecorator",init:function(B,A){this._super(B,A)},paint:function(C){var A=C.set();var B=["M",this.width/2," ",-this.height/2];B.push("L",this.width/2," ",this.height/2);A.push(C.path(B.join("")));A.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Reader.js' */
(function ($) {draw2d.io.Reader=Class.extend({init:function(){},unmarshal:function(B,A){}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/Writer.js' */
(function ($) {draw2d.io.Writer=Class.extend({init:function(){},marshal:function(A){return""},formatXml:function(A){var C="";var B=/(>)(<)(\/*)/g;A=A.replace(B,"$1\r\n$2$3");var D=0;jQuery.each(A.split("\r\n"),function(F,H){var E=0;if(H.match(/.+<\/\w[^>]*>$/)){E=0}else{if(H.match(/^<\/\w/)){if(D!=0){D-=1}}else{if(H.match(/^<\w[^>]*[^\/]>.*$/)){E=1}else{E=0}}}var I="";for(var G=0;G<D;G++){I+="  "}C+=I+H+"\r\n";D+=E});return C}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/svg/Writer.js' */
(function ($) {draw2d.io.svg.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(B){var C=B.getCurrentSelection();B.setCurrentSelection(null);var A=B.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");A=this.formatXml(A);A=A.replace(/<desc>.*<\/desc>/g,"<desc>Create with draw2d JS graph library and RaphaelJS</desc>");B.setCurrentSelection(C);return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/png/Writer.js' */
(function ($) {draw2d.io.png.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(D){var C=D.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");C=C.replace('<svg xmlns="http://www.w3.org/2000/svg"',"<svg");var B=$('<canvas id="canvas" width="1000px" height="600px"></canvas>');$("body").append(B);canvg("canvas",C,{ignoreMouse:true,ignoreAnimation:true});var A=document.getElementById("canvas").toDataURL("image/png");B.remove();return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Writer.js' */
(function ($) {draw2d.io.json.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(C){var A=[];var E=C.getFigures();var D=0;var F=null;for(D=0;D<E.getSize();D++){F=E.get(D);A.push(F.getPersistentAttributes())}var B=C.getLines();B.each(function(H,G){A.push(G.getPersistentAttributes())});return A}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/io/json/Reader.js' */
(function ($) {draw2d.io.json.Reader=draw2d.io.Reader.extend({init:function(){this._super()},unmarshal:function(canvas,json){var node=null;$.each(json,function(i,element){var o=eval("new "+element.type+"()");var source=null;var target=null;for(i in element){var val=element[i];if(i==="source"){node=canvas.getFigure(val.node);source=node.getPort(val.port)}else{if(i==="target"){node=canvas.getFigure(val.node);target=node.getPort(val.port)}}}if(source!==null&&target!==null){o.setSource(source);o.setTarget(target)}o.setPersistentAttributes(element);canvas.addFigure(o)});canvas.calculateConnectionIntersection();canvas.getLines().each(function(i,line){line.svgPathString=null;line.repaint()});canvas.linesToRepaintAfterDragDrop=canvas.getLines().clone()}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/Icon.js' */
(function ($) {draw2d.shape.icon.Icon=draw2d.SetFigure.extend({NAME:"draw2d.shape.icon.Icon",init:function(B,A){this._super(B,A);this.setBackgroundColor("#333333")},repaint:function(A){if(this.repaintBlocked===true||this.shape===null){return }if(typeof A==="undefined"){A={}}A.fill="none";if(this.svgNodes!==null){this.svgNodes.attr({fill:this.bgColor.hash(),stroke:"none"})}this._super(A)},applyTransformation:function(){if(this.isResizeable()===true){this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}else{this.svgNodes.transform("T"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))}},createShapeElement:function(){var A=this._super();var B=this.svgNodes.getBBox();this.offsetX=B.x;this.offsetY=B.y;return A},setDimension:function(A,B){if(A>B){this._super(A,A)}else{this._super(B,B)}}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:draw2d', location = 'js/lib/draw2d/shape/icon/ArrowLeft.js' */
(function ($) {draw2d.shape.icon.ArrowLeft=draw2d.shape.icon.Icon.extend({NAME:"draw2d.shape.icon.ArrowLeft",init:function(B,A){this._super(B,A)},createSet:function(){return this.canvas.paper.path("M24.316,5.318L6.684,15.5l17.632,10.182V5.318L24.316,5.318z")}});}(jQuery));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/LineResizeHandleMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.LineResizeHandleMixin");JIRA.WorkflowDesigner.LineResizeHandleMixin={init:function(){this._actionableArea=new draw2d.shape.basic.Circle(20);this._actionableArea.draggable=true;this.setActionableAreaAttributes({})},setPosition:function(){this._actionableArea.setPosition(this.x-this._actionableArea.width/2+this.width/2,this.y-this._actionableArea.height/2+this.height/2)},show:function(A){this._actionableArea.setCanvas(A);this._actionableArea.sendToFront()},hide:function(){this._actionableArea.setCanvas(null)},repaint:function(A){A=_.extend({},A,{cursor:"crosshair",fill:"#333333",stroke:"#333333"});var B=this.getGap();this.x-=B.x;this.y-=B.y;if(this._actionableArea&&this._actionableAreaAttributes){this._actionableArea.repaint(this._actionableAreaAttributes);this._actionableArea.sendToFront()}return draw2d.shape.basic.LineResizeHandle.prototype.repaint.call(this,A)},setActionableAreaAttributes:function(A){this._actionableAreaAttributes=_.defaults({},A,{cursor:"crosshair","fill-opacity":0,"stroke-opacity":0})},hitTest:function(A,B){return this._actionableArea.hitTest(A,B)},sendActionableAreaToFront:function(){this._actionableArea.sendToFront()},onDragStart:function(){var A=this.getRelatedPort();A.triggerDragStart();_.chain(this._getDropTargets(A)).without(this.getOppositePortTo(A)).invoke("show")},onDragEnd:function(){var A=this.getRelatedPort();A.triggerDragEnd();_.invoke(this._getDropTargets(A),"hide")},_getDropTarget:function(A,C,B){return JIRA.WorkflowDesigner.StatusPort.getHitPort(A,C,this._getDropTargets(B))}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/RequestResponseMixin.js' */
(function(A){AJS.namespace("JIRA.WorkflowDesigner.RequestResponseMixin");JIRA.WorkflowDesigner.RequestResponseMixin={initialize:function(){this.requestResponse=new A.Wreqr.RequestResponse()},remove:function(){this.requestResponse.removeAllHandlers()}}}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-mixins', location = 'js/views/mixins/SelectableFigureMixin.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SelectableFigureMixin");JIRA.WorkflowDesigner.SelectableFigureMixin={deselect:function(){if(this.isSelected()){this._canvas.selectFigure(null)}else{this._onDeselect()}},isSelected:function(){return this._canvas.getSelectedFigure()===this._getFigure()},select:function(){if(this.isSelected()){this._onSelect()}else{this._canvas.selectFigure(this._getFigure())}}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'soy/Forms.soy' */
// This file was automatically generated from Forms.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Forms == 'undefined') { JIRA.WorkflowDesigner.Templates.Forms = {}; }


JIRA.WorkflowDesigner.Templates.Forms.checkbox = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group"><div class="checkbox">');
  aui.form.input({id: opt_data.id, isChecked: opt_data.isChecked, type: 'checkbox'}, output);
  aui.form.label({content: soy.$$escapeHtml(opt_data.labelContent), forField: opt_data.id, isRequired: false}, output);
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'soy/WorkflowDesigner.soy' */
// This file was automatically generated from WorkflowDesigner.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }


JIRA.WorkflowDesigner.Templates.actions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.primaryActions(opt_data, param3);
  }
  if (opt_data.fullScreenButton || ! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.secondaryActions(opt_data, param3);
  }
  aui.toolbar2.toolbar2({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.addStatusInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var hasStatuses__soy18 = opt_data.statusOptions.length > 0;
  var param20 = new soy.StringBuilder();
  var param21 = new soy.StringBuilder();
  aui.form.select({extraAttributes: {'data-container-class': 'full-width-field'}, extraClasses: 'full-width-field', id: 'status-name', options: opt_data.statusOptions}, param21);
  aui.form.fieldDescription({message: "Search for an existing status or name a new one."}, param21);
  aui.form.fieldGroup({content: param21.toString()}, param20);
  JIRA.WorkflowDesigner.Templates.Forms.checkbox({id: 'create-global-transition-add', isChecked: opt_data.createGlobalTransition, labelContent: soy.$$escapeHtml("Allow all statuses to transition to this one")}, param20);
  var param35 = new soy.StringBuilder();
  aui.form.submit({isDisabled: ! hasStatuses__soy18, name: 'submit', text: "Add"}, param35);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param35);
  aui.form.buttons({content: param35.toString()}, param20);
  aui.form.form({action: '', content: param20.toString(), isTopLabels: true}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.browserNotSupportedMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml("This feature is not available in Internet Explorer prior to version 9."));
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.browserNotSupportedWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param50 = new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.browserNotSupportedMessage(null, param50);
  aui.message.warning({content: '', titleContent: param50.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteInitialStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param56 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Read-Only"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("The initial status cannot be deleted.",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param56);
  param56.append('</div></div>');
  aui.form.form({action: '', content: param56.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.cannotDeleteStatusFromActiveWorkflow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param71 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Statuses can\x27t be removed from active workflows"), '</h2><div class="form-body"><p>', soy.$$escapeHtml("You can only remove statuses from inactive workflows. To start with this workflow and remove statuses, make a copy of it which will be inactive. You can assign it to the project when you\x27re happy with it."), '</p><p><a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Configuring+Workflow">', soy.$$escapeHtml("Learn more about configuring and editing workflows."), '</a></p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param71);
  param71.append('</div></div>');
  aui.form.form({action: '', content: param71.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.confirmDeleteStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param88 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml("Confirm Remove Status"), '</h2><div class="form-body"><p>', soy.$$escapeHtml(AJS.format("Are you sure you want to remove the status \x27\x27{0}\x27\x27 and delete the related transitions?",opt_data.name)), '</p></div><div class="buttons-container form-footer"><div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', name: 'submit', text: "Remove"}, param88);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param88);
  param88.append('</div></div>');
  aui.form.form({action: '', content: param88.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.container = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="container"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.createStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.WorkflowDesigner.Templates.statusDialog(soy.$$augmentData(opt_data, {submitText: "Create", title: "Create New Status"}), output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.editStatusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var beforeContent__soy111 = new soy.StringBuilder();
  if (opt_data.numberOfWorkflows > 1) {
    aui.message.warning({content: "This status is used in other workflows, editing it will affect them."}, beforeContent__soy111);
  }
  beforeContent__soy111 = beforeContent__soy111.toString();
  JIRA.WorkflowDesigner.Templates.statusDialog(soy.$$augmentData(opt_data, {beforeContent: beforeContent__soy111, submitText: "Save", title: "Edit Status"}), output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.fullScreenButtons = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button({extraClasses: 'enter-full-screen full-screen-trigger', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Enter full screen"}}, output);
  aui.buttons.button({extraClasses: 'exit-full-screen full-screen-trigger hidden', iconClass: 'aui-icon-small', iconType: 'aui', text: '', extraAttributes: {'title': "Exit full screen"}}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<strong>', soy.$$escapeHtml(opt_data.name), '</strong><p>', soy.$$escapeHtml(AJS.format("All statuses can transition to \x27\x27{0}\x27\x27.",opt_data.statusName)), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.lastEditedMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.updatedDate && opt_data.updateAuthor) {
    var authorName__soy142 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.updateAuthor.displayName));
    authorName__soy142 = authorName__soy142.toString();
    var timeElement__soy145 = new soy.StringBuilder('<time datetime="', soy.$$escapeHtml(opt_data.updatedDate), '"></time>');
    timeElement__soy145 = timeElement__soy145.toString();
    var wasCurrentUser__soy149 = opt_data.currentUserName == opt_data.updateAuthor.userName;
    output.append('<span class="last-edited-message">', (wasCurrentUser__soy149) ? AJS.format("Last edited by you, {0}",timeElement__soy145) : AJS.format("Last edited by {0}, {1}",authorName__soy142,timeElement__soy145), '</span>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.primaryActions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param160 = new soy.StringBuilder();
  aui.buttons.button({extraClasses: 'add-status', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add status", iconType: 'aui', text: "Add status"}, param160);
  aui.buttons.button({extraClasses: 'add-transition', iconClass: 'aui-icon-small aui-iconfont-add', iconText: "Add transition", iconType: 'aui', text: "Add transition"}, param160);
  aui.form.checkboxField({extraClasses: 'show-transition-labels', fields: [{'id': 'show-transition-labels', 'isChecked': opt_data.showTransitionLabels, 'labelText': "Show transition labels"}], legendContent: ''}, param160);
  aui.toolbar2.item({content: param160.toString(), item: 'primary'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.progressIndicatorBlanket = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="blanket"></div><div class="spinner"></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.secondaryActions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param182 = new soy.StringBuilder();
  if (! opt_data.immutable) {
    JIRA.WorkflowDesigner.Templates.lastEditedMessage(opt_data, param182);
  }
  if (opt_data.fullScreenButton) {
    JIRA.WorkflowDesigner.Templates.fullScreenButtons(null, param182);
  }
  aui.toolbar2.item({content: param182.toString(), item: 'secondary'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.statusDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content">');
  var param197 = new soy.StringBuilder('<h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body">', (opt_data.beforeContent) ? opt_data.beforeContent : '');
  aui.form.textField({id: 'status-name', isRequired: true, labelContent: "Name", name: 'name', value: opt_data.name}, param197);
  aui.form.textareaField({id: 'status-description', labelContent: "Description", name: 'description', rows: 4, value: opt_data.description}, param197);
  if (opt_data.showStatusCategoryField) {
    JIRA.WorkflowDesigner.Templates.statusCategorySelectField({id: 'status-category-id', statusCategoryOptions: opt_data.statusCategoryOptions}, param197);
  }
  param197.append('</div><div class="buttons-container form-footer">', (! opt_data.statusId) ? '<div class="checkbox buttons-container-left"><input ' + ((opt_data.createGlobalTransition) ? 'checked="checked"' : '') + ' class="checkbox" id="create-global-transition-create" type="checkbox"><label for="create-global-transition-create">' + soy.$$escapeHtml("Allow all statuses to transition to this one") + '</label></div>' : '', '<div class="buttons">');
  aui.form.submit({extraClasses: 'aui-button aui-button-primary', name: 'submit', text: opt_data.submitText}, param197);
  aui.form.linkButton({name: 'cancel', text: "Cancel"}, param197);
  param197.append('</div></div>');
  aui.form.form({action: '', content: param197.toString()}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.zoomControl = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button ', (opt_data.zoomInDisabled) ? 'aria-disabled="true"' : '', ' class="aui-button zoom-in" title="', soy.$$escapeHtml("Zoom in"), '" type="button">+</button><button ', (opt_data.zoomOutDisabled) ? 'aria-disabled="true"' : '', ' class="aui-button zoom-out" title="', soy.$$escapeHtml("Zoom out"), '" type="button">&ndash;</button>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/lib/cocktail-0.3.0.js' */
(function(){var A;if(typeof exports!=="undefined"){A=exports}else{A=this.Cocktail={}}A.mixins={};A.mixin=function C(F){var G=_.chain(arguments).toArray().rest().flatten().value();var H={};_(G).each(function(I){if(_.isString(I)){I=A.mixins[I]}_(I).each(function(K,J){if(_.isFunction(K)){if(F.prototype[J]){H[J]=H[J]||[F.prototype[J]];H[J].push(K)}F.prototype[J]=K}else{if(_.isObject(K)){F.prototype[J]=_.extend({},K,F.prototype[J]||{})}}})});_(H).each(function(I,J){F.prototype[J]=function(){var M=this,K=arguments,L=undefined;_(I).each(function(N){var O=_.isFunction(N)?N.apply(M,K):N;L=(O===undefined?L:O)});return L}})};var D;A.patch=function E(G){D=G.Model.extend;var F=function(J,K){var H=D.call(this,J,K);var I=H.prototype.mixins;if(I&&H.prototype.hasOwnProperty("mixins")){A.mixin(H,I)}return H};_([G.Model,G.Collection,G.Router,G.View]).each(function(H){H.mixin=function I(){A.mixin(this,_.toArray(arguments))};H.extend=F})};A.unpatch=function B(F){_([F.Model,F.Collection,F.Router,F.View]).each(function(G){G.mixin=undefined;G.extend=D})}})();
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/WorkflowDesignerBackboneDefine.js' */
(function(Backbone){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/Application.js' */
(function(B){function A(C){var D=JIRA.WorkflowDesigner.Templates.browserNotSupportedWarning;jQuery(D()).appendTo(C)}AJS.namespace("JIRA.WorkflowDesigner.Application");JIRA.WorkflowDesigner.Application=function(C){C=_.defaults({},C,{draft:false,immutable:false});if(!JIRA.WorkflowDesigner.browserIsSupported()){A(C.element);return }this._workflowModel=new JIRA.WorkflowDesigner.WorkflowModel({currentStepId:C.currentStepId,draft:C.draft,name:C.workflowId});this._canvas=this._createCanvas(C).render();if(!C.immutable){this._layoutAutoSaver=new JIRA.WorkflowDesigner.IO.LayoutAutoSaver({workflowModel:this._workflowModel})}this._initialiseWorkflow(C)};_.extend(JIRA.WorkflowDesigner.Application.prototype,B.Events,{_createCanvas:function(C){C=_.extend(C,{el:C.element,workflowModel:this._workflowModel});return new JIRA.WorkflowDesigner.Canvas(C)},destroy:function(){this._canvas&&this._canvas.remove();this._layoutAutoSaver&&this._layoutAutoSaver.destroy()},discardDraft:function(C){C=_.defaults({},C,{reloadDesigner:true});this._canvas.showProgressIndicator();return JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.discard(this._workflowModel.get("name")).pipe(_.bind(this._onPublishOrDiscardSuccessHandler,this,C.reloadDesigner),_.bind(this._onPublishOrDiscardFailHandler,this))},publishDraft:function(C){C=_.defaults({},C,{reloadDesigner:true});this._canvas.showProgressIndicator();return JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.publish(this._workflowModel).pipe(_.bind(this._onPublishOrDiscardSuccessHandler,this,C.reloadDesigner),_.bind(this._onPublishOrDiscardFailHandler,this))},_initialiseWorkflow:function(D){var C=this,E=this._loadWorkflow(D);E.done(function(){C._workflowModel.set("loadedAt",new Date());C._canvas.autoFit();C.trigger("loaded")})},_loadWorkflow:function(E){var D=jQuery.Deferred(),C=this,F;if(E.layoutData){F=jQuery.Deferred().resolve(E.layoutData)}else{if(E.workflowId){F=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(E.workflowId,!!E.draft)}}if(F){this._canvas.showProgressIndicator();F.always(function(){C._canvas.hideProgressIndicator()});F.done(function(G){C._workflowModel.reset(G);D.resolve()});F.fail(function(G){JIRA.WorkflowDesigner.Messages.showErrorMessage(G);D.reject(G)})}else{D.resolve()}return D.promise()},_onPublishOrDiscardSuccessHandler:function(C){this._layoutAutoSaver.removeUnsavedChangesMessage();if(C){return this._loadWorkflow({workflowId:this._workflowModel.get("name"),draft:this._workflowModel.get("draft")})}},_onPublishOrDiscardFailHandler:function(C){JIRA.WorkflowDesigner.Messages.showErrorMessage(C);this._canvas.hideProgressIndicator()}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/Canvas.js' */
(function(A){A.define("JIRA.WorkflowDesigner.Canvas",A.Marionette.ItemView.extend({template:JIRA.WorkflowDesigner.Templates.container,ui:{container:".container"},initialize:function(B){B=_.defaults(B,{actions:true,fullScreenButton:true,immutable:false});this._browserZoomChecker=new JIRA.WorkflowDesigner.BrowserZoomChecker();this._canvasModel=new JIRA.WorkflowDesigner.CanvasModel({},{workflowModel:B.workflowModel});this._canvasView=new JIRA.WorkflowDesigner.CanvasView({canvasModel:this._canvasModel,immutable:B.immutable,workflowModel:B.workflowModel});B.actions&&(this._actionsView=this._createActionsView(B));B.immutable||(this._propertiesPanelView=this._createPropertiesPanelView(B));this._zoomControlView=this._createZoomControlView()},autoFit:function(){this._canvasView.autoFit()},_createActionsView:function(C){var B;B=new JIRA.WorkflowDesigner.ActionsView({canvasModel:this._canvasModel,fullScreenButton:C.fullScreenButton,immutable:C.immutable,workflowModel:C.workflowModel});this.listenTo(B,{"addStatus:done":this.hideProgressIndicator,"addStatus:submit":this.showProgressIndicator,"fullScreen:enter":this._enterFullScreen,"fullScreen:exit":this._exitFullScreen});return B},_createPropertiesPanelView:function(B){var C;C=new JIRA.WorkflowDesigner.PropertiesPanel.PropertiesPanelView({canvasModel:this._canvasModel,workflowModel:B.workflowModel});this.listenTo(C,{"transaction:end":this.hideProgressIndicator,"transaction:start":this.showProgressIndicator});return C},_createZoomControlView:function(){var B,C;B={maximumZoomLevel:2,minimumZoomLevel:0.5,model:this._canvasModel};C=new JIRA.WorkflowDesigner.ZoomControlView(B);this.listenTo(C,{zoomIn:_.bind(this._canvasView.zoom,this._canvasView,0.75),zoomOut:_.bind(this._canvasView.zoom,this._canvasView,1.25)});return C},_enterFullScreen:function(){var B=this._canvasView;B.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.enterFullScreen(this.el).done(function(){B.setResizeInterval(JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL)})},_exitFullScreen:function(){var C=this._canvasView,B=this;C.setResizeInterval(25);JIRA.WorkflowDesigner.FullScreenController.exitFullScreen(this.el).done(function(){C.setResizeInterval(JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL);B.$el.css("width","auto")})},hideProgressIndicator:function(){this._canvasView.setLocked(false);this._progressIndicator.hide()},onRender:function(){this.$el.addClass("workflow-designer");this._actionsView&&this.$el.prepend(this._actionsView.render().el);this._canvasView.render(this.ui.container);this._propertiesPanelView&&this.ui.container.append(this._propertiesPanelView.render().el);this.ui.container.append(this._zoomControlView.render().el)},remove:function(){A.Marionette.ItemView.prototype.remove.apply(this,arguments);this._browserZoomChecker.destroy();this._canvasView.remove()},showProgressIndicator:function(){var B={container:this.el},C=JIRA.WorkflowDesigner.ProgressIndicatorBlanketView;this._canvasView.setLocked(true);this._progressIndicator||(this._progressIndicator=new C(B));this._progressIndicator.show()}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/CanvasModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.CanvasModel",A.Model.extend({defaults:{selectedModel:null,selectedView:null,showTransitionLabels:false,zoomLevel:null},initialize:function(B,C){this._workflowModel=C.workflowModel;this.listenTo(this,"change:showTransitionLabels",this._onShowTransitionLabelsChange);this.listenTo(this._workflowModel,{"new:status":this._selectModel,"new:transition":this._selectModel,"reset:before":this._deselect});this.listenTo(this._workflowModel.get("transitions"),"destroy",this._onDestroy)},_deselect:function(){this.set({selectedModel:null,selectedView:null})},_onDestroy:function(C){var B=this.get("selectedModel")===C;B&&this._deselect()},_onShowTransitionLabelsChange:function(B,C){JIRA.WorkflowDesigner.Analytics.triggerToggleLabels(C)},_selectModel:function(B){this.get("selectedModel")||this.set("selectedModel",B)},selectView:function(B){this.set({selectedModel:B&&B.model,selectedView:B})}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/collections/StatusCollection.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusCollection",A.Collection.extend({model:function(B,C){return new JIRA.WorkflowDesigner.StatusModel(B,C)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/collections/TransitionCollection.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionCollection",A.Collection.extend({model:function(B,C){return new JIRA.WorkflowDesigner.TransitionModel(B,C)},getInitial:function(){return this.find(function(B){return B.isInitial()})}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/collections/TransitionOptionTypeCollection.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionOptionTypeCollection",A.Collection.extend({model:function(B,C){return new JIRA.WorkflowDesigner.TransitionOptionTypeModel(B,C)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ajax/AJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.AJAXManager");JIRA.WorkflowDesigner.IO.AJAX.AJAXManager={_makeRequest:function(B){var A=jQuery.Deferred(),C;B.headers=_.extend({},B.headers,{"X-Atlassian-Token":"nocheck"});C=JIRA.SmartAjax.makeWebSudoRequest(B,{cancel:function(D){_.defer(A.reject,undefined,"abort");D.preventDefault()}});C.done(A.resolve);C.fail(A.reject);return A.promise()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ajax/WorkflowAJAXManager.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager");JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager=_.extend({},JIRA.WorkflowDesigner.IO.AJAX.AJAXManager,{discard:function(C){var B=jQuery.Deferred(),A=this;this._publishOrDiscardRequest=this._makeRequest({contentType:"application/json",data:C,success:B.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/discardDraft"});this._publishOrDiscardRequest.fail(function(E,D){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(E,D))});this._publishOrDiscardRequest.always(function(){delete A._publishOrDiscardRequest});return B.promise()},load:function(C,A){var B=jQuery.Deferred(),D;D=this._makeRequest({data:{name:C,draft:!!A},dataType:"json",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});D.done(function(E){var G,F=E.layout;G=JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(F);G=_.extend(G,{liveStepIds:E.liveStepIds});B.resolve(G,E)});D.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});return B.promise()},publish:function(C){var B=jQuery.Deferred(),A=this,D=JIRA.WorkflowDesigner.IO.WorkflowDataWriter.write(C);this._publishOrDiscardRequest=this._makeRequest({contentType:"application/json",data:JSON.stringify(D),success:B.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows/publishDraft"});this._publishOrDiscardRequest.fail(function(F,E){B.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))});this._publishOrDiscardRequest.always(function(){delete A._publishOrDiscardRequest});return B.promise()},save:function(C){var A=jQuery.Deferred(),B,D=JIRA.WorkflowDesigner.IO.WorkflowDataWriter.write(C);if(!this._publishOrDiscardRequest){B=this._makeRequest({contentType:"application/json",data:JSON.stringify(D),success:A.resolve,type:"POST",url:AJS.contextPath()+"/rest/workflowDesigner/latest/workflows"});B.fail(function(F,E){A.reject(JIRA.WorkflowDesigner.IO.ErrorHandler.getErrorMessage(F,E))})}return A.promise()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/ErrorHandler.js' */
(function(){var A;function B(D,C){return !!/websudo/i.exec(D)&&C===401}AJS.namespace("JIRA.WorkflowDesigner.IO.ErrorHandler");A={generic:"The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation.",notAuthenticated:"You are not authorized to perform this operation.  Please log in.",timeout:"The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation.",webSudo:"Your temporary administrative access has timed out. Please refresh the page and try again."};JIRA.WorkflowDesigner.IO.ErrorHandler={getErrorMessage:function(D,C,H){var F=D&&D.responseText,E=D&&D.status;H=_.defaults({},H,A);if(C==="timeout"){return H.timeout}if(B(F,E)){return H.webSudo}if(E===401){return H.notAuthenticated}if(_.contains([400,403,404],E)){try{return JSON.parse(F).errorMessages[0]||F}catch(G){return F}}if(C!=="abort"){return H.generic}return null},handle:function(D,C){var E;E=this.getErrorMessage(D,C);E&&JIRA.WorkflowDesigner.Messages.showErrorMessage(E)}};_.bindAll(JIRA.WorkflowDesigner.IO.ErrorHandler,"getErrorMessage","handle")}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/io/WorkflowDataReader.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.IO.WorkflowDataReader");JIRA.WorkflowDesigner.IO.WorkflowDataReader={read:function(D){var B={},C=[];if(!D||!D.statuses||!D.transitions){return }_.each(D.statuses,function(F){var E=new JIRA.WorkflowDesigner.StatusModel(F);B[E.id]=E});_.each(D.transitions,function(E){C.push(A(E,B))});return{statuses:_.values(B),transitions:C,updateAuthor:D.updateAuthor,updatedDate:new Date(D.updatedDate)}}};function A(B,C){B=_.chain(B).omit("sourceId","targetId").extend({source:C[B.sourceId],target:C[B.targetId]}).value();return new JIRA.WorkflowDesigner.TransitionModel(B)}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/connection/GappedConnection.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.GappedConnection");JIRA.WorkflowDesigner.Layout.Connection.GappedConnection=draw2d.Connection.extend({init:function(A,B){this._super();this._sourceGap=A;this._targetGap=B},_getTransformation:function(C,D){var B=0,A=0;switch(C){case JIRA.WorkflowDesigner.Direction.UP:A=-D;break;case JIRA.WorkflowDesigner.Direction.RIGHT:B=D;break;case JIRA.WorkflowDesigner.Direction.DOWN:A=D;break;case JIRA.WorkflowDesigner.Direction.LEFT:B=-D;break}return{x:B,y:A}},getEndPointGapTransformation:function(){return this._getTransformation(this.getTarget().getConnectionDirection(),this._targetGap)},getStartPointGapTransformation:function(){return this._getTransformation(this.getSource().getConnectionDirection(),this._sourceGap)},setEndPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getEndPointGapTransformation();this._super(A+B.x,C+B.y)}},setStartPoint:function(A,C){var B;if(this.isMoving){this._super(A,C)}else{B=this.getStartPointGapTransformation();this._super(A+B.x,C+B.y)}},getEndPoint:function(){var B,A=this._super();if(this.isMoving){return A}B=this.getEndPointGapTransformation();return A.clone().translate(B.x,B.y)},getStartPoint:function(){var B=this.getStartPointGapTransformation(),A=this._super();if(this.isMoving){return A}return A.clone().translate(B.x,B.y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/connection/RoundedManhattanConnectionRouter.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter");JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({CORNER_RADIUS:5,init:function(){this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Vector2D},_calculateConnectionPoints:function(B){this._route(B,B.getEndPoint(),B.getTarget().getConnectionDirection(),B.getStartPoint(),B.getSource().getConnectionDirection());return B.getPoints().asArray()},_getPointInstructions:function(C,D,F){var E=new A(C,F[D+1]||C),G=new A(C,F[D-1]||C),B;B=Math.min(E.getLength()/2,G.getLength()/2,this.CORNER_RADIUS);return["L",C.add(G.normalize().multiply(B)).getComponents(),"S",C.getComponents(),C.add(E.normalize().multiply(B)).getComponents()]},route:function(D){var C=this,E;function B(G,F,H,I){return G.concat(C._getPointInstructions(F,H,I))}E=this._calculateConnectionPoints(D);D.svgPathString=_.reduce(E,B,["M",E[0].x,E[0].y]).join(" ")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/ManhattanPercentageLocator.js' */
(function(){function B(C){return new JIRA.WorkflowDesigner.Vector2D(C.start,C.end).getLength()}function A(C){var D=C.getSegments().asArray();return _.reduce(D,function(E,F){return E+B(F)},0)}AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator");JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator=draw2d.layout.locator.ConnectionLocator.extend({init:function(D,C){this._percentage=C;this._super(D)},relocate:function(D,F){var C=this.getParent(),H=A(C)*this._percentage,E,G;E=_.find(C.getSegments().asArray(),function(J){var I=B(J);if(I>=H){return true}H-=I});if(E){G=new JIRA.WorkflowDesigner.Vector2D(E.start,E.end);G.normalize().multiply(H).translate(F.getWidth()/-2,F.getHeight()/-2);F.setPosition(E.start.getTranslated(G))}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/PositionOnParentBoundsLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator");JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator=draw2d.layout.locator.Locator.extend({init:function(A){this._super(A.parent);this.side=A.side;this.bias=A.bias},relocate:function(B,D){var F=this.getParent().getBoundingBox(),C=JIRA.WorkflowDesigner.Direction,A,E;if(this.side===C.UP||this.side===C.DOWN){A=F.getWidth()*this.bias;E=(this.side===C.UP)?0:F.getHeight()}else{if(this.side===C.LEFT||this.side===C.RIGHT){E=F.getHeight()*this.bias;A=(this.side===C.LEFT)?0:F.getWidth()}}D.setPosition(A,E)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/layout/locator/StaticLocator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Layout.Locator.StaticLocator");JIRA.WorkflowDesigner.Layout.Locator.StaticLocator=draw2d.layout.locator.Locator.extend({init:function(B,A,C){this._super(B);this._x=A;this._y=C},relocate:function(A,B){B.setPosition(this._x,this._y)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/StatusModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusModel",A.Model.extend({defaults:{description:"",id:null,initial:false,name:"",statusCategory:null,statusId:null,stepId:null,x:null,y:null},hasCoordinates:function(){var B=this.get("x"),C=this.get("y");return _.isNumber(B)&&_.isNumber(C)},hasTransition:function(B){return(B.get("source")===this||B.get("target")===this)},isInitial:function(){return this.get("initial")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/TransitionModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionModel",A.Model.extend({defaults:function(){return{id:null,actionId:null,description:null,globalTransition:false,name:null,screenId:null,screenName:null,source:null,sourceAngle:null,target:null,targetAngle:null,transitionOptions:new JIRA.WorkflowDesigner.TransitionOptionTypeCollection()}},initialize:function(){this._createId();this.on("change:actionId change:source change:target",_.bind(this._createId,this))},_createId:function(){var E=this.getActionId(),C,B=this.get("source"),D=this.get("target");if(E&&B&&D){C=B.isInitial()?"IA":"A";this.set("id",C+"<"+E+":"+B.get("id")+":"+D.get("id")+">")}},isGlobalTransition:function(){return this.get("globalTransition")},isInitial:function(){return this.get("source").isInitial()},getActionId:function(){return this.get("actionId")},getSourceStepId:function(){var B=this.get("source");return B&&B.get("stepId")},getTargetStepId:function(){var B=this.get("target");return B&&B.get("stepId")},setSource:function(C,B){this.set({source:C,sourceAngle:B})},setTarget:function(C,B){this.set({target:C,targetAngle:B})},sync:jQuery.noop}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/TransitionOptionTypeModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionOptionTypeModel",A.Model.extend({defaults:{count:0,key:null,name:null,url:null,weight:1000}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/models/WorkflowModel.js' */
(function(A){A.define("JIRA.WorkflowDesigner.WorkflowModel",A.Model.extend({defaults:function(){return{currentStepId:null,draft:false,name:null,liveStepIds:null,loadedAt:null,statuses:new JIRA.WorkflowDesigner.StatusCollection(),transitions:new JIRA.WorkflowDesigner.TransitionCollection(),updatedDate:null,updateAuthor:null}},initialize:function(){var B=_.bind(this.trigger,this,"layoutChanged");this.listenTo(this.get("statuses"),{"change:x change:y":B,reset:this._detectNewStatus});this.listenTo(this.get("transitions"),{"change:actionId change:sourceAngle change:target change:targetAngle remove":B,reset:this._detectNewTransition})},addStatus:function(B){var C=B instanceof JIRA.WorkflowDesigner.StatusModel;C||(B=new JIRA.WorkflowDesigner.StatusModel(B));this.get("statuses").add(B);return B},addTransition:function(C){var B=C instanceof JIRA.WorkflowDesigner.TransitionModel;B||(C=new JIRA.WorkflowDesigner.TransitionModel(C));this.get("transitions").add(C);return C},_detectNewStatus:function(D,C){var B=this._getNewModel(D,C.previousModels);B&&this.trigger("new:status",B)},_detectNewTransition:function(D,B){var C=this._getNewModel(D,B.previousModels);C&&this.trigger("new:transition",C)},getGlobalTransitionForStatus:function(B){return this.get("transitions").findWhere({globalTransition:true,target:B})},_getInitialTransitions:function(){return this.get("transitions").filter(function(B){return B.isInitial()})},getInitialTransitionDestinations:function(){return _.map(this._getInitialTransitions(),function(B){return B.get("target")})},_getNewModel:function(B,D){var C=D.length===0;B=B.filter(function(E){return _.every(D,function(F){return E.id!==F.id})});if(B.length===1&&!C){return B[0]}},getStatus:function(B){return this.get("statuses").get(B)},removeTransition:function(B){this.get("transitions").remove(B)},reset:function(B){this.trigger("reset:before");this.get("statuses").reset(B.statuses);this.get("transitions").reset(B.transitions);this.set(_.omit(B,"statuses","transitions"));this.trigger("reset:after")},statusHasGlobalTransition:function(B){return !!this.getGlobalTransitionForStatus(B)},statusIsDeletable:function(C){var D=this.get("draft"),B=_.contains(this.get("liveStepIds"),C.get("stepId"));return !(D&&B)},updateTransitionSource:function(B){var C=this.get("statuses").findWhere({initial:false,stepId:B.sourceStepId});B.transition.setSource(C,B.sourceAngle)},updateTransitionTargets:function(C){var D=C.transition.get("actionId"),B;B=this.get("statuses").findWhere({initial:false,stepId:C.targetStepId});C.transition.setTarget(B,C.targetAngle);this.get("transitions").chain().filter(function(E){return E!==C.transition&&E.get("actionId")===D}).invoke("setTarget",B)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/PanningSingleSelectionPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy");JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({init:function(A){this._super();this._getCanvasBoundingBox=A},onMouseDown:function(B,A,C){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this._super(B,A,C);this._initialViewBox=B.getViewBox();this._boundingBox=this._getCanvasBoundingBox()},onMouseDrag:function(D,C,B,E,A){this._super(D,C,B,E,A);if(this.mouseDownElement===null&&this.mouseDraggingElement===null){D.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getPanViewBox({diagramBoundingBox:this._boundingBox,displacement:new JIRA.WorkflowDesigner.Vector2D(-C,-B),viewBox:this._initialViewBox}))}}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/GuideLineEditPolicy.js' */
(function(){var A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({GUIDE_LINE_COLOUR:"#ff0000",init:function(){this._super.apply(this,arguments);A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_collectFigures:function(){var B=this;if(this.figures){return }this.figures=[];this.canvas.getFigures().each(function(D,C){if(C.snapToGeometry){if(C.isInDragDrop){B.dragFigure=C}else{B.figures.push(C)}}})},_collectSnapPoints:function(){if(this.SnapPoints){return }this.SnapPoints={x:A.getXSnapPoints(this.figures),y:A.getYSnapPoints(this.figures)}},_drawGuideLine:function(C,E,B,D){var F=["M",C,E,"L",B,D].join(" ");this.guideLines||(this.guideLines=[]);this.guideLines.push(this.canvas.paper.path(F).attr({stroke:this.GUIDE_LINE_COLOUR}))},_drawGuideLines:function(B,C,D){var E=_.cartesianProduct(C,D);_.each(E,function(F){if(this._equalSnapPoints(F[0],F[1])){B.apply(this,F)}},this)},_drawHorizontalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getRight(),G.rectangle.getRight()),D=Math.min(E.rectangle.getLeft(),G.rectangle.getLeft());this._drawGuideLine(D,E.value,F,E.value)}C=A.getYSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.y)},_drawVerticalGuideLines:function(){var C;function B(E,G){var F=Math.max(E.rectangle.getBottom(),G.rectangle.getBottom()),D=Math.min(E.rectangle.getTop(),G.rectangle.getTop());this._drawGuideLine(E.value,D,E.value,F)}C=A.getXSnapPoints(this.dragFigure);this._drawGuideLines(B,C,this.SnapPoints.x)},_equalSnapPoints:function(C,B){return Math.abs(C.value-B.value)<=0.1},onInstall:function(B){this.canvas=B},onMouseDrag:function(){this._collectFigures();this._removeGuideLines();if(!this.dragFigure||this.figures.length===0){return }this._collectSnapPoints();this._drawHorizontalGuideLines();this._drawVerticalGuideLines()},onMouseUp:function(){delete this.dragFigure;delete this.figures;delete this.SnapPoints;this._removeGuideLines()},onUninstall:function(){delete this.canvas},_removeGuideLines:function(){_.invoke(this.guideLines,"remove");this.guideLines=[]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/SnapEditPolicy.js' */
(function(){var B;var A;AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({SNAP_THRESHOLD:3,init:function(){this._super.apply(this,arguments);B=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper;A=JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints},_createSnappers:function(C){var D;if(this.snappers){return }D=this._getFigures(C);this.snappers={x:new B(this._getXSnapPoints(D)),y:new B(this._getYSnapPoints(D))}},_getFigures:function(C){return _.filter(C.getFigures().asArray(),function(D){return !D.isInDragDrop&&D.snapToGeometry})},_getXSnapPoints:function(C){return _.pluck(A.getXSnapPoints(C),"value")},_getYSnapPoints:function(C){return _.pluck(A.getYSnapPoints(C),"value")},onMouseUp:function(){delete this.snappers},snap:function(E,D,C){if(!D.snapToGeometry){return C}this._createSnappers(E);return this._snapFigure(D).getTopLeft()},_snapFigure:function(C){return C.getBoundingBox().translate(this._snapPoints(this._getXSnapPoints(C),this.snappers.x),this._snapPoints(this._getYSnapPoints(C),this.snappers.y))},_snapPoints:function(E,D){var C=_.chain(E).map(D.snap).min(Math.abs).value();return Math.abs(C)<=this.SNAP_THRESHOLD?C:0}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/Snapper.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper=function(A){_.bindAll(this,"snap");this.points=A};JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.Snapper.prototype={snap:function(B){function A(C){return C-B}if(this.points.length===0){return 0}return _.chain(this.points).map(A).min(Math.abs).value()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/canvas/snap-to-geometry/SnapPoints.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints");JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints={getXSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getLeft(),D.getCenter().getX(),D.getRight()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},getYSnapPoints:function(A){function B(C){var D=C.getBoundingBox();return _.map([D.getTop(),D.getBottom()],this._makeSnapPoint(C))}_.isArray(A)||(A=[A]);return _.flatMap(A,B,this)},_makeSnapPoint:function(A){return function(B){return{rectangle:A.getBoundingBox(),value:B}}}};_.bindAll(JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapPoints,"getXSnapPoints","getYSnapPoints")}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/policy/port/StatusPortsFeedbackPolicy.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy");JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy=draw2d.policy.port.IntrusivePortsFeedbackPolicy.extend({prepareDropTargetsForDrag:function(A){_.invoke(A.asArray(),"show")},alterDropTargetOnDrag:jQuery.noop,alterDropTargetOnDragEnd:jQuery.noop,getConnectionLineColour:function(){return"#1a8cff"},onHoverEnter:function(B,C,A){A.setGlow(true)},onHoverLeave:function(B,C,A){A.setGlow(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Analytics.js' */
(function(){var A,E;function F(G,H){if(AJS.EventQueue){AJS.EventQueue.push({name:"administration.workflow."+G,properties:H})}}function C(H,I){var G="administration.workflow."+H;if(AJS.Analytics){AJS.Analytics.triggerPrivacyPolicySafeEvent(G,I)}else{AJS.trigger("analyticsEvent",{name:G,data:I})}}function B(G,H){jQuery(document).on("click",G,function(){C(H)})}function D(H,G){F("edit",{mode:"new-diagram",action:H,object:G})}B(".enter-full-screen","fullscreen");B("[data-transition-option-key='properties.key']","view.transition.properties");B("[data-transition-option-key='com.atlassian.jira.plugins.jira-transition-triggers-plugin:triggers-transitions-tab']","view.transition.triggers-transitions-tab");B("[data-transition-option-key='com.atlassian.jira.plugin.system.workfloweditor.transition.tabs:conditions']","view.transition.conditions");B("[data-transition-option-key='com.atlassian.jira.plugin.system.workfloweditor.transition.tabs:validators']","view.transition.validators");B("[data-transition-option-key='com.atlassian.jira.plugin.system.workfloweditor.transition.tabs:postfunctions']","view.transition.postfunctions");B(".status-properties","view.status.properties");AJS.namespace("JIRA.WorkflowDesigner.Analytics");JIRA.WorkflowDesigner.Analytics={_reset:function(){A=false;E=false},triggerToggleLabels:function(G){F("toggle.labels."+(G?"on":"off"))},triggerAddStatus:function(){D("add","status")},triggerUpdateStatus:function(){D("update","status")},triggerAddStep:function(){D("add","step")},triggerFirstAddStatus:function(I){var H="jira.workflowdesigner.added.first.status",G=jQuery.Deferred(),J=JIRA.WorkflowDesigner.IO.AJAX.UserPropertiesAJAXManager;A||(G=J.getProperty(H));G.done(function(L){var K=!L.value;if(K){F("first.add.status",{duration:I});J.setProperty(H,true)}A=true})},triggerUpdateStep:function(){D("update","step")},triggerRemoveStep:function(){D("remove","step")},triggerAddCommonTransition:function(){D("add","commontransition")},triggerAddTransition:function(){D("add","transition")},triggerFirstAddTransition:function(I){var H="jira.workflowdesigner.added.first.transition",G=jQuery.Deferred(),J=JIRA.WorkflowDesigner.IO.AJAX.UserPropertiesAJAXManager;E||(G=J.getProperty(H));G.done(function(L){var K=!L.value;if(K){F("first.add.transition",{duration:I});J.setProperty(H,true)}E=true})},triggerUpdateTransition:function(){D("update","transition")},triggerRemoveTransition:function(){D("remove","transition")},triggerAddGlobalTransition:function(){D("add","globaltransition")},triggerUpdateGlobalTransition:function(){D("update","globaltransition")},triggerRemoveGlobalTransition:function(){D("remove","globaltransition")}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/BrowserUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserUtilities");JIRA.WorkflowDesigner.BrowserUtilities={escapeQueryParameter:function(A){return encodeURIComponent(A).replace(/[!'()]/g,escape).replace(/\*/g,"%2A").replace(/%20/g,"+")},makeQueryString:function(B){function A(D){var C=JIRA.WorkflowDesigner.BrowserUtilities.escapeQueryParameter;return _.map(D,C).join("=")}return _.map(_.pairs(B),A).join("&")},getZoomLevel:function(){var A;if(jQuery.browser.mozilla){return null}else{if(jQuery.browser.msie){A=screen.deviceXDPI/screen.logicalXDPI}else{if(jQuery.browser.webkit){A=window.outerWidth/window.innerWidth}}}return Math.round(A*10)/10},isMac:function(){return navigator.platform.toUpperCase().indexOf("MAC")!==-1}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/BrowserZoomChecker.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.BrowserZoomChecker");JIRA.WorkflowDesigner.BrowserZoomChecker=function(){_.bindAll(this,"_startWindowResizeSession","_endWindowResizeSession");jQuery(window).on("resize",this._startWindowResizeSession);this._debouncedEndWindowResizeSession=_.debounce(this._endWindowResizeSession,250);this._intervalId=setInterval(_.bind(this._check,this),1000)};_.extend(JIRA.WorkflowDesigner.BrowserZoomChecker.prototype,{_isMac:JIRA.WorkflowDesigner.BrowserUtilities.isMac(),_check:function(){var A=this._isMac?"The workflow designer may not behave correctly at your current browser zoom level, press \u2318 + 0 to reset it.":"The workflow designer may not behave correctly at your current browser zoom level, press Ctrl + 0 to reset it.",B;if(this._windowIsResizing){return }B=JIRA.WorkflowDesigner.BrowserUtilities.getZoomLevel();if(!B){return }if(B!==1){this._browserZoomMessage=JIRA.WorkflowDesigner.Messages.showErrorMessage(A)}else{if(this._browserZoomMessage){this._browserZoomMessage.remove()}}},destroy:function(){clearInterval(this._intervalId);jQuery(window).off("resize",this._startWindowResizeSession);this._browserZoomMessage&&this._browserZoomMessage.remove()},_endWindowResizeSession:function(){this._windowIsResizing=false},_startWindowResizeSession:function(){this._windowIsResizing=true;this._debouncedEndWindowResizeSession()}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Collection.js' */
(function(B){var A=["chain","filter","find","invoke","without"];AJS.namespace("JIRA.WorkflowDesigner.Collection");JIRA.WorkflowDesigner.Collection=function(C){this.length=0;this._objects=[];this.reset(C||[])};_.extend(JIRA.WorkflowDesigner.Collection.prototype,B.Events,{add:function(C){C=[].concat(C);_.each(C,function(D){D.on("all",this.trigger,this)},this);this._objects=this._objects.concat(C);this.length=this._objects.length;return this},at:function(C){return this._objects[C]},remove:function(C){C=_.isArray(C)?C:[C];_.each(C,function(D){D.off("all",this.trigger,this)},this);this._objects=_.difference(this._objects,C);this.length=this._objects.length;return this},reset:function(C){this.remove(this._objects);return this.add(C)}});_.each(A,function(C){JIRA.WorkflowDesigner.Collection.prototype[C]=function(){return _[C].apply(_,[this._objects].concat(_.toArray(arguments)))}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Direction.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Direction");JIRA.WorkflowDesigner.Direction={DOWN:2,LEFT:3,RIGHT:1,UP:0}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Draw2DUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DUtilities");JIRA.WorkflowDesigner.Draw2DUtilities={setCursor:function(A,C){var B=A.svgNodes||A.shape;B&&B.attr("cursor",C)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/FigureUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.FigureUtilities");JIRA.WorkflowDesigner.FigureUtilities={calculateBoundingBox:function(D){var B=null,F=null,G=null,E=null,C,A;_.each(D,function(H){var J=H.getX(),I=H.getY();if(!B||B>J){B=J}if(!F||F<J){F=J}if(!G||G>I){G=I}if(!E||E<I){E=I}});C=F-B;A=E-G;return new draw2d.geo.Rectangle(B,G,C,A)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Messages.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Messages");JIRA.WorkflowDesigner.Messages={showErrorMessage:function(C,B){var A;B=_.defaults({},B,{closeable:true,timeout:0});if(C){A=JIRA.Messages.showErrorMsg(C,B);A.css("z-index",2510)}return A}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/FigurePatch.js' */
(function(){_.extend(draw2d.Figure.prototype,{sendToBack:function(){this.svgNodes&&this.svgNodes.toBack();this.shape&&this.shape.toBack();return this},sendToFront:function(){this.shape&&this.shape.toFront();this.svgNodes&&this.svgNodes.toFront();return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/LabelPatch.js' */
(function(){var A=draw2d.shape.basic.Label.prototype.setText;_.extend(draw2d.shape.basic.Label.prototype,{setText:function(){A.apply(this,arguments);this.cachedHeight=null;this.cachedMinHeight=null}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/LinePatch.js' */
(function(){_.extend(draw2d.shape.basic.Line.prototype,{getBoundingBox:function(){return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox([this.getStartPoint(),this.getEndPoint()])}});draw2d.shape.basic.Line.hit=function(D,C,J,B,I,H,G){B-=C;I-=J;H-=C;G-=J;var F=H*B+G*I;var A;if(F<=0){return false}else{H=B-H;G=I-G;F=H*B+G*I;if(F<=0){return false}else{A=F*F/(B*B+I*I)}}var E=H*H+G*G-A;if(E<0){E=0}return Math.sqrt(E)<D}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/NodePatch.js' */
(function(){_.extend(draw2d.shape.node.Node.prototype,{onDoubleClick:jQuery.noop})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/PointPatch.js' */
(function(){_.extend(draw2d.geo.Point.prototype,{add:function(){return this.getTranslated.apply(this,arguments)},getComponents:function(){return[this.x,this.y]}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/PolyLinePatch.js' */
(function(){_.extend(draw2d.shape.basic.PolyLine.prototype,{getBoundingBox:function(){var A=this.getPoints().asArray();return JIRA.WorkflowDesigner.FigureUtilities.calculateBoundingBox(A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/patches/RectanglePatch.js' */
(function(){var A={union:function(C){var B,D;B={x:Math.max(C.getRight(),this.getRight()),y:Math.max(C.getBottom(),this.getBottom())};D={x:Math.min(C.getLeft(),this.getLeft()),y:Math.min(C.getTop(),this.getTop())};return new draw2d.geo.Rectangle(D.x,D.y,B.x-D.x,B.y-D.y)},clone:function(){return new draw2d.geo.Rectangle(this.x,this.y,this.w,this.h)},scaleByFactor:function(B){return this.scale(this.w*(B-1),this.h*(B-1))},scaleHeight:function(B){this.h+=B;this.y-=B/2;this.adjustBoundary();return this},scaleWidth:function(B){this.w+=B;this.x-=B/2;this.adjustBoundary();return this},getRelativePosition:function(B){return B.subtract(this.getTopLeft())},getRelativePositionAsPercentage:function(C){var B=this.getRelativePosition(C);return new draw2d.geo.Point(B.x/this.w,B.y/this.h)}};_.extend(draw2d.geo.Rectangle.prototype,A)}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/StatusLozengeColours.js' */
(function(){function A(D){D=D.match(/\d+/g);return"#"+_.map(D,function(E){E=parseInt(E,10).toString(16);return("0"+E).slice(-2)}).join("")}function B(E){var F=C(E),D=F.css(E.property);F.remove();return A(D)}function C(D){return jQuery(JIRA.Template.Util.Issue.Status.issueStatus({isSubtle:!!D.isSubtle,issueStatus:{statusCategory:{colorName:D.colourName}}})).hide().appendTo("body")}AJS.namespace("JIRA.WorkflowDesigner.StatusLozengeColours");JIRA.WorkflowDesigner.StatusLozengeColours={getBackgroundColour:function(D){D.property="background-color";return B(D)},getBorderColour:function(D){D.property="border-top-color";return B(D)},getColour:function(D){D.property="color";return B(D)}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/SVGUtilities.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.SVGUtilities");JIRA.WorkflowDesigner.SVGUtilities={fromScreenToSVGCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM().inverse(),B,D)},fromSVGToPageCoordinate:function(E,D,F){var C=jQuery(window.document),B=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(E,D,F);B.x+=C.scrollLeft();B.y+=C.scrollTop();return B},fromSVGToScreenCoordinate:function(C,B,D){C=jQuery(C).get(0);return A(C,C.getScreenCTM(),B,D)},getPageBoundingBox:function(D){var C,B=jQuery(D).get(0).getBBox(),E;E=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x,B.y);C=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToPageCoordinate(D,B.x+B.width,B.y+B.height);return{height:C.y-E.y,width:C.x-E.x,x:E.x,y:E.y}}};function A(E,D,C,F){var B=jQuery(E).closest("svg").get(0).createSVGPoint();B.x=C;B.y=F;B=B.matrixTransform(D);return{x:B.x,y:B.y}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/UnderscoreMixins.js' */
(function(){_.mixin({cartesianProduct:function(){var A=Array.prototype.slice.call(arguments,0);return _.reduce(A,function(C,D){var B=[];_.each(C,function(E){_.each(D,function(F){B.push(E.concat(F))})});return B},[[]])},flatMap:_.compose(_.flatten,_.map),sum:function(B,A){return _.reduce(B,function(C,D){return C+D},0,A)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/Vector2D.js' */
(function(){var A=draw2d.geo.Point;AJS.namespace("JIRA.WorkflowDesigner.Vector2D");JIRA.WorkflowDesigner.Vector2D=A.extend({init:function(D,C){var E=D instanceof A&&C instanceof A,B=D,F=C;if(E){B=C.x-D.x;F=C.y-D.y}this._super(B,F)},getLength:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},multiply:function(B){this.x*=B;this.y*=B;return this},normalize:function(){var B=this.getLength();if(B>0){this.multiply(1/B)}return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/util/ViewBoxTransformer.js' */
(function(){var F=0.25;var C=2;var B=0.5;var E=10;function D(I,K,J){var L=I.clone().scaleByFactor(F*2),M=L.getLeft()-I.getLeft(),H=L.getTop()-I.getTop();K<M&&L.scaleWidth(2*(M-K+E));J<H&&L.scaleHeight(2*(H-J+E));return L}function G(H,J,I){return D(H,J,I).translate(-J,-I).resize(J,I)}function A(J,I){var L=C*I,H=B*I,K=Math.max(Math.min(J,L),H);if(Math.abs(K-1)>0.0001){return K}else{return 1}}JIRA.WorkflowDesigner.ViewBoxTransformer={getZoomViewBox:function(Q){var I=Q.viewBox,L=Q.diagramBoundingBox,P=A(Q.factor,Q.zoom),H,N,J,O=Q.target,K,M;N=I.getWidth()*P;H=I.getHeight()*P;K=G(L,N,H);J=I.getRelativePositionAsPercentage(O);M=new draw2d.geo.Point(O.getX()-J.x*N,O.getY()-J.y*H);M.setBoundary(K.getLeft(),K.getTop(),K.getRight(),K.getBottom());return new draw2d.geo.Rectangle(M.getX(),M.getY(),N,H)},getPanViewBox:function(L){var M=L.viewBox,K=L.diagramBoundingBox,J=L.displacement,I,H;I=G(K,M.getWidth(),M.getHeight());H=M.getTopLeft().translate(J.x,J.y).setBoundary(I.getLeft(),I.getTop(),I.getRight(),I.getBottom());return new draw2d.geo.Rectangle(H.getX(),H.getY(),M.getWidth(),M.getHeight())}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/actions/ActionsView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.ActionsView",A.Marionette.ItemView.extend({className:"actions",events:{"change .show-transition-labels":"_setShowTransitionLabels","click .add-status":"_addStatus","click .add-transition":"_addTransition","click .enter-full-screen":"_enterFullScreen","click .exit-full-screen":"_exitFullScreen"},template:JIRA.WorkflowDesigner.Templates.actions,ui:{addStatusButton:".add-status",fullScreenTriggers:".full-screen-trigger",lastEditedMessage:".last-edited-message"},initialize:function(B){this._canvasModel=B.canvasModel;this._fullScreenButton=B.fullScreenButton;this._immutable=B.immutable;this._workflowModel=B.workflowModel;this.listenTo(this._workflowModel,"change:updateAuthor change:updatedDate",function(){if(this._workflowModel.get("updateAuthor")&&this._workflowModel.get("updatedDate")){this.stopListening(this._workflowModel);this.render()}})},_addStatus:function(){var B=this.ui.addStatusButton.hasClass("active");this._addStatusDialog||(this._addStatusDialog=this._createAddStatusDialog());if(B){this._addStatusDialog.hide()}else{this._addStatusDialog.show()}},_addTransition:function(){var B=this._canvasModel.get("selectedModel"),C=B&&B instanceof JIRA.WorkflowDesigner.StatusModel,D=new JIRA.WorkflowDesigner.TransitionModel();if(C){D.set({source:B,target:B})}new JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView({canvasModel:this._canvasModel,transitionModel:D,workflowModel:this._workflowModel}).show()},_createAddStatusDialog:function(){var B;B=new JIRA.WorkflowDesigner.Dialogs.AddStatusInlineDialogView({trigger:this.ui.addStatusButton,workflowModel:this._workflowModel});this.listenTo(B,{done:_.bind(this.trigger,this,"addStatus:done"),submit:_.bind(this.trigger,this,"addStatus:submit")});return B},_enterFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:enter")},_exitFullScreen:function(){this._toggleFullScreenTriggers();this.trigger("fullScreen:exit")},onRender:function(){if(this._addStatusDialog){this._addStatusDialog.remove();delete this._addStatusDialog}this.ui.fullScreenTriggers.tooltip();this.ui.fullScreenTriggers.filter(".hidden").tipsy("disable");this.ui.lastEditedMessage.find("time").livestamp()},remove:function(){A.Marionette.ItemView.prototype.remove.apply(this,arguments);this._addStatusDialog&&this._addStatusDialog.remove()},serializeData:function(){return{currentUserName:JIRA.Users.LoggedInUser.userName(),updatedDate:this._workflowModel.get("updatedDate")&&this._workflowModel.get("updatedDate").getTime(),updateAuthor:this._workflowModel.get("updateAuthor"),fullScreenButton:this._fullScreenButton,immutable:this._immutable,showTransitionLabels:this._canvasModel.get("showTransitionLabels")}},_setShowTransitionLabels:function(B){var C=jQuery(B.target).is(":checked");this._canvasModel.set("showTransitionLabels",C)},_toggleFullScreenTriggers:function(){this.ui.fullScreenTriggers.each(function(C,B){jQuery(B).tipsy("toggleEnabled")}).toggleClass("hidden")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/actions/ZoomControlView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.ZoomControlView",A.Marionette.ItemView.extend({className:"zoom-control",events:{"click .zoom-in":"_triggerZoomIn","click .zoom-out":"_triggerZoomOut"},modelEvents:{"change:zoomLevel":"_debouncedRender"},template:JIRA.WorkflowDesigner.Templates.zoomControl,initialize:function(B){this._debouncedRender=_.debounce(this.render,100);this._maximumZoomLevel=B.maximumZoomLevel;this._minimumZoomLevel=B.minimumZoomLevel},serializeData:function(){var C=0.001,B=this.model.get("zoomLevel");return{zoomInDisabled:B>=this._maximumZoomLevel-C,zoomOutDisabled:B<=this._minimumZoomLevel+C}},_triggerZoomIn:function(){this.trigger("zoomIn")},_triggerZoomOut:function(){this.trigger("zoomOut")}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/CanvasView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.CanvasView",A.View.extend({className:"canvas",initialize:function(B){_.bindAll(this,"_onKeyDown");B=_.defaults({},B,{immutable:false});this._canvasModel=B.canvasModel;this.immutable=B.immutable;this.statusViews=new JIRA.WorkflowDesigner.Collection();this.transitionViews=new JIRA.WorkflowDesigner.Collection();this._workflowModel=B.workflowModel;this._zoomHandler=new JIRA.WorkflowDesigner.ZoomHandler(this.el);this.immutable||jQuery(document).on("keydown",this._onKeyDown);this.listenTo(this._canvasModel,"change:selectedModel",this._onSelectedModelChange);this.listenTo(this.statusViews,{deselected:this._clearSelectedView,"port:drag:end":this._onPortDragEnd,"port:drag:start":_.bind(this._setPortDragged,this,true),selected:this._setSelectedView});this.listenTo(this.transitionViews,{deselected:this._onTransitionDeselected,reconnect:this._onReconnect,selected:this._onTransitionSelected});this.listenTo(this._workflowModel,"reset:after",this._positionNewStatuses);this.listenTo(this._workflowModel.get("statuses"),{add:this.addStatus,remove:this.removeStatus,reset:this.resetStatuses});this.listenTo(this._workflowModel.get("transitions"),{add:this.addTransition,"change:source change:target":this._updateTransitionSourceAndTarget,remove:this.removeTransition,reset:this.resetTransitions});this.listenTo(this._zoomHandler,"zoom",this._onZoom)},addStatus:function(C){var F=C.get("initial"),D=this._canvasModel.get("selectedModel")===C,B,E;if(F){E=JIRA.WorkflowDesigner.InitialStatusView}else{E=JIRA.WorkflowDesigner.StatusView}B=new E({canvas:this.canvas,getAllTargetPorts:_.bind(this._getAllTargetPorts,this),immutable:this.immutable,isPortDragged:_.bind(this._isPortDragged,this),model:C,workflowModel:this._workflowModel}).render();this.statusViews.add(B);D&&B.select();return B},addTransition:function(B){var F=B.get("globalTransition"),C=this._canvasModel.get("selectedModel")===B,D=this._getTransitionViewWithModel(B),E;if(D){return D}if(F){E=JIRA.WorkflowDesigner.GlobalTransitionView}else{E=JIRA.WorkflowDesigner.TransitionView}D=new E({canvas:this.canvas,canvasModel:this._canvasModel,immutable:this.immutable,model:B,sourceView:this._getStatusViewWithModel(B.get("source")),targetView:this._getStatusViewWithModel(B.get("target")),workflowModel:this._workflowModel});D.requestResponse&&D.requestResponse.setHandler("isSelected",this._transitionIsSelected,this);D.render();this.transitionViews.add(D);C&&D.select();return D},autoFit:function(){var B,E,C,D=10,F;this.canvas.fitToContainer();B=this.getCanvasBoundingBox();if(B){B.scale(D*2,D*2);F=new draw2d.geo.Rectangle(0,0,this.$el.width(),this.$el.height());C=B.getHeight()<=F.getHeight()&&B.getWidth()<=F.getWidth();if(!C){this.canvas.setViewBox(B);F=this.canvas.getViewBox()}E=B.getCenter();this.canvas.setViewBox(new draw2d.geo.Rectangle(E.getX()-F.getWidth()/2,E.getY()-F.getHeight()/2,F.getWidth(),F.getHeight()));this._canvasModel.set("zoomLevel",this.canvas.getZoom())}},_clearSelectedView:function(B){var C=this._canvasModel.get("selectedView")===B;C&&this._canvasModel.selectView(null)},_createCanvas:function(B){var C,D=_.bind(this.getCanvasBoundingBox,this),F=this._getUniqueId(),E;B=jQuery(B);B.append(this.el);this.$el.attr("id",F);E=["statuses","selected-status","transitions","global-transitions","highlighted-transition","selected-transition","transition-labels"];C=new JIRA.WorkflowDesigner.Draw2DCanvas(F);C.createLayers(E);C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.PanningSingleSelectionPolicy(D));C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.SnapEditPolicy());C.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Canvas.SnapToGeometry.GuideLineEditPolicy());C.onNewConnection=_.bind(this._onNewConnection,this);return C},_delete:function(){var B=this._canvasModel.get("selectedView");B&&B.destroy();return !!B},_getAllTargetPorts:function(){function C(D){return D.model.isInitial()}function B(D){return D.getPorts()}return this.statusViews.chain().reject(C).flatMap(B).value()},getCanvasBoundingBox:function(){var C,E=this.canvas.getFigures().asArray(),B=this.canvas.getLines().asArray();function D(G){var H=G.getBoundingBox();if(C){C=C.union(H)}else{C=H}}function F(G){return G instanceof JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure}_.chain(E).reject(F).each(D);_.each(B,D);return C},_getSiblingTransitions:function(B){var D=B.model.get("actionId");function C(E){return E.model.get("actionId")===D}return this.transitionViews.chain().filter(C).without(B).value()},_getStatusViewWithModel:function(B){return this.statusViews.find(function(C){return C.model===B})},getStatusViewWithPort:function(B){return this.statusViews.find(function(C){return _.contains(C.getPorts(),B)})},_getTransitionViewWithModel:function(B){return this.transitionViews.find(function(C){return C.model===B})},_getUniqueId:function(){var B=0,C;do{B++;C="workflow-designer"+B}while(jQuery("#"+C).length);return C},_isPortDragged:function(){return !!this.portDragged},_onKeyDown:function(B){if(this._shouldHandleDelete(B)){this._delete()&&B.preventDefault()}},_onNewConnection:function(D){var C=D.getSource(),B=this.getStatusViewWithPort(C),F=D.getTarget(),E=this.getStatusViewWithPort(F),G;G=new JIRA.WorkflowDesigner.TransitionModel({source:B.model,sourceAngle:B.getAngleToPort(C),target:E.model,targetAngle:E.getAngleToPort(F)});this.canvas.removeFigure(D);new JIRA.WorkflowDesigner.Dialogs.AddTransitionDialogView({canvasModel:this._canvasModel,transitionModel:G,workflowModel:this._workflowModel}).show()},_onReconnect:function(F){var H,C=F.getConnection().getSource(),B=this.getStatusViewWithPort(C),G,E=F.getConnection().getTarget(),D=this.getStatusViewWithPort(E);H=B.model!==F.model.get("source");G=D.model!==F.model.get("target");if(H){new JIRA.WorkflowDesigner.Dialogs.EditTransitionSourceDialogView({newSourcePort:C,newSourceView:B,originalSourceStatus:F.model.get("source"),transitionView:F,workflowModel:this._workflowModel}).show()}else{if(G){new JIRA.WorkflowDesigner.Dialogs.EditTransitionTargetDialogView({targetPort:E,targetView:D,transitionView:F,workflowModel:this._workflowModel}).show()}else{F.model.set({source:B.model,sourceAngle:B.getAngleToPort(C),target:D.model,targetAngle:D.getAngleToPort(E)})}}},_onTransitionDeselected:function(B){this._clearSelectedView(B);_.invoke(this._getSiblingTransitions(B),"unhighlight")},_onTransitionSelected:function(B){this._setSelectedView(B);_.invoke(this._getSiblingTransitions(B),"appearSelected")},_onZoom:function(B){AJS.InlineDialog.current&&AJS.InlineDialog.current.hide();this.zoom(B.factor,this.canvas.fromDocumentToCanvasCoordinate(B.clientX,B.clientY))},_positionNewStatuses:function(){var C,D=this._workflowModel.get("statuses").map(this._getStatusViewWithModel,this);C=JIRA.WorkflowDesigner.StatusPositioner.positionStatuses({statusViews:D,viewBox:this.canvas.getViewBox(),workflowModel:this._workflowModel});function B(E){return !E.model.isGlobalTransition()&&E.isConnectedToAnyStatus(C)}this.transitionViews.chain().filter(B).invoke("resetConnection")},remove:function(){A.View.prototype.remove.apply(this,arguments);jQuery(document).off("keydown",this._onKeyDown);this._zoomHandler.destroy()},removeStatus:function(C){var B=this._getStatusViewWithModel(C);if(B){B.remove();this.statusViews.remove(B)}},removeTransition:function(B){var C=this._getTransitionViewWithModel(B);if(C){C.remove();this.transitionViews.remove(C)}},render:function(B){this.canvas||(this.canvas=this._createCanvas(B));return this},resetStatuses:function(){while(this.statusViews.length){this.removeStatus(this.statusViews.at(0).model)}this._workflowModel.get("statuses").each(function(B){this.addStatus(B)},this)},resetTransitions:function(){while(this.transitionViews.length){this.removeTransition(this.transitionViews.at(0).model)}this._workflowModel.get("transitions").forEach(function(B){this.addTransition(B)},this)},_transitionIsSelected:function(D){var F=D.model.get("actionId"),C=this._canvasModel.get("selectedView")===D,B=this._canvasModel.get("selectedModel"),E=!!B&&B.get("actionId")===F;return C||E},_onSelectedModelChange:function(E,B){var D=this._getStatusViewWithModel(B)||this._getTransitionViewWithModel(B),C=this._canvasModel.get("selectedView");if(B&&D&&D!==C){D.select()}},_onPortDragEnd:function(){function B(C){return C.model.isInitial()}this._setPortDragged(false);this.statusViews.chain().reject(B).invoke("updatePortsVisibility")},setLocked:function(B){this._isLocked=B},_setPortDragged:function(B){this.portDragged=B},setResizeInterval:function(B){this.canvas.setResizeInterval(B)},_setSelectedView:function(B){this._canvasModel.selectView(B)},_shouldHandleDelete:function(E){var B=[jQuery.ui.keyCode.BACKSPACE,jQuery.ui.keyCode.DELETE],F=!!jQuery(".aui-blanket:visible").length,D=_.contains(B,E.which),C=jQuery(E.target).is(":input");return !F&&D&&!C&&!this._isLocked},_updateTransitionSourceAndTarget:function(C){var B=this._getStatusViewWithModel(C.get("source")),D=this._getStatusViewWithModel(C.get("target")),E=this._getTransitionViewWithModel(C);E.setViews(B,D);E.resetConnection()},zoom:function(B,C){this.canvas.zoom(B,C||this.canvas.getViewBox().getCenter(),this.getCanvasBoundingBox());this._canvasModel.set("zoomLevel",this.canvas.getZoom())}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/Draw2DCanvas.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas");JIRA.WorkflowDesigner.Draw2DCanvas=draw2d.Canvas.extend({init:function(){_.bindAll(this,"_scheduleResize");this._super.apply(this,arguments);this.paper.canvas.style.position="";this.svgElement=jQuery(this.paper.canvas);this._debouncedSetViewBox=_.debounce(this.setViewBox,100);this._scheduleResize()},createLayers:function(){var B=JIRA.WorkflowDesigner.Draw2DCanvas.Layer,A=this._layers||(this._layers={});_.each(_.flatten(arguments),function(C){A[C]||(A[C]=new B(this))},this)},fitToContainer:function(){var C=Number(this.svgElement.attr("height")),A=Number(this.svgElement.attr("width")),E=this.getHeight(),D=this.getWidth(),B=C!==E||A!==D;if(!this.html.is(":visible")){return }if(B){this.paper.setSize(D,E);this.svgElement.css({height:E,width:D})}},fromCanvasToDocumentCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromSVGToScreenCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},fromDocumentToCanvasCoordinate:function(B,C){var A=JIRA.WorkflowDesigner.SVGUtilities.fromScreenToSVGCoordinate(this.paper.canvas,B,C);return new draw2d.geo.Point(A.x,A.y)},getBestFigure:function(A,E,D){var C=D instanceof draw2d.Port,B=D instanceof draw2d.shape.basic.LineResizeHandle;if(!D||C||B){return this._super(A,E,D)}return null},getLayer:function(A){return this._layers&&this._layers[A]},getSelectedFigure:function(){return this.getSelection().getPrimary()},getViewBox:function(){var B,C=jQuery(this.html).offset(),A;A=this.paper.canvas.getAttribute("viewBox");A=A&&_.map(A.split(" "),parseFloat).slice(0,2)||[0,0];B=this.fromDocumentToCanvasCoordinate(C.left+this.svgElement.width()-jQuery(document).scrollLeft(),C.top+this.svgElement.height()-jQuery(document).scrollTop());return new draw2d.geo.Rectangle(A[0],A[1],B.x-A[0],B.y-A[1])},getZoom:function(){return this.svgElement.width()/this.getViewBox().getWidth()},removeFigure:function(A){this._super.apply(this,arguments);A._layer&&A._layer.removeFigure(A)},_scheduleResize:function(){var C=JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL,A=!!this.svgElement.closest("body").length,B=_.isNumber(this._resizeInterval)?this._resizeInterval:C;if(A){setTimeout(this._scheduleResize,B);this.fitToContainer()}},selectFigure:function(A){var B=this;this.editPolicy.each(function(D,C){var E=C instanceof draw2d.policy.canvas.SingleSelectionPolicy;if(E){C.select(B,A)}})},setResizeInterval:function(A){this._resizeInterval=A},setViewBoxQuick:function(A){this.paper.canvas.setAttribute("viewBox",[A.getX(),A.getY(),A.getWidth(),A.getHeight()].join(" "));this._debouncedSetViewBox(A)},zoom:function(B,C,A){this.setViewBoxQuick(JIRA.WorkflowDesigner.ViewBoxTransformer.getZoomViewBox({diagramBoundingBox:A,factor:B,target:C,viewBox:this.getViewBox(),zoom:this.getZoom()}))}});JIRA.WorkflowDesigner.Draw2DCanvas.DEFAULT_RESIZE_INTERVAL=100}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/Layer.js' */
(function(){function A(B,E){var C=B.getChildren().clone().asArray().reverse(),D=E.svgNodes||E.shape;_.each(C,function(F){A(F,E)});B.svgNodes&&B.svgNodes.insertAfter(D);B.shape&&B.shape.insertAfter(D)}AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas.Layer");JIRA.WorkflowDesigner.Draw2DCanvas.Layer=function(B){var C=new JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure();this._canvas=B;this._canvas.addFigure(C);this._figures=[C]};_.extend(JIRA.WorkflowDesigner.Draw2DCanvas.Layer.prototype,{addFigure:function(B){B.getCanvas()||this._canvas.addFigure(B);B._layer&&B._layer.removeFigure(B);B._layer=this;A(B,_.last(this._figures));this._figures.push(B)},removeFigure:function(B){this._figures=_.without(this._figures,B)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/LayerRootFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure");JIRA.WorkflowDesigner.Draw2DCanvas.LayerRootFigure=draw2d.shape.basic.Rectangle.extend({init:function(){this._super(0,0);this.setAlpha(0);this.setDeleteable(false);this.setDraggable(false);this.setResizeable(false);this.setSelectable(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/canvas/ZoomHandler.js' */
(function(A){AJS.namespace("JIRA.WorkflowDesigner.ZoomHandler");JIRA.WorkflowDesigner.ZoomHandler=function(B){_.bindAll(this,"_onMouseWheel");jQuery(document).on({mousewheel:this._onMouseWheel,MozMousePixelScroll:this._onMouseWheel});this._canvas=jQuery(B).get(0)};_.extend(JIRA.WorkflowDesigner.ZoomHandler.prototype,A.Events,{_computeZoomFactor:function(C){var E,D=0.1,B;C=C.originalEvent;E=!!C.detail;if(E){B=this._getDeltaFirefox(C)}else{B=this._getDeltaOthers(C)}isNaN(B)&&(B=1);return Math.max(D,B)},destroy:function(){jQuery(document).off({mousewheel:this._onMouseWheel,MozMousePixelScroll:this._onMouseWheel})},_getDeltaFirefox:function(C){var B=200,D=C.axis===C.VERTICAL_AXIS&&C.detail||0;return 1+D/B},_getDeltaOthers:function(C){var B=500,D=C.wheelDelta;if("wheelDeltaY" in C){D=C.wheelDeltaY}return 1-D/B},_isWorkflowDesigner:function(B){return B===this._canvas||jQuery.contains(this._canvas,B)},_onMouseWheel:function(C){var B=C.altKey&&this._isWorkflowDesigner(C.target);if(B){C.preventDefault();this.trigger("zoom",{clientX:C.originalEvent.clientX,clientY:C.originalEvent.clientY,factor:this._computeZoomFactor(C)})}}})}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/Draw2DView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.Draw2DView",A.View.extend({initialize:function(B){this._canvas=B.canvas},remove:function(){A.View.prototype.remove.apply(this,arguments);this._canvas.removeFigure(this._figure)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/FullScreenController.js' */
(function(){var G=500;var B="full-screen-controller-original-properties";var F="full-screen-controller-placeholder";function E(J,I){return _.reduce(I,function(L,K){L[K]=J.css(K);return L},{})}function A(I){var J;J=jQuery("<div>").css({height:I.outerHeight()}).insertAfter(I);I.data(F,J)}function D(I){I.data(F).remove();I.removeData(F)}function C(I){var J=I.data(B);I.css(J).removeData(B)}function H(J,I){var K=E(J,_.keys(I));J.css(I).data(B,K)}AJS.namespace("JIRA.WorkflowDesigner.FullScreenController");JIRA.WorkflowDesigner.FullScreenController={enterFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document);L=jQuery(L);A(L);H(L,{height:L.outerHeight(),left:L.offset().left-I.scrollLeft(),position:"fixed",top:L.offset().top-I.scrollTop(),width:L.outerWidth(),zIndex:2000});H(J,{overflow:"hidden"});L.appendTo(J);L.animate({height:"100%",left:0,top:0,width:"100%"},G,K.resolve);return K.promise()},exitFullScreen:function(L){var J=jQuery("body"),K=jQuery.Deferred(),I=jQuery(window.document),M;function N(){L.insertBefore(M);D(L);C(L);K.resolve()}L=jQuery(L);M=L.data(F);C(J);L.animate({height:M.outerHeight(),left:M.offset().left-I.scrollLeft(),top:M.offset().top-I.scrollTop(),width:M.outerWidth()},G,N);return K.promise()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/InlineDialogSVGPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.InlineDialogSVGPositioner");JIRA.WorkflowDesigner.InlineDialogSVGPositioner={calculatePosition:function(E,F,G,D){var C,A,B;C=JIRA.WorkflowDesigner.SVGUtilities.getPageBoundingBox(F.target);B=jQuery("<div/>").css({height:C.height,left:C.x,position:"absolute",top:C.y,width:C.width}).appendTo("body");A=AJS.InlineDialog.opts.calculatePositions(E,{target:B},G,D);B.remove();return A}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/ProgressIndicatorBlanketView.js' */
(function(C){var B=40,A=440;C.define("JIRA.WorkflowDesigner.ProgressIndicatorBlanketView",C.Marionette.ItemView.extend({className:"progress-indicator-blanket",template:JIRA.WorkflowDesigner.Templates.progressIndicatorBlanket,ui:{spinner:".spinner"},initialize:function(D){this._container=jQuery(D.container)},hide:function(){clearInterval(this._intervalID);this.$el.remove()},show:function(){var F=0,D=this;function E(){F=(F-B)%A;D.ui.spinner.css("background-position","0 "+F+"px")}clearInterval(this._intervalID);this._intervalID=setInterval(E,50);this.render().$el.appendTo(this._container)}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/BaseStatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.BaseStatusView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);B=_.defaults({},B,{immutable:false});this.immutable=B.immutable;this.isPortDragged=B.isPortDragged;this.getAllTargetPorts=B.getAllTargetPorts;this.workflowModel=B.workflowModel;this.listenTo(this.model,"change",this.render)},_createAndConfigureFigure:function(){var C=this._createFigure(),B=this;C.onDrag=_.wrap(C.onDrag,function(D){D.apply(this,_.toArray(arguments).slice(1));B.trigger("drag")});C.onDragEnd=_.wrap(C.onDragEnd,function(D){D.apply(this,_.toArray(arguments).slice(1));B._updatePosition();B.trigger("dragEnd")});if(this.immutable){C.setDeleteable(false);C.setResizeable(false)}else{C.installEditPolicy(new draw2d.policy.figure.DragDropEditPolicy())}return C},_createPort:function(B){B=_.extend({},B,{canvas:this._canvas,isPortDragged:this.isPortDragged,getAllTargetPorts:this.getAllTargetPorts});return new JIRA.WorkflowDesigner.StatusPort(B)},_getAngleToFigure:function(B){var D=B.getBoundingBox().getCenter(),C=this._figure.getBoundingBox().getCenter();return Math.atan2(D.getY()-C.getY(),D.getX()-C.getX())/Math.PI*180},getAngleToPort:function(B){return this._getAngleToFigure(B)},getAngleToStatus:function(B){return this._getAngleToFigure(B._figure)},getPortForAngle:function(C){function B(D){var E=Math.abs(C-this._getAngleToFigure(D));return E<180?E:Math.abs(E-360)}return _.min(this.getPorts(),B,this)},_positionFigure:function(){if(this.model.hasCoordinates()){this._figure.setPosition(this.model.get("x"),this.model.get("y"))}},render:function(){this._figure||(this._figure=this._createAndConfigureFigure());return this},setPosition:function(B,C){this.model.set({x:B,y:C})},_updatePosition:function(){var B=this.getBoundingBox();this.setPosition(B.getX(),B.getY())}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/InitialStatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.InitialStatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_createFigure:function(){var B,C;B=this._figure=new draw2d.shape.basic.Circle(30);B.setBackgroundColor("#C0C0C0");B.setStroke(0);B.setSelectable(false);B.snapToGeometry=true;C=this._fill=new draw2d.shape.basic.Circle(30);C.onMouseEnter=_.bind(this.trigger,this,"highlight");C.onMouseLeave=_.bind(this.trigger,this,"unhighlight");C.setBackgroundColor("#C0C0C0");C.setStroke(0);B.addFigure(C,new draw2d.layout.locator.CenterLocator(B));this._canvas.addFigure(B);JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(C,"move");this._addPort();this._positionFigure();return B},_addPort:function(){var C=JIRA.WorkflowDesigner.Direction.DOWN,B;this.port=this._createPort({connectionDirection:C});B=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this._figure,side:C,bias:0.5});this._figure.addPort(this.port,B)},getBoundingBox:function(){return this._figure.getBoundingBox()},getPorts:function(){return[this.port]},isSelected:function(){return false},render:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype.render.apply(this,arguments);this._positionFigure();return this}}))}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/StatusFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusFigure");JIRA.WorkflowDesigner.StatusFigure=draw2d.shape.basic.Rectangle.extend({init:function(){var E,F,D,C,A,B;A=new draw2d.layout.locator.CenterLocator(this);this._super.apply(this,arguments);this.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this.setAlpha(0);this.setDeleteable(false);this.setStroke(0);this.snapToGeometry=true;D=this._hover=new draw2d.shape.basic.Rectangle();D.onDoubleClick=_.bind(this._onDoubleClick,this);D.onMouseEnter=_.bind(this._onMouseEnter,this);D.onMouseLeave=_.bind(this._onMouseLeave,this);D.setAlpha(0);this.addFigure(D,A);E=this._edge=new draw2d.shape.basic.Rectangle();E.setRadius(4);E.setStroke(0);this.addFigure(E,A);B=this._selectedOutline=new draw2d.shape.basic.Rectangle();B.setColor("#1a8cff");B.setRadius(4);B.setStroke(2);B.setVisible(false);this.addFigure(B,A);F=this._fill=new draw2d.shape.basic.Rectangle();F.setRadius(3);F.setStroke(0);this.addFigure(F,A);C=this._label=new draw2d.shape.basic.Label();C.setBold(true);C.setFontFamily("Arial");C.setFontSize(11);C.setStroke(0);this.addFigure(C,A)},getTextColor:function(){return this._label.getFontColor()},_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_onMouseEnter:function(){this.onMouseEnter.apply(this,arguments)},_onMouseLeave:function(){this.onMouseLeave.apply(this,arguments)},repaint:function(){function A(B){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(B.figure,"move")}this._super.apply(this,arguments);_.each(this.children.asArray(),A)},_resize:function(){var A=Math.max(this._label.getBoundingBox().getWidth()+40,60);this.setDimension(A,30)},select:function(){this._super.apply(this,arguments);this._selectedOutline.setVisible(true)},setBackgroundColor:function(A){this._super.apply(this,arguments);this._fill&&this._fill.setBackgroundColor(A)},setCanvas:function(A){this._super.apply(this,arguments);A&&this._selectedOutline.shape.attr("fill-opacity","0")},setColor:function(A){this._super.apply(this,arguments);this._edge&&this._edge.setBackgroundColor(A)},setDimension:function(B,A){var C=!!this._edge;this._super.apply(this,arguments);if(C){this._edge.setDimension(B,A);this._fill.setDimension(B-2,A-2);this._hover.setDimension(B+12,A+12);this._selectedOutline.setDimension(B+1,A+1)}},setText:function(A){this._label.setText(A.toUpperCase());this._resize()},setTextColor:function(A){this._label&&this._label.setFontColor(A)},unselect:function(){this._super.apply(this,arguments);this._selectedOutline.setVisible(false)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/statuses/StatusView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.StatusView",JIRA.WorkflowDesigner.BaseStatusView.extend({_addPort:function(E,F){var C=this,B,D;D=this._createPort({connectionDirection:F});B=new JIRA.WorkflowDesigner.Layout.Locator.PositionOnParentBoundsLocator({parent:this._figure,side:F,bias:E});this._figure.addPort(D,B);D.bind("mouse:enter",function(H,G){C._onMouseEnter(G)});D.bind("mouse:leave",function(G,H){C._onMouseLeave(H)});D.bind("drag:start",_.bind(this._portStatusDragStart,this));D.bind("drag:end",_.bind(this._portStatusDragEnd,this));D.bind("select",_.bind(this.select,this));return D},_createFigure:function(){var B,C;C={onOtherFigureIsMoving:_.throttle(_.bind(this.trigger,this,"move"),25)};B=this._figure=new JIRA.WorkflowDesigner.StatusFigure();B.attachMoveListener(C);B.onDeselect=_.bind(this._onDeselect,this);B.onMouseEnter=_.bind(this._onMouseEnter,this);B.onMouseLeave=_.bind(this._onMouseLeave,this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this.immutable);this.immutable||(B.onDoubleClick=_.bind(this.edit,this));this._canvas.getLayer("statuses").addFigure(B);this._createPorts();this._positionFigure();return B},_createPorts:function(){var B=JIRA.WorkflowDesigner.Direction;this.ports=[this._addPort(0.22,B.UP),this._addPort(0.5,B.UP),this._addPort(0.78,B.UP),this._addPort(0.5,B.RIGHT),this._addPort(0.78,B.DOWN),this._addPort(0.5,B.DOWN),this._addPort(0.22,B.DOWN),this._addPort(0.5,B.LEFT)]},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditStatusDialogView({statusModel:this.model,workflowModel:this.workflowModel}).show()},_getBackgroundColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getBackgroundColour({colourName:B.colourName,isSubtle:C})}else{if(C){D="#ffffff"}else{D="#4a6785"}}return D},_getBorderColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(!C){D="#ffffff"}else{if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getBorderColour({colourName:B.colourName,isSubtle:C})}else{D="#4a6785"}}return D},getBoundingBox:function(){return this._figure.getBoundingBox()},_getFigure:function(){return this._figure},getPorts:function(){return this.ports},_getTextColor:function(){var D,C=this._isSubtle(),B=this.model.get("statusCategory");if(B){D=JIRA.WorkflowDesigner.StatusLozengeColours.getColour({colourName:B.colourName,isSubtle:C})}else{if(C){D="#4a6785"}else{D="#ffffff"}}return D},highlight:function(){this.immutable||_.invoke(this.getPorts(),"show");this.trigger("highlight")},_isSubtle:function(){var D=this.workflowModel.has("currentStepId"),B=this.model.get("stepId")===this.workflowModel.get("currentStepId"),C=this.model.get("initial");return D&&!B&&!C},_isThisStatusHighlightTarget:function(B){var C=B&&B.getParent()===this._figure,E=this._figure===B,D=_.contains(this.ports,B);return C||E||D},_onDeselect:function(){this._canvas.getLayer("statuses").addFigure(this._figure);this.trigger("deselected",this);this.selected=false;this.unhighlight()},_onMouseEnter:function(B){this._isThisStatusHighlightTarget(B)||this.highlight()},_onMouseLeave:function(B){this._isThisStatusHighlightTarget(B)||this.unhighlight()},_onSelect:function(){this._canvas.getLayer("selected-status").addFigure(this._figure);this.highlight();this.selected=true;this.trigger("selected",this)},_portStatusDragEnd:function(){this.trigger("port:drag:end")},_portStatusDragStart:function(){this.trigger("port:drag:start")},render:function(){JIRA.WorkflowDesigner.BaseStatusView.prototype.render.apply(this,arguments);this._figure.setBackgroundColor(this._getBackgroundColor());this._figure.setColor(this._getBorderColor());this._figure.setText(this.model.get("name"));this._figure.setTextColor(this._getTextColor());this._positionFigure();return this},unhighlight:function(){if(this.selected){return }this.immutable||_.invoke(this.getPorts(),"hide");this.trigger("unhighlight")},updatePortsVisibility:function(){_.invoke(this.getPorts(),this.selected?"show":"hide")}}));Cocktail.mixin(JIRA.WorkflowDesigner.StatusView,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/StatusPort.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPort");JIRA.WorkflowDesigner.StatusPort=draw2d.HybridPort.extend({RADIUS:8,STROKE_WIDTH:1,init:function(A){this._super();this.connectionDirection=A.connectionDirection;this.canvas=A.canvas;this.isPortDragged=A.isPortDragged;this.getAllTargetPorts=A.getAllTargetPorts;this.lighterBgColor=this.bgColor.hash();this.setBackgroundColor("#ffffff");this.setColor("#1a8cff");this.setCoronaWidth(6);this.setDimension(this.RADIUS,this.RADIUS);this.setStroke(this.STROKE_WIDTH);this.hide();this._resetEditPolicies();this.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.StatusPortsFeedbackPolicy())},_resetEditPolicies:function(){var A=this;this.editPolicy.each(function(B,C){C.onUninstall(A)});this.editPolicy=new draw2d.util.ArrayList()},getConnectionDirection:function(){return this.connectionDirection},getDropTarget:function(A,B){return JIRA.WorkflowDesigner.StatusPort.getHitPort(A,B,this.getDropTargets().asArray())},getDropTargets:function(){var A=_.without(this.getAllTargetPorts(),this);return new draw2d.util.ArrayList(A).trimToSize()},onMouseEnter:function(A){this.trigger("mouse:enter",A)},onMouseLeave:function(A){this.trigger("mouse:leave",A)},onDragStart:function(){this.triggerDragStart();this.trigger("select");this._super()},onDragEnd:function(){this._super();this.triggerDragEnd()},triggerDragStart:function(){this.trigger("drag:start")},triggerDragEnd:function(){this.trigger("drag:end")},hitTest:function(B,H){if(this.isPortDragged()){return this._super(B,H)}var E=this.getAbsoluteX();var C=this.getAbsoluteY();var D=E-this.getWidth()/2;var A=C-this.getHeight()/2;var G=E+this.getWidth()/2;var F=C+this.getHeight()/2;return(B>=D&&B<=G&&H>=A&&H<=F)},show:function(){this.sendToFront().setVisible(true)},hide:function(){this.setVisible(false)},repaint:function(){this._super.apply(this,arguments);this._setCursor(this)},setGlow:function(A){var B="#3b7fc4";this._super(A);if(A){this.corona.setBackgroundColor(B);this.corona.setColor(B);this.corona.shape.attr("opacity",0.45);this._setCursor(this.corona);this.sendToFront();this.setStroke(0)}else{this.setStroke(this.STROKE_WIDTH)}},_setCursor:function(A){JIRA.WorkflowDesigner.Draw2DUtilities.setCursor(A,"crosshair")}});JIRA.WorkflowDesigner.StatusPort.getHitPort=function(A,G,D){var F=new draw2d.geo.Point(A,G),E;function B(H){return H.hitTest(F.x,F.y)}function C(H){return H.getAbsolutePosition().getDistance(F)}E=_.chain(D).filter(B).min(C).value();return E instanceof JIRA.WorkflowDesigner.StatusPort?E:null}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/StatusPositioner.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.StatusPositioner");var B=20;JIRA.WorkflowDesigner.StatusPositioner={positionStatuses:function(F){var J,H,I;J=new draw2d.geo.Point(F.viewBox.getCenter().getX(),F.viewBox.getY()+F.viewBox.getHeight()*0.2);function G(L){var K=_.sum(_.map(L,D));I=J.getY()-K/2}function E(K){K.setPosition(J.getX()-K.getBoundingBox().getWidth()/2,I);I+=D(K)}H=_.chain(F.statusViews).reject(A).value();H.sort(C(F.workflowModel));_.chain(H).tap(G).each(E);return H}};function C(F){var E=F.getInitialTransitionDestinations();return function(N,L){var G,M,H=N.model,I,K,J=L.model;G=H.isInitial();I=J.isInitial();if(G&&!I){return -1}if(!G&&I){return 1}if(!G&&!I){M=_.contains(E,H);K=_.contains(E,J);if(M&&!K){return -1}if(!M&&K){return 1}}return H.get("id").localeCompare(J.get("id"))}}function D(E){return E.getBoundingBox().getHeight()+B}function A(E){return E.model.hasCoordinates()}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/GlobalTransitionFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.GlobalTransitionFigure");JIRA.WorkflowDesigner.GlobalTransitionFigure=draw2d.shape.basic.Rectangle.extend({init:function(){var E,C,A,B,D;_.bindAll(this,"_onDoubleClick");this._super.apply(this,arguments);this.installEditPolicy(new draw2d.policy.figure.SelectionFeedbackPolicy());this.setAlpha(0);this.setDeleteable(false);this.setDimension(68,14);this.setResizeable(false);A=this._line=new draw2d.shape.basic.Line(0,0,0,0);A.onDoubleClick=this._onDoubleClick;A.setColor("#cccccc");A.setStroke(1);this.addFigure(A,new draw2d.layout.locator.CenterLocator(this));E=this._arrow=new JIRA.WorkflowDesigner.TriangleFigure();E.onDoubleClick=this._onDoubleClick;E.setDimension(7,8);E.setBackgroundColor("#cccccc");E.setColor("#cccccc");E.setStroke(1);this.addFigure(E,new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,0,3));B=this._createLozenge();D=new JIRA.WorkflowDesigner.Layout.Locator.StaticLocator(this,49,0);this.addFigure(B,D);C=this._hover=new draw2d.shape.basic.Rectangle(19,14);C.onDoubleClick=this._onDoubleClick;C.setAlpha(0);this.addFigure(C,D)},_createLozenge:function(){var A,B;A=this._lozengeRectangle=new draw2d.shape.basic.Rectangle(19,14);A.setBackgroundColor("#333333");A.setStroke(0);B=this._lozengeText=new draw2d.shape.basic.Label();B.setAlpha(0);B.setBold(true);B.setFontColor("#ffffff");B.setFontFamily("Arial");B.setFontSize(11);B.setStroke(0);B.setText("All");A.addFigure(B,new draw2d.layout.locator.CenterLocator(A));return A},getHoverElement:function(){return this._hover.shape.node},getPorts:function(){return new draw2d.util.ArrayList()},onDrag:jQuery.noop,_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_resizeLozenge:function(){var A=this._lozengeText.getWidth();this._hover.setDimension(A,this._hover.getHeight());this._lozengeRectangle.setDimension(A,this._lozengeRectangle.getHeight())},select:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#ffffff");this._arrow.setColor("#1a8cff");this._line.setColor("#1a8cff")},setCanvas:function(){this._super.apply(this,arguments);this._resizeLozenge()},setPosition:function(A,C){var B;this._super(A,C);B=this.getBoundingBox();this._line.setStartPoint(B.getLeft(),B.getCenter().getY());this._line.setEndPoint(B.getRight(),B.getCenter().getY())},unselect:function(){this._super.apply(this,arguments);this._arrow.setBackgroundColor("#cccccc");this._arrow.setColor("#cccccc");this._line.setColor("#cccccc")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/GlobalTransitionView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.GlobalTransitionView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);B=_.defaults({},B,{immutable:false});this._immutable=B.immutable;this._targetView=B.targetView;this._workflowModel=B.workflowModel;this.listenTo(this._targetView,"move",this._onMove)},_createDialog:function(){var D=this._figure.getHoverElement(),F=_.uniqueId("global-transition-dialog-"),B=this;function E(){return{fill:"#333333",stroke:"#333333"}}function C(I,H,G){var J=JIRA.WorkflowDesigner.Templates.globalTransitionDialogContent;I.html(J({name:B.model.get("name"),statusName:B.model.get("target").get("name")}));G()}this._dialog=AJS.InlineDialog(D,F,C,{calculatePositions:JIRA.WorkflowDesigner.InlineDialogSVGPositioner.calculatePosition,getArrowAttributes:E,hideDelay:50,onHover:true})},_createFigure:function(){var B;B=this._figure=new JIRA.WorkflowDesigner.GlobalTransitionFigure();B.onDeselect=_.bind(this._onDeselect,this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this._immutable);this._immutable||(B.onDoubleClick=_.bind(this.edit,this));this._canvas.getLayer("global-transitions").addFigure(B);this._createDialog();this._positionFigure()},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditGlobalTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},_getFigure:function(){return this._figure},_onDeselect:function(){this._canvas.getLayer("global-transitions").addFigure(this._figure);this.trigger("deselected",this)},_onMove:function(){this._dialog&&this._dialog.hide();this._positionFigure()},_onSelect:function(){this._canvas.getLayer("selected-transition").addFigure(this._figure);this.trigger("selected",this)},_positionFigure:function(){var B=this._figure.getBoundingBox(),C=this._targetView.getBoundingBox();this._figure.setPosition(C.getRight()+2,C.getCenter().getY()-B.getHeight()/2)},render:function(){this._figure||this._createFigure();return this}}));Cocktail.mixin(JIRA.WorkflowDesigner.GlobalTransitionView,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/TransitionConnection.js' */
(function(){var A="#707070",D=30,C="#cccccc",E="#ffffff",F="#1a8cff",B="#f5f5f5";AJS.namespace("JIRA.WorkflowDesigner.TransitionConnection");JIRA.WorkflowDesigner.TransitionConnection=JIRA.WorkflowDesigner.Layout.Connection.GappedConnection.extend({init:function(G){var I,H;_.bindAll(this,"_onDoubleClick","_onMouseEnter","_onMouseLeave");this._isInitialTransition=G;if(G){this._super(0,3)}else{this._super(3,3)}I=new draw2d.decoration.connection.ArrowDecorator();I.onDoubleClick=this._onDoubleClick;I.setBackgroundColor(C);I.setColor(C);I.setDimension(7,7);H=this._label=new draw2d.shape.basic.Label();H.onDoubleClick=this._onDoubleClick;H.onMouseEnter=this._onMouseEnter;H.onMouseLeave=this._onMouseLeave;H.setBackgroundColor(E);H.setColor("#cccccc");H.setBold(true);H.setDraggable(false);H.setFontColor("#333333");H.setFontFamily("Arial");H.setFontSize(11);H.setPadding(2);H.setParent(this);H.setRadius(3);H.setSelectable(false);H.setStroke(0);this.setColor(C);this.setCoronaWidth(6);this.setDeleteable(false);this.setResizeable(false);this.setRouter(new JIRA.WorkflowDesigner.Layout.Connection.RoundedManhattanConnectionRouter());this.setStroke(1);this.setTargetDecorator(I)},appearSelected:function(){this.setColor(F);this.targetDecoratorNode.attr({fill:"#ffffff",stroke:F}).insertAfter(this.shape);this._label.setBackgroundColor(B).setStroke(1)},highlight:function(){this.setColor(A);this.targetDecoratorNode.attr({fill:A,stroke:A}).insertAfter(this.shape)},_onDoubleClick:function(){this.onDoubleClick.apply(this,arguments)},_onMouseEnter:function(){this.onMouseEnter.apply(this,arguments)},_onMouseLeave:function(){this.onMouseLeave.apply(this,arguments)},onOtherFigureIsMoving:function(){this._super.apply(this,arguments);this._positionLabel()},positionArrow:function(){this.targetDecoratorNode.insertAfter(this.shape)},_positionLabel:function(){this._labelLocator||(this._labelLocator=new JIRA.WorkflowDesigner.Layout.Locator.ManhattanPercentageLocator(this,0.8));this._labelLocator.relocate(0,this._label)},select:function(){var G;this._super.apply(this,arguments);this.appearSelected();G=this.selectionHandles.get(0);this._isInitialTransition&&G.hide();G.sendToFront();this.selectionHandles.get(0).sendActionableAreaToFront();this.selectionHandles.get(1).sendActionableAreaToFront();return this},setCanvas:function(G){var H=G!==null,I=G===null;if(H){G.getLayer("transition-labels").addFigure(this._label)}else{if(I){this.canvas.removeFigure(this._label)}}this._super(G)},setText:function(G){this._label.setText(this._truncate(G));this._positionLabel()},_truncate:function(H){var G=this._getEllipsis();if(!H||H.length<=D){return H}return H.substring(0,D-G.length)+G},_getEllipsis:function(){return "\u2026"},setTextVisible:function(G){this._label.setVisible(G);this._positionLabel()},setSource:function(G){this._super(G);this._positionLabel()},setTarget:function(G){this._super(G);this._positionLabel()},textIsVisible:function(){return this._label.isVisible()},unhighlight:function(){this._label.setBackgroundColor(E).setStroke(0);this.setColor(C);this.targetDecoratorNode.attr({fill:C,stroke:C}).insertAfter(this.shape)},unselect:function(){this._super.apply(this,arguments);this.unhighlight();this._label.setBackgroundColor(E).setStroke(0);return this}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/transitions/TransitionView.js' */
(function(A){A.define("JIRA.WorkflowDesigner.TransitionView",JIRA.WorkflowDesigner.Draw2DView.extend({initialize:function(B){JIRA.WorkflowDesigner.Draw2DView.prototype.initialize.apply(this,arguments);this._canvasModel=B.canvasModel;this._immutable=B.immutable;this._views=new JIRA.WorkflowDesigner.Collection();this._views.reset([B.sourceView,B.targetView]);this._workflowModel=B.workflowModel;this.listenTo(this._canvasModel,"change:showTransitionLabels",this._setTextVisibility);this.listenTo(this.model,"change:name",this.render);this.listenTo(this._views,{drag:this._onStatusDrag,dragEnd:this._onStatusDragEnd,highlight:this._onMouseEnter,unhighlight:this._onMouseLeave})},appearSelected:function(){this._canvas.getLayer("selected-transition").addFigure(this._connection);this._connection.appearSelected();this._connection.positionArrow();this.render()},_createConnection:function(){var B;B=new JIRA.WorkflowDesigner.TransitionConnection(this.isInitialTransition());B.onDeselect=_.bind(this._onDeselect,this);B.onMouseEnter=_.bind(this._onMouseEnter,this);B.onMouseLeave=_.bind(this._onMouseLeave,this);B.onReconnect=_.bind(this.trigger,this,"reconnect",this);B.onSelect=_.bind(this._onSelect,this);B.setSelectable(!this._immutable);if(!this._immutable){B.installEditPolicy(new JIRA.WorkflowDesigner.Policy.Feedback.LineSelectionFeedbackPolicy());B.onDoubleClick=_.bind(this.edit,this)}this._canvas.getLayer("transitions").addFigure(B);this._connection=this._figure=B;this._setConnectionPorts();this._setTextVisibility()},destroy:function(){new JIRA.WorkflowDesigner.Dialogs.DeleteTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},edit:function(){new JIRA.WorkflowDesigner.Dialogs.EditTransitionDialogView({transitionModel:this.model,workflowModel:this._workflowModel}).show()},getConnection:function(){return this._connection},_getFigure:function(){return this._connection},_getSourceAngle:function(){var C=this._getSourceView()===this._getTargetView(),B=this.model.get("sourceAngle");if(_.isNumber(B)){return B}else{if(C){return -90}else{return this._getSourceView().getAngleToStatus(this._getTargetView())}}},_getSourceView:function(){return this._views.at(0)},_getTargetAngle:function(){var C=this._getSourceView()===this._getTargetView(),B=this.model.get("targetAngle");if(_.isNumber(B)){return B}else{if(C){return 0}else{return this._getTargetView().getAngleToStatus(this._getSourceView())}}},_getTargetView:function(){return this._views.at(1)},_highlight:function(){this._canvas.getLayer("highlighted-transition").addFigure(this._connection);this._connection.highlight();this._highlighted=true;this.render()},isConnectedToAnyStatus:function(B){return _.contains(B,this._getSourceView())||_.contains(B,this._getTargetView())},isHighlighted:function(){return this._highlighted},isInitialTransition:function(){return this.model.get("source").get("initial")},_isSelected:function(){return this.requestResponse.request("isSelected",this)},_onDeselect:function(){this.trigger("deselected",this);this.unhighlight()},_onMouseEnter:function(){this._isSelected()||this._highlight()},_onMouseLeave:function(){var B=_.some(this._views.invoke("isSelected"));B||this._isSelected()||this.unhighlight()},_onSelect:function(){this.trigger("selected",this);this.appearSelected()},_onStatusDragEnd:function(){this._connection.setTextVisible(true)},_onStatusDrag:function(){this._connection.setTextVisible(false)},remove:function(){JIRA.WorkflowDesigner.Draw2DView.prototype.remove.apply(this,arguments);this._views.off({drag:this._onStatusDrag,dragEnd:this._onStatusDragEnd,highlight:this._onMousEnter,unhighlight:this._onMouseLeave})},render:function(){this._connection||this._createConnection();this._connection.setText(this.model.get("name"));this._setTextVisibility();return this},resetConnection:function(){this._canvas.removeFigure(this._connection);this._connection=null;this.render()},_setConnectionPorts:function(){var B=this._getSourceView().getPortForAngle(this._getSourceAngle()),C=this._getTargetView().getPortForAngle(this._getTargetAngle());this._connection.setSource(B);this._connection.setTarget(C);this.model.set({sourceAngle:this._getSourceView().getAngleToPort(B),targetAngle:this._getTargetView().getAngleToPort(C)})},_setTextVisibility:function(){var D=!!this.model.get("name"),B=this._canvasModel.get("showTransitionLabels"),C=D&&(B||this.isHighlighted()||this._isSelected());this._connection.setTextVisible(C)},setViews:function(B,C){this._views.reset([B,C])},unhighlight:function(){this._canvas.getLayer("transitions").addFigure(this._connection);this._connection.unhighlight();this._highlighted=false;this.render()}}));Cocktail.mixin(JIRA.WorkflowDesigner.TransitionView,JIRA.WorkflowDesigner.RequestResponseMixin,JIRA.WorkflowDesigner.SelectableFigureMixin)}(JIRA.WorkflowDesigner.Backbone));
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/views/TriangleFigure.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.TriangleFigure");JIRA.WorkflowDesigner.TriangleFigure=draw2d.VectorFigure.extend({repaint:function(A){var B;if(this.shape===null){return }B=["M",this.getAbsoluteX(),this.getAbsoluteY()+this.getHeight()/2,"l",this.getWidth(),-(this.getHeight()/2),"l",0,this.getHeight(),"Z"].join(" ");this._super(_.extend({},A,{path:B}))},createShapeElement:function(){return this.canvas.paper.path("")}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:workflow-designer-read-only', location = 'js/WorkflowDesigner.js' */
(function(){_.extend(JIRA.WorkflowDesigner,{browserIsSupported:function(){return !(jQuery.browser.msie&&parseInt(jQuery.browser.version,10)<9)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/views/dialogs/Dialog.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.Dialog");JIRA.WorkflowDesigner.Dialog=JIRA.FormDialog.extend({init:function(A){_.bindAll(this,"_sizeAndPositionDialog");A=_.defaults({},A,{content:this.createDialogContent,isDraft:false,onContentRefresh:this._showWorkflowDesigner,widthClass:"large"});this.options=A;this.sizeAndPositionDialog=_.throttle(this._sizeAndPositionDialog,100);this._super(A);this.onContentReady(this._addLabelHint)},createDialogContent:function(A){A(JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog({title:_.result(this.options,"workflowId")}))},show:function(){this._super.apply(this,arguments);jQuery(window).on("resize",this.sizeAndPositionDialog)},hide:function(){this._designer&&this._designer.destroy();this._super.apply(this,arguments);jQuery(window).off("resize",this.sizeAndPositionDialog)},_sizeAndPositionDialog:function(){var A,B;if(JIRA.Dialog.current===this){B=JIRA.WorkflowDesigner.DialogSizeCalculator.calculateDialogSize(this);this.options.width=B.width;A=this.$popup.find(".form-body");A.css({height:B.height,maxHeight:""});this._positionInCenter()}},_showWorkflowDesigner:function(){this._sizeAndPositionDialog();this._designer=new JIRA.WorkflowDesigner.Application({actions:false,element:this.get$popup().find(".form-body"),immutable:true,draft:_.result(this.options,"isDraft"),layoutData:_.result(this.options,"layoutData"),workflowId:_.result(this.options,"workflowId"),currentStepId:_.result(this.options,"currentStepId")})},_addLabelHint:function(){this.getButtonsContainer().prepend(JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint())}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'js/util/DialogSizeCalculator.js' */
(function(){AJS.namespace("JIRA.WorkflowDesigner.DialogSizeCalculator");JIRA.WorkflowDesigner.DialogSizeCalculator={DISTANCE_FROM_EDGE:100,calculateDialogSize:function(B,A){this.dialog=B;A=_.defaults(A||{},{windowHeight:this._getWindowHeight(),windowWidth:this._getWindowWidth(),dialogHeaderHeight:this._getDialogHeaderHeight(),dialogFooterHeight:this._getDialogFooterHeight()});return{height:this._calculateDialogHeight(A.windowHeight,A.dialogHeaderHeight,A.dialogFooterHeight),width:this._calculateDialogWidth(A.windowWidth)}},_calculateDialogHeight:function(C,A,B){return C-A-B-(this.DISTANCE_FROM_EDGE*2)},_calculateDialogWidth:function(A){return A-(this.DISTANCE_FROM_EDGE*2)},_getWindowHeight:function(){return jQuery(window).height()},_getWindowWidth:function(){return jQuery(window).width()},_getDialogHeaderHeight:function(){return this.dialog.$popupHeading.outerHeight()},_getDialogFooterHeight:function(){return this.dialog.$buttonContainer.outerHeight()}}}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:dialog', location = 'soy/Dialog.soy' */
// This file was automatically generated from Dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.Dialog == 'undefined') { JIRA.WorkflowDesigner.Templates.Dialog = {}; }


JIRA.WorkflowDesigner.Templates.Dialog.workflowDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2><div class="form-body"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.WorkflowDesigner.Templates.Dialog.labelMouseOverHint = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="buttons-container-left"><small>', soy.$$escapeHtml("Mouse over objects to see transition names."), '</small></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'js/views/ViewIssue.js' */
(function(){var F;var D;var E;var C;function B(H,G){var I=parseUri(H).queryKey[G];return decodeURIComponent(I.replace(/\+/g,"%20"))}function A(){var G;if(D){return jQuery.Deferred().resolve(D).promise()}else{G=JIRA.WorkflowDesigner.IO.AJAX.WorkflowAJAXManager.load(C);G.done(function(I,H){D=H});return G}}AJS.namespace("JIRA.WorkflowDesigner.ViewIssue");JIRA.WorkflowDesigner.ViewIssue={replaceViewWorkflowLink:function(G){var H=JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink,J,I;G=jQuery(G);J=G.find(".issueaction-viewworkflow:not(.new-workflow-designer)");I=J.attr("href");if(J.length){F=parseInt(B(I,"stepId"),10);D=null;J.replaceWith(H({href:I}));C=B(I,"workflowName")}}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(H,G){if(JIRA.WorkflowDesigner.browserIsSupported()){JIRA.WorkflowDesigner.ViewIssue.replaceViewWorkflowLink(G)}});E=new JIRA.WorkflowDesigner.Dialog({content:function(I){var G=A();var H=this;G.done(function(){H.createDialogContent(I)});G.fail(function(J){JIRA.WorkflowDesigner.Messages.showErrorMessage(J);E.hide(true)})},id:"view-workflow-dialog",trigger:".issueaction-viewworkflow.new-workflow-designer",workflowId:function(){return C},currentStepId:function(){return F},layoutData:function(){return JIRA.WorkflowDesigner.IO.WorkflowDataReader.read(D)}})}());
/* module-key = 'com.atlassian.jira.plugins.jira-workflow-designer:view-issue-page-workflow-designer', location = 'soy/ViewIssue.soy' */
// This file was automatically generated from ViewIssue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.WorkflowDesigner == 'undefined') { JIRA.WorkflowDesigner = {}; }
if (typeof JIRA.WorkflowDesigner.Templates == 'undefined') { JIRA.WorkflowDesigner.Templates = {}; }
if (typeof JIRA.WorkflowDesigner.Templates.ViewIssue == 'undefined') { JIRA.WorkflowDesigner.Templates.ViewIssue = {}; }


JIRA.WorkflowDesigner.Templates.ViewIssue.viewWorkflowLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issueaction-viewworkflow new-workflow-designer" href="', soy.$$escapeHtml(opt_data.href), '">', soy.$$escapeHtml("View Workflow"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:css', location = 'templates/plugins/bamboo/script/common.js' */
(function(b,a){if(typeof a.CONFIG==="undefined"){a.CONFIG={$planSelect:b(),$buildTypes:b(),buildResultsContainerId:"bamboo-build-results",stagesContainerId:"bamboo-plan-stages",variablesContainerId:"bamboo-override-variables",initialised:false,updateTimeout:null,init:function(){if(a.CONFIG.initialised){return}b(document).bind("dialogContentReady",function(f){var d=a.CONFIG.buildResultsContainerId,c=a.CONFIG.stagesContainerId,g=a.CONFIG.variablesContainerId;a.CONFIG.$planSelect=b("#bamboo-plan").change(a.CONFIG.onPlanChange);a.CONFIG.BuildResults.init({container:{id:d,insertAfter:a.CONFIG.$planSelect.closest(".field-group")}});a.CONFIG.Stages.init({container:{id:c,insertAfter:"#"+d}});a.CONFIG.Variables.init({container:{id:g,insertAfter:"#"+c}});a.CONFIG.$buildTypes=b("input:radio[name='buildType']").change(a.CONFIG.onBuildTypeChange).filter(":checked").change().end()});a.CONFIG.initialised=true}};a.CONFIG.Spinner=function(c,d){this.beforeShow=d;this.add=function(){return b(bamboo.components.icon({type:"loading"})).appendTo(c)}};a.CONFIG.Spinner.prototype.show=function(){var c=this.$spinner;this.beforeShow();if(!c||(c&&(!c.length||!c.parent().length))){this.$spinner=this.add()}else{c.show()}return this};a.CONFIG.Spinner.prototype.hide=function(){this.$spinner.hide();return this}}a.CONFIG.onPlanChange=function(j){var f=b("#existing-build").is(":checked"),i=b(this),d=i.add(a.CONFIG.$buildTypes).attr("disabled",true),m=i.find("option:selected"),h=(f?m.attr("data-selected-build-result"):null),n=(f?null:m.attr("data-selected-stages")),k=(f?null:m.attr("data-selected-variables")),l,g,c;if(k){k=b.parseJSON(k)}a.CONFIG.BuildResults.updateSelectedBuildResult(h);a.CONFIG.Stages.updateSelectedStages(n);a.CONFIG.Variables.updateSelectedVariables(k);a.CONFIG.Variables.hide();if(f){a.CONFIG.Stages.hide();a.CONFIG.BuildResults.showSpinner();l=a.restURL+"history/"+a.jiraProjectKey+"/"+i.val()+"/5";g={continuable:true,buildstate:"successful"};c=function(e){if(e.results.result&&e.results.result.length){a.CONFIG.BuildResults.show(e.results.result)}else{a.CONFIG.BuildResults.showNoResultsMsg()}d.attr("disabled",false)}}else{a.CONFIG.BuildResults.hide();a.CONFIG.Stages.showSpinner();l=a.restURL+"plan/"+a.jiraProjectKey+"/"+i.val();c=function(e){if(e.stages.stage&&e.stages.stage.length){a.CONFIG.Stages.show(e.stages.stage)}else{a.CONFIG.Stages.showNoStagesMsg()}if(e.variableContext.variable&&e.variableContext.variable.length){a.CONFIG.Variables.show(e.variableContext.variable)}d.attr("disabled",false)}}b.ajax({url:l,dataType:"json",data:g,beforeSend:function(){i.attr("disabled","true")},success:c,error:function(u,v){var q,t,o,p,r=b('<div class="form-body"></div><div class="form-footer"><a class="cancel">Cancel</a></div>');r.find(".cancel").click(function(w){if(a.CONFIG.FormDialog&&a.CONFIG.FormDialog.hide){a.CONFIG.FormDialog.hide()}});try{p=u.responseText||u.response;if(p){q=b.parseJSON(p);t=q.message;o=(q.messageBody?"<p>"+q.messageBody+"</p>":null);if(q.oauthCallback){r.filter(".content-footer").prepend('<a href="'+q.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a> | ')}}else{throw"noJSONResponse"}}catch(s){t="An error occurred while trying to retrieve the build information."}AJS.messages.warning(r.filter(".form-body"),{title:t,body:o,closeable:false});i.closest("form").replaceWith(r)},ajaxComplete:function(){i.attr("disabled","false")}})};a.CONFIG.onBuildTypeChange=function(g){var c=b(this),f=c.closest("fieldset.group"),d=f.nextAll(".field-group,.group"),h=b("#"+a.CONFIG.buildResultsContainerId);switch(c.val()){case"no-build":d.hide();f.css({"margin-bottom":0,"padding-bottom":0});break;case"new-build":d.show();h.hide();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break;case"existing-build":d.show();f.css({"margin-bottom":"","padding-bottom":""});a.CONFIG.$planSelect.change();break}};a.CONFIG.Stages=(function(){var d={container:{id:null,insertAfter:null,i18n:{legend:"Stages"}},selectedStages:null},k,j,f,g=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:f}).insertAfter(k.container.insertAfter).delegate("input:checkbox","click",h)},c=function(m){var l=false,v,o,x;for(o=0,x=m.length;o<x;o++){var q=m[o],r=!!(q.state&&q.state!="Unknown"),w=!!(q.manual),n=!!(!q.manual||r),p,t,u="stage-"+o,s;if(!l&&q.manual&&!r){l=true}t=b('<input type="checkbox" />').attr({name:"selectedStages",id:u,"class":"checkbox",checked:w,disabled:n}).val(q.name);s=b("<label />",{text:q.name,"for":u});p=b("<div/>",{"class":"checkbox"+(q.manual?(r?" already-run":" manual"):"")+(!l?" selected":"")}).append(t).append(s).appendTo(j);if(!r&&w){v=p}}if(v){v.find("input:checkbox").trigger("click",true)}},e=function(){j.find("div.checkbox,p").remove()},h=function(p,l){if(l){p.preventDefault()}var m=b(this),o=m.is(":checked"),n=false;m.closest("div.checkbox").toggleClass("selected",o).prevAll("div.checkbox").each(function(s){var r=b(this),t=r.children("input:checkbox"),q=r.hasClass("manual");if(o){r.addClass("selected");if(q){t.attr("checked","checked").attr("disabled","disabled")}}else{if(q&&!n){t.removeAttr("disabled");n=true}}}).end().nextAll("div.checkbox").each(function(r){var q=b(this);if(q.hasClass("manual")){return false}else{q.toggleClass("selected",o)}})},i;return{init:function(l){k=b.extend(true,d,l);f="<legend><span>"+k.container.i18n.legend+"</span></legend>";g();i=new a.CONFIG.Spinner(j,e)},show:function(l){j.html(f).show();c(l)},hide:function(){j.hide().html(f)},showNoStagesMsg:function(){i.hide();j.append(b("<p/>",{text:"No stages found."}))},showSpinner:function(){i.show()},updateSelectedStages:function(l){k.selectedStages=l}}})();a.CONFIG.Variables=(function(){var c={container:{id:null,insertAfter:null,i18n:{legend:"Build Variables"}},selectedVariables:null},l,j,k,g,h=function(){j=b("<fieldset/>",{id:l.container.id,"class":"group",html:g}).insertAfter(l.container.insertAfter).delegate("#override-another","click",i).delegate(".bamboo-icon-variable-delete","click",f).delegate("select","change",e)},d=function(r){var m,q,o,p;k=b("<select/>",{"class":"select"});for(o=0,p=r.length;o<p;o++){var n=r[o];if(m!=n.variableType){m=n.variableType;q=b("<optgroup/>",{label:m}).appendTo(k)}b("<option/>",{text:n.key,data:{"server-value":n.value}}).appendTo(q)}},i=function(){var n=k.clone(true),o,p,q,m="";if(arguments.length==2){p=n.find("option[text='"+arguments[0]+"']");m=arguments[1]}else{p=n.find("option:first")}p.attr("selected","selected");q=b('<input type="text" />').attr({name:"variable_"+p.val(),placeholder:p.data("server-value"),"class":"text medium-field"}).val(m);o=b("<div/>",{"class":"field-group"}).append(n).append(q).append(bamboo.components.icon({type:"variable-delete"})).insertBefore(j.children("a"))},f=function(m){b(this).closest(".field-group").remove()},e=function(o){var m=b(this),n=m.find("option:selected");m.nextAll(".text").attr({name:"variable_"+n.val(),placeholder:n.data("server-value")})};return{init:function(m){l=b.extend(true,c,m);g="<legend><span>"+l.container.i18n.legend+'</span></legend><a id="override-another" class="aui-button aui-button-link">Override variable<span class="icon icon-edit-sml"></span></a>';h()},show:function(m){d(m);if(l.selectedVariables&&l.selectedVariables.variables){b.each(l.selectedVariables.variables,i)}j.show()},hide:function(){j.hide().html(g)},updateSelectedVariables:function(m){l.selectedVariables=m}}})();a.CONFIG.BuildResults=(function(){var e={container:{id:null,insertAfter:null,i18n:{legend:"Existing build"}},selectedBuildResult:null},k,j,g,h=function(){j=b("<fieldset/>",{id:k.container.id,"class":"group",html:g}).insertAfter(k.container.insertAfter).delegate("input:radio","change",f).delegate("a","click",function(l){l.preventDefault();window.open(this.href)})},d=function(p){var o,q,n="build-result-"+p.number,l,m=(p.lifeCycleState=="Finished"?(p.continuable?"SuccessfulPartial":p.state):p.lifeCycleState);q=b('<input type="radio" />').attr({name:"buildResult",id:n,"class":"radio",checked:(p.key==k.selectedBuildResult)}).val(p.key).data("stages",(p.stages.stage&&p.stages.stage.length?p.stages.stage:[]));l=b("<label />",{html:'<a href="'+a.bambooBaseURL+"/browse/"+p.key+'" class="'+m+'">#'+p.number+'</a><span class="trigger-reason">'+a.replaceWithBambooIcon(p.buildReason)+"</span>","for":n}).prepend(bamboo.components.icon({type:m}));o=b("<div/>",{"class":"radio"}).append(q).append(l).appendTo(j)},c=function(){j.find("div.radio,p").remove()},f=function(l){var m=b(this).data("stages");if(m&&m.length){a.CONFIG.Stages.show(m)}else{a.CONFIG.Stages.showNoStagesMsg()}},i;return{init:function(l){k=b.extend(true,e,l);g="<legend><span>"+k.container.i18n.legend+"</span></legend>";h();i=new a.CONFIG.Spinner(j,c)},show:function(n){j.html(g).show();for(var l=0,m=n.length;l<m;l++){d(n[l])}},hide:function(){j.hide().html(g)},showNoResultsMsg:function(){i.hide();j.append(b("<p/>",{text:"No builds found with unbuilt manual stages."})).show()},showSpinner:function(){i.show()},updateSelectedBuildResult:function(l){k.selectedBuildResult=l}}})();a.CheckReleaseBuildStatus=function(d,c){b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+d,dataType:"json",success:function(h){var f=h.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),e;if((f.lifeCycleState!="InProgress"&&f.lifeCycleState!="Queued")||(h.jira&&h.jira.forceRefresh)){AJS.reloadViaWindowLocation()}else{if(f.lifeCycleState=="InProgress"&&f.progress){if(!c){e=b("#build-details");c=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(e).find("dd");e.find(".build + dd > span.bamboo-icon").replaceWith(bamboo.components.icon({type:g}))}else{c.html(f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>")}}}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(d,c)},5000)},error:function(l,m){var i,k,g,h,f=b("#build-details").empty();try{h=l.responseText||l.response;if(h){i=b.parseJSON(h);k=i.message;g=(i.messageBody?"<p>"+i.messageBody+"</p>":"");if(i.oauthCallback){g+='<p><a href="'+i.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(j){k="An error occurred while trying to retrieve the build information."}AJS.messages.warning(f,{title:k,body:g,closeable:false})}})};a.ShowBuildReleaseDetails=function(e){var d=b("#build-details"),c=b(bamboo.components.icon({type:"loading"}));if(d.length){c.appendTo(d);b.ajax({url:a.restURL+"status/"+a.jiraVersionId+"/"+e,dataType:"json",success:function(i){var f=i.bamboo,g=(f.lifeCycleState=="Finished"?(f.continuable?"SuccessfulPartial":f.state):f.lifeCycleState),h;if(i.jira&&i.jira.forceRefresh){AJS.reloadViaWindowLocation()}c.remove();d.append(bamboo.components.buildDetail({key:"Build",keyClass:"build",value:bamboo.components.icon({type:g})+' <a href="'+a.bambooBaseURL+"/browse/"+e+'"><span class="'+g+'">#'+f.number+"</span> "+f.planName+"</a>"}));d.append(bamboo.components.buildDetail({key:"Trigger",keyClass:"trigger",value:a.replaceWithBambooIcon(f.buildReason)}));if(f.vcsRevisionKey){d.append(bamboo.components.buildDetail({key:"Revision",keyClass:"revision",value:f.vcsRevisionKey}))}if(f.labels.label&&f.labels.label.length){d.append(bamboo.components.buildDetail({key:"Labels",keyClass:"labels",value:bamboo.components.labels({baseBambooUrl:a.bambooBaseURL,labels:f.labels.label})}))}if(f.lifeCycleState=="InProgress"||f.lifeCycleState=="Queued"){if(f.lifeCycleState=="InProgress"&&f.progress){h=b(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.progress.prettyBuildTime+" &ndash; <span>"+f.progress.prettyTimeRemaining+"</span>"})).appendTo(d).find("dd")}clearTimeout(a.CONFIG.updateTimeout);a.CONFIG.updateTimeout=setTimeout(function(){a.CheckReleaseBuildStatus(e,h)},5000)}else{if(f.lifeCycleState=="Finished"){if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}if(f.buildDuration){d.append(bamboo.components.buildDetail({key:"Duration",keyClass:"duration",value:f.buildDurationDescription}))}}else{if(f.lifeCycleState=="NotBuilt"){if(f.buildStartedTime){d.append(bamboo.components.buildDetail({key:"Started",keyClass:"started",value:'<time datetime="'+f.buildStartedTime+'">'+f.prettyBuildStartedTime+"</time>"}))}if(f.buildCompletedTime){d.append(bamboo.components.buildDetail({key:"Completed",keyClass:"completed",value:'<time datetime="'+f.buildCompletedTime+'">'+f.prettyBuildCompletedTime+" &ndash; <span>"+f.buildRelativeTime+"</span></time>"}))}d.append(bamboo.components.buildDetail({key:"Status",keyClass:"status",value:(f.buildStartedTime&&!f.buildCompletedTime?"Reason for not completing is unknown":"Reason for not building is unknown")}))}}}if(f.artifacts.artifact&&f.artifacts.artifact.length){d.append(bamboo.components.buildDetail({key:"Artifacts",keyClass:"artifacts",value:bamboo.components.artifacts({artifacts:f.artifacts.artifact})}))}},error:function(k,l){var h,j,f,g;c.remove();try{g=k.responseText||k.response;if(g){h=b.parseJSON(g);j=h.message;f=(h.messageBody?"<p>"+h.messageBody+"</p>":"");if(h.oauthCallback){f+='<p><a href="'+h.oauthCallback+"&amp;redirectUrl="+encodeURIComponent(a.baseURL)+'">Login &amp; Approve</a></p>'}}else{throw"noJSONResponse"}}catch(i){j="An error occurred while trying to retrieve the build information."}AJS.messages.warning(d,{title:j,body:f,closeable:false})}})}};a.replaceWithBambooIcon=function(c){return c.replace(/(\b)icon(\b)/g,"$1bamboo-icon$2")};a.init=function(d){a.CONFIG.init();var c=b("#runRelease",d);if(c.length){a.CONFIG.FormDialog=new JIRA.FormDialog({trigger:c,widthClass:"large",autoClose:true});if(/showReleaseDialog=true/.test(window.location.href)){c.click()}}};b(function(){a.init(AJS.$(document))});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,c,d){if(d===JIRA.CONTENT_ADDED_REASON.tabUpdated){a.init(c)}})}(AJS.$,window.JBAM=(window.JBAM||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/backbone-brace/backbone.brace.min.js' */
//     Backbone Brace - 2012/10/29
//     Copyright 2012 Atlassian Software Systems Pty Ltd
//     Licensed under the Apache License, Version 2.0
(function(){function i(e){return n.isArray(e)?n.reduce(e,function(e,t){return e[t]=null,e},{}):e}function s(e,t){if(!e||t==null)return t;if(typeof e=="string"||e instanceof String){if(typeof t!=""+e)throw"The typeof "+t+" is "+typeof t+" but expected it to be "+e;return t}if(n.isArray(e)||e===Array){if(!u(t))throw"Array type expected, but nonnull, non-Array value provided.";return e===Array||!e[0]?t:n.map(t,n.bind(s,null,e[0]))}if(typeof e!="function")throw"Invalid expected type "+e+". Should be falsy, String, Array, Backbone.Collection constructor, or function.";return t instanceof e?t:o(e)?new e(s([e.model],t)):new e(t)}function o(e,t){return e&&(e.__super__ instanceof(t||r.Collection)||e.__super__===(t||r.Collection).prototype||e===(t||r.Collection))}function u(e){return n.has(e,"length")&&!(e instanceof String||n.has({string:1,"function":1},typeof e)||e instanceof r.Collection)}function a(e,t){var r={};return n.each(e,function(e,n){if(!!t[n]&&!f(e,t[n])){if(!e||f(t[n],e))return;throw n+" has conflicted type descriptors."}r[n]=e}),r}function f(e,t){return!t||t===e?!0:!e||typeof e=="string"?!1:e instanceof Array?t===Array||t instanceof Array&&f(e[0],t[0]):typeof t!="function"?!1:o(t)?o(e,t):e.prototype instanceof t}function l(e){return n.isObject(e)?n.reduce(e,function(e,t,r){return t&&n.isFunction(t.toJSON)?e[r]=t.toJSON():n.isArray(t)&&(e[r]=n.map(t,function(e){return e&&n.isFunction(e.toJSON)?e.toJSON():e})),e},e):e}function c(e){return function(){var n=e.call(this);return l(n)}}function h(e){return function r(s,o){var u,a=n.extend({},s),f;return s&&s.mixins&&(f=s.mixins,delete a.mixins),u=e.call(this,a,o),this.prototype.namedEvents&&t.Mixins.applyMixin(u,{namedEvents:this.prototype.namedEvents}),this.prototype.namedAttributes&&t.Mixins.applyMixin(u,{namedAttributes:this.prototype.namedAttributes}),f&&n.each(s.mixins,function(e){t.Mixins.applyMixin(u,e)}),u.prototype.namedEvents&&t.Mixins.applyMixin(u,t.EventsMixinCreator.create(u.prototype.namedEvents)),u.prototype.namedAttributes&&(u.prototype.namedAttributes=i(u.prototype.namedAttributes),t.Mixins.applyMixin(u,t.AttributesMixinCreator.create(u.prototype.namedAttributes))),u.prototype.toJSON&&(u.prototype.toJSON=c(u.prototype.toJSON)),u.extend=r,u}}function p(e,t){var r=e.prototype,i=t.prototype,o=r.set;i.set=function(e,t,r){var i,u=this.namedAttributes;if(!u||e==null)return o.apply(this,arguments);n.isObject(e)?(i=n.clone(e),r=t):(i={},i[e]=t);for(var a in i){if(!n.has(i,a))continue;if(!n.has(u,a))throw"Attribute '"+a+"' does not exist";i[a]=s(u[a],i[a])}return o.call(this,i,r)};var u=r.get;i.get=function(e){if(this.namedAttributes&&!n.has(this.namedAttributes,e))throw"Attribute '"+e+"' does not exist";return u.apply(this,arguments)}}function d(e){var t=e.extend(),n=e.extend;return t.extend=h(n),t}function v(e){var t=d(e);return p(e,t),t}var e=this,t;typeof exports!="undefined"?t=exports:t=e.Brace={};var n=e._;!n&&typeof require!="undefined"&&(n=require("underscore"));var r=e.Backbone;!r&&typeof require!="undefined"&&(r=require("backbone")),t.Mixins={createMethodName:function(e,t){return e+t.charAt(0).toUpperCase()+t.substr(1)},applyMixin:function(e,t){n.forEach(n.keys(t),function(r){var s=e.prototype;if("initialize"===r){var o=s.initialize;s.initialize=function(){o&&o.apply(this,arguments),t.initialize.apply(this,arguments)};return}if("validate"===r){var u=s.validate;s.validate=function(){if(u){var e=u.apply(this,arguments);if(e)return e}return t.validate.apply(this,arguments)};return}if("defaults"===r){var f=s.defaults||(s.defaults={}),l=t[r];for(var c in l){if(f.hasOwnProperty(c))throw"Mixin error: class already has default '"+c+"' defined";f[c]=l[c]}return}if("namedAttributes"===r){var h=i(s.namedAttributes)||{},p=i(t[r]);s.namedAttributes=n.extend(h,a(p,h));return}if("namedEvents"===r){if(!n.isArray(t[r]))throw"Expects events member on mixin to be an array";s.namedEvents||(s.namedEvents=[]),s.namedEvents=n.uniq(s.namedEvents.concat(t[r]));return}if(s.hasOwnProperty(r))throw"Mixin error: class already has property '"+r+"' defined";s[r]=t[r]},this)}},t.AttributesMixinCreator={create:function(e){var r={};return e||(e={}),n.has(e,"id")||(e.id=null),n.each(e,function(e,n){var i=t.Mixins.createMethodName("set",n);r[i]=function(e,t){return this.set(n,e,t)};var s=t.Mixins.createMethodName("get",n);r[s]=function(){return this.get(n)}}),r},ensureType:s},t.EventsMixinCreator={create:function(e){var r={},i=function(e){var i=t.Mixins.createMethodName("on",e);r[i]=function(){return this.on.apply(this,[e].concat(n.toArray(arguments)))};var s=t.Mixins.createMethodName("trigger",e);r[s]=function(){return this.trigger.apply(this,[e].concat(n.toArray(arguments)))}};return n.each(e,n.bind(i,this)),r}},t.Model=v(r.Model),t.Collection=d(r.Collection),t.View=d(r.View),t.Router=d(r.Router)})();
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/script/deployments.js' */
(function(c,b){b.Model={};b.Model.DeploymentProject=Brace.Model.extend({namedAttributes:{name:"string",bambooId:"number",url:"string",environmentCount:"number",upToDateEnvironmentCount:"number",applinkId:"string"}});b.Model.Version=Brace.Model.extend({namedAttributes:{name:"string",id:"number",url:"string"}});b.Model.Environment=Brace.Model.extend({namedAttributes:{name:"string",id:"number",issueStatus:"string",statusOk:"boolean",url:"string",version:b.Model.Version}});b.Model.IssueDeploymentStatus=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProject:b.Model.DeploymentProject,versions:Brace.Collection.extend({model:b.Model.Version}),environments:Brace.Collection.extend({model:b.Model.Environment})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.Model.ErrorMessage=Brace.Model.extend({namedAttributes:{message:"string",messageBody:"string"}});b.Model.OauthCallback=Brace.Model.extend({namedAttributes:{oauthCallback:"string",serverName:"string"}});b.Model.RelatedDeploymentProjects=Brace.Model.extend({fetchUrl:"",namedAttributes:{deploymentProjects:Brace.Collection.extend({model:b.Model.DeploymentProject}),errorMessages:Brace.Collection.extend({model:b.Model.ErrorMessage}),oauthCallbacks:Brace.Collection.extend({model:b.Model.OauthCallback})},url:function(){return this.fetchUrl},initialize:function(e,d){this.fetchUrl=d.fetchUrl}});b.IssueDeploymentStatus={};b.IssueDeploymentStatus.View=Brace.View.extend({oAuthDanceReturnUrl:"",initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.model=new b.Model.IssueDeploymentStatus(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){this.$el.html(bamboo.deployments.issueDetailsDialogContent({data:this.model.toJSON()}));return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.removeSpinner,this)).fail(_.bind(this.clearError,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){a(d,f,e,this.$el)},clearError:function(){this.$el.children(".aui-message").remove()},removeSpinner:function(){this.$el.children(".bamboo-icon-loading").remove()}});b.RelatedDeploymentProjects={};b.RelatedDeploymentProjects.PopupDialog=b.RelatedDeploymentProjects.PopupDialog||new JIRA.FormDialog({trigger:".bamboo-deployments-details-link",width:640,autoClose:true});b.RelatedDeploymentProjects.View=Brace.View.extend({initialize:function(d){this.options.bootstrap=d.bootstrap||[];this.oAuthDanceReturnUrl=d.oAuthDanceReturnUrl||"";this.issueId=d.issueId||"";this.selector=d.el;this.model=new b.Model.RelatedDeploymentProjects(this.options.bootstrap,{fetchUrl:d.fetchUrl});this.update()},render:function(){c(this.selector).html(bamboo.deployments.issuePanelContent({data:this.model.toJSON(),issueId:this.issueId,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}));return this.showPanelIfNotEmpty()},showPanelIfNotEmpty:function(){if(!c(this.selector).is(":empty")){c("#bamboo-deployment-projects-right").show()}else{c("#bamboo-deployment-projects-right").hide()}return this},update:function(){return this.model.fetch({cache:false}).done(_.bind(this.render,this)).fail(_.bind(this.displayError,this))},displayError:function(d,f,e){c(this.selector).children(".aui-message").remove();a(d,f,e,c(this.selector))}});function a(h,l,j,g){var f,k,d;try{d=h.responseText||h.response;if(d){f=c.parseJSON(d);g.append(bamboo.components.errorResponseMessage({errorMessage:f,oAuthDanceReturnUrl:encodeURIComponent(this.oAuthDanceReturnUrl)}))}else{k="Unknown error: no response from server"}}catch(i){k="An error occurred while trying to retrieve the deployment project information."}if(k){AJS.messages.warning(g,{title:k,closeable:false})}c("#bamboo-deployment-projects-right").show()}}(AJS.$,window.JBAM_DEPLOYMENT=(window.JBAM_DEPLOYMENT||{})));
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:deployments-resources', location = '/templates/plugins/bamboo/deployments/deployments.soy' */
// This file was automatically generated from deployments.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.deployments == 'undefined') { bamboo.deployments = {}; }


bamboo.deployments.issueDetailsDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Issue deployment details"), '</h2><div id=\'bamboo-deployments-issue-status-container\'><span class="bamboo-icon bamboo-icon-loading" title="loading"><span> </span></span></div><script>new JBAM_DEPLOYMENT.IssueDeploymentStatus.View({el: \'#bamboo-deployments-issue-status-container\', fetchUrl: \'', soy.$$escapeHtml("" + '/rest/bamboo/latest/deploy/' + opt_data.issueKey + '/' + opt_data.applinkId + '/' + opt_data.deploymentProjectId), '\', oAuthDanceReturnUrl: \'', soy.$$escapeHtml(opt_data.returnUrl), '\'});<\/script>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issuePanelContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.data.deploymentProjects) {
    output.append('<ul class=\'property-list\'>');
    var deploymentProjectList14 = opt_data.data.deploymentProjects;
    var deploymentProjectListLen14 = deploymentProjectList14.length;
    for (var deploymentProjectIndex14 = 0; deploymentProjectIndex14 < deploymentProjectListLen14; deploymentProjectIndex14++) {
      var deploymentProjectData14 = deploymentProjectList14[deploymentProjectIndex14];
      output.append('<li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml(deploymentProjectData14.name), '</strong><span class=\'value\'>', (deploymentProjectData14.environmentCount == 0) ? '<span class="aui-icon aui-icon-info"> </span> ' + soy.$$escapeHtml("No environments defined") : (deploymentProjectData14.upToDateEnvironmentCount == 0) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml("None of the environments have all related commits.") : (deploymentProjectData14.environmentCount > deploymentProjectData14.upToDateEnvironmentCount) ? '<span class="aui-icon aui-icon-warning"> </span> ' + soy.$$escapeHtml(AJS.format("{0} of {1} environments don\x27\x27t have all related commits.",deploymentProjectData14.environmentCount - deploymentProjectData14.upToDateEnvironmentCount,deploymentProjectData14.environmentCount)) : '<span class="aui-icon aui-icon-success"> </span> ' + soy.$$escapeHtml("All environments have all related commits."), ' <a id="bamboo-deployment-details_', soy.$$escapeHtml(deploymentProjectData14.bambooId), '" class="bamboo-deployments-details-link" href="', soy.$$escapeHtml(""), '/secure/ViewIssueDeploymentStatus.jspa?id=', soy.$$escapeHtml(opt_data.issueId), '&deploymentProjectId=', soy.$$escapeHtml(deploymentProjectData14.bambooId), '&applicationLinkId=', soy.$$escapeHtml(deploymentProjectData14.applinkId), '">', "Details\x26hellip;", '</a></span></div></li>');
    }
    output.append('</ul>');
  }
  if (opt_data.data.errorMessages) {
    var errorMessageList49 = opt_data.data.errorMessages;
    var errorMessageListLen49 = errorMessageList49.length;
    for (var errorMessageIndex49 = 0; errorMessageIndex49 < errorMessageListLen49; errorMessageIndex49++) {
      var errorMessageData49 = errorMessageList49[errorMessageIndex49];
      bamboo.components.errorResponseMessage({errorMessage: errorMessageData49, oAuthDanceReturnUrl: opt_data.oAuthDanceReturnUrl}, output);
    }
  }
  if (opt_data.data.oauthCallbacks && opt_data.data.oauthCallbacks.length) {
    output.append('<div class="aui-message no-border no-background"><span class="aui-icon icon-warning"></span> ', soy.$$escapeHtml("For more deployment information, you need to log in to and approve the following servers:"), '<ul>');
    var oauthCallbackList59 = opt_data.data.oauthCallbacks;
    var oauthCallbackListLen59 = oauthCallbackList59.length;
    for (var oauthCallbackIndex59 = 0; oauthCallbackIndex59 < oauthCallbackListLen59; oauthCallbackIndex59++) {
      var oauthCallbackData59 = oauthCallbackList59[oauthCallbackIndex59];
      output.append('<li><a href="', oauthCallbackData59.oauthCallback, '&amp;redirectUrl=', opt_data.oAuthDanceReturnUrl, '">', soy.$$escapeHtml(oauthCallbackData59.serverName), '</a></li>');
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueDetailsDialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Bamboo releases with related commits"), '</h3><ul class=\'property-list\'><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Deployment project"), '</strong><span class=\'value\'>');
  bamboo.deployments.itemLink({item: opt_data.data.deploymentProject}, output);
  output.append('</span></div></li><li class=\'item\'><div class=\'wrap\'><strong class=\'name\'>', soy.$$escapeHtml("Releases with commits"), '</strong><span class=\'value\'>');
  var versionList82 = opt_data.data.versions;
  var versionListLen82 = versionList82.length;
  if (versionListLen82 > 0) {
    for (var versionIndex82 = 0; versionIndex82 < versionListLen82; versionIndex82++) {
      var versionData82 = versionList82[versionIndex82];
      bamboo.deployments.itemLink({item: versionData82}, output);
      output.append((! (versionIndex82 == versionListLen82 - 1)) ? ', ' : '');
    }
  } else {
    output.append(soy.$$escapeHtml("No related releases found"));
  }
  output.append('</span></div></li></ul>');
  bamboo.deployments.environmentsTable({environments: opt_data.data.environments}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.environmentsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml("Issue availability across environments"), '</h3>');
  if (opt_data.environments.length > 0) {
    output.append('<table width=\'100%\' class=\'aui\'><colgroup><col width=\'45%\'><col width=\'30%\'><col width=\'25%\'></colgroup><thead><tr><th>', soy.$$escapeHtml("Environment"), '</th><th>', soy.$$escapeHtml("Issue availability"), '</th><th>', soy.$$escapeHtml("Current release"), '</th></tr></thead><tbody>');
    var environmentList107 = opt_data.environments;
    var environmentListLen107 = environmentList107.length;
    for (var environmentIndex107 = 0; environmentIndex107 < environmentListLen107; environmentIndex107++) {
      var environmentData107 = environmentList107[environmentIndex107];
      output.append('<tr><td>');
      bamboo.deployments.itemLink({item: environmentData107}, output);
      output.append((! environmentData107.statusOk) ? ' <span class="aui-icon aui-icon-error">Error</span>' : '', '</td><td>');
      bamboo.deployments.issueAvailabilityLozenge({issueStatus: environmentData107.issueStatus}, output);
      output.append('</td><td>');
      if (environmentData107.version) {
        bamboo.deployments.itemLink({item: environmentData107.version}, output);
      } else {
        output.append('<em>', soy.$$escapeHtml("Never deployed"), '</em>');
      }
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<p>', soy.$$escapeHtml("No environments defined"), '</p>');
  }
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.issueAvailabilityLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.issueStatus == 'AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-success">' + soy.$$escapeHtml("deployed") + '</span>' : (opt_data.issueStatus == 'PARTIALLY_AVAILABLE') ? '<span class="aui-lozenge aui-lozenge-current">' + soy.$$escapeHtml("partly deployed") + '</span>' : '<span class="aui-lozenge">' + soy.$$escapeHtml("not deployed") + '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.deployments.itemLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.item.url) ? '<a href="' + opt_data.item.url + '">' + soy.$$escapeHtml(opt_data.item.name) + '</a>' : soy.$$escapeHtml(opt_data.item.name));
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){GH.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a=this.useAsync?"gh.analytics.async":"gh.analytics.sync";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};
/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:JIRA.Dialogs.getDefaultAjaxOptions});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function k(u,p,r){u=soy.$$escapeHtml(u);p=soy.$$escapeHtml(p);r=soy.$$escapeHtml(r);var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(e){var m={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var i=10;var k,n;var s=e.element.data("saved-state"),r=e.element.data("saved-id");var g,p=this;var d=AJS.SelectSuggestHandler.extend({formatSuggestions:function(v,w){v=this._super(v,w);if(w.length===0){v[v.length-1].footerText("Start typing for sprints.")}return v}});AJS.$.extend(e,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:i,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:t}});o();function h(w){var v=k.apply(this,arguments);v.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(w.properties));return v}function u(x){var w=this.getSelectedDescriptor(),v;if(!x&&!w){b(null)}j();this.hideErrorMessage();if(!w){v=c(x)}else{v=q(w)}if(v.message){this.options.errorMessage=v.message;n.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(v.needsScopeChangeWarning){l()}}function c(x){var w=null,v=false;if(x&&x.length>0){if(s){w=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",x);if(s===m.ACTIVE){v=true}}else{w=AJS.format("{0} is not a valid sprint name.",x)}}else{if(s===m.ACTIVE){v=true}}return{message:w,needsScopeChangeWarning:v}}function q(w){var v=false;if(s===m.ACTIVE){if(r!=w.properties.value){v=true}}else{if(s===m.FUTURE){if(w.properties.stateKey===m.ACTIVE){v=true}}else{if(!s){if(w.properties.stateKey===m.ACTIVE){v=true}}}}return{message:null,needsScopeChangeWarning:v}}function l(){if(!g){g=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var v=p.$container.closest(".inline-edit-fields");if(v.size()>0){v.closest(".editable-field").append(g)}else{p.$container.closest(".field-group").append(g)}}g.show()}function j(){if(g){g.remove();g=null}}function t(v){if(!v.suggestions&&!v.allMatches){return[]}var x=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var w=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(v.suggestions),function(y){x.addItem(f(y,true))});_.each(a(v.allMatches),function(y){w.addItem(f(y,false))});return[x,w]}function f(x,w){var v=soy.$$escapeHtml(x.name);return new AJS.ItemDescriptor({value:x.id.toString(),label:x.name,html:v,stateKey:x.stateKey,boardName:x.boardName,allowDuplicate:false,isSuggestion:w})}function a(v){return _.sortBy(v,function(w){return w.name.toLowerCase()})}function b(v){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:r,updated:v?v.properties.value:null}})}}function o(){p._super(e);k=p.listController._renders.suggestion;n=p.showErrorMessage;p.listController._renders.suggestion=h;p.showErrorMessage=u;e.element.bind("selected",function(x,w,v){v.showErrorMessage(v.getQueryVal());b(w)});p.suggestionsHandler=new d(p.options,p.model)}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.Notification={};GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});AJS.$(".ghx-feedback").css({visibility:"hidden"});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}AJS.$(".ghx-feedback").css({visibility:""})};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});
/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}},generateApplinksAdminUrl:function(d,c,a){var b=d+"/plugins/servlet/applinks/listApplicationLinks";if(c==="confluence"){b=d+"/admin/listapplicationlinks.action"}return AppLinks.Urls.generateUrl(b,a)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
var IssueLinkAppLinks=IssueLinkAppLinks||(function($){function createHelper(servers,context,settings){var helper={};var selectedServer=null;function selectServer(appId){selectedServer=getServer(servers,appId);var authenticationRequired=selectedServer&&selectedServer.requireCredentials;doAuthenticationRequired(authenticationRequired,context);return{authenticationRequired:authenticationRequired}}function setAuthenticationRequired(appId,authenticationRequired){var server=getServer(servers,appId);if(server){server.requireCredentials=authenticationRequired;if(selectedServer&&selectedServer.id===appId){doAuthenticationRequired(authenticationRequired,context)}}}function doAuthenticationRequired(required,context){$(".issue-link-applinks-authentication-message",context).empty();if(required){createAuthRequiredBanner($(".issue-link-applinks-authentication-message",context),context);$(".issue-link-oauth-toggle").hide();$(".buttons-container input[type=submit]",context).attr("disabled","disabled")}else{$(".issue-link-oauth-toggle").show();$(".buttons-container input[type=submit]",context).removeAttr("disabled")}}function createAuthRequiredBanner($container,context){var oauthCallbacks={onSuccess:function(){selectedServer.requireCredentials=false;doAuthenticationRequired(false,context);if(settings.onAuthenticationSuccessCallback){settings.onAuthenticationSuccessCallback(context,selectedServer.id,helper)}},onFailure:function(){if(settings.onAuthenticationFailedCallback){settings.onAuthenticationFailedCallback(context,selectedServer.id,helper)}}};var encodedServerName=AJS.escapeHtml(selectedServer.name);if(selectedServer.authUrl){var $banner=$('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');$banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",selectedServer.authUrl,selectedServer.url,encodedServerName));$("a",$banner).addClass("applink-authenticate");$(".applink-authenticate",$banner).click(function(e){authenticateRemoteCredentials(selectedServer.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});$container.append($banner)}else{var warningMessage=AJS.format("Unable to create a link to \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e as the application does not have any authentication configured.",selectedServer.url,encodedServerName);AJS.messages.warning($container,{body:warningMessage})}}function createOAuthCallback(){if(!AppLinks.OAuthCallback&&typeof (oauthCallback)==="undefined"){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.show=function(url,onSuccess,onFailure){this.onSuccess=onSuccess;this.onFailure=onFailure;this.aouthWindow=window.open(url,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback()}}function authenticateRemoteCredentials(url,onSuccess,onFailure){createOAuthCallback();$(".applinks-error").remove();oauthCallback.show(url,onSuccess,onFailure)}return $.extend(helper,{selectServer:selectServer,setAuthenticationRequired:setAuthenticationRequired})}function getServer(servers,appId){var i;if(servers.length){for(i=0;i<servers.length;i++){if(servers[i].id===appId){return servers[i]}}}return null}function initApplinkServers(settings,context,deferred){var currentAppId=settings.getCurrentAppId(context);var applicationType=$(".issue-link-applinks-application-type",context).val();$.get(AJS.contextPath()+"/rest/issueLinkAppLink/1/appLink/info?type="+applicationType,function(servers){var helper=createHelper(servers,context,settings);var currentRequiresCredentials;if(servers&&servers.length){var currentServer=getServer(servers,currentAppId);if(currentServer){currentRequiresCredentials=$(".issue-link-applinks-authentication-message",context).hasClass("required");if(currentRequiresCredentials){currentServer.requireCredentials=true}helper.selectServer(currentAppId)}deferred.resolve(context,helper)}else{deferred.reject(context)}})}function init(settings,context){var deferred=$.Deferred();var isIssueLinkAppLinkContent=$(".issue-link-applinks-authentication-message",context).length!==0;if(isIssueLinkAppLinkContent&&settings.shouldExecute(context)){initApplinkServers(settings,context,deferred)}return deferred.promise()}return{init:init}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#jira-app-link",context).val()},shouldExecute:function(context){return $("#jira-app-link",context).length!==0}};var updateIssuePicker=function($select,appId){if($select.length){$select.attr("data-ajax-options.data.app-id",appId);if(appId&&appId!==""){$select.attr("data-ajax-options.url",contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/picker")}else{$select.attr("data-ajax-options.url",contextPath+"/rest/api/1.0/issues/picker")}$select.trigger("updateOptions");$select.trigger("clearSelection")}};var updateCreateReciprocalCheckbox=function(appId,context){var $reciprocalCheckbox=$("#create-reciprocal",context);if($reciprocalCheckbox.length){if(appId&&appId!==""){var defaultChoice=($("#create-reciprocal-default",context).val()=="true");if(defaultChoice){$reciprocalCheckbox.attr("checked","checked")}else{$reciprocalCheckbox.removeAttr("checked")}$reciprocalCheckbox.removeAttr("disabled");$("#create-reciprocal-fieldset",context).removeClass("disabled")}else{$reciprocalCheckbox.attr("checked","checked");$reciprocalCheckbox.attr("disabled","disabled");$("#create-reciprocal-fieldset",context).addClass("disabled")}}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){var $select=$("#jira-issue-keys",context);if($select.length){var appId=$("#jira-app-link",context).val();updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)}IssueLinkAppLinks.init(settings,context).done(function(context,helper){$("#jira-app-link",context).change(function(){var appId=$(this).val();helper.selectServer(appId);updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)})})})})(AJS.$);
/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
define("jira/jql/jql-grammar",function(){var grammar={};grammar.jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];grammar.jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];grammar.jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];grammar.jql_logical_operators_and_order_by=grammar.jql_logical_operators.concat(grammar.jql_order_by);grammar.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];grammar.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];grammar.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];grammar.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];grammar.jql_changed_predicates=grammar.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);grammar.jql_was_predicates_and_order_by=grammar.jql_was_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_was_predicates_and_logical_operators=grammar.jql_was_predicates.concat(grammar.jql_logical_operators);grammar.jql_changed_predicates_and_order_by=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_changed_predicates_and_logical_operators=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators);grammar.REGEXP_ANDS=/^AND\s/i;grammar.REGEXP_ORS=/^OR\s/i;grammar.REGEXP_NOTS=/^NOT\s/i;grammar.REGEXP_SNOT=/^\s+not/i;grammar.REGEXP_SIN=/^\s+in/i;grammar.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;grammar.REGEXP_COMMA_DELIMITER=/^\s*,/;grammar.REGEXP_ASCENDING=/^\s+asc/i;grammar.REGEXP_DESCENDING=/^\s+desc/i;grammar.REGEXP_ORDER_BY=/^order\s+by/i;grammar.REGEXP_WHITESPACE=/^\s/;grammar.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;grammar.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;grammar.REGEXP_NEW_LINE=/[\r\n]/;grammar.REGEXP_NUMBER=/\d/;grammar.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;grammar.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;grammar.REGEXP_SPACE_OR_ELSE=/[\s(]/;grammar.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;grammar.REGEXP_NOTSTART=/^NO?$/i;grammar.REGEXP_INSTART=/^IN?$/i;grammar.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;return grammar});define("jira/autocomplete/jql-autocomplete",["jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jquery"],function(AutoComplete,grammar,Util,OperatorUtil,Meta,Objects,jQuery){var JQLAutoComplete=function(options){var that=Objects.begetObject(AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/1.0/jql/autocomplete";that.textToSuggestionCursorPosition=function(){return that.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayNameSug}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=jQuery('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",Meta.get("advanced-search-help-title")).attr("href",Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=jQuery('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(that.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:Util.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=OperatorUtil.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(Util.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:Util.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,grammar.empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);var value;var functionSuggestions;var token=parser.parse(parseValue);result=token.getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,grammar.jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;token.calcLastOperandStartIndex();var parsedOperator=token.getParsedOperator();var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,grammar.jql_operators);if(operatorSuggestions&&operatorSuggestions.length>0){var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),grammar.jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,Util.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,grammar.jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,grammar.jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,grammar.jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),grammar.jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),grammar.jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!OperatorUtil.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),grammar.jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(that.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&OperatorUtil.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(that.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==that.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(that.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=that.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(grammar.REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(that.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=Util.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return Util.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!OperatorUtil.isListSupportingOperator(operator))||(!arrValue.isList&&OperatorUtil.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){supportedType=grammar.jql_changed_predicates[i].type;supportsList=grammar.jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){auto=grammar.jql_changed_predicates[i].auto;break}}return auto};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(grammar.REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};return JQLAutoComplete});define("jira/jql/util",["jira/jql/jql-grammar"],function(grammar){var JQLAutoCompleteUtil={};JQLAutoCompleteUtil.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal};JQLAutoCompleteUtil.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!grammar.REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};JQLAutoCompleteUtil.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};JQLAutoCompleteUtil.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};JQLAutoCompleteUtil.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(grammar.REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};return JQLAutoCompleteUtil});define("jira/jql/operator-util",function(){var that={};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return that.isWasOperator(operator)||that.isChangedOperator(operator)};return that});define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jquery"],function(grammar,Token,OperatorUtil,jQuery){return function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(grammar.REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(grammar.REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!grammar.REGEXP_COMMA_DELIMITER.test(remainingString)){if(grammar.REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(grammar.REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(grammar.REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(grammar.REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(grammar.REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(grammar.REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){var remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,grammar.jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(OperatorUtil.isWasOperator(operator)||OperatorUtil.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_NOTSTART.test(remainingString)||grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&grammar.REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;var matchArray;if(this.startsWithIgnoreCase("is",value)){matchArray=value.substring(2).match(grammar.REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){matchArray=value.substring(3).match(grammar.REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(grammar.REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||grammar.jql_operators[i].value.length>longestMatch){longestMatch=grammar.jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(grammar.REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||grammar.REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(grammar.REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!grammar.REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(grammar.REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(grammar.REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=grammar.jql_changed_predicates.length;for(var i=0;i<arLen;++i){if(predicate.toLowerCase()==grammar.jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}}});define("jira/jql/jql-parse-result",function(){return function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}}});define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],function(ParseResult){return function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var result=this.getResult();var operator=result.getLastOperator();if(operator.length>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operator.length+numSpaces+1)}},getParsedOperator:function(){var result=this.getResult();return(result.getLastOperator().length>0)?this.tokenString.substr(result.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}});AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));
/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/initJQLAutoComplete.js' */
(function(){var JQLAutoComplete=require("jira/autocomplete/jql-autocomplete");var JQLParser=require("jira/jql/jql-parser");var Forms=require("jira/util/forms");var jQuery=require("jquery");jQuery(function(){jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JQLAutoComplete({fieldID:"jqltext",parser:JQLParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",Forms.submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode===13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
var IssueLinkJQLAutoComplete=IssueLinkJQLAutoComplete||(function($){function initialize(options){var fieldID=options.fieldID;var errorID=options.errorID;var autoCompleteUrl=options.autoCompleteUrl;var autoCompleteData=options.autoCompleteData;var formSubmitFunction=options.formSubmitFunction;var $field=$("#"+fieldID);var hasFocus=$field.length>0&&$field[0]==document.activeElement;var jqlFieldNames=autoCompleteData.visibleFieldNames||[];var jqlFunctionNames=autoCompleteData.visibleFunctionNames||[];var jqlReservedWords=autoCompleteData.jqlReservedWords||[];var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:fieldID,parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:errorID,autoCompleteUrl:autoCompleteUrl});$field.unbind("keypress",submitOnEnter);if(formSubmitFunction){$field.keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){formSubmitFunction();return false}else{return true}}})}jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse($field.text());jqlAutoComplete.updateColumnLineCount();$field.click(function(){jqlAutoComplete.dropdownController.hideDropdown()});if(hasFocus){$field.select()}}return{initialize:initialize}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function($){var remoteJiraSearchDialog=new JIRA.FormDialog({id:"remote-jira-search-dialog",trigger:"#link-jira-issue .remote-jira-search-trigger",widthClass:"large",content:function(render){render(JIRA.Templates.RemoteJiraIssueSearch.dialog());initSearchDialog(this.$popup)},submitHandler:function(e,callback){e.preventDefault();$("#simple-search-panel-button").removeAttr("disabled");$("#advanced-search-panel-button").removeAttr("disabled");if($(e.target).attr("id")=="remote-jira-simple-search-form"){$("#simple-search-panel-button").click()}else{$("#advanced-search-panel-button").click()}callback()}});function initSearchDialog($dialog){var appId=$("#jira-app-link").val();var autoCompletePromise=getJqlAutoCompleteData(appId);$("#simple-search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSimpleSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false});$("#advanced-search-panel-button",$dialog).click(function(){advancedSearchButtonClick($dialog);return false});$("#simple-search-toggle",$dialog).click(function(){$("#remote-jira-simple-search-form",$dialog).show();$("#remote-jira-advanced-search-form",$dialog).hide();return false});$("#linkjiraissue-add-selected",$dialog).click(function(){$("table tbody tr:visible  td.selection input:checked",$dialog).each(function(){var issueKey=$(this).parent().data("key");$("#jira-issue-keys").trigger("selectOption",[{value:issueKey}])});$("#link-issue-dialog .error").hide();remoteJiraSearchDialog.hide();$("#link-issue-dialog").show().trigger("multiSelectRevealed");$("#jira-issue-keys-textarea").focus().select()});$("#advanced-search-toggle",$dialog).click(function(){$("#remote-jira-advanced-search-form",$dialog).show();$("#remote-jira-simple-search-form",$dialog).hide();var $jqlSearchText=$("#jql-search-text");if(!$jqlSearchText.attr("jql-initialized")){setAutoCompleteLoadingIconVisible(true,$dialog);autoCompletePromise.done(function(smartAjaxResult){if(smartAjaxResult.successful){IssueLinkJQLAutoComplete.initialize({fieldID:"jql-search-text",errorID:"jql-search-error",autoCompleteUrl:getAutoCompleteUrl(appId),autoCompleteData:smartAjaxResult.data,formSubmitFunction:function(){advancedSearchButtonClick($dialog)}})}else{setJQLErrorVisible(false,$dialog);setAutoCompleteFailedIconVisible(true,$dialog)}setAutoCompleteLoadingIconVisible(false,$dialog);$jqlSearchText.attr("jql-initialized",1)})}$jqlSearchText.focus();return false});$("#simple-search-toggle",$dialog).trigger("click")}function getAutoCompleteUrl(appId){if(appId&&appId!==""){return contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId="+appId}return""}function advancedSearchButtonClick($dialog){$("#search-results-table",$dialog).empty();var searchText=$("#jql-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doAdvancedSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteLoadingIconVisible(visible,$context){$("#autocomplete-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteFailedIconVisible(visible,$context){$("#autocomplete-failed",$context).toggleClass("hidden",!visible)}function setJQLErrorVisible(visible,$context){$("#jql-search-error",$context).toggleClass("hidden",!visible)}function doSimpleSearch(searchText,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();var issueKeyJql='key = "'+searchText+'"';var projectJql='project = "'+searchText+'"';var plainTextJql='summary ~ "'+searchText+'" OR description ~ "'+searchText+'" OR comment ~ "'+searchText+'"';jqlSearch(issueKeyJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(projectJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(plainTextJql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{showResultsError(smartAjaxResult)}})}})}})}function doAdvancedSearch(jql,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();jqlSearch(jql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{if(smartAjaxResult.status===400){AJS.messages.warning("#search-results-table",{body:"Invalid JQL query.",closeable:false})}else{showResultsError(smartAjaxResult)}}})}function jqlSearch(jql,appId){var deferred=$.Deferred();var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/search?jql="+jql+"&appId="+appId+"&maxResults=10"}else{var currentIssueKey=$("#current-issue-key").val();jql="("+jql+") and key != "+currentIssueKey;url=contextPath+"/rest/api/2/search?jql="+jql+"&maxResults=10"}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}});return deferred.promise()}function getJqlAutoCompleteData(appId){var deferred=$.Deferred();var remote;var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId="+appId;remote=true}else{url=contextPath+"/rest/api/2/jql/autocompletedata";remote=false}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){if(!smartAjaxResult.successful&&remote){JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}})}else{deferred.resolve(smartAjaxResult)}}});return deferred.promise()}function showResults(smartAjaxResult,$context){var resultHtml=JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result:smartAjaxResult.data});$("#search-results-table",$context).html(resultHtml);$("#linkjiraissue-select-all",$context).click(function(){var $masterStatus=$(this).prop("checked");$("tbody tr td.selection input",$context).prop("checked",$masterStatus)});$("tbody tr",$context).click(function(e){if($(e.target).is(":checkbox")){return }var checkbox=$(this).find("td.selection input");checkbox.prop("checked",!checkbox.prop("checked"))})}function showResultsError(smartAjaxResult){AJS.messages.error("#search-results-table",{body:JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),closeable:false})}});
/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);
/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.optionName && opt_data.optionName != '-1') ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) + ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");a.focus();this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.$dialogElement.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.$dialogElement.show();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?",""],noEllipsis:[]}})})};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml(""), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm,submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};
/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});
/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);
/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml("This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:data', location = 'js/data/data.js' */
(function(){if(!window.WRM){window.WRM={}}function a(c){if(!c){return c}return JSON.parse(c)}function b(d,c){return Object.prototype.hasOwnProperty.call(d,c)}WRM.data={claim:function(c){if(WRM._unparsedData&&b(WRM._unparsedData,c)){var g=WRM._unparsedData[c];try{var d=a(g);delete WRM._unparsedData[c];return d}catch(f){console&&console.log&&console.log("JSON Error parsing data with key "+c+": "+f)}}}}}());
/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path', location = 'js/data/context-path.js' */
(function(){var a=null;(window.AJS||(window.AJS={}));AJS.contextPath=function(){if(a===null){a=WRM.data.claim("com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path")}return a};AJS.contextPath._reset=function(){a=null}}());
/* module-key = 'com.atlassian.shipit.click-listener-plugin:heat-mapper-events-resources', location = 'js/heat-mapper-dom.js' */
(function(G){try{if(window.AJS&&!AJS.DarkFeatures.isEnabled("heatmapper")){return 
}window.HeatMapper=window.HeatMapper||{};
var E="\"#$%&'()*+,./:;<=>?@[\\]^`{|}~";
function C(J,I,L,K){if(window.AJS&&window.AJS.log){window.AJS.log(J,I,L,K)
}}function D(I){if(!I){return null
}var N="",K;
var M=I.split(" ");
for(var L=0,J=M.length;
L<J;
L++){K=G.trim(M[L]);
if(K.length){N+="."+K
}}return N
}function F(L){var J="";
for(var K=0,I=L.length;
K<I;
K++){var M=L.charAt(K);
if(E.indexOf(M)>=0){J+="\\"
}J+=M
}return J
}function A(I){var K=[];
for(var J in I){if(I.hasOwnProperty(J)&&(J==="name"||J.indexOf("id")>=0)){K.push(J)
}}return K
}var B={click:"a,input,button,textarea",mousedown:"select"};
HeatMapper.DOM={find:function(){return G.find(HeatMapper.DOM.findSelector)
},findSelector:G.map(B,function(I){return I
}).join(","),eventSelectors:B,findAsSelectors:function(){return HeatMapper.DOM.mapToUniqueSelectors(HeatMapper.DOM.find())
},uniqueSelector:function(I){try{if(!I.jquery){I=G(I)
}if(I.attr("id")){return"#"+I.attr("id")
}var K=I.closest("[id]").attr("id")||"";
if(K.length){K="#"+K+" "
}var R=D(I.attr("class"));
var L=K+R;
if(R&&R.length&&G(L).length===1){return L
}var S=HeatMapper.DOM.getAttributes(I);
var T=A(S);
var N;
for(var M=0,J=T.length;
M<J;
M++){N=K+"["+T[M]+'="'+F(S[T[M]])+'"]';
if(G(N).length===1){return N
}}var P=K+I[0].nodeName;
if(R){P+=R
}var Q=G(P).index(I);
return P+":eq("+Q+")"
}catch(O){C("Failed to get selector for:");
C(I);
C(O);
return null
}},mapToUniqueSelectors:function(I){return G.map(I,function(J){return HeatMapper.DOM.uniqueSelector(J)
})
},getAttributes:function(M){if(!M||!M.length){return{}
}var N={};
var K=M[0].attributes;
for(var L=0,J=K.length;
L<J;
L++){var I=K[L];
N[I.name]=I.value
}return N
}}
}catch(H){if(AJS){AJS.log("heat-mapper-dom.js - unexpected exception");
AJS.log(H)
}}})(window.jQuery);
/* module-key = 'com.atlassian.shipit.click-listener-plugin:heat-mapper-events-resources', location = 'js/heat-mapper-events.js' */
AJS.toInit(function(C){try{if(window.AJS&&!AJS.DarkFeatures.isEnabled("heatmapper")){return 
}window.HeatMapper=window.HeatMapper||{};
if(!AJS.EventQueue&&!HeatMapper.Events){AJS.log("Analytics support not installed. Not tracking click events.");
return 
}function A(I){var H=window.location;
return{selector:HeatMapper.DOM.uniqueSelector(I),element:I[0].nodeName,hostname:H.hostname,port:H.port,protocol:H.protocol,path:H.pathname,userAgent:navigator.userAgent}
}function G(H){if(AJS.EventQueue){AJS.trigger("analyticsEvent",{name:"heatmapper-click",data:H})
}else{if(HeatMapper.Events){HeatMapper.Events.publish("heatmapper",H)
}}}function B(J){var I=C(J.currentTarget);
var H=A(I);
J.heatMapperHandled=true;
G(H)
}var E=C(document);
E.delegate(HeatMapper.DOM.eventSelectors.click,"click",B);
E.delegate(HeatMapper.DOM.eventSelectors.mousedown,"mousedown",B);
var F=jQuery.Event.prototype.stopPropagation;
jQuery.Event.prototype.stopPropagation=function(){try{if(this.currentTarget&&!this.heatMapperHandled&&this.type==="click"){var H=C(this.currentTarget);
if(H.is(HeatMapper.DOM.findSelector)){B(this)
}}}catch(I){AJS.log("Failed to intercept stopPropagation properly - skipping event capture");
AJS.log(I)
}return F.call(this)
}
}catch(D){AJS.log("heat-mapper-events.js - unexpected exception");
AJS.log(D)
}});
/* module-key = 'com.atlassian.jira.plugins.jira-software-plugin:jira-software-project-template-resources', location = '/projecttemplates/soy/SoftwareDevelopmentTemplate.soy' */
// This file was automatically generated from SoftwareDevelopmentTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.SoftwareTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.SoftwareTemplates = {}; }


JIRA.Templates.ProjectTemplates.SoftwareTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">', soy.$$escapeHtml("Story"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(h){AJS.EventQueue=AJS.EventQueue||[];var k="jira.project";var B={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function d(J){var L={};for(var K in J.types){if(K!==k){L[K]=J.types[K]}}return L};ATLAS_PROJECT_CREATE.loadRemoteRoots=function a(J){var L=jQuery.Deferred(),M=[],K=[];e(J,function(N){var O=N.capabilitiesUrl;return AJS.$.ajax(O+"/aggregate-root",{success:function(P){var Q=ATLAS_PROJECT_CREATE.getFilteredRootTypes(P);M=M.concat(_.map(Q,function(S,R){return AJS.$.ajax(S.href,{xhrFields:{withCredentials:true},success:function(T){K.push(ATLAS_PROJECT_CREATE.constructFullRootType(T,S.label,R,O,N.id))},error:function(V,T,U){AJS.log("Got "+U+" from aggregate root type "+S.href)}}).promise()}))},error:function(R,P,Q){AJS.log("Got "+Q+" from aggregate roots capapbility for "+O)}}).promise()}).done(function(){u(M).done(function(){L.resolve(K)})});return L.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function g(J,K,N,M,L){return{keys:J.keys,url:J.links.self,label:K,capabilityKey:N,baseUrl:M,instanceId:L}};ATLAS_PROJECT_CREATE.createLink=function w(K,J){console.log("creating link from "+K.entityType+" to "+K.remoteEntityType);var L=JSON.stringify({local:K.baseUrl+"/aggregate-root/"+K.entityType+"/"+K.entityKey,target:K.remoteInstanceBaseUrl+"/aggregate-root/"+K.remoteEntityType+"/"+K.remoteEntityKey});AJS.$.ajax(K.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:L,timeout:8000,complete:J})};ATLAS_PROJECT_CREATE.linkAllTheThings=function q(M,P,J,R,Q){var L=[];h.each(P,function O(S,T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:n()+"/rest/capabilities",remoteEntityType:k,remoteEntityKey:J});L.push({baseUrl:n()+"/rest/capabilities",entityType:k,entityKey:J,remoteInstanceBaseUrl:T.type.baseUrl,remoteEntityType:T.type.capabilityKey,remoteEntityKey:T.data.key});AJS.$.each(P,function U(W,V){if(V!==T){L.push({baseUrl:T.type.baseUrl,entityType:T.type.capabilityKey,entityKey:T.data.key,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key})}})});var N=0;function K(W,S){if(S!=="success"){N++;var T=W.statusText;try{var V=JSON.parse(W.responseText);if(V&&V.message){T=V.message}}catch(U){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:T});M.updateHeight()}if(L.length>0){ATLAS_PROJECT_CREATE.createLink(L.pop(),K)}else{if(N>0){R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{R.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}Q.prop("disabled",false);Q.attr("aria-disabled","false")}}K(null,"success")};var H;function i(M,J,K){var L=J();h.when(M).then(function(N){L.getCurPanel().body.find(".field-group.loading").remove();N.sort(o);if(N.length!==0){var O=L.getCurPanel().body.find("form");O.append(project.creation.remoteRootsCheckboxes({rootTypes:N}));if(K){O.find('input[type="checkbox"]').filter(".remote-root").change(K)}L.updateHeight()}m(L,true)},function(){L.getCurPanel().body.find(".field-group.loading").remove();m(L,true);L.updateHeight()})}var t;function p(J,K){var L=J();t=L.getCurPanel();t.body.find("form").append(project.creation.remoteRootsLoading({}));m(L,false);L.updateHeight();t.page.element.find(".add-project-back-button").click(function(){L.updateHeight()});G(i,J,K)}function j(K){var L=_.filter(t.body.find("input.remote-root.checkbox"),function(M){return M.checked===true});var J=_.map(L,function(M){return M.id});return _.filter(K,function(M){return _.contains(J,"capability_"+M.capabilityKey)})}var c=AJS.$('meta[name="ajs-remote-user"]');if(!c||!c[0]||!c[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var I=function I(O,L,N,K,M){var J=function J(P,Q){Q.prop("disabled",true);Q.attr("aria-disabled","true");Q.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");P()};h.when(H).then(function(Q){var P=j(Q);f(P);if(P.length===0){O.prevPage();L();return}r(O,J,L);var R=[];var S=[];e(P,function(T){var U="creation_status_"+T.capabilityKey.replace(".","_")+"_"+T.instanceId;R.push({statusId:U,label:T.label});return AJS.$.ajax(T.url+"/"+K,{type:"PUT",data:JSON.stringify({label:M}),xhrFields:{withCredentials:true},success:function(V){S=S.concat(D(V,T));z(V,U)},error:function(W,X,V){y(U,T,W,V)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){F(O);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(O,S,K,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:R}))})};var l=function l(K){var J;h.when(H).then(function(N){var M=j(N);_.each(M,function(P){if(P.keys){for(var O in P.keys){if(P.keys.hasOwnProperty(O)){if(K.toUpperCase()===O.toUpperCase()){J=P}}}}})});var L={errors:{}};if(J){L.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",J.label)}return L};function E(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function n(){var J=E();return J+AJS.contextPath()}function G(M,K,L){AJS.$.ajax(n()+"/rest/capabilities/awareness",{type:"GET",success:function J(O){var R="source/rest/capabilities";var P=_.pairs(O.applications);var Q=E()+"/svn";var N=_.map(_.filter(P,function(S){return(S[0].substr(0,Q.length))!==Q}),function(T){var S=T[0];if(S.substr(S.length-R.length)===R){A=T[1]}return _.extend(T[1],{capabilitiesUrl:S})});N.push({id:O.links.selfInstanceId,capabilitiesUrl:O.links.collection});H=ATLAS_PROJECT_CREATE.loadRemoteRoots(N);v=O.links.selfInstanceId;if(typeof M==="function"){M(H,K,L)}},error:function(P,N,O){console.log("Project create error - error gathering roots from awareness capability");if(K){h(K().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var v;var A=null;function e(L,K){var J=_.map(L,K);return u(J)}function u(K){var J=h.Deferred();var L=0;if(K.length===0){J.resolve()}else{_.each(K,function(M){M.always(function(){L++;if(L===K.length){J.resolve()}})})}return J.promise()}function r(L,J,K){L.addPanel("title","","post-project-created-page-content");L.addHeader("Creating and linking companions for your JIRA project");L.addButton("All done!",function(){J(K,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(K,J){var L=[];if(J.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");L.push({type:{capabilityKey:"fecru.repository",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:K.key}});L.push({type:{capabilityKey:"fecru.project",instanceId:A.id,baseUrl:A.capabilitiesUrl},data:{key:"CR-"+K.key}})}else{console.log("got back created thing "+J.capabilityKey);var M={type:J,data:K};L.push(M)}return L}function z(L,M){var K=AJS.$("."+M);K.empty();K.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(L.links.resource){var J=AJS.$("<a target='_blank'></a>");J.text(L.label);J.attr("href",L.links.resource);J.attr("title",L.label);K.closest("li").append(J)}}function y(Q,K,P,O){var M=AJS.$("."+Q);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var J=O;if(P&&P.responseText){try{var N=JSON.parse(P.responseText);if(N&&N.message){J=N.message}}catch(L){J=P.responseText}}AJS.messages.error(".li-"+Q,{title:AJS.format("Could not create {0}",K.label),body:J})}function F(J){var K=J.getCurrentPanel();if(K.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});J.updateHeight()}}function f(J){var K=_.map(J,function(M){return M.capabilityKey});var L=(K.length==0)?"none":K.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:L}})}function m(K,J){h(K.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!J)}function o(K,J){return x(J.capabilityKey)-x(K.capabilityKey)}function x(J){return _.has(B,J)?B[J]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(l);var C=function C(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var b=function b(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){p(C,b)});JPT.AddProjectController.registerPostProjectCreationCallback(function(N,O,M,K,L){var J=function(){window.location=AJS.contextPath()+O};I(N,J,M,K,L)});var s=function s(){var M="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function L(O){if(O==M){G()}});GH.StartWizardView.registerWizardStepPostRenderCallback(function N(Q,O){if(Q==M){p(function P(){return O});O.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function J(T,Q){if(T==M){var S=Q.getCurPanel().body.find("#ghx-wizard-project-projectkey");var P=l(S.val());if(P.errors.projectKey){var O=AJS.$("<div class='error project-creation-error'></div>");var R=S.parent();R.find(".project-creation-error").remove();R.append(O);O.text(P.errors.projectKey);O.show();return false}}return true});GH.StartWizardView.registerWizardStepOnCreateCallbacks(function K(P,Q,O){console.log("creating external entities");P.addPage("post-project-created-page");I(P,Q,null,O.project.key,O.project.name)})};h(function(){AJS.$(".add-project-trigger").live("click",G);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){s()}}});h(function(){AJS.$(".add-project-trigger").live("click",G)})})(jQuery);
/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'templates/whats-new.soy' */
// This file was automatically generated from whats-new.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WhatsNew == 'undefined') { JIRA.Templates.WhatsNew = {}; }


JIRA.Templates.WhatsNew.whatsNewDialogPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="whats-new-dialog-text"><div class="whats-new-throbber hidden"></div><div class="whats-new-timeout hidden"><div class="aui-message warning"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Oops."), '</strong></p><p>', AJS.format("We\u2019re having trouble downloading the \x3ca target\x3d\x22_blank\x22 href\x3d\x22{0}\x22\x3eWhat\u2019s New content\x3c/a\x3e from the Atlassian website. This may be because you have a slow internet connection or that no internet connection is available.",opt_data.whatsNewFullLink), '</p></div></div></div><iframe id="whats-new-iframe" class="hidden" scrolling="no" frameborder="0" src="', soy.$$escapeHtml(opt_data.whatsNewHelpLink), '"></iframe>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WhatsNew.whatsNewDialogTipPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-tip"><input id="dont-show-whats-new" type="checkbox" name="dontshow"', (opt_data.dontShowAgain) ? ' checked="checked"' : '', '><label for="dont-show-whats-new" type="checkbox"><span class="checkbox-label">', (opt_data.isOnDemand) ? soy.$$escapeHtml("Don\u2019t show again") : soy.$$escapeHtml("Don\u2019t show again. You will still be able to access this dialog through the \u2018Help\u2019 Menu in the application header."), '</span></label></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'js/whats-new.js' */
Raphael.spinner=function(k,f,h){var o=h||"#fff",n=f*13/60,s=f*35/60,p=f,d=p+n,c=p+n,m=Raphael(k,p*2+n*2,p*2+n*2),l=[],e=[],u=2*Math.PI/12,j={stroke:o,"stroke-width":n,"stroke-linecap":"round"};for(var q=0;q<12;q++){var g=u*q-Math.PI/2,b=Math.cos(g),a=Math.sin(g);e[q]=q/12;l[q]=m.path([["M",d+s*b,c+s*a],["L",d+p*b,c+p*a]]).attr(j)}var t;(function v(){e.unshift(e.pop());for(var r=0;r<12;r++){l[r].attr("opacity",e[r])}m.safari();t=setTimeout(v,80)})();return function(){clearTimeout(t);m.remove()}};var dim=AJS.dim;AJS.dim=function(){try{dim.apply(this,arguments)}catch(a){}};AJS.toInit(function(l){var i=l("#whats-new-menu-link"),e,c,a,m,h,g,k=function(p){var o=!l(this).attr("checked");var n=contextPath+"/rest/whatsnew/1.0/show";l.ajax({url:n,data:{},type:o?"POST":"DELETE",success:function(){AJS.log("whatsnew > toggleDontShow > isWelcomeDialogShownForUser set to: "+o)}})},d=function(){if(!c){return}g&&clearTimeout(g);f();AJS.setVisible(c,true)},j=function(p){var o=new AJS.Dialog({width:855,height:545,id:"whats-new-dialog",onCancel:function(){o.hide().remove();g&&clearTimeout(g)}});var q=AJS.Meta.get("whats-new-iframe-src");if(typeof(q)=="undefined"||q===""){q=AJS.Meta.get("whatsnew-full-link")}var r="What\u2019s New in JIRA";o.addHeader(r);var n=JIRA.Templates.WhatsNew.whatsNewDialogPanel({whatsNewHelpLink:q,whatsNewFullLink:AJS.Meta.get("whatsnew-full-link")});o.addPanel("default",n);o.addCancel("Close",function(){o.hide().remove();g&&clearTimeout(g);return false});a=o.popup.element;if(AJS.Meta.get("remote-user")){o.page[o.curpage].buttonpanel.append(JIRA.Templates.WhatsNew.whatsNewDialogTipPanel({isOnDemand:AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND"),dontShowAgain:(!p)}));a.find("#dont-show-whats-new").change(k)}c=a.find("iframe");c.load(d);m=a.find(".whats-new-timeout");return o},f=function(){if(h){h();h=null}e.addClass("hidden")},b=function(){var n=contextPath+"/rest/whatsnew/1.0/show";l.getJSON(n,function(o){j(o.isShownForUser).show();e=a.find(".whats-new-throbber.hidden");e.removeClass("hidden");h=Raphael.spinner(e[0],80,"#666");g=setTimeout(function(){c=null;f();AJS.setVisible(m,true)},10000)})};i.click(function(n){n.preventDefault();b()});if(AJS.Meta.getBoolean("show-whats-new")){AJS.Popups.DisplayController.request({name:"jira-whats-new-dialog",weight:100,show:function(){b()}})}});
/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'templates/welcome.soy' */
// This file was automatically generated from welcome.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WelcomeScreen == 'undefined') { JIRA.Templates.WelcomeScreen = {}; }


JIRA.Templates.WelcomeScreen.welcomeScreenPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="welcome-screen-splash aui-item"><h1><span class="assistive">JIRA</span></h1></div><div class="welcome-screen-content-container aui-item"><div class="welcome-screen-content">', (opt_data.theirName) ? '<h1>' + soy.$$escapeHtml(AJS.format("Welcome, {0}!",opt_data.theirName)) + '</h1>' : '<h1>' + soy.$$escapeHtml("Welcome!") + '</h1>', '<p>', soy.$$escapeHtml("To begin working with JIRA, you need to create a project."), '</p><ul class="welcome-screen-options aui-group"><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'demoproject', href: '/secure/CreateDemoProject.jspa?atl_token=' + opt_data.atl_token, title: "Start with a demo project", description: "Get started with a pre-populated project to get an idea of what you can do in JIRA.", cssClass: ''}, output);
  output.append('</li><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'blankproject', href: '/secure/admin/AddProject!default.jspa?nextAction=browseprojects', title: "Create a blank project", description: "Start with an empty project to begin managing your issues.", cssClass: 'add-project-trigger'}, output);
  output.append('</li></ul></div><div class="welcome-screen-alternate-options"><p>', AJS.format("{0}I\x27\x27ll skip this{1}, I know what I\x27\x27m doing.",opt_data.cancelLinkHtml,'</a>'), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WelcomeScreen.welcomeScreenAction = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="welcome-screen-action ', soy.$$escapeHtml(opt_data.cssClass), '" data-type="', soy.$$escapeHtml(opt_data.type), '" href="', soy.$$escapeHtml(""), soy.$$escapeHtml(opt_data.href), '"><h3>', soy.$$escapeHtml(opt_data.title), '</h3>', (opt_data.description) ? '<p>' + soy.$$escapeHtml(opt_data.description) + '</p>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'js/welcome.js' */
(function(d){var c=contextPath+"/rest/welcome/1.0/show/welcome",b=contextPath+"/rest/welcome/1.0/show/browseprojects",e="welcome-screen-cancel-trigger";function a(){return JIRA.Templates.WelcomeScreen.welcomeScreenPanel({theirName:AJS.Meta.get("remote-user-fullname")||"",cancelLinkHtml:'<a class="'+e+'" href="'+contextPath+'/">',atl_token:atl_token()})}JIRA.Dialogs.demoProject=new JIRA.FormDialog({id:"demo-project-dialog",trigger:"a.welcome-screen-action[data-type='demoproject']",stayVisibleOnRedirect:true,onContentRefresh:function(){jQuery(".overflow-ellipsis").textOverflow()}});d(document).bind("focusShifterTip.show",function(f){if(AJS.Meta.getBoolean("suppress-focus-shifter-tip")){f.preventDefault()}});AJS.toInit(function(j){var g;var f=function(){var k=new AJS.Dialog({width:860,height:500,id:"welcome-dialog",onCancel:function(){}});k.addPanel("default",a());JIRA.bind("Dialog.beforeHide",i);j("a",k.popup.element).click(function(l){JIRA.unbind("Dialog.beforeHide",i)});j("."+e,k.popup.element).click(h);j(".welcome-screen-action",k.popup.element).click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.action",properties:{type:this.getAttribute("data-type")}});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > action clicked > don't show dialog anymore")}});k.hide().remove()});return k},i=function(k){if(JIRA.Dialog&&JIRA.Dialog.current&&g&&JIRA.Dialog.current.$popup==g.popup.element){k.preventDefault()}},h=function(k){k.preventDefault();g.hide().remove();AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.dismiss"});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > don't show dialog anymore")}})};if(AJS.Meta.getBoolean("show-welcome-screen")){}j(".browse-projects-info-dismiss").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.dismisstext"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > dismiss clicked > don't show info panel anymore")}});j("#browse-projects-info").fadeOut()});AJS.bind("messageClose",function(l,k){if(k.attr("id")=="browse-projects-info"){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.closebutton"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > close button clicked > don't show info panel anymore")}})}})})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:shared-resources', location = '/js/shared/Link.js' */
(function(){var c;var a=function(d){return AJS.Meta.getBoolean(d)===true};var b=Class.extend({suppress:function(){c=true;return undefined},isSuppressed:function(){if(c===true){return true}return a("disable-issue-collector")}});JIRA=JIRA||{};JIRA.Feedback=JIRA.Feedback||{};JIRA.Feedback.Link=new b()})();
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/templates/feedback-link.soy' */
// This file was automatically generated from feedback-link.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Feedback == 'undefined') { JIRA.Feedback = {}; }
if (typeof JIRA.Feedback.Plugin == 'undefined') { JIRA.Feedback.Plugin = {}; }


JIRA.Feedback.Plugin.subtleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jira-feedback-link-container float subtle-style\'><a class=\'js-feedback-link jira-feedback-link\' href=\'#\'>', soy.$$escapeHtml("Got Feedback?"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Feedback.Plugin.footerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class=\'jira-feedback-link-container footer-style\'><a class="aui-button jira-feedback-link ">', soy.$$escapeHtml("Got Feedback?"), '</a></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jic-bootstrap.js' */
(function($){var ATL_JQ=function(){return $.apply($,arguments)};var baseUrl="https://jira.atlassian.com";var css=".atlwdg-blanket {background: black;height: 100%;left: 0;opacity: .5;position: fixed;top: 0;width: 100%;z-index: 1000000;}.atlwdg-popup {background: white;border: 1px solid #666;position: fixed;top: 50%;left: 50%;z-index: 10000011;}.atlwdg-popup.atlwdg-box-shadow {-moz-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);-webkit-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);box-shadow: 10px 10px 20px rgba(0,0,0,0.5);background-color: white;}.atlwdg-hidden {display: none;}.atlwdg-trigger {position: fixed;background: #013466;padding: 5px;border: 2px solid white;border-top: none;font-weight: bold;color: white !important;display: block;white-space: nowrap;text-decoration: none !important;font-family: arial, FreeSans, Helvetica, sans-serif;font-size: 12px;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-webkit-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-moz-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);border-radius: 0 0 5px 5px;-moz-border-radius: 0 0 5px 5px;}.atlwdg-trigger.atlwdg-TOP {left: 45%;top: 0;}.atlwdg-trigger.atlwdg-RIGHT {left: 100%;top: 40%;-webkit-transform-origin: top left;-webkit-transform: rotate(90deg);-moz-transform: rotate(90deg);-moz-transform-origin: top left;-ms-transform: rotate(90deg);-ms-transform-origin: top left;}.atlwdg-trigger.atlwdg-SUBTLE {right: 0;bottom: 0;border: 1px solid #ccc;border-bottom: none;border-right: none;background-color: #f5f5f5;color: #444;font-size: 11px;padding: 6px;box-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5);border-radius: 2px 0 0 0;}.atlwdg-loading {position: absolute;top: 220px;left: 295px;}";var cssIE=".atlwdg-trigger {position: absolute;}.atlwdg-blanket {position: absolute;filter: alpha(opacity=50);width: 110%;}.atlwdg-popup {position: absolute;}.atlwdg-trigger.atlwdg-RIGHT {left: auto;right: 0;filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);}";ATL_JQ.isQuirksMode=function(){return document.compatMode!="CSS1Compat"};ATL_JQ.IssueDialog=function(options){var $body=$("body"),that=this,showDialog=function(){that.show();return false};this.options=options;this.frameUrl=baseUrl+"/rest/collectors/1.0/template/form/"+this.options.collectorId+"?os_authType=none";$("head").append("<style type='text/css'>"+css+"</style>");if(this.options.triggerPosition==="CUSTOM"){var oldTriggerFunction;if(this.options.triggerFunction){try{oldTriggerFunction=eval("("+this.options.triggerFunction+")")}catch(ex){}}$(function(){try{var newTriggerFunction;if(window.ATL_JQ_PAGE_PROPS&&((window.ATL_JQ_PAGE_PROPS.triggerFunction)||(window.ATL_JQ_PAGE_PROPS[this.options.collectorId]&&window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction))){newTriggerFunction=window.ATL_JQ_PAGE_PROPS.triggerFunction||window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction}else{newTriggerFunction=oldTriggerFunction}if($.isFunction(newTriggerFunction)){newTriggerFunction(showDialog)}}catch(ex){}})}else{if($.isFunction(this.options.triggerPosition)){try{this.options.triggerPosition(showDialog)}catch(ex){}}else{if(this.options.triggerPosition&&this.options.triggerText){var triggerClass="atlwdg-trigger atlwdg-"+this.options.triggerPosition;var $trigger=$("<a href='#' id='atlwdg-trigger'/>").addClass(triggerClass).text(this.options.triggerText);$body.append($trigger);$trigger.click(showDialog)}}}var $iframeContainer=$("<div id='atlwdg-container'/>").addClass("atlwdg-popup atlwdg-box-shadow atlwdg-hidden");var $blanket=$("<div id='atlwdg-blanket' class='atlwdg-blanket'/>").hide();$body.append($blanket).append($iframeContainer);if($.browser.msie&&(ATL_JQ.isQuirksMode()||$.browser.version<9)){$("head").append("<style type='text/css'>"+cssIE+"</style>");var triggerAdjuster=function(e){};if(this.options.triggerPosition==="TOP"){triggerAdjuster=function(e){$("#atlwdg-trigger").css("top",$(window).scrollTop()+"px")}}else{if(this.options.triggerPosition==="RIGHT"){triggerAdjuster=function(e){var $trigger=$("#atlwdg-trigger");$trigger.css("top",($(window).height()/2-$trigger.outerWidth()/2+$(window).scrollTop())+"px");if(!ATL_JQ.isQuirksMode()&&$.browser.version==="8.0"){$trigger.css("right",-($trigger.outerHeight()-$trigger.outerWidth())+"px")}}}else{if(this.options.triggerPosition==="SUBTLE"){var outerHeight=$trigger.outerHeight();triggerAdjuster=function(e){var $window=$(window);$trigger.css("top",($window.scrollTop()+$window.height()-outerHeight)+"px")}}}}$(window).bind("scroll resize",triggerAdjuster);triggerAdjuster()}};ATL_JQ.IssueDialog.prototype={hideDialog:undefined,updateContainerPosition:function(){var width=810,height=450;$("#atlwdg-container").css({height:height+"px",width:width+"px","margin-top":-Math.round(height/2)+"px","margin-left":-Math.round(width/2)+"px"});$("#atlwdg-frame").height("100%").width("100%")},show:function(){var that=this,$iframeContainerElem=$("#atlwdg-container"),$body=$("body"),$iframeElem=$('<iframe id="atlwdg-frame" frameborder="0" src="'+this.frameUrl+'"></iframe>'),$loadingImage=$('<img class="atlwdg-loading" style="display:none;" src="https://jira.atlassian.com/images/throbber/loading_barber_pole_horz.gif">');hideDialog=function(e){if(e.keyCode===27){that.hide()}};$iframeContainerElem.append($loadingImage);var throbberTimeout=setTimeout(function(){$loadingImage.show()},300);$body.css("overflow","hidden").keydown(hideDialog);window.scroll(0,0);var feedbackString="";if(this.options.collectFeedback){var feedback=this.options.collectFeedback();for(var prop in feedback){if(feedback.hasOwnProperty(prop)&&feedback[prop]!==undefined&&feedback[prop]!==""&&typeof feedback[prop]==="string"){feedbackString+="*"+prop+"*: "+feedback[prop]+"\n"}}}var fieldValues={};if(this.options.fieldValues&&!$.isEmptyObject(this.options.fieldValues)){$.extend(fieldValues,this.options.fieldValues)}$iframeElem.load(function(){var message={feedbackString:feedbackString,fieldValues:fieldValues};$iframeElem[0].contentWindow.postMessage(JSON.stringify(message),"https://jira.atlassian.com");$(window).bind("message",function(e){if(e.originalEvent.data&&e.originalEvent.data==="cancelFeedbackDialog"){that.hide()}})});$iframeElem.load(function(e){clearTimeout(throbberTimeout);$loadingImage.hide();$iframeElem.show()});var currentMilis=new Date().getTime();var dummyElement=document.createElement("a");dummyElement.href="https://jira.atlassian.com";$iframeContainerElem.append($iframeElem);this.updateContainerPosition();$iframeContainerElem.show();$("#atlwdg-blanket").show()},hide:function(){$("body").css("overflow","auto").unbind("keydown",hideDialog);$("#atlwdg-container").hide().empty();$("#atlwdg-blanket").hide()}};var filterStrings=function(obj,recursingIn){for(var key in obj){if(!obj.hasOwnProperty(key)){continue}var value=obj[key];if(recursingIn===undefined&&$.isArray(value)){filterStrings(value,key);continue}if(typeof value!=="string"){var paramName=recursingIn===undefined?key:recursingIn+":"+key;console.log("bootstrap.js:filterStrings ignoring key for value '"+paramName+"'; typeof must be string");delete obj[key]}}return obj};window.JIRAS_OWN_ATL_JQ=ATL_JQ})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jira-feedback-plugin.js' */
AJS.$(function(f){var d="d3de7fb5";var g="c612fb25";var e=AJS.Meta.get("version-number");var c=!(f.browser.msie&&parseInt(f.browser.version,10)<9);var b=function(){if(!c){return false}if(AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND")){return g}if(AJS.params.baseURL&&AJS.params.baseURL.indexOf("sandbox.onjira.com")>=0){return d}if(AJS.Meta.get("is-beta")||AJS.Meta.get("is-rc")||AJS.Meta.get("is-snapshot")||AJS.Meta.get("is-milestone")){return d}if(f(".licensemessagered:contains('JIRA evaluation license')").length>0){return d}return false};var a=b();if(!JIRA.Feedback.Link.isSuppressed()&&a){h();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,i);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,i)}function i(o,l,n){if((o.type==="newContentAdded"&&n==="pageLoad")||(o.type==="layoutRendered"&&l==="list-view")){var m=f(".navigator-sidebar").hasClass("collapsed");var k=f(".jira-feedback-link-container");k.remove();k=h();if(m&&k.hasClass("subtle-style")){k.addClass("left noborder")}}}function j(){var k=f("#footer-build-information").text();var m=function(){return{Location:window.location.href,"User-Agent":navigator.userAgent,Referrer:document.referrer,"Screen Resolution":screen.width+" x "+screen.height,"JIRA Version":e,"JIRA Footer Version":k}};var l=new JIRAS_OWN_ATL_JQ.IssueDialog({collectorId:a,collectFeedback:m});l.show()}function h(){var m=f("#footer .atlassian-footer:visible").eq(0);var l;if(m.length>0){l=m;l.append(JIRA.Feedback.Plugin.footerLink())}else{l=f("body");l.append(JIRA.Feedback.Plugin.subtleLink())}var k=l.find(".jira-feedback-link-container");k.on("click",".jira-feedback-link",j);return k}});
/* module-key = 'com.atlassian.growth.product-growth-jira-plugin:growth-web-resources', location = 'js/growth-helper.js' */
var GROW=GROW||{};(function(a){GROW.isLoggedIn=function(){if(AJS.Meta.get("remote-user")){return true}return false};GROW.isAdmin=function(){return a("#system-admin-menu").length!==0};AJS.toInit(function(){if(location.search.indexOf("triggerCreateProject=true")>-1){JPT.DialogController.handleProjectTemplateTriggered()}})})(AJS.$);
/* module-key = 'com.atlassian.growth.product-growth-jira-plugin:growth-web-resources', location = 'js/store.js' */
var GROW=GROW||{};GROW.Store=GROW.Store||{};(function(a){GROW.Store.get=function(b){return AJS.Meta.get(b)};GROW.Store.getNumber=function(b){return AJS.Meta.getNumber(b)};GROW.Store.getBoolean=function(b){return AJS.Meta.getBoolean(b)};GROW.Store.set=function(b,c){AJS.Meta.set(b,c);return a.ajax({url:contextPath+"/rest/growth/1/store",type:"PUT",contentType:"application/json",data:JSON.stringify({key:b,value:c})})};GROW.Store.setGlobal=function(b,c){AJS.Meta.set(b,c);return a.ajax({url:contextPath+"/rest/growth/1/store/global",type:"PUT",contentType:"application/json",data:JSON.stringify({key:b,value:c})})}})(AJS.$);
/* module-key = 'com.atlassian.jira.ext.calendar:browse-project-tip', location = 'com/atlassian/jira/ext/calendar/resources/js/BrowseProjectTip.js' */
AJS.toInit(function(d){var c=WRM.data.claim("com.atlassian.jira.ext.calendar:tipDataProvider.tip").suppressTip;if(!c){var a="browse-project-calendar-info";var b=function(e){if(e.length){var f=d("<div/>");AJS.messages.info(f,{body:AJS.format("This calendar shows when issues are due to be completed. This is set by the {0} field for an issue.","Due Date"),closeable:true});f.find(".aui-message").attr("id",a);e.prepend(f)}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,g,h){var f;if(g.attr("id")=="project-tab"){f=d(".issues-calendar-container",g)}else{f=d("#project-tab .issues-calendar-container",g)}b(f)});b(d("#project-tab .issues-calendar-container"));AJS.bind("messageClose",function(g,f){if(f.attr("id")==a){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectcalendarinfo.closebutton"});d.ajax({data:{tipKey:"browseProjectCalendarTab"},type:"POST",url:contextPath+"/rest/calendar-plugin/1.0/suppressedTips"})}})}});
/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected;this._urls=options.urls},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},getUrl:function(size){return this._urls[size]},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected,urls:this._urls}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.getSizeObjectFromName=function(name){if("object"===typeof name){return name}var nameTrimmed="string"===typeof name?jQuery.trim(name):"";if(JIRA.Avatar.LARGE.param===name){return JIRA.Avatar.LARGE}else{if(JIRA.Avatar.MEDIUM.param===name){return JIRA.Avatar.MEDIUM}else{if(JIRA.Avatar.SMALL.param===name){return JIRA.Avatar.SMALL}else{if("xsmall"===name){return JIRA.Avatar.SMALL}else{return JIRA.Avatar.LARGE}}}}};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}return avatar.getUrl(AJS.format("{0}x{1}",size.height,size.width))},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createUniversalAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectId){var urlAvatarOwnerPrefix=contextPath+"/rest/api/latest/universal_avatar/type/"+options.avatarType+"/owner/"+options.projectId;restQueryUrl=urlAvatarOwnerPrefix;var avatarCreateUrl=urlAvatarOwnerPrefix+"/avatar";restUpdateUrl=null;restCreateTempUrl=urlAvatarOwnerPrefix+"/temp";restUpdateTempUrl=avatarCreateUrl;restSingleAvatarUrl=avatarCreateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createProjectAvatarManager=function(options){options.avatarType="project";return JIRA.AvatarManager.createUniversalAvatarManager(options)};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null;this.initialSelection=options.initialSelection},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar img"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));if(undefined!=instance.initialSelection){instance.getAvatarElById(instance.initialSelection).addClass("jira-selected-avatar")}ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(e.target===el[0]){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createUniversalAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUniversalAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,avatarType:options.avatarType}),initialSelection:options.initialSelection,imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:options.hasOwnProperty("avatarSize")?options.avatarSize:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createUniversalAvatarPickerDialog=function(options){var lastSelection=options.initialSelection||options.defaultAvatarId;var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text(options.title||"Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUniversalAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,initialSelection:lastSelection,avatarType:options.avatarType,avatarSize:options.avatarSize,select:function(avatar,src,implicit){lastSelection=String(avatar.getId());if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});userAvatarDialog._focusFirstField=function(){}};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());
/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label>', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader" /><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" data-id="', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" /></span></li>');
  }
  var avatarList25 = opt_data.avatars.custom;
  var avatarListLen25 = avatarList25.length;
  for (var avatarIndex25 = 0; avatarIndex25 < avatarListLen25; avatarIndex25++) {
    var avatarData25 = avatarList25[avatarIndex25];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData25.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData25.id), '" data-id="', soy.$$escapeHtml(avatarData25.id), '" src="', soy.$$escapeHtml(avatarData25.src), '" width="', soy.$$escapeHtml(avatarData25.width), '" height="', soy.$$escapeHtml(avatarData25.height), '" /></span><span class="jira-delete-avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">Delete</span></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var trigger=jQuery(".jira-avatar-picker-trigger");var triggerImg=jQuery(".jira-avatar-picker-trigger img, img.jira-avatar-picker-trigger",ctx);var avatarIdField=jQuery(ctx).find("#avatar-picker-avatar-id");var avatarIconurlField=jQuery(ctx).find("#avatar-picker-iconurl");var avatarTypeElement=jQuery(ctx).find("#avatar-type");if(""===avatarTypeElement.text()){return }JIRA.createUniversalAvatarPickerDialog({trigger:trigger,title:jQuery(ctx).find("#avatar-dialog-title").text(),projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),initialSelection:avatarIdField.val(),avatarSize:JIRA.Avatar.getSizeObjectFromName(jQuery(ctx).find("#avatar-size").text()),avatarType:avatarTypeElement.text(),select:function(avatar,src){triggerImg.attr("src",src);avatarIconurlField.val(src);avatarIdField.val(avatar.getId())}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();
/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],init:function(A){A=A||{};
this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";
this._hasRetainFeature=true;
this._hasVisibilityFeature=true;
this.retainedFields=[];
this.initIssueType=A.issueType;
this.initProjectId=A.projectId;
this.parentIssueId=A.parentIssueId;
this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;
if(A.nonRetainedFields){this.nonRetainedFields=_.union(A.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)
}},getParentIssueId:function(){return this.parentIssueId
},isInMultipleMode:function(){return this.multipleMode
},setIsMultipleMode:function(A){this.multipleMode=A
},getActiveFieldIds:function(){var A=this,B=jQuery.Deferred(),C=[];
this.getUserFields().done(function(D){jQuery.each(D,function(F,E){C.push(E)
});
A.getRequiredFields().done(function(E){jQuery.each(E,function(G,F){if(jQuery.inArray(F.id,C)===-1){C.push(F.id)
}});
B.resolve(C)
})
});
return B.promise()
},hasVisibilityFeature:function(A){return !A.required
},getFieldsResource:function(){var A=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";
if(this.parentIssueId){return A+"&parentIssueId="+this.parentIssueId
}if(this.initIssueType){A=A+"&issuetype="+this.initIssueType;
delete this.initIssueType
}if(this.initProjectId){A=A+"&pid="+this.initProjectId;
delete this.initProjectId
}return A
},addFieldToRetainValue:function(D,B){var A=!_.contains(this.nonRetainedFields,D);
var C=D.match(/^filetoconvert/)!==null;
if(A||C||B){this._super(D)
}},getRequiredFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.required){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getConfigurableFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id!=="project"&&E.id!=="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
},getIssueSetupFields:function(){var A=jQuery.Deferred(),B=[];
this.getFields().done(function(C){jQuery.each(C,function(D,E){if(E.id==="project"||E.id==="issuetype"){B.push(E)
}});
A.resolve(B)
});
return A.promise()
}});
JIRA.Forms.CreateIssueHelper=Class.extend({init:function(A){this.form=A
},handleSubmitSuccess:function(D){function C(E,G,F){var H='<a href="'+F+'">'+E+" - "+AJS.escapeHTML(G)+"</a>";
return AJS.format("Issue {0} has been successfully created",H)
}var A=this,B=this.form.$element.find("#summary").val();
D.summary=B;
this.form.triggerEvent("submitted",[D,this]);
this.form.triggerEvent("issueCreated",[D,this],true);
if(A.form.model.isInMultipleMode()){this.form.render().done(function(){var E=C(D.issueKey,B,contextPath+"/browse/"+D.issueKey);
JIRA.applySuccessMessageToForm(A.form.getForm(),E)
})
}else{this.form.triggerEvent("sessionComplete")
}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")
},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")
},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")
},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")
},serializeForToggle:function(C){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()
}var E=this.form.model.prevActiveFields||[];
var J=this.form.getForm().serializeArray();
var D=this.form.getActiveFieldIds();
var F=jQuery.grep(J,function(K){return jQuery.inArray(K.name,D)!==-1
});
var A=jQuery.grep(E,function(K){return jQuery.inArray(K.name,D)===-1
});
var B=jQuery.map(A,function(K){return K.name
});
var H=jQuery.merge(F,A);
var G=jQuery.merge(D,B);
this.form.model.prevActiveFields=jQuery.extend(true,[],H);
if(C){G=this.executeProjectChangedSecuritySettingAction(G)
}var I=jQuery.merge([{name:"retainValues",value:true}],H);
jQuery.each(J,function(K,L){if(L.name==="pid"||L.name==="issuetype"){I.push(L)
}});
I.push({name:"toggle",value:true});
jQuery.each(G,function(K,L){I.push({name:"fieldsToRetain",value:L})
});
return jQuery.param(I)
},executeProjectChangedSecuritySettingAction:function(A){return _.reject(A,function(B){return B==="security"
})
},prepareFieldsToRetain:function(A,B){jQuery.each(A,function(C,D){B.push({name:"fieldsToRetain",value:D})
});
return B
},setIssueType:function(){var A=this,B=this.serializeForToggle();
this.form.invalidateFieldsCache();
this.form.disable();
this.form.model.refresh(B).done(function(){A.form.render();
A.form.enable()
})
},setProjectId:function(){var A=this,B=this.serializeForToggle(true);
this.form.invalidateFieldsCache();
this.form.disable();
this.form.model.refresh(B).done(function(){A.form.render();
A.form.enable()
})
},decorate:function(){var A=this;
this.getProjectField().change(function(){JIRA.trigger("dialogBeforeContentChange",["projectId",this.value,JIRA.Dialog.current.options.id]);
A.setProjectId(this.value)
});
this.getIssueTypeField().change(function(){JIRA.trigger("dialogBeforeContentChange",["issueType",this.value,JIRA.Dialog.current.options.id]);
A.setIssueType(this.value)
});
this.getCreateAnotherCheckbox().change(function(){A.form.model.setIsMultipleMode(this.checked)
})
}});
JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(A){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:A,useLegacyDecorator:JIRA.useLegacyDecorator()}))
}});
JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(A){this._serialization={};
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.title=A.title;
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div class='qf-unconfigurable-form' />")
},handleSubmitSuccess:function(A){this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
this.getFieldsHtml().done(function(C){A.model.getIssueSetupFields().done(function(F){var E=JIRA.Templates.Issue.createIssueForm({issueSetupFields:F,fieldsHtml:C,parentIssueId:A.model.getParentIssueId(),atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),title:A.title,multipleMode:A.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),D=JIRA.extractScripts(E);
A.$element.empty().append(D.html);
A.helper.decorate();
B.resolveWith(A,[A.$element,D.scripts])
})
});
return B.promise()
}});
JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(A){this.model=A.model;
this.helper=new JIRA.Forms.CreateIssueHelper(this);
this.globalEventNamespaces=A.globalEventNamespaces||[];
this.issueId=A.issueId;
this.title=A.title;
this._serialization={};
this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";
this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")
},handleSubmitSuccess:function(A){return this.helper.handleSubmitSuccess(A)
},_render:function(){var B=jQuery.Deferred(),A=this;
A.model.getIssueSetupFields().done(function(D){var C=JIRA.Templates.Issue.createIssueForm({issueSetupFields:D,atlToken:A.model.getAtlToken(),formToken:A.model.getFormToken(),isConfigurable:true,title:A.title,parentIssueId:A.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:A.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});
A.$element.html(C);
A.helper.decorate();
A.renderFormContents().done(function(F,E){B.resolveWith(A,[A.$element,E])
})
});
return B.promise()
}});
JIRA.Forms.createCreateIssueForm=function(A){A=A||{};
return new JIRA.Forms.Container(function(){A.globalEventNamespaces=A.globalEventNamespaces||["QuickCreateIssue"];
var E="Create Issue",B=new JIRA.Forms.CreateIssueModel({projectId:A.pid,issueType:A.issueType}),D=new JIRA.Forms.ConfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces}),C=new JIRA.Forms.UnconfigurableCreateIssueForm({model:B,title:E,globalEventNamespaces:A.globalEventNamespaces});
return{globalEventNamespaces:A.globalEventNamespaces,model:B,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:D,unconfigurableForm:C}
})
};
JIRA.Forms.createSubtaskForm=(function(){var A=function A(C){return C.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()
};
var B=function B(C){C=C||{};
return new JIRA.Forms.Container(function(){C.globalEventNamespaces=C.globalEventNamespaces||["QuickCreateSubtask"];
var G=A(C),H=JIRA.Dialog.getIssueActionTitle("Create Subtask"),D=new JIRA.Forms.CreateIssueModel({parentIssueId:G,projectId:C.pid,issueType:C.issueType}),F=new JIRA.Forms.ConfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces}),E=new JIRA.Forms.UnconfigurableCreateIssueForm({model:D,title:H,globalEventNamespaces:C.globalEventNamespaces});
return{globalEventNamespaces:C.globalEventNamespaces,model:D,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:F,unconfigurableForm:E}
})
};
return B
})();
jQuery(function(){var A;
jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(E){var B=jQuery(E.target);
var D=B.is("a")?B:B.find("a");
var F=parseUri(D.attr("href")).queryKey;
var C={pid:F.pid,issueType:F.issuetype};
C=jQuery.extend(C,{pid:B.attr("data-pid"),issueType:B.attr("data-issue-type")});
JIRA.Forms.createCreateIssueForm(C).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();
E.preventDefault()
});
A=document.getElementById("stqc_show");
if(A){A.onclick=null
}jQuery(document).on("simpleClick",".issueaction-create-subtask",function(E){var B=jQuery(E.target);
var D=B.is("a")?B:B.find("a");
var C={parentIssueId:D.attr("data-issueid")};
JIRA.Forms.createSubtaskForm(C).asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")
},trigger:document.createElement("a"),id:"create-subtask-dialog"}).show();
E.preventDefault()
})
});
/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList68 = opt_data.tabs;
    var tabListLen68 = tabList68.length;
    for (var tabIndex68 = 0; tabIndex68 < tabListLen68; tabIndex68++) {
      var tabData68 = tabList68[tabIndex68];
      output.append((tabData68) ? '<li class="menu-item ' + ((tabData68.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData68.position) + '" ><strong>' + soy.$$escapeHtml(tabData68.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      if (tabData82) {
        output.append('<div class="tabs-pane ', (tabData82.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData82.position), '">');
        var fieldList92 = tabData82.fields;
        var fieldListLen92 = fieldList92.length;
        for (var fieldIndex92 = 0; fieldIndex92 < fieldListLen92; fieldIndex92++) {
          var fieldData92 = fieldList92[fieldIndex92];
          output.append((fieldData92.editHtml) ? fieldData92.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList102 = opt_data.fields;
    var fieldListLen102 = fieldList102.length;
    for (var fieldIndex102 = 0; fieldIndex102 < fieldListLen102; fieldIndex102++) {
      var fieldData102 = fieldList102[fieldIndex102];
      output.append((fieldData102.editHtml) ? fieldData102.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList126 = opt_data.issueSetupFields;
    var fieldListLen126 = fieldList126.length;
    for (var fieldIndex126 = 0; fieldIndex126 < fieldListLen126; fieldIndex126++) {
      var fieldData126 = fieldList126[fieldIndex126];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData126.id), ' qf-required">', fieldData126.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList191 = opt_data.errors;
  var errorListLen191 = errorList191.length;
  for (var errorIndex191 = 0; errorIndex191 < errorListLen191; errorIndex191++) {
    var errorData191 = errorList191[errorIndex191];
    output.append('<li>', soy.$$escapeHtml(errorData191), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/dialog-ids.js' */
define("jira/analytics/browser-metrics/dialog-checker",[],function(){allowedIdsArray=["about-dialog","add-basicuser-dialog","add-developer-dialog","add-field-configuration-dialog","add-field-configuration-scheme-dialog","add-field-dialog","add-field-screen-dialog","add-field-screen-scheme-dialog","add-incoming-mail-handler-dialog","add-issue-type-dialog","add-issue-type-field-configuration-association-dialog","add-issue-type-screen-scheme-configuration-association-dialog","add-issue-type-screen-scheme-dialog","add-new-issue-type-to-scheme-dialog","add-screen-scheme-item-dialog","add-subtask-type-dialog","add-workflow-dialog","add_workflowscheme-dialog","assign-dialog","assign-issue-types-dialog","assign-to-me-link-handler","attach-file-dialog","attach-screenshot-dialog","auditing-settings-dialog","clone-issue-dialog","comment-add-dialog","configure_wallboard_dialog","confluence-page-search-dialog","copy_classic default workflow-dialog","copy-filter-dialog","copy_jira-dialog","create-issue-dialog","create-issue-dialog.issueType","create-issue-dialog.projectId","create-request-dialog","create-service-desk-dialog","create-status-dialog","create-story-dialog","create-story-dialog.issueType","create-story-dialog.projectId","create-subtask-dialog","create-subtask-dialog.issueType","create-team-dialog","create_user-dialog","credits-dialog","delete-attachment-dialog","delete-comment-dialog","delete-dshboard","delete-filter-dialog","delete-issue-dialog","delete-issue-link-dialog","delete-log-work-dialog","delete-metric","delete-queue","delete-status-dialog","deleteuser_link-dialog","devstatus-branch-detail-dialog","devstatus-build-detail-dialog","devstatus-commit-detail-dialog","devstatus-cta-dialog","devstatus-deployment-detail-dialog","devstatus-pullrequest-detail-dialog","devstatus-review-detail-dialog","discard-draft-dialog","discard_draft_workflow-dialog","edit-attachments-dialog","edit-comment","editgroups_admin-dialog","editgroups_link-dialog","editgroups_sysadmin-dialog","edit-issue-dialog","edit-labels-dialog","edit-log-work-dialog","edit-status-dialog","edituser_link_admin-dialog","edit-workflow-dialog","gh-rapidboard-dialog","inline-issue-create-dialog","invite_user-dialog","issue-actions-dialog","issue-tab-error-dialog","jim-create-project-dialog","keyboard-shortcuts-dialog","link-issue-dialog","log-work-dialog","manage-attachment-dialog","metric-pre-save-dialog","modal-field-view","permission-helper-dialog","project-avatar-cropper","project-avatar-picker","project-config-details-project-category-dialog","project-config-project-edit-dialog","project-config-project-edit-lead-and-default-assignee-dialog","project-email-dialog","publish_draft_workflow-dialog","queue-dirty-edits","QuickCreateIssue.error","QuickCreateIssue.success","QuickCreateSubtask.error","QuickCreateSubtask.success","QuickEdit.error","QuickEdit.success","remote-jira-search-dialog","rename-filter-dialog","report-dirty-edits","save-filter-dialog","sd-add-default-value","sd-add-remove-agent-dialog","sd-remove-field-dialog","server-error-dialog","report-delete-confirm","tempo-add-hours-issue-dialog","tempo-add-internal-activity-form","tempo-core-medium-form","tempo-delete-form-dialog","tempo-grace-form","tempo-large-form","tempo-medium-form","tempo-move-form-dialog","tempo-pdf-form","tempo-small-form","tempo-split-form-dialog","tempo-user-settings-dialog","user-avatar-picker","user-defaults-edit-dialog","versionsMergeDialog","view-workflow-dialog","view-workflow-dialog-project-admin","view-workflow-dialog-workflow-schemes","wait-migrate-dialog","whereismycf-dialog","workflow-text-view"];var a={};allowedIdsArray.forEach(function(c){a[c]=true});var b=[{key:"component-delete-dialog",pattern:/^component-\d+-delete-dialog$/i},{key:"version-delete-dialog",pattern:/^version-\d+-delete-dialog$/i},{key:"workflow-transition-dialog",pattern:/^workflow-transition-\d+-dialog$/i}];return{transformDialogId:function(c){if(!c){return undefined}if(a[c]){return c}for(var d=0;d<b.length;++d){var e=b[d];if(c.match(e.pattern)){return e.key}}return undefined}}});
/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/browser-metrics.js' */
require(["jira/analytics/browser-metrics/dialog-checker","jira/util/events","jquery"],function(c,a,b){b(function(){var e={startEvent:function(g){try{window.BrowserMetrics&&BrowserMetrics.start(g)}catch(h){console.log(h)}},endEvent:function(g,i){try{window.BrowserMetrics&&BrowserMetrics.end(g,i)}catch(h){console.log(h)}}};var f={openDialogs:{},start:function(){a.bind("dialogContentReady",function(k,i){var h=c.transformDialogId(i.options.id);if(!h){return}var j=f.openDialogs[h];if(j){if(!j.initialized){e.endEvent("jira.dialog.open."+h);j.initialized=true}else{if(j.action){e.endEvent("jira.dialog.change."+h+"."+j.action);j.action=undefined}}}});a.bind("beforeShow",function(j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]===undefined){f.openDialogs[i]={initialized:false};e.startEvent("jira.dialog.open."+i)}});a.bind("Dialog.hide",function(l,j,k,h){var i=c.transformDialogId(h);if(!i){return}delete f.openDialogs[i]});a.bind("dialogBeforeContentChange",function(l,k,j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]){f.openDialogs[i].action=k;e.startEvent("jira.dialog.change."+i+"."+k)}});function g(i,j){var h=c.transformDialogId(i);if(!h){return}a.bind(i+".submitting",function(){e.startEvent("jira.dialog."+h)});a.bind(i+"."+j,function(){e.endEvent("jira.dialog."+h,"success")});a.bind(i+".validationError",function(){e.endEvent("jira.dialog."+h,"error")})}["QuickCreateIssue","QuickCreateSubtask"].forEach(function(h){g(h,"issueCreated")});g("QuickEdit","issueEdited")}};var d={start:function(){a.bind("aui-dropdown2-show-before",function(g,h){e.startEvent("jira.header.menu."+h)});a.bind("aui-dropdown2-show-after",function(g,h){e.endEvent("jira.header.menu."+h)})}};if(window.BrowserMetrics!==undefined&&AJS.BrowserMetrics===undefined){[f,d].forEach(function(g){g.start()})}})});
/* module-key = 'com.atlassian.jconnect.jconnect-plugin:common', location = 'js/ViewLocation.js' */
(function(G){var C=window,H="onJMCGMapsLoad";
mapsCallbacks=[],googleLoaderRequested=false,googleMapsRequested=false;
function I(){var M;
while(M=mapsCallbacks.shift()){M()
}}function E(N){var M=C.google.maps&&C.google.maps.LatLng;
if(M){mapsCallbacks.push(N);
I()
}else{if(googleMapsRequested){mapsCallbacks.push(N)
}else{googleMapsRequested=true;
mapsCallbacks.push(N);
google.load("maps","3",{other_params:"sensor=false",callback:I})
}}}function F(N){if(C.google&&C.google.load){E(N)
}else{if(googleLoaderRequested){mapsCallbacks.push(N)
}else{googleLoaderRequested=true;
C[H]=function(){E(N)
};
var M=document.createElement("script");
M.src="https://www.google.com/jsapi?callback="+H;
M.type="text/javascript";
G("body").append(M)
}}}function D(M){if(M.hasClass("open")){K(M)
}else{L(M)
}}function K(M){M.removeClass("open");
B=false
}function L(N){var M=N.find(".jConnectMap");
N.addClass("open");
B=true;
if(!A){A=new google.maps.Map(M.get(0),{zoom:8,center:J[1].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP});
new google.maps.Marker({map:A,position:J[1].geometry.location,title:J[1].formatted_address})
}}var J,A,B=false;
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(S,O,R){if(R=="panelRefreshed"||R=="pageLoad"){var P=G(".jConnectLocation.ready",O),N=P.find("> a"),M,Q;
if(N.length){F(function(){if(P.hasClass("ready")){M=new google.maps.LatLng(N.data("lat"),N.data("long"));
Q=new google.maps.Geocoder();
Q.geocode({latLng:M},function(U,T){if(T==google.maps.GeocoderStatus.OK){J=U;
if(U[1]){N.text(U[1].formatted_address)
}}});
P.removeClass("ready");
A=null;
if(B){L(P)
}N.click(function(T){T.preventDefault();
T.stopPropagation();
D(P)
})
}})
}}})
})(AJS.$);
/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/store_js/store.js' */
(function(){var c=function(g,h){return Object.prototype.hasOwnProperty.call(g,h)};var b=function(g){var i=0;for(var h in g){if(c(g,h)){i++}}return i};var d=function(l,j,k){var h=l.length>>>0;for(var g=(k<0)?Math.max(0,h+k):k||0;g<h;g++){if(l[g]===j){return g}}return -1};var f=function(i,g,h){return d(i,g,h)!==-1};var a=function(h,g){if(!f(h,g)){h.push(g)}return h};var e=this.Store=function(g,i,h){this.name=g;this.defaults=i||{};this.watcherSpeed=h||500;this.listeners={};this.applyDefaults()};e.clear=function(){localStorage.clear()};e.prototype.applyDefaults=function(){for(var g in this.defaults){if(c(this.defaults,g)&&this.get(g)===undefined){this.set(g,this.defaults[g])}}return this};e.prototype.watcher=function(i){if(this.watcherTimer){clearTimeout(this.watcherTimer)}if(b(this.listeners)||i){this.newObject=this.toObject();if(this.oldObject){for(var g in this.newObject){if(c(this.newObject,g)&&this.newObject[g]!==this.oldObject[g]){this.fireEvent(g,this.newObject[g])}}for(var g in this.oldObject){if(c(this.oldObject,g)&&!c(this.newObject,g)){this.fireEvent(g,this.newObject[g])}}}this.oldObject=this.newObject;var h=this;this.watcherTimer=setTimeout(function(){h.watcher()},this.watcherSpeed)}return this};e.prototype.get=function(g){var h=localStorage.getItem("store."+this.name+"."+g);if(h===null){return undefined}try{return JSON.parse(h)}catch(i){return null}};e.prototype.set=function(g,h){if(h===undefined){this.remove(g)}else{if(typeof h==="function"){h=null}try{h=JSON.stringify(h)}catch(i){h=null}localStorage.setItem("store."+this.name+"."+g,h)}return this};e.prototype.remove=function(g){localStorage.removeItem("store."+this.name+"."+g);return this.applyDefaults()};e.prototype.reset=function(){var g="store."+this.name+".";for(var h=(localStorage.length-1);h>=0;h--){if(localStorage.key(h).substring(0,g.length)===g){localStorage.removeItem(localStorage.key(h))}}return this.applyDefaults()};e.prototype.toObject=function(){var g={};var h="store."+this.name+".";for(var k=(localStorage.length-1);k>=0;k--){if(localStorage.key(k).substring(0,h.length)===h){var j=localStorage.key(k).substring(h.length);var l=this.get(j);if(l!==undefined){g[j]=l}}}return g};e.prototype.fromObject=function(g,i){if(!i){this.reset()}for(var h in g){if(c(g,h)){this.set(h,g[h])}}return this};e.prototype.addEvent=function(g,h){this.watcher(true);if(!this.listeners[g]){this.listeners[g]=[]}a(this.listeners[g],h);return this};e.prototype.removeEvent=function(g,j){for(var h=(this.listeners[g].length-1);h>=0;h--){if(this.listeners[g][h]===j){this.listeners[g].splice(h,1)}}if(!this.listeners[g].length){delete this.listeners[g]}return this};e.prototype.fireEvent=function(k,n){var m=[k,"*"];for(var l=0;l<m.length;l++){var g=m[l];if(this.listeners[g]){for(var h=0;h<this.listeners[g].length;h++){this.listeners[g][h](n,k,this.name)}}}return this}}());
/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/pasConfig.js' */
var Atlassian=Atlassian||{};Atlassian.PAS={timeUpdateInterval:60000,pollingInterval:15*60*1000,url:AJS.contextPath()+"/rest/pas/latest/announcement",store:new Store("Atlassian.PAS.Announcements."+document.location.hostname+AJS.contextPath()+"."+AJS.$("meta[name='ajs-remote-user']").attr("content")),nextAnnouncementKey:"nextAnnouncement",timeStampKey:"timeStamp",config:{url:AJS.contextPath()+"/rest/pas/latest/settings",timeStampKey:"configTimeStampKey",pollingInterval:30*60*1000,currentConfigKey:"currentConfigKey"},cookieKey:AJS.contextPath().replace("/","")+"_pas.dismiss",ace:{aceCookieKey:AJS.contextPath().replace("/","")+"_ace.dismiss",acePath:"/j/",aceHost:"ace.atlassian.com",nextAnnouncementKey:"aceNextAnnouncement",timeStampKey:"aceTimeStamp"}};
/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/pas.js' */
(function(){function a(){AJS.$.ajaxSetup({cache:false});var k=null;var o=null;var c=null;var f=0;var t=[".atlassian.net",".jira.com",".jira-dev.com"];var x=function(){Atlassian.PAS.announcement=AJS.$("<div id='pas-announcement'/>");Atlassian.PAS.announcementText=AJS.$("<span/>").appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcementUrl=AJS.$("<a id='more-info' target='_blank'>(more info)</a>").appendTo(Atlassian.PAS.announcement);AJS.$("<button id='dismiss-announcement' class='pas-announcement-right'>&#x2716;</button>").click(j).appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcementTime=AJS.$("<span class='pas-announcement-right'/>").appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcement.hide();AJS.$("#header").before(Atlassian.PAS.announcement)};var q=function(E){var H=function(M,N,L){M=""+M;while(M.length<L){M=N+M}return M};var G=function(N,M){var L=N+" "+M;if(N!=1){L+="s"}return L};var K=60000;var I=3600000;var F=86400000;if(E<K){return"in less than a minute"}else{if(E<I){return"in "+G(Math.round(E/K),"min")}else{if(E<F){return"in "+G(Math.round(E/I),"hour")+" "+G(Math.round((E%I)/K),"minute")}else{var J=new Date();J.setSeconds(J.getSeconds()+Math.round(E/1000));return(H(J.getFullYear(),"0",4)+"/"+H(J.getMonth()+1,"0",2)+"/"+H(J.getDate(),"0",2)+" "+H(J.getHours(),"0",2)+":"+H(J.getMinutes(),"0",2))}}}};var d=function(){if(AJS.$(window).scrollTop()>0){Atlassian.PAS.announcement.addClass("pas-persistent-header")}else{Atlassian.PAS.announcement.removeClass("pas-persistent-header");AJS.trigger("confluence.header-resized")}};var s=function(){if(k!=null){clearTimeout(k)}if(o!=null){clearTimeout(o)}if(c!=null){clearInterval(c)}Atlassian.PAS.announcement.hide();AJS.$(window).unbind("scroll",d)};var z=function(F){d();var E=function(){Atlassian.PAS.announcement.show();AJS.trigger("confluence.header-resized")};if(F==true){Atlassian.PAS.announcement.slideDown("fast",function(){E()})}else{E()}};var j=function(){Atlassian.PAS.announcement.slideUp("fast",function(){Atlassian.PAS.announcement.hide();AJS.trigger("confluence.header-resized")});var F=Atlassian.PAS.announcement.attr("announcementId");var E=new Date();if(F=="ace"){E.setDate(E.getDate()+7);var G=F+"; expires="+E.toUTCString();document.cookie=Atlassian.PAS.ace.aceCookieKey+"="+G+"; path=/";AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.dismiss-ace-announcement.click",data:{message:AJS.$("#pas-announcement span:first").text()}})}else{E.setDate(E.getDate()+1);var G=F+"; "+E.toUTCString();document.cookie=Atlassian.PAS.cookieKey+"="+G+"; path=/";AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.dismiss-announcement.click",data:{message:AJS.$("#pas-announcement span:first").text()}})}};var g=function(J,K){var H=document.cookie.split(";");for(var G=0;G<H.length;G++){var F=H[G];var L=F.indexOf("=");var E=AJS.$.trim(F.substr(0,L));var I=AJS.$.trim(F.substr(L+1));if(E==K){return I==J}}return false};var i=function(){if(f>0){var E=f-Atlassian.PAS.timeUpdateInterval;f=E;Atlassian.PAS.announcementTime.text(q(E))}else{clearInterval(c);c=null}};function l(){var L=m(Atlassian.PAS.config.currentConfigKey);if(L.aceEnabled){var F=(location.protocol=="https:"?"https://"+Atlassian.PAS.ace.aceHost+Atlassian.PAS.ace.acePath:"http://"+Atlassian.PAS.ace.aceHost+Atlassian.PAS.ace.acePath);var I=Math.floor(Math.random()*99999999999);if(!document.MAX_used){document.MAX_used=","}var E=(document.MAX_used!=","?"&exclude="+document.MAX_used:"");var K=(document.charset?"&charset="+document.charset:(document.characterSet?"&charset="+document.characterSet:""));var H=(document.URL?"&referer="+escape(document.URL):"");var G=(document.context?"&context="+escape(document.context):"");var J=F+"?zoneid="+L.zoneId+"&cb="+I+E+K+"&loc="+escape(window.location)+H+G;AJS.log("Polling ACE...");AJS.$.ajax({url:J,dataType:"jsonp",contentType:"application/json",success:function(M){y(Atlassian.PAS.ace.timeStampKey,D());y(Atlassian.PAS.ace.nextAnnouncementKey,M);e()},error:function(O,M,N){AJS.log("Could not get banner from ace: "+N)}})}else{AJS.log("Polling to ACE is disabled.")}}var e=function(){var F=AJS.Meta.get("remote-user");var E=m(Atlassian.PAS.ace.nextAnnouncementKey);if(E&&E.html!=null&&E.html!=""&&F!=null&&F!=""){Atlassian.PAS.announcementText.html(E.html);Atlassian.PAS.announcementUrl.hide();Atlassian.PAS.announcement.attr("announcementId","ace");z(true)}};var p=function(){var F=location.hostname;var E;for(E=0;E<t.length;++E){if(A(F,t[E])){return true}}return false};var A=function(F,E){var G=F.length-E.length;return G>=0&&F.lastIndexOf(E)===G};var w=function(){var F=function(){return G.timeToStart-r()};var G=m(Atlassian.PAS.nextAnnouncementKey);if(G==null||G.message==null||g(G.id,Atlassian.PAS.cookieKey)){if(p()){if(!g("ace",Atlassian.PAS.ace.aceCookieKey)){if(B()){l()}else{e()}}}return}f=G.timeLeft;AJS.$(window).bind("scroll",d);Atlassian.PAS.announcementText.html(G.message);Atlassian.PAS.announcementTime.text(q(f));c=setInterval(i,Atlassian.PAS.timeUpdateInterval);if(G.url){Atlassian.PAS.announcementUrl.attr("href",G.url);Atlassian.PAS.announcementUrl.show()}else{Atlassian.PAS.announcementUrl.hide()}var H=Atlassian.PAS.announcement.attr("announcementId");var I=(H&&H!=G.id);Atlassian.PAS.announcement.attr("announcementId",G.id);var E=G.duration;G.timeToStart=F();if(G.timeToStart>0){E+=G.timeToStart;k=setTimeout(function(){z(I)},G.timeToStart)}else{z(I)}if(E>0){o=setTimeout(function(){s()},E)}};function v(){AJS.$.ajax({type:"GET",contentType:"application/json",url:Atlassian.PAS.url,cache:false,global:false,timeout:5000,async:false,success:function(E,F){y(Atlassian.PAS.timeStampKey,D());y(Atlassian.PAS.nextAnnouncementKey,E)},error:function(G,E,F){AJS.log("Could not get announcement from server: "+F)}})}function b(){AJS.$.ajax({type:"GET",contentType:"application/json",url:Atlassian.PAS.config.url,cache:false,global:false,timeout:5000,async:false,success:function(E,F){y(Atlassian.PAS.config.timeStampKey,D());y(Atlassian.PAS.config.currentConfigKey,E)},error:function(G,E,F){AJS.log("Could not get configuration from server: "+F)}})}var D=function(){return new Date().getTime()};var r=function(){return(D()-m(Atlassian.PAS.timeStampKey))};function m(E){return Atlassian.PAS.store.get(E)}function y(E,F){return Atlassian.PAS.store.set(E,F)}function u(G,H){var F=m(G);var E=D()-F;return F==undefined||E>H}function n(){return u(Atlassian.PAS.timeStampKey,Atlassian.PAS.pollingInterval)}function C(){return u(Atlassian.PAS.config.timeStampKey,Atlassian.PAS.config.pollingInterval)}function B(){return true}function h(){AJS.$("#more-info").live("click",function(E){AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.more-info.click",data:{message:AJS.$("#pas-announcement span:first").text()}})})}h();x();if(C()){b()}if(n()){v()}w()}AJS.toInit(a)})();
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-amd', location = '/js/iframe/host/_ap.js' */
window._AP=window._AP||{};
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-amd', location = '/js/iframe/_amd.js' */
(function(f){var e=f._AP?_AP:(f.RA=f.AP={});
var d={};
e.define=function(i,k,h){var j=c(i),g;
if(!h){h=k;
k=[]
}if(h){g=typeof h!=="function"?function(){return h
}:h;
b(k,function(){var m=g.apply(f,arguments);
if(m){if(typeof m==="function"){j.exports.__target__=m
}for(var l in m){if(m.hasOwnProperty(l)){j.exports[l]=m[l]
}}}})
}};
e.require=function(g,h){b(typeof g==="string"?[g]:g,h)
};
function b(l,m){var j=[],h=0,g=l.length;
function k(p){j.push(p);
if(j.length===g){var n=[],o=0;
for(;
o<g;
o+=1){n[o]=j[o].exports
}if(m){m.apply(f,n)
}}}if(l&&l.length>0){for(;
h<g;
h+=1){a(l[h],k)
}}else{if(m){m()
}}}function a(g,h){h(c(g))
}function c(g){return d[g]=d[g]||{name:g,exports:function(){function h(){var i=h.__target__;
if(i){return i.apply(f,arguments)
}}return h
}()}
}}(this));
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-amd', location = '/js/iframe/host/_dollar.js' */
_AP.define("_dollar",function(){return AJS.$
});
/* module-key = 'com.atlassian.auiplugin:aui-focus-manager', location = 'js/focus-manager.js' */
AJS.FocusManager=(function(G){(function B(){function J(L){return !G(L).parents().andSelf().filter(function(){return G.css(this,"visibility")==="hidden"||G.expr.filters.hidden(this)}).length}function I(P,Q){var S=P.nodeName.toLowerCase();if(S==="area"){var M=P.parentNode;var R=M.name;var T=G("img[usemap=#"+R+"]").get();if(!P.href||!R||M.nodeName.toLowerCase()!=="map"){return false}return T&&J(T)}var O=/input|select|textarea|button|object/.test(S);var L=S==="a";var N=(P.href||Q);return(O?!P.disabled:(L?N:Q))&&J(P)}function K(N){var L=G.attr(N,"tabindex"),M=isNaN(L);var O=(M||L>=0);return O&&I(N,!M)}G.extend(G.expr[":"],{"aui-focusable":function(L){return I(L,!isNaN(G.attr(L,"tabindex")))},"aui-tabbable":K})}());var D="_aui-focus-restore";function C(){this._focusTrapStack=[];G(document).on("focusout",{focusTrapStack:this._focusTrapStack},F)}C.defaultFocusSelector=":aui-tabbable";C.prototype.enter=function(I){I.data(D,G(document.activeElement));if(I.attr("data-aui-focus")!=="false"){var J=I.attr("data-aui-focus-selector")||C.defaultFocusSelector;var K=I.is(J)?I:I.find(J);K.first().focus()}if(H(I)){E(I,this._focusTrapStack)}};function E(I,J){J.push(I)}function A(I){I.pop()}function H(I){return I.is(".aui-dialog2")}C.prototype.exit=function(I){if(H(I)){A(this._focusTrapStack)}var J=document.activeElement;if(I[0]===J||I.has(J).length){G(J).blur()}var K=I.data(D);if(K&&K.length){I.removeData(D);K.focus()}};function F(K){var O=K.data.focusTrapStack;if(!K.relatedTarget){return }if(O.length===0){return }var R=O[O.length-1];var I=K.target;var N=K.relatedTarget;var M=R.find(":aui-tabbable");var L=AJS.$(M.first());var J=AJS.$(M.last());var Q=R.has(N).length===0;var P=Q&&N;if(P){if(L.is(I)){J.focus()}else{if(J.is(I)){L.focus()}}}}C.global=new C();return C}(AJS.$));
/* module-key = 'com.atlassian.auiplugin:aui-layer-manager', location = 'js/layer-manager.js' */
(function(E){function D(G,I){var H=G.length;while(H--){if(I(G[H])){return H}}return -1}function B(G,H){return D(G,function(I){return I[0]===H[0]})}function C(G){return D(G,function(H){return AJS.layer(H).isBlanketed()})}function A(H){var G;if(H.length){var I=H[H.length-1];var J=parseInt(I.css("z-index"),10);G=(isNaN(J)?0:J)+100}else{G=0}return Math.max(3000,G)}function F(){this._stack=[]}F.prototype.push=function(H){if(B(this._stack,H)>=0){throw new Error("The given element is already an active layer")}var G=AJS.layer(H);var I=A(this._stack);G._showLayer(I);if(G.isBlanketed()){if(C(this._stack)>=0){AJS.undim()}AJS.dim(false,I-20)}this._stack.push(H)};F.prototype.popUntil=function(J){var H=B(this._stack,J);if(H<0){return null}var L=this._stack.slice(H);this._stack=this._stack.slice(0,H);var K=C(L);if(K>=0){AJS.undim();var I=C(this._stack);if(I>=0){AJS.dim(false,this._stack[I].css("z-index")-20)}}var G;while(L.length){G=L.pop();AJS.layer(G)._hideLayer()}return G};F.prototype.getTopLayer=function(){if(!this._stack.length){return null}var G=this._stack[this._stack.length-1];return G};F.prototype.popTopIfNonModal=function(){var G=this.getTopLayer();if(!G||AJS.layer(G).isModal()){return null}return this.popUntil(G)};F.prototype.popUntilTopBlanketed=function(){var H=C(this._stack);if(H<0){return null}var G=this._stack[H];if(AJS.layer(G).isModal()){return null}return this.popUntil(G)};AJS.LayerManager=F}(AJS.$));
/* module-key = 'com.atlassian.auiplugin:aui-layer-manager', location = 'js/layer-manager-global.js' */
(function(A){AJS.LayerManager.global=new AJS.LayerManager();A(document).on("keydown",function(C){if(C.keyCode===AJS.keyCode.ESCAPE){var B=AJS.LayerManager.global.popTopIfNonModal();if(B){C.preventDefault()}}}).on("click",".aui-blanket",function(C){var B=AJS.LayerManager.global.popUntilTopBlanketed();if(B){C.preventDefault()}})}(AJS.$));
/* module-key = 'com.atlassian.auiplugin:layer', location = 'js/layer.js' */
(function(E,C,B){var A="_aui-internal-layer-";var D="_aui-internal-layer-global-";function F(G){this.$el=E(G||'<div class="aui-layer" aria-hidden="true"></div>')}F.prototype.changeSize=function(H,G){this.$el.css("width",H);this.$el.css("height",G==="content"?"":G);return this};F.prototype.on=function(H,G){this.$el.on(A+H,G);return this};F.prototype.off=function(H,G){this.$el.off(A+H,G);return this};F.prototype.show=function(){if(this.$el.is(":visible")){return this}var H=AJS.$.Event(A+"beforeShow");this.$el.trigger(H);var G=AJS.$.Event(D+"beforeShow");E(document).trigger(G,[this.$el]);if(!H.isDefaultPrevented()&&!G.isDefaultPrevented()){AJS.LayerManager.global.push(this.$el);this.$el.attr("data-aui-alignment")&&this.$el[0]._tether.enable()}return this};F.prototype.hide=function(){if(!this.$el.is(":visible")){return this}var H=AJS.$.Event(A+"beforeHide");this.$el.trigger(H);var G=AJS.$.Event(D+"beforeHide");E(document).trigger(G,[this.$el]);if(!H.isDefaultPrevented()&&!G.isDefaultPrevented()){AJS.LayerManager.global.popUntil(this.$el)}return this};F.prototype.isVisible=function(){return this.$el.attr("aria-hidden")==="false"};F.prototype.remove=function(){this.hide();this.$el[0]._tether&&this.$el[0]._tether.destroy();this.$el.remove();this.$el=null};F.prototype._showLayer=function(G){if(!this.$el.parent().is("body")){this.$el.appendTo(document.body)}this.$el.data("_aui-layer-cached-z-index",this.$el.css("z-index"));this.$el.css("z-index",G);this.$el.attr("aria-hidden","false");AJS.FocusManager.global.enter(this.$el);this.$el.trigger(A+"show");E(document).trigger(D+"show",[this.$el])};F.prototype._hideLayer=function(){AJS.FocusManager.global.exit(this.$el);this.$el.attr("aria-hidden","true");this.$el.css("z-index",this.$el.data("_aui-layer-cached-z-index")||"");this.$el.data("_aui-layer-cached-z-index","");this.$el.trigger(A+"hide");E(document).trigger(D+"hide",[this.$el])};F.prototype.isBlanketed=function(){return this.$el.attr("data-aui-blanketed")==="true"};F.prototype.isModal=function(){return this.$el.attr("data-aui-modal")==="true"};AJS.layer=AJS._internal.widget("layer",F);AJS.layer.on=function(G,H){E(document).on(D+G,H);return this};AJS.layer.off=function(G,H){E(document).off(D+G,H);return this}}(AJS.$));
/* module-key = 'com.atlassian.auiplugin:internal-aui-browser', location = 'js/internal/browser.js' */
AJS._internal||(AJS._internal={});(function(A){AJS._internal.browser={};var B=null;AJS._internal.browser.supportsCalc=function(){if(B===null){var C=A('<div style="height: 10px; height: -webkit-calc(20px + 0); height: calc(20px);"></div>');B=(20===C.appendTo(document.documentElement).height());C.remove()}return B}}(AJS.$));
/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'js/dialog2.js' */
(function(G){var H={"aui-focus":"false","aui-blanketed":"true"};function F(I){jQuery.each(H,function(J,K){var L="data-"+J;if(!I[0].hasAttribute(L)){I.attr(L,K)}})}function D(I){if(I){this.$el=G(I)}else{this.$el=G(AJS.parseHtml(G(aui.dialog.dialog2({}))))}F(this.$el)}D.prototype.on=function(J,I){AJS.layer(this.$el).on(J,I);return this};D.prototype.off=function(J,I){AJS.layer(this.$el).off(J,I);return this};D.prototype.show=function(){var I=AJS.layer(this.$el);I.show();return this};D.prototype.hide=function(){AJS.layer(this.$el).hide();return this};D.prototype.remove=function(){AJS.layer(this.$el).remove();return this};AJS.dialog2=AJS._internal.widget("dialog2",D);var B="_aui-internal-dialog2-global-";function C(I){AJS.layer.on(I,function(L,J){if(J.is(".aui-dialog2")){var K=AJS.$.Event(B+I);G(document).trigger(K,[J]);return !K.isDefaultPrevented()}else{return true}})}var A=["show","hide","beforeShow","beforeHide"];for(var E=0;E<A.length;++E){C(A[E])}AJS.dialog2.on=function(I,J){G(document).on(B+I,J);return this};AJS.dialog2.off=function(I,J){G(document).off(B+I,J);return this};G(document).on("click",".aui-dialog2-header-close",function(I){I.preventDefault();AJS.dialog2(G(this).closest(".aui-dialog2")).hide()});AJS.dialog2.on("show",function(L,K){var J=[".aui-dialog2-content",".aui-dialog2-footer",".aui-dialog2-header"];var I;J.some(function(M){I=K.find(M+" :aui-tabbable");return I.length});I&&I.first().focus()});AJS.dialog2.on("hide",function(K,J){var I=AJS.layer(J);if(J.data("aui-remove-on-hide")){I.remove()}})})(AJS.$);
/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'soy/dialog2.soy' */
// This file was automatically generated from dialog2.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dialog == 'undefined') { aui.dialog = {}; }


aui.dialog.dialog2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param12 = new soy.StringBuilder();
  aui.dialog.dialog2Content(opt_data, param12);
  aui.dialog.dialog2Chrome({id: opt_data.id, titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, modal: opt_data.modal, tagName: opt_data.tagName, removeOnHide: opt_data.removeOnHide, visible: opt_data.visible, size: opt_data.size, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param12.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Chrome = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.titleId) ? ' aria-labelledby="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '', ' role="dialog" class=" aui-layer aui-dialog2 aui-dialog2-', soy.$$escapeHtml(opt_data.size ? opt_data.size : 'medium'));
  aui.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.modal) ? 'data-aui-modal="true"' : '', (opt_data.removeOnHide) ? 'data-aui-remove-on-hide="true"' : '', (opt_data.visible != true) ? 'aria-hidden="true"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dialog.dialog2Header({titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, actionContent: opt_data.headerActionContent, secondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal}, output);
  aui.dialog.dialog2Panel(opt_data, output);
  aui.dialog.dialog2Footer({hintText: opt_data.footerHintText, hintContent: opt_data.footerHintContent, actionContent: opt_data.footerActionContent}, output);
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<header', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-header');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><h2 ', (opt_data.titleId) ? ' id="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '', ' class="aui-dialog2-header-main">', (opt_data.titleText) ? soy.$$escapeHtml(opt_data.titleText) : '', (opt_data.titleContent) ? opt_data.titleContent : '', '</h2>', (opt_data.actionContent) ? '<div class="aui-dialog2-header-actions">' + opt_data.actionContent + '</div>' : '', (opt_data.secondaryContent) ? '<div class="aui-dialog2-header-secondary">' + opt_data.secondaryContent + '</div>' : '', (opt_data.modal != true) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml("Close") + '</span></a>' : '', '</header>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Footer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<footer', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-footer');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.actionContent) ? '<div class="aui-dialog2-footer-actions">' + opt_data.actionContent + '</div>' : '', (opt_data.hintText || opt_data.hintContent) ? '<div class="aui-dialog2-footer-hint">' + ((opt_data.hintText) ? soy.$$escapeHtml(opt_data.hintText) : '') + ((opt_data.hintContent) ? opt_data.hintContent : '') + '</div>' : '', '</footer>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Panel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-content');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:dialog', location = 'js/dialog/button.js' */
_AP.define("dialog/button",["_dollar"],function(b){function a(c){this.$el=b("<button />").text(c.text).addClass("aui-button aui-button-"+c.type).addClass(c.additionalClasses);
this.isEnabled=function(){return !(this.$el.attr("aria-disabled")==="true")
};
this.setEnabled=function(d){if(c.noDisable===true){return false
}this.$el.attr("aria-disabled",!d);
return true
};
this.setEnabled(true);
this.click=function(d){if(d){this.$el.bind("ra.dialog.click",d)
}else{this.dispatch(true)
}};
this.dispatch=function(d){var e=d?"done":"fail";
c.actions&&c.actions[e]&&c.actions[e]()
};
this.setText=function(d){if(d){this.$el.text(d)
}}
}return{submit:function(c){return new a({type:"primary",text:"Submit",additionalClasses:"ap-dialog-submit",actions:c})
},cancel:function(c){return new a({type:"link",text:"Cancel",noDisable:true,additionalClasses:"ap-dialog-cancel",actions:c})
}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:dialog', location = 'js/dialog/main.js' */
_AP.define("dialog/main",["_dollar","_uri","host/_status_helper","dialog/button"],function(g,d,b,a){var l=g(window);
var m=0;
var h;
var j;
var o;
var k={submit:a.submit({done:e}),cancel:a.cancel({done:e})};
function c(q,p){var r=g(aui.dialog.dialog2Chrome({id:q.id,titleId:q.titleId,size:q.size,extraClasses:["ap-aui-dialog2","ap-aui-dialog2-chromeless"],removeOnHide:true}));
r.append(p);
return r
}function n(q,p){var r=g(aui.dialog.dialog2({id:q.id,titleText:q.header,titleId:q.titleId,size:q.size,extraClasses:["ap-aui-dialog2"],removeOnHide:true,footerActionContent:true}));
k.submit.setText(q.submitText);
k.cancel.setText(q.cancelText);
r.find(".aui-dialog2-footer-actions").empty().append(k.submit.$el,k.cancel.$el);
r.find(".aui-dialog2-content").append(p);
p.data("ra.dialog.buttons",k);
function s(t){if(t.isEnabled()){t.$el.trigger("ra.dialog.click",t.dispatch)
}}g.each(k,function(u,t){t.$el.click(function(){s(t)
})
});
return r
}function f(q,p){q.append('<div id="embedded-'+p.ns+'" class="ap-dialog-container ap-content" />')
}function i(r,p){if(typeof r==="string"){var q=r.indexOf("%")===r.length-1;
r=parseInt(r,10);
if(q){r=r/100*p
}}return r
}function e(){if(h){h.trigger("ra.iframe.destroy").removeData("ra.dialog.buttons").unbind();
h=null
}j.hide()
}return{id:o,getButton:function(p){var q=h.data("ra.dialog.buttons");
return(p)?q[p]:q
},create:function(s,r){var q={width:"50%",height:"50%"},p=s.id||"ap-dialog-"+(m+=1),u=g.extend({id:p},q,s,{dlg:1}),t;
u.w=i(u.width,l.width());
u.h=i(u.height,l.height());
h=g("<div />").addClass("ap-servlet-placeholder ap-container").attr("id","ap-"+s.ns).bind("ra.dialog.close",e);
if(s.chrome){t=n(u,h)
}else{t=c(u,h)
}if(s.size){u.w="100%";
u.h="100%"
}else{AJS.layer(t).changeSize(u.w,u.h)
}j=AJS.dialog2(t);
j.on("hide",e);
f(h,u);
if(r!==false){h.append(b.createStatusMessages())
}if(s.src){_AP.create(u)
}j.show()
},close:e}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:dialog', location = 'js/dialog/dialog-factory.js' */
_AP.define("dialog/dialog-factory",["_dollar","dialog/main","host/content"],function(c,a,b){return function(e,g,h){var j,d,f={key:e.moduleKey},i=c.extend({dlg:1},e.uiParams);
a.create({id:e.id,ns:e.moduleKey||e.key,chrome:g.chrome||e.chrome,header:g.header,width:g.width,height:g.height,size:g.size,submitText:g.submitText,cancelText:g.cancelText},false);
d=c(".ap-dialog-container");
if(e.url){j=b.getIframeHtmlForUrl(e.key,e.url,h,i)
}else{j=b.getIframeHtmlForKey(e.key,h,f,i)
}j.done(function(k){var l=c(k);
l.addClass("ap-dialog-container");
d.replaceWith(l)
}).fail(function(o,k,l){var n=c("<p class='title' />").text("Unable to load add-on content. Please try again later.");
d.html("<div class='aui-message error ap-aui-message'></div>");
d.find(".error").append(n);
var m=k+(l?": "+l.toString():"");
d.find(".error").text(m);
AJS.log(m)
});
return a
}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:dialog', location = 'js/dialog/binder.js' */
_AP.require(["dialog/main","host/content","_uri","dialog/dialog-factory"],function(a,d,c,b){AJS.toInit(function(g){var f="click",e=".ap-dialog",h=function(k,l){var j=d.getOptionsForWebItem(l.bindTo);
var m=k.match(/\/servlet\/atlassian\-connect\/([\w-]+)\/([\w-]+)/);
if(m){var n={key:m[1],moduleKey:m[2],chrome:true};
b(n,l);
return
}g.extend(l,j);
l.src=k;
var i=new c.init(k);
if(!l.ns){l.ns=i.getQueryParamValue("xdm_c").replace("channel-","")
}if(!l.container){l.container=l.ns
}if(l.chrome===undefined||l.chrome===""){l.chrome=true
}a.create(l)
};
d.eventHandler(f,e,h)
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:remote-condition', location = 'js/condition/remote.js' */
_AP.define("condition/remote",["_dollar"],function(c){var b;
function a(){if(!b){b=true;
c(".remote-condition, #issue-tabs a[id$='-remote-condition'], .tabs a[id$='-remote-condition-panel']").each(function(d,f){var g=c(f),e=g.parent();
g.addClass("hidden");
if(e[0].tagName=="LI"){e.addClass("hidden")
}})
}}AJS.toInit(a);
return{hide:a}
});
if(!_AP.RemoteConditions){_AP.require(["condition/remote"],function(a){_AP.RemoteConditions=a
})
};
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/_util.js' */
_AP.define("host/_util",function(){return{escapeSelector:function(a){if(!a){throw new Error("No selector to escape")
}return a.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")
}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/_rpc.js' */
_AP.define("_rpc",["_dollar","_xdm"],function(b,c){var i=b.each,h=b.extend,d=b.isFunction,j=[],e={},a=[],f={},g=[];
return{extend:function(k){if(d(k)){k=k()
}h(e,k.apis);
h(f,k.internals);
a=a.concat(k.stubs||[]);
var l=k.init;
if(d(l)){g.push(l)
}return k.apis
},init:function(l,k){l=l||{};
i(e,function(n){a.push(n)
});
var m=new c(b,k,{remote:a,local:b.extend({},f)});
j[m.id]=m;
i(g,function(n,p){try{p(h({},l),m)
}catch(o){console.log(o)
}})
}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/env.js' */
_AP.define("env",["_dollar","_rpc"],function(a,b){var c;
b.extend(function(d){return{init:function(e){c=e
},internals:{getLocation:function(){return window.location.href
},getUser:function(){var e=AJS.Meta,f=e?e.get("remote-user-fullname"):null;
if(!f){f=a("a#header-details-user-fullname, .user.ajs-menu-title, a#user").text()
}if(!f){f=a("a#user-menu-link").attr("title")
}return{fullName:f,id:c.uid,key:c.ukey}
},getTimeZone:function(){return c.data.timeZone
}}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/resize.js' */
_AP.define("resize",["_dollar","_rpc"],function(a,b){b.extend(function(){function c(e){var d=a(document).height()-a("#header > nav").outerHeight()-a("#footer").outerHeight()-20;
a(e).css({width:"100%",height:d+"px"})
}return{init:function(e,f){f.resize=_.debounce(function d(i,h,g){i(this.iframe).css({width:h,height:g})
})
},internals:{resize:function(e,d){if(!this.uiParams.isDialog){this.resize(a,e,d)
}},sizeToParent:_.debounce(function(){if(this.uiParams.isGeneral){a(this.iframe).addClass("full-size-general-page");
a(window).on("resize",function(){resizeHander(this.iframe)
});
c(this.iframe)
}else{a(this.iframe).addClass("full-size-general-page-fail")
}})}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/loading-indicator.js' */
_AP.define("loading-indicator",["_dollar","_rpc","host/_status_helper"],function(b,c,a){c.extend(function(d){return{init:function(g,f){var e=b(f.iframe).closest(".ap-container");
a.showLoadingStatus(e,0);
f.timeout=setTimeout(function(){f.timeout=null;
a.showloadTimeoutStatus(e);
var h=e.find(".ap-load-timeout");
h.find("a.ap-btn-cancel").click(function(){a.showLoadErrorStatus(e);
this.analytics.iframePerformance.timeout()
})
},20000)
},internals:{init:function(){this.analytics.iframePerformance.end();
var e=b(this.iframe).closest(".ap-container");
a.showLoadedStatus(e);
clearTimeout(this.timeout);
e.find(".ap-content").addClass("iframe-init")
}}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/request.js' */
_AP.define("request",["_dollar","_rpc"],function(b,d){var c=["status","statusText","responseText"],a=["Content-Type"];
d.extend(function(){return{internals:{request:function(j,l,i){var h=AJS.contextPath()+j.url;
function e(n){var m={headers:{}};
b.each(c,function(p,o){m[o]=n[o]
});
b.each(a,function(p,o){m.headers[o]=n.getResponseHeader(o)
});
return m
}function g(m,o,n){l([m,o,e(n)])
}function f(n,o,m){i([e(n),o,m])
}var k={};
b.each(j.headers||{},function(n,m){k[n.toLowerCase()]=m
});
b.ajaxSettings={};
b.ajax({url:h,type:j.type||"GET",data:j.data,dataType:"text",contentType:j.contentType,headers:{Accept:k.accept||"*/*","AP-Client-Key":this.addonKey}}).then(g,f)
}}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/dialog/dialog-rpc.js' */
_AP.define("dialog",["_dollar","_rpc","dialog/dialog-factory","dialog/main"],function(c,d,b,a){d.extend(function(){return{stubs:["dialogMessage"],init:function(g,f){if(f.uiParams.isDialog){var e=a.getButton();
if(e){c.each(e,function(h,i){i.click(function(j,k){if(f.isActive()){f.dialogMessage(h,k)
}else{k(true)
}})
})
}}},internals:{setDialogButtonEnabled:function(f,e){a.getButton(f).setEnabled(e)
},isDialogButtonEnabled:function(e,g){var f=a.getButton(e);
g(f?f.isEnabled():void 0)
},createDialog:function(f){var e={key:this.addonKey};
if(f.key){e.moduleKey=f.key
}else{if(f.url){e.url=f.url
}}b(e,f,this.productContext)
},closeDialog:function(f,e){this.events.emit("ra.iframe.destroy");
a.close()
}}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/history/history-rpc.js' */
_AP.define("history/rpc",["_dollar","history/history","_rpc"],function(a,b,c){c.extend(function(d){return{init:function(f,e){if(f.uiParams.isGeneral){a(window).on("hashchange",function(g){b.hashChange(g.originalEvent,e.historyMessage)
})
}},internals:{historyPushState:function(e){if(this.uiParams.isGeneral){return b.pushState(e)
}else{a.log("History is only available to page modules")
}},historyReplaceState:function(e){if(this.uiParams.isGeneral){return b.replaceState(e)
}else{a.log("History is only available to page modules")
}},historyGo:function(e){if(this.uiParams.isGeneral){return b.go(e)
}else{a.log("History is only available to page modules")
}}},stubs:["historyMessage"]}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/_events.js' */
(window.AP||window._AP).define("_events",["_dollar"],function(f){var b=window,d=(b.AJS&&b.AJS.log)||(b.console&&b.console.log)||(function(){});
function a(h,g){this._key=h;
this._origin=g;
this._events={};
this._any=[]
}var e=a.prototype;
e.on=function(g,h){if(g&&h){this._listeners(g).push(h)
}return this
};
e.once=function(h,i){var g=this;
var j=function(){g.off(h,j);
i.apply(null,arguments)
};
this.on(h,j);
return this
};
e.onAny=function(g){this._any.push(g);
return this
};
e.off=function(g,k){var j=this._events[g];
if(j){var h=f.inArray(k,j);
if(h>=0){j.splice(h,1)
}if(j.length===0){delete this._events[g]
}}return this
};
e.offAll=function(g){if(g){delete this._events[g]
}else{this._events={}
}return this
};
e.offAny=function(j){var h=this._any;
var g=f.inArray(j,h);
if(g>=0){h.splice(g,1)
}return this
};
e.emit=function(g){return this._emitEvent(this._event.apply(this,arguments))
};
e._event=function(g){return{name:g,args:[].slice.call(arguments,1),attrs:{},source:{key:this._key,origin:this._origin}}
};
e._emitEvent=function(h){var g=h.args.concat(h);
c(this._listeners(h.name),g);
c(this._any,[h.name].concat(g));
return this
};
e._listeners=function(g){return this._events[g]=this._events[g]||[]
};
function c(j,g){for(var h=0;
h<j.length;
++h){try{j[h].apply(null,g)
}catch(k){d(k.stack||k.message||k)
}}}return{Events:a}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/_xdm.js' */
(this.AP||this._AP).define("_xdm",["_events","_base64","_uri","_ui-params","host/analytics","host/_util"],function(d,b,g,h,c,a){var f=0;
function e(I,O,T){var q,L,i,l,N,V,M,S,x,P=window,s=P.location.toString(),y=T.local||{},E=T.remote||[],G=D(s);
var k=function(){var w={};
return{add:function(Y,X,W){w[Y]={done:X||null,fail:W||null,async:!!X}
},invoke:function(Y,X,W){var Z;
if(w[X]){if(w[X][Y]){w[X][Y](W);
Z=true
}else{Z=!w[X].async&&Y!=="fail"
}delete w[X]
}return Z
}}
}();
if(!/xdm_e/.test(s)){var r=A(O);
i=r.contentWindow;
M=o(O.remote,"oauth_consumer_key")||o(O.remote,"jwt");
S=O.remoteKey;
x=S;
l=D(O.remote).toLowerCase();
N=O.channel;
V={isHost:true,iframe:r,uiParams:O.uiParams,destroy:function(){z();
if(q.iframe){I(q.iframe).remove();
delete q.iframe
}},isActive:function(){return I.contains(document.documentElement,q.iframe)
}};
I(r).on("ra.iframe.destroy",V.destroy)
}else{i=P.parent;
M="local";
var K=o(s,"jwt");
S=K?n(K):o(s,"oauth_consumer_key");
if(null===S){S=Math.random()
}x=M;
l=o(s,"xdm_e").toLowerCase();
N=o(s,"xdm_c");
V={isHost:false,isActive:function(){return true
}}
}L=x+"|"+(f+=1);
q=I.extend({id:L,remoteOrigin:l,channel:N,addonKey:x},V);
function F(w,X,Y){try{i.postMessage(JSON.stringify({c:N,i:w,t:X,m:Y}),l)
}catch(W){p(C(W))
}}function U(Y,Z,X,W){var w=Math.floor(Math.random()*1000000000).toString(16);
k.add(w,X,W);
F(w,"request",{n:Y,a:Z})
}function Q(w,W){F(w,"done",W)
}function R(w,W){F(w,"fail",W)
}function j(ac){try{var ag=JSON.parse(ac.data),aa=ag.i,ab=ag.c,ai=ag.t,ah=ag.m;
if(ac.source!==i&&ac.origin.toLowerCase()===l&&ab===N){i=ac.source
}if(ac.source!==i||ac.origin.toLowerCase()!==l||ab!==N){return
}if(ai==="request"){var w=ah.n,ae=ah.a,af=y[w],Z,X,Y;
if(af){Z=function(aj){Q(aa,aj)
};
X=function(aj){R(aa,aj)
};
Y=(ae?ae.length:0)<af.length;
var W=y;
if(q.isHost===true){W=q;
if(W.analytics){W.analytics.trackBridgeMethod(w)
}}else{W.isHost=false
}try{if(Y){af.apply(W,ae.concat([Z,X]))
}else{Z(af.apply(W,ae))
}}catch(ad){X(C(ad))
}}else{B("Unhandled request:",ag)
}}else{if(ai==="done"||ai==="fail"){if(!k.invoke(ai,aa,ah)){B("Unhandled response:",ai,aa,ah)
}}}}catch(ad){p(C(ad))
}}function t(w){return function(){var Y=[].slice.call(arguments),X,W;
function Z(){if(I.isFunction(Y[Y.length-1])){return Y.pop()
}}W=Z();
X=Z();
if(!X){X=W;
W=undefined
}U(w,Y,X,W)
}
}I.each(E,function(W,w){if(typeof W==="number"){W=w
}q[W]=t(W)
});
var u=q.events=new d.Events(M,G);
u.onAny(function(){var W=arguments[arguments.length-1];
var X=W.trace=W.trace||{};
var w=q.id+"|xdm";
if((q.isHost&&!X[w]&&W.source.channel!==q.id)||(!q.isHost&&W.source.key===M)){X[w]=true;
W=I.extend({},W);
delete W.trace;
B("Forwarding "+(q.isHost?"host":"addon")+" event:",W);
U("_event",[W])
}});
y._event=function(w){delete w.trace;
if(this.isHost){w.source={channel:this.id||L,key:this.addonKey,origin:this.remoteOrigin||l}
}B("Receiving as "+(this.isHost?"host":"addon")+" event:",w);
u._emitEvent(w)
};
function H(w){if(q.isActive()){j(w.originalEvent?w.originalEvent:w)
}else{z()
}}function m(){I(window).bind("message",H)
}function z(){I(window).unbind("message",H)
}function o(W,w){return new g.init(W).getQueryParamValue(w)
}function D(w){return new g.init(w).origin()
}function J(W,X){var w=new g.init(W);
I.each(X,function(Z,Y){w.addQueryParam(Z,Y)
});
return w.toString()
}function A(W){if(!W.container){throw new Error("config.container must be defined")
}var X=document.createElement("iframe"),Y="easyXDM_"+W.container+"_provider",w="";
if(W.uiParams){w=h.encode(W.uiParams)
}I.extend(X,{id:Y,name:w,frameBorder:"0"},W.props);
X.setAttribute("rel","nofollow");
I("#"+a.escapeSelector(W.container)).append(X);
X.src=W.remote;
return X
}function C(w){return w.message||w.toString()
}function B(){if(e.debug){p.apply(P,["DEBUG:"].concat([].slice.call(arguments)))
}}function p(){var w=I.log||(P.AJS&&P.AJS.log);
if(w){w.apply(P,arguments)
}}function n(w){return v(w)["iss"]
}function v(Y){if(null===Y||""===Y){throw ("Invalid JWT: must be neither null nor empty-string.")
}var X=Y.indexOf(".");
var W=Y.indexOf(".",X+1);
if(X<0||W<=X){throw ('Invalid JWT: must contain 2 period (".") characters.')
}var Z=Y.substring(X+1,W);
if(null===Z||""===Z){throw ("Invalid JWT: encoded claims must be neither null nor empty-string.")
}var w=b.decode(Z);
return JSON.parse(w)
}m();
return q
}return e
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/_uri.js' */
/*!
 * jsUri
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2013, Derek Watson
 * Released under the MIT license.
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 */
(this.AP||this._AP).define("_uri",[],function(){var d={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};
if(!Array.prototype.forEach){Array.prototype.forEach=function(j,h){for(var g=0,f=this.length;
g<f;
++g){j.call(h||this,this[g],g,this)
}}
}function e(f){if(f){f=decodeURIComponent(f);
f=f.replace(d.pluses," ")
}return f
}function c(i){var j=d.uri_parser;
var g=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];
var f=j.exec(i||"");
var h={};
g.forEach(function(l,k){h[l]=f[k]||""
});
return h
}function a(o){var h,m,l,q,g,f;
var j=[];
if(typeof(o)==="undefined"||o===null||o===""){return j
}if(o.indexOf("?")===0){o=o.substring(1)
}m=o.toString().split(d.query_separator);
for(h=0;
h<m.length;
h++){l=m[h];
q=l.indexOf("=");
if(q!==0){g=decodeURIComponent(l.substring(0,q));
f=decodeURIComponent(l.substring(q+1).replace(/\+/g," "));
j.push(q===-1?[l,null]:[g,f])
}}return j
}function b(f){this.uriParts=c(f);
this.queryPairs=a(this.uriParts.query);
this.hasAuthorityPrefixUserPref=null
}["protocol","userInfo","host","port","path","anchor"].forEach(function(f){b.prototype[f]=function(g){if(typeof g!=="undefined"){this.uriParts[f]=g
}return this.uriParts[f]
}
});
b.prototype.hasAuthorityPrefix=function(f){if(typeof f!=="undefined"){this.hasAuthorityPrefixUserPref=f
}if(this.hasAuthorityPrefixUserPref===null){return(this.uriParts.source.indexOf("//")!==-1)
}else{return this.hasAuthorityPrefixUserPref
}};
b.prototype.query=function(j){var g="",f,h;
if(typeof j!=="undefined"){this.queryPairs=a(j)
}for(f=0;
f<this.queryPairs.length;
f++){h=this.queryPairs[f];
if(g.length>0){g+="&"
}if(h[1]===null){g+=h[0]
}else{g+=h[0];
g+="=";
if(h[1]){g+=encodeURIComponent(h[1])
}}}return g.length>0?"?"+g:g
};
b.prototype.getQueryParamValue=function(g){var h,f;
for(f=0;
f<this.queryPairs.length;
f++){h=this.queryPairs[f];
if(g===h[0]){return h[1]
}}};
b.prototype.getQueryParamValues=function(h){var f=[],g,j;
for(g=0;
g<this.queryPairs.length;
g++){j=this.queryPairs[g];
if(h===j[0]){f.push(j[1])
}}return f
};
b.prototype.deleteQueryParam=function(j,m){var f=[],h,l,g,k;
for(h=0;
h<this.queryPairs.length;
h++){l=this.queryPairs[h];
g=e(l[0])===e(j);
k=l[1]===m;
if((arguments.length===1&&!g)||(arguments.length===2&&(!g||!k))){f.push(l)
}}this.queryPairs=f;
return this
};
b.prototype.addQueryParam=function(g,h,f){if(arguments.length===3&&f!==-1){f=Math.min(f,this.queryPairs.length);
this.queryPairs.splice(f,0,[g,h])
}else{if(arguments.length>0){this.queryPairs.push([g,h])
}}return this
};
b.prototype.replaceQueryParam=function(k,h,f){var g=-1,j,l;
if(arguments.length===3){for(j=0;
j<this.queryPairs.length;
j++){l=this.queryPairs[j];
if(e(l[0])===e(k)&&decodeURIComponent(l[1])===e(f)){g=j;
break
}}this.deleteQueryParam(k,f).addQueryParam(k,h,g)
}else{for(j=0;
j<this.queryPairs.length;
j++){l=this.queryPairs[j];
if(e(l[0])===e(k)){g=j;
break
}}this.deleteQueryParam(k);
this.addQueryParam(k,h,g)
}return this
};
["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(f){var g="set"+f.charAt(0).toUpperCase()+f.slice(1);
b.prototype[g]=function(h){this[f](h);
return this
}
});
b.prototype.scheme=function(){var f="";
if(this.protocol()){f+=this.protocol();
if(this.protocol().indexOf(":")!==this.protocol().length-1){f+=":"
}f+="//"
}else{if(this.hasAuthorityPrefix()&&this.host()){f+="//"
}}return f
};
b.prototype.origin=function(){var f=this.scheme();
if(f=="file://"){return f+this.uriParts.authority
}if(this.userInfo()&&this.host()){f+=this.userInfo();
if(this.userInfo().indexOf("@")!==this.userInfo().length-1){f+="@"
}}if(this.host()){f+=this.host();
if(this.port()){f+=":"+this.port()
}}return f
};
b.prototype.addTrailingSlash=function(){var f=this.path()||"";
if(f.substr(-1)!=="/"){this.path(f+"/")
}return this
};
b.prototype.toString=function(){var g,f=this.origin();
if(this.path()){g=this.path();
if(!(d.ends_with_slashes.test(f)||d.starts_with_slashes.test(g))){f+="/"
}else{if(f){f.replace(d.ends_with_slashes,"/")
}g=g.replace(d.starts_with_slashes,"/")
}f+=g
}else{if(this.host()&&(this.query().toString()||this.anchor())){f+="/"
}}if(this.query().toString()){if(this.query().toString().indexOf("?")!==0){f+="?"
}f+=this.query().toString()
}if(this.anchor()){if(this.anchor().indexOf("#")!==0){f+="#"
}f+=this.anchor()
}return f
};
b.prototype.clone=function(){return new b(this.toString())
};
return{init:b}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/_addons.js' */
(window.AP||window._AP).define("host/_addons",["_dollar","_rpc"],function(b,c){var a={};
c.extend(function(){var d={_emitEvent:function(e){b.each(a[e.source.key],function(g,f){f.bus._emitEvent(e)
})
},remove:function(f){var e=a[f.addonKey][f.id];
if(e){e.bus.offAny(e.listener)
}delete a[f.addonKey][f.id];
return this
},init:function(e,g){if(!a[g.addonKey]){a[g.addonKey]={}
}var f=a[g.addonKey][g.id]={bus:g.events,listener:function(){var i=arguments[arguments.length-1];
var j=i.trace=i.trace||{};
var h=g.id+"|addon";
if(!j[h]){j[h]=true;
d._emitEvent(i)
}}};
f.bus.onAny(f.listener);
f.bus.on("ra.iframe.destroy",function(){d.remove(g)
})
}};
return d
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/main.js' */
_AP.define("host/main",["_dollar","_xdm","host/_addons","_rpc","_ui-params","analytics/analytics","host/_util"],function(c,f,j,h,e,i,g){var a=window.requestAnimationFrame||function(k){setTimeout(k,10)
};
function b(k){if(!k){throw new Error("ns undefined")
}return c("#embedded-"+g.escapeSelector(k))
}function d(w){c.extend(w,e.fromUrl(w.src));
var u=w.ns,n=b(u),m="embedded-"+u,q="channel-"+u,l=w.w||"100%",t=w.h||"0",o=new Date().getTime(),p=!!w.dlg,k=(n.closest(".aui-inline-dialog").length>0),v=!!w.simpleDlg,s;
if(typeof w.uiParams!=="object"){w.uiParams={}
}if(!!w.general){w.uiParams.isGeneral=true
}if(w.dlg){w.uiParams.isDialog=true
}var r={remote:w.src,remoteKey:w.key,container:m,channel:q,props:{width:l,height:t},uiParams:w.uiParams};
if(w.productCtx&&!w.productContext){w.productContext=JSON.parse(w.productCtx)
}h.extend({init:function(y,x){x.analytics=i.get(x.addonKey,u);
x.analytics.iframePerformance.start();
x.productContext=w.productContext
}});
h.init(w,r)
}return function(l){$content=b(l.ns);
$contentIframe=$content.find("iframe");
if($contentIframe.length){$contentIframe.trigger("ra.iframe.destroy");
$content.remove()
}var n=0;
function k(){if(b(l.ns).length===0&&n<10){setTimeout(function(){n++;
k()
},50);
return
}d(l)
}if(typeof ConfluenceMobile!=="undefined"){k()
}else{if(c.isReady){a(k)
}else{AJS.toInit(function m(){if(AJS.Confluence&&AJS.Confluence.EditorLoader&&AJS.Confluence.EditorLoader.load){try{AJS.Confluence.EditorLoader.load(k,k)
}catch(p){try{k()
}catch(o){AJS.log(o)
}}}else{try{k()
}catch(o){AJS.log(o)
}}})
}}}
});
if(!_AP.create){_AP.require(["host/main"],function(a){_AP.create=a
})
}if(typeof ConfluenceMobile!=="undefined"){ConfluenceMobile.contentEventAggregator.on("render:pre:after-content",function(d,c,e){window["eval"].call(window,$(e.attributes.body).find(".ap-iframe-body-script").html())
})
};
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = 'js/iframe/_base64.js' */
(window.AP||window._AP).define("_base64",["_dollar"],function(e){function i(){this.buffer=[]
}i.prototype.append=function c(j){this.buffer.push(j);
return this
};
i.prototype.toString=function b(){return this.buffer.join("")
};
var f={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(l){var j=new i();
var k=new d(l);
while(k.moveNext()){var s=k.current;
k.moveNext();
var q=k.current;
k.moveNext();
var o=k.current;
var r=s>>2;
var p=((s&3)<<4)|(q>>4);
var n=((q&15)<<2)|(o>>6);
var m=o&63;
if(isNaN(q)){n=m=64
}else{if(isNaN(o)){m=64
}}j.append(this.codex.charAt(r)+this.codex.charAt(p)+this.codex.charAt(n)+this.codex.charAt(m))
}return j.toString()
},decode:function(l){var k=new i();
var o=new h(l);
while(o.moveNext()){var j=o.current;
if(j<128){k.append(String.fromCharCode(j))
}else{if((j>191)&&(j<224)){o.moveNext();
var n=o.current;
k.append(String.fromCharCode(((j&31)<<6)|(n&63)))
}else{o.moveNext();
var n=o.current;
o.moveNext();
var m=o.current;
k.append(String.fromCharCode(((j&15)<<12)|((n&63)<<6)|(m&63)))
}}}return k.toString()
}};
function d(j){this._input=j;
this._index=-1;
this._buffer=[]
}d.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0){this.current=this._buffer.shift();
return true
}else{if(this._index>=(this._input.length-1)){this.current=Number.NaN;
return false
}else{var j=this._input.charCodeAt(++this._index);
if((j==13)&&(this._input.charCodeAt(this._index+1)==10)){j=10;
this._index+=2
}if(j<128){this.current=j
}else{if((j>127)&&(j<2048)){this.current=(j>>6)|192;
this._buffer.push((j&63)|128)
}else{this.current=(j>>12)|224;
this._buffer.push(((j>>6)&63)|128);
this._buffer.push((j&63)|128)
}}return true
}}}};
function h(j){this._input=j;
this._index=-1;
this._buffer=[]
}h.prototype={current:64,moveNext:function(){if(this._buffer.length>0){this.current=this._buffer.shift();
return true
}else{if(this._index>=(this._input.length-1)){this.current=64;
return false
}else{var p=f.codex.indexOf(this._input.charAt(++this._index));
var o=f.codex.indexOf(this._input.charAt(++this._index));
var n=f.codex.indexOf(this._input.charAt(++this._index));
var m=f.codex.indexOf(this._input.charAt(++this._index));
var l=(p<<2)|(o>>4);
var k=((o&15)<<4)|(n>>2);
var j=((n&3)<<6)|m;
this.current=l;
if(n!=64){this._buffer.push(k)
}if(m!=64){this._buffer.push(j)
}return true
}}}};
function g(j){return window.btoa?window.btoa(j):f.encode(j)
}function a(j){return window.atob?window.atob(j):f.decode(j)
}return{encode:g,decode:a}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/_ui-params.js' */
(this.AP||this._AP).define("_ui-params",["_dollar","_base64","_uri"],function(c,a,b){return{encode:function(d){return a.encode(JSON.stringify(d))
},fromUrl:function(d){var d=new b.init(d),e=d.getQueryParamValue("ui-params");
return this.decode(e)
},fromWindowName:function(d,f){d=d||window;
var e=this.decode(d.name);
if(!f){return e
}return(e)?e[f]:undefined
},decode:function(g){var f={};
if(g&&g.length>0){try{f=JSON.parse(a.decode(g))
}catch(d){if(console&&console.log){console.log("Cannot decode passed ui params",g)
}}}return f
}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/content.js' */
_AP.define("host/content",["_dollar","_uri","_ui-params"],function(f,c,b){function g(l,k){return AJS.contextPath()+"/plugins/servlet/ac/"+encodeURIComponent(l)+"/"+encodeURIComponent(k.key)
}function i(l){var k=l.attr("class").match(/ap-plugin-key-([^\s]*)/);
return f.isArray(k)?k[1]:false
}function a(l){var k=l.attr("class").match(/ap-module-key-([^\s]*)/);
return f.isArray(k)?k[1]:false
}function e(n){var m=i(n),k=a(n),l=n.hasClass("ap-inline-dialog")?"inlineDialog":"dialog";
return window._AP[l+"Options"][k]||{}
}function j(m,k,l,o){var n=AJS.contextPath()+"/plugins/servlet/render-signed-iframe";
return f.ajax(n,{dataType:"html",data:{dialog:true,"ui-params":b.encode(o),"plugin-key":m,"product-context":JSON.stringify(l),"remote-url":k,width:"100%",height:"100%",raw:"true"}})
}function h(m,l,k,o){var n=g(m,k);
return f.ajax(n,{dataType:"html",data:{"ui-params":b.encode(o),"plugin-key":m,"product-context":JSON.stringify(l),key:k.key,width:"100%",height:"100%",raw:"true"}})
}function d(m,k,n){function l(s){s.preventDefault();
var r=f(s.target).closest(k),o=r.attr("href"),q=new c.init(o),p={bindTo:r,header:r.text(),width:q.getQueryParamValue("width"),height:q.getQueryParamValue("height"),cp:q.getQueryParamValue("cp"),key:i(r)};
n(o,p,s.type)
}f(window.document).on(m,k,l)
}return{getContentUrl:g,getIframeHtmlForUrl:j,getIframeHtmlForKey:h,eventHandler:d,getOptionsForWebItem:e}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/_status_helper.js' */
_AP.define("host/_status_helper",["_dollar"],function(e){var b={loading:{descriptionHtml:'<div class="small-spinner"></div>Loading add-on...'},"load-timeout":{descriptionHtml:'<div class="small-spinner"></div>Add-on is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?'},"load-error":{descriptionHtml:"Add-on failed to load."}};
function d(j){if(j.data("loadingStatusTimer")){clearTimeout(j.data("loadingStatusTimer"));
j.removeData("loadingStatusTimer")
}j.find(".ap-status").addClass("hidden")
}function f(k,j){d(k);
k.closest(".ap-container").removeClass("hidden");
k.find(".ap-stats").removeClass("hidden");
k.find(".ap-"+j).removeClass("hidden");
setTimeout(function(){var l=AJS.$(".small-spinner",".ap-"+j);
if(l.length){l.spin({zIndex:"1"})
}},10)
}function g(j){d(j)
}function c(k,j){if(!j){f(k,"loading")
}else{var l=setTimeout(f.bind(null,k,"loading"),j);
k.data("loadingStatusTimer",l)
}}function h(j){f(j,"load-timeout")
}function i(j){f(j,"load-error")
}function a(){var l,k=e('<div class="ap-stats" />');
for(l in b){var j=e('<div class="ap-'+l+' ap-status hidden" />');
j.append("<small>"+b[l].descriptionHtml+"</small>");
k.append(j)
}return k
}return{createStatusMessages:a,showLoadingStatus:c,showloadTimeoutStatus:h,showLoadErrorStatus:i,showLoadedStatus:g}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/history/history.js' */
_AP.define("history/history",["_dollar","_uri"],function(h,b){var k,d="!";
function e(n){if(n===undefined||n===null){return""
}return n.toString().replace(new RegExp("^"+d),"")
}function l(n){if(n===undefined||n===null){throw"You must supply text to prefix"
}return d+e(n)
}function m(n,o){var p=new b.init(window.location.href),q=new b.init(window.location.href);
q.anchor(l(n));
if(q.anchor()!==p.anchor()){k=q.anchor();
if(o){window.location.replace("#"+q.anchor())
}else{window.location.assign("#"+q.anchor())
}return q.anchor()
}}function i(n){m(n)
}function g(n){m(n,true)
}function c(n){history.go(n)
}function f(p,n){var q=new b.init(p.newURL);
var o=new b.init(p.oldURL);
if((q.anchor()!==o.anchor())&&(k!==q.anchor())){n(a(p))
}k=null
}function a(n){return{newURL:e(new b.init(n.newURL).anchor()),oldURL:e(new b.init(n.oldURL).anchor())}
}function j(){var o=new b.init(window.location.href),n=e(o.anchor());
return n
}return{pushState:i,replaceState:g,go:c,hashChange:f,getState:j}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/analytics/analytics.js' */
_AP.define("analytics/analytics",["_dollar"],function(e){var b=["resize","init"];
var d=20000;
var g=100;
function f(){return window.performance&&window.performance.now?window.performance.now():new Date().getTime()
}function a(h,i){var j={};
this.addonKey=h;
this.moduleKey=i;
this.iframePerformance={start:function(){j.startLoading=f()
},end:function(){var k=f()-j.startLoading;
c.track("iframe.performance.load",{addonKey:h,moduleKey:i,value:k>d?"x":Math.ceil((k)/g)});
delete j.startLoading
},timeout:function(){c.track("iframe.performance.timeout",{addonKey:h,moduleKey:i});
this.end()
},cancel:function(){c.track("iframe.performance.cancel",{addonKey:h,moduleKey:i})
}}
}var c=a.prototype;
c.getKey=function(){return this.addonKey+":"+this.moduleKey
};
c.track=function(h,j){var i="connect.addon."+h;
if(AJS.Analytics){AJS.Analytics.triggerPrivacyPolicySafeEvent(i,j)
}else{if(AJS.trigger){AJS.trigger("analyticsEvent",{name:i,data:j})
}else{return false
}}return true
};
c.trackBridgeMethod=function(h){if(e.inArray(h,b)!==-1){return false
}this.track("bridge.invokemethod",{name:h,addonKey:this.addonKey,moduleKey:this.moduleKey})
};
return{get:function(h,i){return new a(h,i)
}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:inline-dialog', location = 'js/inline-dialog/main.js' */
_AP.define("inline-dialog",["_dollar","inline-dialog/simple"],function(f,a){function d(h){return h.closest(".contents").data("inlineDialog")
}function b(h){d(h).show()
}function c(i,j,h){i.closest(".contents").css({width:j,height:h});
g(i)
}function g(h){d(h).refresh()
}function e(h){d(h).hide()
}return{showInlineDialog:b,resizeInlineDialog:c,hideInlineDialog:e}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:inline-dialog', location = 'js/inline-dialog/binder.js' */
_AP.require(["inline-dialog/simple","_dollar","host/content"],function(a,d,c){var b=".ap-inline-dialog";
AJS.toInit(function(f){var e="click mouseover mouseout",g=function(i,j,k){var h=c.getOptionsForWebItem(j.bindTo);
f.extend(j,h);
if(j.onHover!=="true"&&k!=="click"){return
}a(i,j).show()
};
c.eventHandler(e,b,g)
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:inline-dialog', location = 'js/inline-dialog/simple.js' */
_AP.define("inline-dialog/simple",["_dollar","host/_status_helper","host/_util"],function(c,a,b){return function(j,g){var h;
if(!g.bindTo||!g.bindTo.jquery){return
}var f=g.bindTo.hasClass("ap-inline-dialog")?g.bindTo:g.bindTo.closest(".ap-inline-dialog");
var i=f.attr("id");
if(!i){return
}var d=function(l,k,m){g.w=g.w||g.width;
g.h=g.h||g.height;
if(!g.ns){g.ns=i
}g.container=g.ns;
g.src=g.url=g.url||j;
l.data("inlineDialog",h);
if(!l.find("iframe").length){l.attr("id","ap-"+g.ns);
l.append('<div id="embedded-'+g.ns+'" />');
l.append(a.createStatusMessages());
_AP.create(g)
}m();
return false
};
var e="ap-inline-dialog-content-"+i;
h=c("#inline-dialog-"+b.escapeSelector(e));
if(h.length===0){h=AJS.InlineDialog(g.bindTo,e,d,g)
}return{id:h.attr("id"),show:function(){h.show()
},hide:function(){h.hide()
}}
}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:messages', location = 'js/messages/main.js' */
_AP.define("messages/main",["_dollar"],function(e){var b="ac-message-container",c=["generic","error","warning","success","info","hint"];
function f(g){return g.search(/^ap\-message\-[0-9]+$/)==0
}function a(){var g=e("#"+b);
if(g.length<1){g=e('<div id="'+b+'" />').appendTo("body")
}return g
}function d(g){var j,h,l={},k=["closeable","fadeout","delay","duration","id"];
for(j in k){h=k[j];
if(h in g){l[h]=g[h]
}}return l
}return{showMessage:function(j,k,g,i){var h=a();
i=d(i);
e.extend(i,{title:k,body:AJS.escapeHtml(g)});
if(e.inArray(j,c)<0){throw"Invalid message type. Must be: "+c.join(", ")
}if(f(i.id)){AJS.messages[j](h,i);
h.css("margin-left","-"+h.innerWidth()/2+"px")
}},clearMessage:function(g){if(f(g)){e("#"+g).remove()
}}}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:messages', location = 'js/messages/messages-rpc.js' */
_AP.define("messages-rpc",["_dollar","messages/main","_rpc"],function(b,a,c){c.extend(function(){return{internals:{showMessage:function(f,g,d,e){return a.showMessage(f,g,d,e)
},clearMessage:function(d){return a.clearMessage(d)
},}}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-workflow-post-function', location = 'js/jira/workflow-post-function/workflow-post-function.js' */
_AP.define("jira/workflow-post-function",["_dollar"],function(c){function d(f,g){var e=c("#postFunction-config-"+f);
if(g){e.val(g)
}return e.val()
}function b(){return(c("input[name='postFunction.id']").length>0)
}function a(g,h,f){if(!b()){throw"Not on a workflow configuration page"
}var e=false;
c(document).delegate("#add_submit, #update_submit","click",function(i){if(!e||f){i.preventDefault();
h(function(j){if(j.valid){d(g,j.value);
e=true;
c(i.target).click()
}})
}})
}return{postFunctionConfigInput:d,isOnWorkflowPostFunctionPage:b,registerSubmissionButton:a}
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-workflow-post-function', location = 'js/jira/workflow-post-function/workflow-post-function-rpc.js' */
_AP.define("jira/workflow-post-function/rpc",["_dollar","_rpc","jira/workflow-post-function"],function(a,b,c){b.extend(function(){return{init:function(e,d){if(!c.isOnWorkflowPostFunctionPage()){return
}var f=d.setWorkflowConfigurationMessage;
c.registerSubmissionButton(e.productContext["postFunction.id"],f)
},internals:{getWorkflowConfiguration:function(e){var d=c.postFunctionConfigInput(this.productContext["postFunction.id"]);
if(e){e(d)
}return d
}},stubs:["setWorkflowConfigurationMessage"]}
})
});
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-events', location = '/js/jira/events.js' */
_AP.define("jira/events",["_dollar","_rpc"],function(b,c){var a={refreshIssuePage:function(){try{JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[JIRA.Issue.getIssueId()])
}catch(d){throw new Error("Failed to refresh the issue page")
}}};
c.extend(function(){return{internals:{triggerJiraEvent:function(){a.refreshIssuePage()
}}}
});
return a
});
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:analytics', location = 'analytics/analytics.js' */
var _gaq=_gaq||[];AJS.$(function(){_gaq.push(["navlinks._setAccount","UA-20272869-14"]);_gaq.push(["navlinks._setDomainName","none"]);_gaq.push(["navlinks._setAllowLinker",true]);_gaq.push(["navlinks._setDetectTitle",false]);_gaq.push(["navlinks._trackPageview",location.pathname]);AJS.$.ajax(AJS.contextPath()+"/rest/nav-links-analytics-data/1.0/",{success:function(a){_gaq.push(["navlinks._setCustomVar",1,"isUserAdmin",a.isUserAdmin?"true":"false",2])}})});(function(a){a.trackEvent=function(c,e,b,d){if(d===undefined){_gaq.push(["navlinks._trackEvent",c,e,b])}else{_gaq.push(["navlinks._trackEvent",c,e,b,d])}if(AJS.EventQueue){AJS.EventQueue.push({name:c+"."+e,properties:{label:b,value:d}})}};a.getCurrentApplication=function(){if(window.Confluence!==undefined){return"confluence"}else{if(window.BAMBOO!==undefined){return"bamboo"}else{if(window.JIRA!==undefined){return"jira"}else{return""}}}}}(window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:analytics', location = 'analytics/help-analytics.js' */
(function(c,b){function a(g,d,f){try{b.trackEvent("helpmenu",g,d,f)}catch(h){AJS.log("failed to track analytics event, category: helpmenu, action: "+g+", label: "+d+", value: "+f)}}c(function(){var d=c("#system-help-menu-content,#help-menu-link-content,#bamboo\\.global\\.header-help\\.menu");d.bind({"aui-dropdown2-show":function(f){a("show","")},"aui-dropdown2-hide":function(f){a("hide","")}}).find("a").unbind(".analytics").bind("click.analytics",function(){var e=this.attributes.href;a("linkFollowed",typeof e==="object"?e.value:e)}).addClass("interactive")})}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,h){var j,l={},o="key",b="name",k="entity-type";function n(r,p,q){try{h.trackEvent("projectshortcuts",r,p,q)}catch(s){AJS.log("failed to track analytics event, category: projectshortcuts, action: "+r+", label: "+p+", value: "+q)}}function f(u){var p=e(this),q=p.data(o),s=p.data(b),r=p.data(k);if(typeof q==="undefined"){return}u.preventDefault();j=new AJS.Dialog({width:600,keypressListener:function(w){if(w.which==jQuery.ui.keyCode.ESCAPE){j.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){j.remove();n("hide",h.getCurrentApplication())}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:s,logoUrl:i(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links"})})).show();c(j);if(!l[q]){l[q]={entity:{title:s},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+q,{entityType:r}).done(v);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+q,{entityType:r}).done(t).fail(function(){var w=j.getCurrentPanel().body.find(".project-content-wrapper");w.find(".projectshortcuts-loading").remove();AJS.messages.error(w,{body:"Could not retrieve remote project shortcuts",closeable:false});c(j)})}else{m(l[q])}function v(w){l[q].localShortcuts=w.shortcuts;m(l[q])}function t(w){l[q].remoteShortcuts=w.shortcuts;m(l[q])}n("show",h.getCurrentApplication())}function i(){return e(".project-shortcut-dialog-trigger img").attr("src")}function g(p){p.getCurrentPanel().body.find("a").unbind(".analytics").bind("click.analytics",function(){var q=this.attributes.href;n("navLinkFollowed",typeof q==="object"?q.value:q)})}function m(p){if(p.localShortcuts){j.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:p.entity.title,logoUrl:i(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(p)}));g(j);c(j)}}function a(r){var q=210;if(!r||r.length<=q){return r}var p=q;while(p>0&&r.charAt(p)!=" "){p--}if(p==0){p=q}r=r.substring(0,p);if(r.length>=p){r=r+"..."}return r}function c(p){var s=p.popup.element,r=s.find(".dialog-panel-body"),q=s.find(".dialog-components");r.height("auto");s.height(q.outerHeight()-1);e(".aui-shadow").remove()}function d(p,q){return e.ajax({url:p,cache:false,data:q,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'templates/soy/attach-screenshot-form.soy' */
// This file was automatically generated from attach-screenshot-form.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Html5Screenshot == 'undefined') { JIRA.Templates.Html5Screenshot = {}; }


JIRA.Templates.Html5Screenshot.attachScreenshotForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2 class="dialog-title">', soy.$$escapeHtml("Attach screenshot"), '</h2><form action="ShowAttachScreenshotFormAction.jspa" class="aui" method="post" id="attach-screenshot-form" data-attach-secure-token="', soy.$$escapeHtml(opt_data.attachUserToken), '" data-submit-secure-token="', soy.$$escapeHtml(opt_data.submitUserToken), '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.id), '"/><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '"><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '"><input type="hidden" name="filetoconvert" value=""><div class="attach-screenshot-padding"><div class="attach-screenshot-container"><div id="attach-screenshot-inner-container"><div class="mod-content"><ul class="item-details"><li><dl><dt>Take a screenshot:</dt>', (opt_data.userPlatform == 'pc') ? '<dd><kbd>PrtScn</kbd></dd>' : '<dd><kbd> Ctrl</kbd> + <kbd> Cmd</kbd> + <kbd> Shift</kbd> + <kbd>3</kbd></dd>', '</dl></li><li><dl><dt>Paste the image:</dt>', (opt_data.userPlatform == 'pc') ? '<dd><kbd>Ctrl</kbd> + <kbd>v</kbd></dd>' : '<dd><kbd> Cmd</kbd> + <kbd>v</kbd></dd>', '</dl></li></ul></div><input type="text" id="attach-screenshot-fake-input"><div class="attach-screenshot-padding attach-screenshot-padding-inner"><div id="attach-screenshot-image-container" class="attach-screenshot-image-container"><div class="attach-screenshot-placeholder"><div class="mod-content"><ul class="item-details"><li><dl><dt id="attach-screenshot-placeholder-message">', soy.$$escapeHtml("Your image will be pasted here"), '</dt></dl></li></ul></div></div></div></div><div id=\'attach-max-size\' class="hidden">', soy.$$escapeHtml(opt_data.maxSize), '</div></div></div></div><fieldset><div><legend><span>Attach Screenshot</span></legend><div id="attach-screenshot-filename-group" class="field-group"><div id="attach-screenshot-progress-container"></div><label for="attachscreenshotname">', soy.$$escapeHtml("File name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("Required"), '</span></label><input class="text" type="text" id="attachscreenshotname" name="attachscreenshotname" title="File Name" value="', soy.$$escapeHtml(opt_data.nextScreenshotName), '"><div class="description">', soy.$$escapeHtml("A file name to be used as attached image name"), '</div></div></div></fieldset><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button" id="attach-screenshot-html5-upload">', soy.$$escapeHtml("Upload"), '</button><a href="#" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'js/base64decode.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");function a(b){return b>64&&b<91?b-65:b>96&&b<123?b-71:b>47&&b<58?b+4:b===43?62:b===47?63:0}JIRA.AttachImagesPlugin.base64decode=function(d){var k=d.replace(/[^A-Za-z0-9\+\/]/g,""),e=k.length,b=e*3+1>>2,i=new Uint8Array(b);for(var h,f,g=0,c=0,j=0;j<e;j++){f=j&3;g|=a(k.charCodeAt(j))<<18-6*f;if(f===3||e-j===1){for(h=0;h<3&&c<b;h++,c++){i[c]=g>>>(16>>>h&24)&255}g=0}}return i}})();
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'js/utility.js' */
(function(a){AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.isPasteEvent=function(e,b){var c=86,d=(b||navigator.platform).indexOf("Mac")!==-1;return e.which===c&&(d?e.metaKey:e.ctrlKey)};JIRA.AttachImagesPlugin.browserIsSupported=function(b){var d=document.documentElement.className.split(/\s+/),e=(b||navigator.platform).indexOf("Mac")!==-1,c=a.inArray("safari",d)!==-1;return !(e&&c)}})(jQuery);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'js/requireDeployJava.js' */
AJS.namespace("JIRA.AttachImagesPlugin");(function(b,a){JIRA.AttachImagesPlugin.requireDeployJava=a.once(function(){var c=b.Deferred();if(window.deployJava){c.resolve(window.deployJava,window)}else{b('<iframe style="display: none !important; visibility: hidden !important; opacity: 0"/>').attr("src",AJS.contextPath()+"/download/resources/com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources/applet/deployJava.html").one("load",function(){var d=this.contentWindow;c.resolve(d.deployJava,d)}).one("error",a.bind(c.reject,c)).appendTo("body")}return c})})(AJS.$,_);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'js/polyfill.js' */
(function(e,b){AJS.namespace("JIRA.AttachImagesPlugin");var f,d,g,c;function a(){var h=e.Deferred();return h.reject.apply(h,arguments)}(function(){var j=document.documentElement.className.split(/\s+/),l=e.inArray("msie",j)>-1,m=e.inArray("msie-gt-7",j)>-1,k=e.inArray("msie-gt-8",j)>-1,i=e.inArray("msie-gt-9",j)>-1,h=e.inArray("msie-gt-10",j)>-1;f=l&&m&&!k;d=l&&k&&!i;g=l&&i&&!h})();JIRA.AttachImagesPlugin.polyfill=new (function(){var i;var j=b.bind(function(m){if(JIRA.AttachImagesPlugin.isPasteEvent(m)){c.reload();var l=c.getClipboardData();if(l){var k=c.getClipboardData(this.pasteImageWidth,this.pasteImageHeight);if(k.length>this.dataURILimit){var n=this.dataURILimit/k.length;k=c.getClipboardData(this.pasteImageWidth*n,this.pasteImageHeight*n)}i.trigger("polyPaste",[l,k])}}},this);this.install=b.once(function(k){i=e(k);return JIRA.AttachImagesPlugin.requireDeployJava().pipe(function(o,l){var n,q,m,p="1.7.0_06";if(o.getJREs().length===0){return a("java-absent")}else{if(!o.versionCheck(p+"+")){return a("java-version")}}m=!o.versionCheck("1.7.0_45+");n={id:"JIRA HTML5 Images Applet",codebase:AJS.contextPath()+"/download/resources/com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources/applet/",code:"com.atlassian.plugins.jira.screenshot.applet.ScreenshotApplet.class",archive:m?"screenshot-legacy.jar":"screenshot.jar",width:0,height:0};q={permissions:"all-permissions"};o.runApplet(n,q,p);c=l.document.getElementById(n.id);try{if(!c||!c.isSecurityOk()){return a("java-security")}}catch(r){return a("java-security")}i.on("keydown",j);return h},function(){return a("unknown")}).pipe(null,function(m){var l;if(m==="unknown"){l="A problem occurred while running Java."}else{if(m==="java-version"){l=AJS.format("You need to {0}upgrade Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-absent"){l=AJS.format("You need to install {0}Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-security"){l=AJS.format("Your Java security settings are blocking this feature. Please upgrade to the latest {0}Java{1}.",'<a href="//java.com">',"</a>")}}}}return a(m,l)})});this.isRequired=function(){return f||d||g};this.isRequiredForBinaryAjax=function(){return f||d};this.pasteImageWidth=510;this.pasteImageHeight=280;this.dataURILimit=f?32000:Number.MAX_VALUE;function h(n,l){var m=document.cookies,k=e.Deferred();c.doMultipartRequest(l,"UTF-8",window.navigator.userAgent,k);k.always(function(){document.cookies=m});return k}this.proxyAjaxRequest=function(k,l){return function(){var m=JIRA.SmartAjax.makeRequest;JIRA.SmartAjax.makeRequest=function(n){var o=b.reduce(b.keys(n.data),function(s,q){s.push(q,n.data[q]);return s},[]);o.push("secureToken",l());var p=c.doAjaxRequest(n.url,"UTF-8",window.navigator.userAgent,e.Deferred(),o);p.abort=e.noop;p.then(function(s){var r=b.filter(arguments,function(w,v){return v>0});r[0]="Status";r=b.reduce(b.reduce(r,function(y,x,v){var w=(v/2)<<0;(y[w]||(y[w]=[])).push(x);return y},[]),function(w,v){w[v[0]]=v[1];return w},{});var t={getResponseHeader:function(v){return r[v]}};var u="success";var q=new JIRA.SmartAjax.SmartAjaxResult(t,0,"success",s,true);n.complete(t,u,q)});return p};k.apply(this,arguments);JIRA.SmartAjax.makeRequest=m}}})})(AJS.$,_);
/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'js/html5.js' */
AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.handler=(function(){var a;AJS.EventQueue=AJS.EventQueue||[];a={REQUEST_TIMEOUT_MILLIS:5*60*1000,screenshotFileUpload:{},screenshotFileUploadUri:null,dropHandlerConfigured:false,dropFeatureEnabled:true,$document:undefined,$window:undefined,$container:undefined,$fakeInput:undefined,uploadError:false,uploadErrorMsg:"",progressView:{hidden:false,progress:0,old:0,progressBarContainer:undefined,progressEl:undefined,container:undefined,options:undefined,staticProgress:undefined,initProgress:function(){this.container=this.buildContainer();this.progressEl=this.buildProgress();this.container.append(this.progressEl);this.options={showPercentage:false,height:"2px"};this.progressBarContainer=AJS.$("#attach-screenshot-progress-container");this.progressBarContainer.empty();this.progressBarContainer.append(this.container);this.staticProgress=this.container;this.hidden=true},finish:function(){this.value(100)},progressHandler:function(c){var b=Math.round(c.loaded*100/c.total);a.debug("progress = "+b);a.progressView.value(b)},value:function(b){if(b>100){b=100}else{if(b<0){b=0}}if(this.hidden){a.debug("showing progressEl");this.progressEl.show();this.hidden=false}if(this.old!==b){this.progressEl.progressBar(b,this.options);if(b>=100){this.progressEl.fadeOut()}this.old=b}},buildContainer:function(){return AJS.$("<div>").addClass("file-progress")},buildProgress:function(){return AJS.$("<div>").attr("id","attach-screenshot-upload-progress")}},dialogView:{pasteCatcher:{},presenter:undefined,getMaxSize:function(){return AJS.$("#attach-max-size").text()},getFileSize:function(){if(AJS.$.isPlainObject(this.presenter.screenshotFileUpload)&&_.isEmpty(this.presenter.screenshotFileUpload)){return 0}return this.presenter.screenshotFileUpload.size},cleanGeneralErrors:function(){AJS.$("#error-attach-screenshot-image").closest(".field-group").remove()},cleanFileErrors:function(){AJS.$("#error-attachScreenshotFileName").remove()},displayErrors:function(b){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if("compatibility" in b){AJS.$("#attach-screenshot-inner-container").before(aui.message.error({content:b.compatibility}))}if("fileName" in b){AJS.$("#attach-screenshot-filename-group").append('<div class="error" id="error-attach-screenshot-filename" data-field="attachscreenshotname">'+b.fileName+"</div>")}if("fileUpload" in b){AJS.$("#attach-screenshot-inner-container").append('<div class="field-group attach-screenshot-image-error"><div class="error" id="error-attach-screenshot-image">'+b.fileUpload+"</div></div>")}},appendBlobImage:function(b){var d=window.URL||window.webkitURL;var c=d.createObjectURL(b);this.presenter.screenshotFileUpload=b;this.createImage(c)},generateFileName:function(){var c=new Date().getTime();var b="attach-screenshot-temp-"+c},createImage:function(e){var c=new Image();c.onload=function(){};c.src=e;this.presenter.screenshotToUpload=c;var d=AJS.$(c);d.addClass("attach-screenshot-pasted-image");var b=AJS.$("#attach-screenshot-image-container");b.empty();b.append(d);this.presenter.$fakeInput.focus();a.imageCreatedHandler()},checkInput:function(){var c,b=a.dialogView.pasteCatcher.childNodes[0];if(b){if("IMG"===b.tagName){c=b.src}a.dialogView.pasteCatcher.innerHTML=""}if(!c){a.$fakeInput.focus()}return c},onPaste:function(d){this.presenter.debug("attach image - onPaste");a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if(d&&d.clipboardData&&d.clipboardData.items){var b=d.clipboardData.items;if(b){for(var c=0;c<b.length;c++){if(b[c].type.indexOf("image")!==-1){this.appendBlobImage(b[c].getAsFile())}}}}else{setTimeout(function(){var e=this.checkInput();if(e){a.screenshotFileUpload=a.decodeBase64DataUri(e);a.dialogView.createImage(e)}}.bind(this),0)}},getFakeInput:function(){return AJS.$("#attach-screenshot-fake-input")},getContainer:function(){return AJS.$("#attach-screenshot-image-container")},getIssueKey:function(){return AJS.$("input[name='id']").val()},getDocument:function(){return AJS.$(document)},getWindow:function(){return AJS.$(window)},getFileNameInput:function(){return AJS.$("#attachscreenshotname")},hasPngExtension:function(c){var b=/\.png$/i;return b.test(c)},setFileToConvert:function(b){AJS.$("input[name='filetoconvert']").val(b)},buildPasteCatcher:function(){if(!document.getElementById("attach-screenshot-form")){return}var b=document.createElement("div");b.setAttribute("contenteditable","true");b.style.width=0;b.style.height=0;document.getElementById("attach-screenshot-form").appendChild(b);return b},_getFormSubmits:function(){return AJS.$("#attach-screenshot-form").find("button.aui-button")},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},isEnabled:function(){return !this._getFormSubmits().attr("disabled")},initDialog:function(b){this.pasteCatcher={};this.presenter=b;if(!JIRA.AttachImagesPlugin.polyfill.isRequired()){this.pasteCatcher=this.buildPasteCatcher()}}},initScreenshotPasteHandler:function(){var b=a.dialogView;a.screenshotFileUpload={};a.resetUploadErrors();a.dialogView.initDialog(a.getPresenter());a.$document=b.getDocument();a.$window=b.getWindow();a.$container=b.getContainer();a.$fakeInput=b.getFakeInput();a.bindOnce(a.$container,"click",a.setFocusOnClickHandler);a.bindOnce(a.$fakeInput,"focus",a.showFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"blur",a.hideFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"keydown",a.keyDownHandler);if(!JIRA.AttachImagesPlugin.browserIsSupported()){b.displayErrors({compatibility:AJS.format("Your browser is not supported. Consider using an alternative supported browser such as {0}Google Chrome{1} or {2}Firefox{3}.",'<a href="//www.google.com/chrome/browser/">',"</a>",'<a href="//www.mozilla.org/firefox/">',"</a>")})}else{if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(c){a.bindOnce(a.$document,"polyPaste",a.polyPasteHandler);if(JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){a.executeAjaxUpload=c}}).fail(function(d,c){b.displayErrors({compatibility:c})})}else{a.bindOnce(a.$window,"paste",a.pasteHandler)}}},resetUploadErrors:function(){a.uploadError=false;a.uploadErrorMsg=undefined},setUploadError:function(b){a.uploadError=true;a.uploadErrorMsg=b},bindOnce:function(d,b,c){d.unbind(b,c);d.bind(b,c)},showFocusOnFieldHandler:function(){a.$container.addClass("focus")},hideFocusOnFieldHandler:function(){a.$container.addClass("focus")},setFocusOnClickHandler:function(){a.debug("attach image - focusingHandler");a.$fakeInput.focus()},pasteHandler:function(b){if(!a.dialogView.isEnabled()){a.debug("attach image - onPaste not ready");return}a.debug("attach image - pasteHandler");a.dialogView.onPaste(b.originalEvent)},polyPasteHandler:function(c,b,d){if(!a.dialogView.isEnabled()){a.debug("attach image - onPaste not ready");return}a.screenshotFileUpload={length:0};a.screenshotFileUploadUri=b;a.dialogView.createImage(d)},keyDownHandler:function(b){if(JIRA.AttachImagesPlugin.isPasteEvent(b)){if(a.dialogView.pasteCatcher.focus){a.dialogView.pasteCatcher.focus()}}},getPresenter:function(){return a},imageCreatedHandler:function(){var b=a.dialogView.generateFileName();a.doAjaxUpload(this.dialogView.getIssueKey(),b)},getMimeType:function(){if(a.screenshotFileUploadUri){return"image/jpeg"}return"image/png"},createData:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()&&!JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){return this.decodeBase64DataUri(a.screenshotFileUploadUri)}return a.screenshotFileUpload},debug:function(b){if(!("undefined"===console)){console.log(b)}},hasCharacter:function(b,d){return b.indexOf(d)!=-1},decodeBase64DataUri:function(c){var e=";base64,",d=c.slice(0,c.indexOf(e))+e,b=c.substring(d.length);return JIRA.AttachImagesPlugin.base64decode(b)},validateFileSize:function(e){var b=a.dialogView.getFileSize();var d=a.dialogView.getMaxSize();if(b>d){var c=AJS.InlineAttach.Text.fileSize(d,b);e.fileUpload=AJS.format("Screenshot is too large to attach. Attachment is {0} but the largest allowed attachment is {1}.",c[1],c[0])}},validateFormData:function(b,d){var c={};if(AJS.$.isPlainObject(b)&&_.isEmpty(b)){c.fileUpload="Please paste the image you wish to upload"}a.validateFileSize(c);if(a.uploadError){c.fileUpload="The error occurred during image upload - you will need to try the pasting image again. Sorry for the inconvenience."}if(""==d){c.fileName="You must specify a filename of the image."}if(this.hasCharacter(d,"\\")||this.hasCharacter(d,"/")||this.hasCharacter(d,'"')||this.hasCharacter(d,":")||this.hasCharacter(d,"?")||this.hasCharacter(d,"*")||this.hasCharacter(d,"<")||this.hasCharacter(d,"|")||this.hasCharacter(d,">")){c.fileName="Filename must not contain the characters \', /, \", :, ?, *, \u003c, |, \u003e"}return c},doAjaxUpload:function(b,i){this.debug("attach image - doAjaxUpload");a.dialogView.disable();var h=[];a.validateFileSize(h);if(!_.isEmpty(h)){a.dialogView.displayErrors(h);a.dialogView.enable();return}var f=a.createData(),g=a.getMimeType(),d=AJS.$("#attach-screenshot-form").data("attach-secure-token"),c=AJS.$("#attach-screenshot-form").find("input[name='formToken']").attr("value");var e=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile"+(JIRA.AttachImagesPlugin.polyfill.isRequired()?"/secure?":"?")+"filename="+encodeURIComponent(i)+"&atl_token="+encodeURIComponent(atl_token())+"&issueId="+encodeURIComponent(this.dialogView.getIssueKey())+(d?("&secureToken="+encodeURIComponent(d)):"")+(c?("&formToken="+encodeURIComponent(c)):"");a.resetUploadErrors();a.executeAjaxUpload(f,e,g).progress(function(j){if(j=="init"){a.progressView.initProgress()}}).done(function(j){if(typeof j=="string"){j=JSON.parse(j)}a.dialogView.setFileToConvert(j.id)}).fail(function(l,n,m,j){var k;if(j.statusText=="abort"){k="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{k=JIRA.SmartAjax.buildSimpleErrorContent(j,{alert:false})}a.setUploadError(k);a.dialogView.displayErrors({fileUpload:k})}).always(function(){var j=AJS.$.Deferred();if(JIRA.AttachImagesPlugin.polyfill.isRequired()){a.reloadSecureToken(j)}else{j.resolve()}j.then(function(){a.dialogView.enable();a.progressView.finish()})}).progress(function(j){if(j!="init"){a.progressView.progressHandler(j)}})},executeAjaxUpload:function(d,c,e){var b=AJS.$.Deferred();JIRA.SmartAjax.makeRequest({type:"POST",url:c,contentType:e,processData:false,data:d,timeout:a.REQUEST_TIMEOUT_MILLIS,success:b.resolve.bind(b),error:b.reject.bind(b),xhr:function(){var f=AJS.$.ajaxSettings.xhr();b.notify("init");f.upload.addEventListener("progress",b.notify.bind(b));return f}});b.always(function(){AJS.$.ajaxSettings.xhr().removeEventListener("progress",a.progressView.progressHandler)});return b},reloadSecureToken:function(b){var c=AJS.contextPath()+"/secure/ShowAttachScreenshotFormAction!default.jspa?id="+encodeURIComponent(this.dialogView.getIssueKey())+"&inline=true&decorator=dialog&_="+(new Date().getTime());AJS.$.get(c).then(function(d){var e=AJS.$(d).find("#attach-screenshot-form").data("attach-secure-token");if(e){AJS.$("#attach-screenshot-form").data("attach-secure-token",e);b.resolve(e)}else{b.reject()}},_.bind(b.reject,b))},handleDrop:function(d){a.debug("handleDrop");a.dialogView.disable();var f=[];a.validateFileSize(f);if(!_.isEmpty(f)){a.dialogView.displayErrors(f);a.dialogView.enable();return}var e=a.createData();var b=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile/secure?filename="+fileName+"&atl_token="+atl_token()+"&issueId="+this.dialogView.getIssueKey()+"&secureToken="+AJS.$("#attach-screenshot-form").data("attach-secure-token");a.resetUploadErrors();var c=this.files||d.dataTransfer.files;if(c==="undefined"||c.length==0){alert("dnd.attachment.no.files")}else{a.uploadFiles(c)}},uploadFiles:function(c){a.debug("uploadFiles");var d={};for(var b=0;b<c.length;++b){d=c[b];break}this.dialogView.appendBlobImage(d)}};AJS.$(document).ready(function(){var b=JIRA.FormDialog.extend({options:{}});var d=AJS.$.Deferred();if(!JIRA.AttachImagesPlugin.browserIsSupported()||!JIRA.AttachImagesPlugin.polyfill.isRequired()){d.resolve()}JIRA.Dialogs.attachScreenshotDialog=new b({id:"attach-screenshot-dialog",trigger:"a.issueaction-attach-image",isIssueDialog:true,onContentRefresh:function c(){this.$form.bind("before-submit",function e(f){var g=a.validateFormData(a.screenshotFileUpload,AJS.$.trim(a.dialogView.getFileNameInput().val()));if(a.dialogView.getFileSize()==0){f.preventDefault();return false}else{if(!_.isEmpty(g)){a.dialogView.displayErrors(g);f.preventDefault();return false}}return true})},delayShowUntil:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(){b.prototype._submitForm=JIRA.AttachImagesPlugin.polyfill.proxyAjaxRequest(b.prototype._submitForm,function(){return AJS.$("#attach-screenshot-form").data("submit-secure-token")})}).always(function(){d.resolve()})}return d}});AJS.$(document).bind("dialogContentReady",function(f,e){if(e===JIRA.Dialogs.attachScreenshotDialog&&document.getElementById("attach-screenshot-form")!==null){a.initScreenshotPasteHandler()}});AJS.$(document).ready(function(){AJS.$(document).on("click","#attach-screenshot-html5",function(){AJS.EventQueue.push({name:"attach.screenshot.html5.display",properties:{}})})});if(a.dropFeatureEnabled){if(!a.dropHandlerConfigured){AJS.$(document).on("dragover",function(){}).on("dragleave drop",function(){}).on("dragover drop",false);AJS.$(document).on("drop",".attach-screenshot-image-container",function(f){a.handleDrop(f);a.dropHandlerConfigured=true})}}});return a})();
/* module-key = 'is.origo.jira.tempo-plugin:tempo-bar', location = 'com/tempoplugin/js/tempo.bar.js' */
var tempobar=tempobar||{};tempobar=(function(i){var B='<span class="issue"><span class="image"><a><img width="16" height="16" border="0" align="absmiddle"></a></span><span class="key"><a></a></span><span id="issue-tracker-summary-id" class="summary"><a></a></span></span>';var d=contextPath+"/rest/api/2/issue/";var x=contextPath+"/secure/TempoAddHours!default.jspa";var n=1000;var D=null;var p=null;var f="Tempo.TRACKER_ISTRACKING_";var c="Tempo.TRACKER_PREV_DURATION_";var E="Tempo.TRACKER_CYCLE_START_";var H="Tempo.TRACKER_INITIAL_START_";var C="Tempo.TRACKER_ISSUE_ID_";var m="Tempo.TRACKER_PAUSED_";var o="Tempo.SHOW_TRACKER_";var F="Tempo.EXPAND_TRACKER_";var G;function s(J){return AJS.Cookie.read(J+AJS.params.loggedInUser)}function u(J,K){return AJS.Cookie.save(J+AJS.params.loggedInUser,K)}function t(J){return AJS.Cookie.erase(J+AJS.params.loggedInUser)}function b(){return s(f)==="true"&&Number(s(E))>0}function k(){return(s(m)==="true")}function w(){return(s(o)==="true")}function y(){return(s(F)==="true")}function r(){return Number(s(c))+(new Date().getTime()-new Date(Number(s(E))).getTime())/1000}function a(M,N){if(M===null||M===undefined||M<=0){return"0m"}var L=Math.round(M);var O=L%60;var K;var J=Math.floor(L/3600);if(N){K=Math.floor(L/60)%60}else{K=Math.round(L/60)%60;if(K===0){J=Math.round(L/3600)}}var P="";if(J>0){P=P+J+"h"}if(K>=0){if(J>0){P=P+" "}P=P+K+"m"}if(N&&O){P=P+" "+O+"s"}return P.toString()}function q(){if(k()){var J=Number(s(c));if(J===null||J===undefined){J=0}return J}return r()}function e(K){var J=d+K;i.get(J,function(L){G={id:L.id,key:L.key,iconUrl:L.fields.issuetype.iconUrl,href:contextPath+"/browse/"+L.key,summary:L.fields.summary};l()})}function l(){if(w()&&!AJS.params.printable){var L=D.find("span.clock");L.show().text(a(q(),true));var M=s(C);if(M&&!G){e(M)}else{if(M&&G){var J=D.find("span.issue");var K=J.find("img");K.attr("src",G.iconUrl);J.find("span a").attr("href",G.href);J.find("span.key a").text(G.key).attr("data-id",G.id);J.find("span.summary a").text(G.summary);J.find("span.summary a").attr("title",G.summary);J.show()}}D.show()}if(b()&&!k()){clearTimeout(p);p=setTimeout(function(){l()},n)}}function z(K){var J=i("<a>",{href:"#","class":"tracker-button button aui-button aui-button-subtle",text:"",title:K});J.prepend('<span class="label"></span>');J.prepend('<span class="icon"></span>');return J}function g(){i(document).click()}function j(){var J=jira.app.issue.getIssueId()||AJS.$(".tempo-bar-start").data("issueid");if(J){u(C,J)}G=null}function v(){t(f);t(H);t(E);t(c);t(C);t(m)}function I(){t(o);t(F);v()}function h(){if(y()){i("#tempo-bar").removeClass("tempo-bar-expanded");i("#tempo-tracker-slider-id").removeClass("tracker-expanded");i("#issue-tracker-summary-id").addClass("hidden-actions");i(".tracker-button span.label").text("");u(F,"false")}else{i("#tempo-bar").addClass("tempo-bar-expanded");i("#tempo-tracker-slider-id").addClass("tracker-expanded");i("#issue-tracker-summary-id").removeClass("hidden-actions");i(".play span.label").text("Start");i(".pause span.label").text("Pause");i(".stop span.label").text("Stop");u(F,"true")}}function A(){if(AJS.params.loggedInUser===""){return}var O=i("<div>").attr("id","tempo-bar");var K=i("<div>").attr("id","tempo-tracker-slider-id");var M=i("<a>").attr("title","View timesheets and log work").attr("href",contextPath+"/secure/TempoUserBoard!timesheet.jspa").addClass("tempo-bar-logo").text("TEMPO");O.append(K).append(M).hide();if(b()||k()){i(O).find("#tempo-bar").addClass("tempo-bar-expanded tracker-not-started");i(O).find("#tempo-tracker-slider-id").addClass("tempo-tracker-slider aui-button aui-button-subtle");if(y()){i(O).find("#tempo-tracker-slider-id").addClass("tracker-expanded")}}var L=i('<span id="tempo-tracker-clock-id" class="clock"></span>');if(!b()&&!y()){L.addClass("hide-clock")}L.appendTo(O);i("#tempo-tracker-slider-id").live("click",function(){h()});var J=i("<a>",{id:"tempo-bar-close",href:contextPath+"/secure/TempoTrackerConfirmation!default.jspa?returnUrl="+document.URL,"class":"tempoaction-open-dialog-form aui-button aui-button-subtle",text:"Close Tracker",title:"Close Tracker"});J.bind("click",function(){if(!b()){I();O.hide();return false}return true});J.appendTo(O);var R=i('<ul id="tempo-tracker-actions" class="action-buttons ops aui-buttons"></ul>');var N=z("Start Tracker");N.addClass("play first last");R.append(N);var Q=z("Pause Tracker");Q.addClass("pause first");R.append(Q);var S=z("Stop Tracker");S.addClass("stop issueaction-tempo-add-hours-on-issue last");R.append(S);N.bind("click",function(T){if(!b()){u(f,"true");u(H,new Date().getTime());u(E,new Date().getTime());u(c,"0");i("#tempo-tracker-clock-id").removeClass("hide-clock");i("#tempo-tracker-slider-id").addClass("tempo-tracker-slider aui-button aui-button-subtle");j();l()}else{u(E,new Date().getTime());t(m);l()}i(".play span.label").text("");Q.show();N.hide();S.show();T.preventDefault()});Q.bind("click",function(T){Q.hide();N.removeClass("last").show();if(b()){u(c,r());u(m,"true")}T.preventDefault()});S.bind("click",function(){if(b()){clearTimeout(p);var T=new Date(Number(s(H)));var U=x+"?tracker=true&systemTimeStamp="+T.getTime();l();if(G&&G.key){U+="&key="+G.key}S.attr("href",U+"&time="+a(q(),false));h();return true}return false});R.appendTo(O);var P=i(B).hide();P.appendTo(O);O.appendTo("body");if(!y()){i("#issue-tracker-summary-id").addClass("hidden-actions")}i("a.tempo-bar-show").click(function(){u(o,"true");i("#tempo-tracker-slider-id").removeClass("tempo-tracker-slider aui-button aui-button-subtle");l();g();return false});i("a.tempo-bar-start").live("click",function(){j();if(b()){l()}else{u(o,"true");N.trigger("click")}g();return false});D=O;if(b()&&!k()){Q.show();N.hide()}else{Q.hide();N.removeClass("last").show()}if(!b()){i(".play span.label").text("Start");S.hide();N.addClass("last")}l()}return{init:A,clearTracker:I,stopTracker:v}}(AJS.$));AJS.$(function(){tempobar.init()});
/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList63 = opt_data.labels;
  var labelListLen63 = labelList63.length;
  for (var labelIndex63 = 0; labelIndex63 < labelListLen63; labelIndex63++) {
    var labelData63 = labelList63[labelIndex63];
    bamboo.components.labelItem(soy.$$augmentData(labelData63, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData63.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(f){var j=AJS.$.ajax;var h="atlassian-analytics";var e=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var d=null;var m=null;var c=null;var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var s=Math.random()*16|0,q=t=="x"?s:(s&3|8);return q.toString(16)});var a=function(){var q="unknown";if(document.body.id=="jira"){q="jira"}else{if(document.body.id=="com-atlassian-confluence"){q="confluence"}}m=h+"."+q;c=m+".lock"};var o=function(){if(store.get(c)){return false}store.set(c,b);return(store.get(c)===b)};var k=function(){store.set(c,null)};var g=function(){var r=[],t,u,q,s;if(AJS.EventQueue.length==0){return}r=store.get(m)||r;for(q=0,s=AJS.EventQueue.length;q<s;++q){u=AJS.EventQueue[q];if(u.name){t={name:u.name,properties:u.properties,analyticsEnabled:u.analyticsEnabled,time:u.time||0};r.push(t)}}AJS.EventQueue.length=0;store.set(m,r)};var l=function(){var r;if(!o()){return}g();r=store.get(m);if(r&&r.length){store.remove(m);k();var s=new Date().getTime();for(var q=0;q<r.length;q++){if(r[q].time>0){r[q].timeDelta=r[q].time-s}else{r[q].timeDelta=q-r.length}delete r[q].time}d=j({type:"POST",url:e+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(r),contentType:"application/json",dataType:"json"});d.fail(function(){AJS.EventQueue.concat(r);g()})}else{k()}};var n=function(){if(d&&!(d.state()==="resolved"||d.state()==="rejected")){d.abort()}};AJS.EventQueue=AJS.EventQueue||[];var i=Array.prototype.push;AJS.EventQueue.push=function(q){q.time=new Date().getTime();i.call(AJS.EventQueue,q)};AJS.toInit(function(){a();l();setInterval(l,5000);p()});f(window).unload(function(){n();g()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(q,r){AJS.EventQueue.push({name:q,properties:r,analyticsEnabled:true})}};AJS.bind("analytics",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});AJS.bind("analyticsEvent",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});var p=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var r=AJS.$(":contains(Enable Atlassian analytics)");if(r.size()>0){var q=r[r.size()-2];if(q){q.remove()}}}}}}(AJS.$));
/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */

/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function(){var $hiddenImg=AJS.$("<img>"),$iconUrlInput,$urlInput,faviconUrl,throbberTimeoutId;$hiddenImg.load(function(){$iconUrlInput.val(faviconUrl);$urlInput.css("background-image",'url("'+faviconUrl+'")');clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});$hiddenImg.error(function(){clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});function init(context){$iconUrlInput=AJS.$("#web-link-icon-url",context);$urlInput=AJS.$("#web-link-url",context).bind("change",fetchFavicon);if($iconUrlInput.val()){$urlInput.css("background-image","url("+$iconUrlInput.val()+")")}}function fetchFavicon(){$hiddenImg.attr("src","");$iconUrlInput.val("");$urlInput.css("background-image","");faviconUrl=parseFaviconUrl($urlInput.val());if(!faviconUrl){return }setTimeout(function(){$urlInput.addClass("loading")},0);throbberTimeoutId=setTimeout(function(){$urlInput.removeClass("loading")},3000);$hiddenImg.attr("src",faviconUrl)}function parseFaviconUrl(url){var hostUrl=url.match(/^([^/]*\/\/[^/]+)/)[1];if(!hostUrl){return }return hostUrl+"/favicon.ico"}JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){init(context)})})();
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#issue-link-confluence-app-id",context).val()},shouldExecute:function(context){return $("#confluence-page-link",context).length!==0}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){IssueLinkAppLinks.init(settings,context)})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function($){var confluenceSearchDialog=new JIRA.FormDialog({id:"confluence-page-search-dialog",trigger:"#confluence-page-link .confluence-search-trigger",widthClass:"large",height:"565px",content:function(render){var dialog=this;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/applink",complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var appLinks=smartAjaxResult.data.applicationLinks;render(JIRA.Templates.ConfluencePageSearch.result({appLinks:appLinks}));initAppLinks(dialog.$popup).done(function(context,helper){initSearchDialog(context,helper);$("#link-search-text",context).focus()})}else{AJS.messages.error("#search-results-table",{body:"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",closeable:false});render()}}})},submitHandler:function(e,callback){e.preventDefault();$("#search-panel-button").click().removeAttr("disabled");callback()}});function initSearchDialog($dialog,helper){$("#confluence-app-link",$dialog).change(function(){var authenticationRequired=helper.selectServer($(this).val()).authenticationRequired;if(!authenticationRequired){populateSpaces($dialog,$(this).val(),helper)}$("#search-results-table",$dialog).empty();setSearchControlsEnabled(true,$dialog)});$("#search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false})}var spaceAjaxId=0;function populateSpaces($context,appId,helper){$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());var myAjaxId=++spaceAjaxId;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/space?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){if(myAjaxId!==spaceAjaxId){return }if(smartAjaxResult.successful){var spaces=smartAjaxResult.data.spaces;$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces:spaces}))}else{if(smartAjaxResult.status===401){helper.setAuthenticationRequired(appId,true)}else{setSearchControlsEnabled(false,$context);var msg;if(smartAjaxResult.status===403){msg="Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content."}else{msg="Unable to gather information from the selected Confluence instance."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}}}})}function setSearchControlsEnabled(enabled,$context){if(enabled){$("#link-search-text",$context).removeAttr("disabled");$("#search-panel-space",$context).removeAttr("disabled");$("#search-panel-button",$context).removeAttr("disabled")}else{$("#link-search-text",$context).attr("disabled","disabled");$("#search-panel-space",$context).attr("disabled","disabled");$("#search-panel-button",$context).attr("disabled","disabled")}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function doSearch(searchText,$context){setLoadingIconVisible(true,$context);var appLinkId=$("#confluence-app-link",$context).val();var spaceKey=$("#search-panel-space option:selected",$context).val();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/search?query="+searchText+"&appId="+appLinkId+"&spaceKey="+spaceKey+"&maxResults=10",complete:function(xhr,textStatus,smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){var results=smartAjaxResult.data.result;var resultHtml=JIRA.Templates.ConfluencePageSearch.resultsTable({results:results});$("#search-results-table",$context).html(resultHtml)}else{var msg;if(smartAjaxResult.hasData){msg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{msg="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}$("#confluence-searchresult tbody tr",$context).click(function(){var linkUrl=$(this).children().first().data("url");$("#confluence-page-url").val(linkUrl);$("#link-issue-dialog .error").hide();confluenceSearchDialog.hide();$("#link-issue-dialog").show();$("#confluence-page-url").focus().select()})}})}function initAppLinks($dialog){var settings={getCurrentAppId:function(context){return $("#confluence-app-link",context).val()},shouldExecute:function(context){return $("#confluence-app-link",context).length!==0},onAuthenticationSuccessCallback:function(context,currentAppId,helper){populateSpaces(context,currentAppId,helper)}};return IssueLinkAppLinks.init(settings,$dialog).done(function(context,helper){populateSpaces(context,settings.getCurrentAppId(context),helper)})}});
/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'lib/brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View);if(typeof JIRA==="undefined"){JIRA={}}if(!JIRA.Issues){JIRA.Issues={}}JIRA.Issues.Brace=k}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:lib', location = 'namespaces.js' */
JIRA.Components=JIRA.Components||{};JIRA.Issues=JIRA.Issues||{};JIRA.Events=JIRA.Events||{};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'lib/jquery.hoverIntent.min.js' */
/**
* hoverIntent r6 // 2011.02.26 // jQuery 1.5.1+
* <http://cherne.net/brian/resources/jquery.hoverIntent.html>
* 
* @param  f  onMouseOver function || An object with configuration options
* @param  g  onMouseOut function  || Nothing (use configuration options object)
* @author    Brian Cherne brian(at)cherne(dot)net
*/
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:tipsy', location = 'util/TipsyView.js' */
if(!jQuery.fn.tooltip){jQuery.fn.tooltip=jQuery.noop;jQuery.fn.tipsy=jQuery.noop}JIRA.Issues.Tipsy=JIRA.Issues.Brace.View.extend({events:{click:"hide"},initialize:function(a){if(_.isFunction(a.showCondition)){this.shouldShow=a.showCondition}else{if(a.showCondition){this.shouldShow=_.bind(function(){return this.$el.filter(a.showCondition).length>0},this)}else{this.shouldShow=function(){return true}}}this.tipsy=this.$el.tooltip(_.extend({trigger:"manual"},a.tipsy));this.hoverIntent(a.intents)},hoverIntent:function(a){if(this.tipsy){this.tipsy.hoverIntent(_.extend({interval:200,over:_.bind(this.show,this),out:_.bind(this.hide,this)},a))}return this},show:function(){if(this.shouldShow()&&this.tipsy){this.$el.tipsy("show")}},hide:function(){if(this.tipsy){this.$el.tipsy("hide")}},remove:function(){this.hide();this.$el.removeData("tipsy")}});JIRA.Issues.Tipsy.revalidate=function(){return jQuery.fn.tipsy.revalidate()};JIRA.Issues.Tipsy.autoBounds=function(){return jQuery.fn.tipsy.autoBounds.apply(jQuery.fn.tipsy,arguments)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/CatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/RecurringPromise.js' */
jQuery.RecurringPromise=function(a){if(!(this instanceof jQuery.RecurringPromise)){return new jQuery.RecurringPromise()}this._parent=a;this._doneCallbacks=jQuery.Callbacks();this._failCallbacks=jQuery.Callbacks();this._alwaysCallbacks=jQuery.Callbacks()};jQuery.RecurringPromise.prototype={add:function(b){var a=jQuery.Deferred();a.original=b;var c=this._getPending();this._abortIfPending(c);this._setPending(a);b.done(_.bind(function(){if(a===this._getPending()){a.resolveWith(this,arguments);this._doneCallbacks.fireWith(this,arguments)}},this));b.fail(_.bind(function(){if(a===this._getPending()){a.rejectWith(this,arguments);this._failCallbacks.fireWith(this,arguments)}},this));b.always(_.bind(function(){if(a===this._getPending()){this._alwaysCallbacks.fireWith(this,arguments)}},this));return a.promise()},done:function(a){this._doneCallbacks.add(a);return this},fail:function(a){this._failCallbacks.add(a);return this},always:function(a){this._alwaysCallbacks.add(a);return this},reset:function(){this._abortIfPending(this._getPending());this._setPending(null)},sub:function(){return new jQuery.RecurringPromise(this)},_getPending:function(){return this._parent?this._parent._getPending():this._pending},_setPending:function(a){if(this._parent){this._parent._setPending(a)}else{this._pending=a}},_abortIfPending:function(a){if(a&&a.state()==="pending"){a.reject("abort");if(jQuery.isFunction(a.original.abort)){a.original.abort()}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ConcurrentDeferred.js' */
jQuery.ConcurrentDeferred=function(c){var b=jQuery.Deferred();var d;var a=function(e){d=e;e.done(function(){if(d===e){b.resolve.apply(b,arguments)}}).fail(function(){if(d===e){b.reject.apply(b,arguments)}})};a(c);jQuery.extend(b,{update:function(e){if(!this.isPending()){throw"Cannot update non-pending ConcurrentDeferred"}var f=d;a(e);if(jQuery.isFunction(f.abort)){f.abort()}return this},isPending:function(){return this.state()==="pending"}});return b};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:jqueryutils', location = 'util/jquery/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-events-patch.js' */
(function(){var a=[Backbone.View.prototype,Backbone.Events,Backbone.Model.prototype];if(!Backbone.Events.listenTo){b("listenTo","on")}if(!Backbone.Events.listenToOnce){b("listenToOnce","once")}function b(d,c){_.each(a,function(e){e[d]=function(h,f,j){var g=this._listeners||(this._listeners={});var i=h._listenerId||(h._listenerId=_.uniqueId("l"));g[i]=h;if(typeof f==="object"){j=this}h[c](f,j,this);return this}})}_.each(a,function(c){c.stopListening=function(g,d,i){var e=this._listeners;if(!e){return this}var f=!d&&!i;if(typeof d==="object"){i=this}if(g){(e={})[g._listenerId]=g}for(var h in e){e[h].off(d,i,this);if(f){delete this._listeners[h]}}return this}})}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/patches/backbone-0.9.2-misc-patch.js' */
(function(){Backbone.View.prototype.remove=_.compose(function(a){this.stopListening();return a},Backbone.View.prototype.remove);Backbone.$=AJS.$}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/backbone.marionette-noconflict-1.4.1.js' */
/*!
 * Includes BabySitter
 * https://github.com/marionettejs/backbone.babysitter/
 *
 * Includes Wreqr
 * https://github.com/marionettejs/backbone.wreqr/
 */
(function(){var b=this;var a=b.Marionette;Backbone.ChildViewContainer=(function(g,f){var d=function(h){this._views={};this._indexByModel={};this._indexByCustom={};this._updateLength();f.each(h,this.add,this)};f.extend(d.prototype,{add:function(h,j){var i=h.cid;this._views[i]=h;if(h.model){this._indexByModel[h.model.cid]=i}if(j){this._indexByCustom[j]=i}this._updateLength()},findByModel:function(h){return this.findByModelCid(h.cid)},findByModelCid:function(h){var i=this._indexByModel[h];return this.findByCid(i)},findByCustom:function(i){var h=this._indexByCustom[i];return this.findByCid(h)},findByIndex:function(h){return f.values(this._views)[h]},findByCid:function(h){return this._views[h]},remove:function(h){var i=h.cid;if(h.model){delete this._indexByModel[h.model.cid]}f.any(this._indexByCustom,function(k,j){if(k===i){delete this._indexByCustom[j];return true}},this);delete this._views[i];this._updateLength()},call:function(h){this.apply(h,f.tail(arguments))},apply:function(i,h){f.each(this._views,function(j){if(f.isFunction(j[i])){j[i].apply(j,h||[])}})},_updateLength:function(){this.length=f.size(this._views)}});var e=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];f.each(e,function(h){d.prototype[h]=function(){var i=f.values(this._views);var j=[i].concat(f.toArray(arguments));return f[h].apply(f,j)}});return d})(Backbone,_);Backbone.Wreqr=(function(g,f,d){var e={};e.Handlers=(function(j,i){var h=function(k){this.options=k;this._wreqrHandlers={};if(i.isFunction(this.initialize)){this.initialize(k)}};h.extend=j.Model.extend;i.extend(h.prototype,j.Events,{setHandlers:function(k){i.each(k,function(n,l){var m=null;if(i.isObject(n)&&!i.isFunction(n)){m=n.context;n=n.callback}this.setHandler(l,n,m)},this)},setHandler:function(l,n,m){var k={callback:n,context:m};this._wreqrHandlers[l]=k;this.trigger("handler:add",l,n,m)},hasHandler:function(k){return !!this._wreqrHandlers[k]},getHandler:function(l){var k=this._wreqrHandlers[l];if(!k){throw new Error("Handler not found for '"+l+"'")}return function(){var m=Array.prototype.slice.apply(arguments);return k.callback.apply(k.context,m)}},removeHandler:function(k){delete this._wreqrHandlers[k]},removeAllHandlers:function(){this._wreqrHandlers={}}});return h})(g,d);e.CommandStorage=(function(){var h=function(i){this.options=i;this._commands={};if(d.isFunction(this.initialize)){this.initialize(i)}};d.extend(h.prototype,g.Events,{getCommands:function(j){var i=this._commands[j];if(!i){i={command:j,instances:[]};this._commands[j]=i}return i},addCommand:function(j,i){var k=this.getCommands(j);k.instances.push(i)},clearCommands:function(i){var j=this.getCommands(i);j.instances=[]}});return h})();e.Commands=(function(h){return h.Handlers.extend({storageType:h.CommandStorage,constructor:function(j){this.options=j||{};this._initializeStorage(this.options);this.on("handler:add",this._executeCommands,this);var i=Array.prototype.slice.call(arguments);h.Handlers.prototype.constructor.apply(this,i)},execute:function(j,i){j=arguments[0];i=Array.prototype.slice.call(arguments,1);if(this.hasHandler(j)){this.getHandler(j).apply(this,i)}else{this.storage.addCommand(j,i)}},_executeCommands:function(i,k,j){var l=this.storage.getCommands(i);d.each(l.instances,function(m){k.apply(j,m)});this.storage.clearCommands(i)},_initializeStorage:function(i){var k;var j=i.storageType||this.storageType;if(d.isFunction(j)){k=new j()}else{k=j}this.storage=k}})})(e);e.RequestResponse=(function(h){return h.Handlers.extend({request:function(){var j=arguments[0];var i=Array.prototype.slice.call(arguments,1);return this.getHandler(j).apply(this,i)}})})(e);e.EventAggregator=(function(j,h){var i=function(){};i.extend=j.Model.extend;h.extend(i.prototype,j.Events);return i})(g,d);return e})(Backbone,Backbone.Marionette,_);var c=(function(e,j,d){var i={};j.Marionette=i;i.$=j.$;var f=Array.prototype.slice;function g(k){return f.call(k)}function h(m,l){var k=new Error(m);k.name=l||"Error";throw k}i.extend=j.Model.extend;i.getOption=function(m,k){if(!m||!k){return}var l;if(m.options&&(k in m.options)&&(m.options[k]!==undefined)){l=m.options[k]}else{l=m[k]}return l};i.triggerMethod=(function(){var l=/(^|:)(\w)/gi;function m(o,p,n){return n.toUpperCase()}var k=function(o){var n="on"+o.replace(l,m);var p=this[n];if(d.isFunction(this.trigger)){this.trigger.apply(this,arguments)}if(d.isFunction(p)){return p.apply(this,d.tail(arguments))}};return k})();i.MonitorDOMRefresh=(function(){function m(n){n._isShown=true;k(n)}function l(n){n._isRendered=true;k(n)}function k(n){if(n._isShown&&n._isRendered){if(d.isFunction(n.triggerMethod)){n.triggerMethod("dom:refresh")}}}return function(n){n.listenTo(n,"show",function(){m(n)});n.listenTo(n,"render",function(){l(n)})}})();(function(p){function o(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];if(!w){h("Method '"+v+"' was configured as an event handler, but does not exist.")}u.listenTo(s,q,w,u)})}function k(s,r,q,t){s.listenTo(r,q,t,s)}function m(u,s,q,r){var t=r.split(/\s+/);d.each(t,function(v){var w=u[v];u.stopListening(s,q,w,u)})}function l(s,r,q,t){s.stopListening(r,q,t,s)}function n(t,q,u,s,r){if(!q||!u){return}if(d.isFunction(u)){u=u.call(t)}d.each(u,function(w,v){if(d.isFunction(w)){s(t,q,v,w)}else{r(t,q,v,w)}})}p.bindEntityEvents=function(r,q,s){n(r,q,s,k,o)};p.unbindEntityEvents=function(r,q,s){n(r,q,s,l,m)}})(i);i.Callbacks=function(){this._deferred=i.$.Deferred();this._callbacks=[]};d.extend(i.Callbacks.prototype,{add:function(l,k){this._callbacks.push({cb:l,ctx:k});this._deferred.done(function(n,m){if(k){n=k}l.call(n,m)})},run:function(k,l){this._deferred.resolve(l,k)},reset:function(){var k=this._callbacks;this._deferred=i.$.Deferred();this._callbacks=[];d.each(k,function(l){this.add(l.cb,l.ctx)},this)}});i.Controller=function(k){this.triggerMethod=i.triggerMethod;this.options=k||{};if(d.isFunction(this.initialize)){this.initialize(this.options)}};i.Controller.extend=i.extend;d.extend(i.Controller.prototype,j.Events,{close:function(){this.stopListening();this.triggerMethod("close");this.unbind()}});i.Region=function(l){this.options=l||{};this.el=i.getOption(this,"el");if(!this.el){var m=new Error("An 'el' must be specified for a region.");m.name="NoElError";throw m}if(this.initialize){var k=Array.prototype.slice.apply(arguments);this.initialize.apply(this,k)}};d.extend(i.Region,{buildRegion:function(l,r){var p=(typeof l==="string");var o=(typeof l.selector==="string");var s=(typeof l.regionType==="undefined");var m=(typeof l==="function");if(!m&&!p&&!o){throw new Error("Region must be specified as a Region type, a selector string or an object with selector property")}var k,n;if(p){k=l}if(l.selector){k=l.selector}if(m){n=l}if(!m&&s){n=r}if(l.regionType){n=l.regionType}var q=new n({el:k});if(l.parentEl){q.getEl=function(t){var u=l.parentEl;if(d.isFunction(u)){u=u()}return u.find(t)}}return q}});d.extend(i.Region.prototype,j.Events,{show:function(m){this.ensureEl();var k=m.isClosed||d.isUndefined(m.$el);var l=m!==this.currentView;if(l){this.close()}m.render();if(l||k){this.open(m)}this.currentView=m;i.triggerMethod.call(this,"show",m);i.triggerMethod.call(m,"show")},ensureEl:function(){if(!this.$el||this.$el.length===0){this.$el=this.getEl(this.el)}},getEl:function(k){return i.$(k)},open:function(k){this.$el.empty().append(k.el)},close:function(){var k=this.currentView;if(!k||k.isClosed){return}if(k.close){k.close()}else{if(k.remove){k.remove()}}i.triggerMethod.call(this,"close");delete this.currentView},attachView:function(k){this.currentView=k},reset:function(){this.close();delete this.$el}});i.Region.extend=i.extend;i.RegionManager=(function(m){var l=m.Controller.extend({constructor:function(n){this._regions={};m.Controller.prototype.constructor.call(this,n)},addRegions:function(n,o){var p={};d.each(n,function(r,q){if(typeof r==="string"){r={selector:r}}if(r.selector){r=d.defaults({},r,o)}var s=this.addRegion(q,r);p[q]=s},this);return p},addRegion:function(p,q){var s;var o=d.isObject(q);var n=d.isString(q);var r=!!q.selector;if(n||(o&&r)){s=m.Region.buildRegion(q,m.Region)}else{if(d.isFunction(q)){s=m.Region.buildRegion(q,m.Region)}else{s=q}}this._store(p,s);this.triggerMethod("region:add",p,s);return s},get:function(n){return this._regions[n]},removeRegion:function(n){var o=this._regions[n];this._remove(n,o)},removeRegions:function(){d.each(this._regions,function(o,n){this._remove(n,o)},this)},closeRegions:function(){d.each(this._regions,function(o,n){o.close()},this)},close:function(){this.removeRegions();var n=Array.prototype.slice.call(arguments);m.Controller.prototype.close.apply(this,n)},_store:function(n,o){this._regions[n]=o;this._setLength()},_remove:function(n,o){o.close();delete this._regions[n];this._setLength();this.triggerMethod("region:remove",n,o)},_setLength:function(){this.length=d.size(this._regions)}});var k=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];d.each(k,function(n){l.prototype[n]=function(){var p=d.values(this._regions);var o=[p].concat(d.toArray(arguments));return d[n].apply(d,o)}});return l})(i);i.TemplateCache=function(k){this.templateId=k};d.extend(i.TemplateCache,{templateCaches:{},get:function(k){var l=this.templateCaches[k];if(!l){l=new i.TemplateCache(k);this.templateCaches[k]=l}return l.load()},clear:function(){var l;var k=g(arguments);var m=k.length;if(m>0){for(l=0;l<m;l++){delete this.templateCaches[k[l]]}}else{this.templateCaches={}}}});d.extend(i.TemplateCache.prototype,{load:function(){if(this.compiledTemplate){return this.compiledTemplate}var k=this.loadTemplate(this.templateId);this.compiledTemplate=this.compileTemplate(k);return this.compiledTemplate},loadTemplate:function(k){var l=i.$(k).html();if(!l||l.length===0){h("Could not find template: '"+k+"'","NoTemplateError")}return l},compileTemplate:function(k){return d.template(k)}});i.Renderer={render:function(m,n){if(!m){var k=new Error("Cannot render the template since it's false, null or undefined.");k.name="TemplateNotFoundError";throw k}var l;if(typeof m==="function"){l=m}else{l=i.TemplateCache.get(m)}return l(n)}};i.View=j.View.extend({constructor:function(l){d.bindAll(this,"render");var k=Array.prototype.slice.apply(arguments);this.options=d.extend({},this.options,l);this.events=this.normalizeUIKeys(d.result(this,"events"));j.View.prototype.constructor.apply(this,k);i.MonitorDOMRefresh(this);this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:i.triggerMethod,getTemplate:function(){return i.getOption(this,"template")},mixinTemplateHelpers:function(k){k=k||{};var l=i.getOption(this,"templateHelpers");if(d.isFunction(l)){l=l.call(this)}return d.extend(k,l)},normalizeUIKeys:function(k){if(typeof(k)==="undefined"){return}d.each(d.keys(k),function(l){var m=l.split("@ui.");if(m.length===2){k[m[0]+this.ui[m[1]]]=k[l];delete k[l]}},this);return k},configureTriggers:function(){if(!this.triggers){return}var l={};var k=this.normalizeUIKeys(d.result(this,"triggers"));d.each(k,function(o,n){var p=d.isObject(o);var m=p?o.event:o;l[n]=function(v){if(v){var q=v.preventDefault;var u=v.stopPropagation;var t=p?o.preventDefault:q;var s=p?o.stopPropagation:u;if(t&&q){q.apply(v)}if(s&&u){u.apply(v)}}var r={view:this,model:this.model,collection:this.collection};this.triggerMethod(m,r)}},this);return l},delegateEvents:function(k){this._delegateDOMEvents(k);i.bindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.bindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(k){k=k||this.events;if(d.isFunction(k)){k=k.call(this)}var m={};var l=this.configureTriggers();d.extend(m,k,l);j.View.prototype.delegateEvents.call(this,m)},undelegateEvents:function(){var k=Array.prototype.slice.call(arguments);j.View.prototype.undelegateEvents.apply(this,k);i.unbindEntityEvents(this,this.model,i.getOption(this,"modelEvents"));i.unbindEntityEvents(this,this.collection,i.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(this.isClosed){return}var k=this.triggerMethod("before:close");if(k===false){return}this.isClosed=true;this.triggerMethod("close");this.unbindUIElements();this.remove()},bindUIElements:function(){if(!this.ui){return}if(!this._uiBindings){this._uiBindings=this.ui}var k=d.result(this,"_uiBindings");this.ui={};d.each(d.keys(k),function(m){var l=k[m];this.ui[m]=this.$(l)},this)},unbindUIElements:function(){if(!this.ui||!this._uiBindings){return}d.each(this.ui,function(l,k){delete this.ui[k]},this);this.ui=this._uiBindings;delete this._uiBindings}});i.ItemView=i.View.extend({constructor:function(){i.View.prototype.constructor.apply(this,g(arguments))},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}else{if(this.collection){k={items:this.collection.toJSON()}}}return k},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.triggerMethod("item:before:render",this);var m=this.serializeData();m=this.mixinTemplateHelpers(m);var l=this.getTemplate();var k=i.Renderer.render(l,m);this.$el.html(k);this.bindUIElements();this.triggerMethod("render",this);this.triggerMethod("item:rendered",this);return this},close:function(){if(this.isClosed){return}this.triggerMethod("item:before:close");i.View.prototype.close.apply(this,g(arguments));this.triggerMethod("item:closed")}});i.CollectionView=i.View.extend({itemViewEventPrefix:"itemview",constructor:function(k){this._initChildViewStorage();i.View.prototype.constructor.apply(this,g(arguments));this._initialEvents();this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment()},startBuffering:function(){this.initRenderBuffer();this.isBuffering=true},endBuffering:function(){this.appendBuffer(this,this.elBuffer);this.initRenderBuffer();this.isBuffering=false},_initialEvents:function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this.render,this)}},addChildView:function(n,o,l){this.closeEmptyView();var m=this.getItemView(n);var k=this.collection.indexOf(n);this.addItemView(n,m,k)},onShowCalled:function(){this.children.each(function(k){i.triggerMethod.call(k,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this);this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this);this.triggerMethod("collection:rendered",this)},render:function(){this.isClosed=false;this.triggerBeforeRender();this._renderChildren();this.triggerRendered();return this},_renderChildren:function(){this.startBuffering();this.closeEmptyView();this.closeChildren();if(this.collection&&this.collection.length>0){this.showCollection()}else{this.showEmptyView()}this.endBuffering()},showCollection:function(){var k;this.collection.each(function(m,l){k=this.getItemView(m);this.addItemView(m,k,l)},this)},showEmptyView:function(){var l=this.getEmptyView();if(l&&!this._showingEmptyView){this._showingEmptyView=true;var k=new j.Model();this.addItemView(k,l,0)}},closeEmptyView:function(){if(this._showingEmptyView){this.closeChildren();delete this._showingEmptyView}},getEmptyView:function(){return i.getOption(this,"emptyView")},getItemView:function(l){var k=i.getOption(this,"itemView");if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},addItemView:function(n,m,l){var o=i.getOption(this,"itemViewOptions");if(d.isFunction(o)){o=o.call(this,n,l)}var k=this.buildItemView(n,m,o);this.addChildViewEventForwarding(k);this.triggerMethod("before:item:added",k);this.children.add(k);this.renderItemView(k,l);if(this._isShown){i.triggerMethod.call(k,"show")}this.triggerMethod("after:item:added",k)},addChildViewEventForwarding:function(k){var l=i.getOption(this,"itemViewEventPrefix");this.listenTo(k,"all",function(){var m=g(arguments);m[0]=l+":"+m[0];m.splice(1,0,k);i.triggerMethod.apply(this,m)},this)},renderItemView:function(k,l){k.render();this.appendHtml(this,k,l)},buildItemView:function(m,k,n){var l=d.extend({model:m},n);return new k(l)},removeItemView:function(l){var k=this.children.findByModel(l);this.removeChildView(k);this.checkEmpty()},removeChildView:function(k){if(k){this.stopListening(k);if(k.close){k.close()}else{if(k.remove){k.remove()}}this.children.remove(k)}this.triggerMethod("item:removed",k)},checkEmpty:function(){if(!this.collection||this.collection.length===0){this.showEmptyView()}},appendBuffer:function(l,k){l.$el.append(k)},appendHtml:function(k,m,l){if(k.isBuffering){k.elBuffer.appendChild(m.el)}else{k.$el.append(m.el)}},_initChildViewStorage:function(){this.children=new j.ChildViewContainer()},close:function(){if(this.isClosed){return}this.triggerMethod("collection:before:close");this.closeChildren();this.triggerMethod("collection:closed");i.View.prototype.close.apply(this,g(arguments))},closeChildren:function(){this.children.each(function(k){this.removeChildView(k)},this);this.checkEmpty()}});i.CompositeView=i.CollectionView.extend({constructor:function(){i.CollectionView.prototype.constructor.apply(this,g(arguments))},_initialEvents:function(){this.once("render",function(){if(this.collection){this.listenTo(this.collection,"add",this.addChildView,this);this.listenTo(this.collection,"remove",this.removeItemView,this);this.listenTo(this.collection,"reset",this._renderChildren,this)}})},getItemView:function(l){var k=i.getOption(this,"itemView")||this.constructor;if(!k){h("An `itemView` must be specified","NoItemViewError")}return k},serializeData:function(){var k={};if(this.model){k=this.model.toJSON()}return k},render:function(){this.isRendered=true;this.isClosed=false;this.resetItemViewContainer();this.triggerBeforeRender();var k=this.renderModel();this.$el.html(k);this.bindUIElements();this.triggerMethod("composite:model:rendered");this._renderChildren();this.triggerMethod("composite:rendered");this.triggerRendered();return this},_renderChildren:function(){if(this.isRendered){i.CollectionView.prototype._renderChildren.call(this);this.triggerMethod("composite:collection:rendered")}},renderModel:function(){var l={};l=this.serializeData();l=this.mixinTemplateHelpers(l);var k=this.getTemplate();return i.Renderer.render(k,l)},appendBuffer:function(l,k){var m=this.getItemViewContainer(l);m.append(k)},appendHtml:function(k,m,l){if(k.isBuffering){k.elBuffer.appendChild(m.el)}else{var n=this.getItemViewContainer(k);n.append(m.el)}},getItemViewContainer:function(n){if("$itemViewContainer" in n){return n.$itemViewContainer}var l;var m=i.getOption(n,"itemViewContainer");if(m){var k=d.isFunction(m)?m():m;l=n.$(k);if(l.length<=0){h("The specified `itemViewContainer` was not found: "+n.itemViewContainer,"ItemViewContainerMissingError")}}else{l=n.$el}n.$itemViewContainer=l;return l},resetItemViewContainer:function(){if(this.$itemViewContainer){delete this.$itemViewContainer}}});i.Layout=i.ItemView.extend({regionType:i.Region,constructor:function(k){k=k||{};this._firstRender=true;this._initializeRegions(k);i.ItemView.prototype.constructor.call(this,k)},render:function(){if(this.isClosed){this._initializeRegions()}if(this._firstRender){this._firstRender=false}else{if(!this.isClosed){this._reInitializeRegions()}}var l=Array.prototype.slice.apply(arguments);var k=i.ItemView.prototype.render.apply(this,l);return k},close:function(){if(this.isClosed){return}this.regionManager.close();var k=Array.prototype.slice.apply(arguments);i.ItemView.prototype.close.apply(this,k)},addRegion:function(k,l){var m={};m[k]=l;return this._buildRegions(m)[k]},addRegions:function(k){this.regions=d.extend({},this.regions,k);return this._buildRegions(k)},removeRegion:function(k){delete this.regions[k];return this.regionManager.removeRegion(k)},_buildRegions:function(m){var k=this;var l={regionType:i.getOption(this,"regionType"),parentEl:function(){return k.$el}};return this.regionManager.addRegions(m,l)},_initializeRegions:function(k){var l;this._initRegionManager();if(d.isFunction(this.regions)){l=this.regions(k)}else{l=this.regions||{}}this.addRegions(l)},_reInitializeRegions:function(){this.regionManager.closeRegions();this.regionManager.each(function(k){k.reset()})},_initRegionManager:function(){this.regionManager=new i.RegionManager();this.listenTo(this.regionManager,"region:add",function(k,l){this[k]=l;this.trigger("region:add",k,l)});this.listenTo(this.regionManager,"region:remove",function(k,l){delete this[k];this.trigger("region:remove",k,l)})}});i.AppRouter=j.Router.extend({constructor:function(l){j.Router.prototype.constructor.apply(this,g(arguments));this.options=l||{};var m=i.getOption(this,"appRoutes");var k=this._getController();this.processAppRoutes(k,m)},appRoute:function(m,l){var k=this._getController();this._addAppRoute(k,m,l)},processAppRoutes:function(k,m){if(!m){return}var l=d.keys(m).reverse();d.each(l,function(n){this._addAppRoute(k,n,m[n])},this)},_getController:function(){return i.getOption(this,"controller")},_addAppRoute:function(k,m,l){var n=k[l];if(!n){throw new Error("Method '"+l+"' was not found on the controller")}this.route(m,l,d.bind(n,k))}});i.Application=function(k){this._initRegionManager();this._initCallbacks=new i.Callbacks();this.vent=new j.Wreqr.EventAggregator();this.commands=new j.Wreqr.Commands();this.reqres=new j.Wreqr.RequestResponse();this.submodules={};d.extend(this,k);this.triggerMethod=i.triggerMethod};d.extend(i.Application.prototype,j.Events,{execute:function(){var k=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,k)},request:function(){var k=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,k)},addInitializer:function(k){this._initCallbacks.add(k)},start:function(k){this.triggerMethod("initialize:before",k);this._initCallbacks.run(k,this);this.triggerMethod("initialize:after",k);this.triggerMethod("start",k)},addRegions:function(k){return this._regionManager.addRegions(k)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(k){this._regionManager.removeRegion(k)},getRegion:function(k){return this._regionManager.get(k)},module:function(k,m){var l=g(arguments);l.unshift(this);return i.Module.create.apply(i.Module,l)},_initRegionManager:function(){this._regionManager=new i.RegionManager();this.listenTo(this._regionManager,"region:add",function(k,l){this[k]=l});this.listenTo(this._regionManager,"region:remove",function(k,l){delete this[k]})}});i.Application.extend=i.extend;i.Module=function(k,l){this.moduleName=k;this.submodules={};this._setupInitializersAndFinalizers();this.app=l;this.startWithParent=true;this.triggerMethod=i.triggerMethod};d.extend(i.Module.prototype,j.Events,{addInitializer:function(k){this._initializerCallbacks.add(k)},addFinalizer:function(k){this._finalizerCallbacks.add(k)},start:function(k){if(this._isInitialized){return}d.each(this.submodules,function(l){if(l.startWithParent){l.start(k)}});this.triggerMethod("before:start",k);this._initializerCallbacks.run(k,this);this._isInitialized=true;this.triggerMethod("start",k)},stop:function(){if(!this._isInitialized){return}this._isInitialized=false;i.triggerMethod.call(this,"before:stop");d.each(this.submodules,function(k){k.stop()});this._finalizerCallbacks.run(undefined,this);this._initializerCallbacks.reset();this._finalizerCallbacks.reset();i.triggerMethod.call(this,"stop")},addDefinition:function(k,l){this._runModuleDefinition(k,l)},_runModuleDefinition:function(l,m){if(!l){return}var k=d.flatten([this,this.app,j,i,i.$,d,m]);l.apply(this,k)},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new i.Callbacks();this._finalizerCallbacks=new i.Callbacks()}});d.extend(i.Module,{create:function(q,k,l){var m=q;var o=g(arguments);o.splice(0,3);k=k.split(".");var n=k.length;var p=[];p[n-1]=l;d.each(k,function(r,s){var t=m;m=this._getModule(t,r,q);this._addModuleDefinition(t,m,p[s],o)},this);return m},_getModule:function(o,l,p,n,k){var m=o[l];if(!m){m=new i.Module(l,p);o[l]=m;o.submodules[l]=m}return m},_addModuleDefinition:function(p,l,o,k){var n;var m;if(d.isFunction(o)){n=o;m=true}else{if(d.isObject(o)){n=o.define;m=o.startWithParent}else{m=true}}if(n){l.addDefinition(n,k)}l.startWithParent=l.startWithParent&&m;if(l.startWithParent&&!l.startWithParentIsConfigured){l.startWithParentIsConfigured=true;p.addInitializer(function(q){if(l.startWithParent){l.start(q)}})}}});return i})(this,Backbone,_);c.noConflict=function(){b.Marionette=a;return this};b.Marionette=c})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/marionette.adapter.js' */
AJS.namespace("JIRA.Libs.Marionette");JIRA.Libs.Marionette=Marionette.noConflict();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Mixins.js' */
AJS.namespace("JIRA.Marionette.Mixins");JIRA.Marionette.Mixins={listenAndRethrow:function(b,a){a=[].concat(a);_.each(a,function(c){this.listenTo(b,c,function(){this.trigger.apply(this,[c].concat(_.toArray(arguments)))},this)},this)}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/LinkRegion.js' */
AJS.namespace("JIRA.Marionette.LinkRegion");JIRA.Marionette.LinkRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.append(a.$el.children());a.setElement(this.$el)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ReplaceRegion.js' */
AJS.namespace("JIRA.Marionette.ReplaceRegion");JIRA.Marionette.ReplaceRegion=JIRA.Libs.Marionette.Region.extend({open:function(a){this.$el.replaceWith(a.el)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Controller.js' */
AJS.namespace("JIRA.Marionette.Controller");JIRA.Marionette.Controller=JIRA.Libs.Marionette.Controller.extend({});_.extend(JIRA.Marionette.Controller.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/ItemView.js' */
AJS.namespace("JIRA.Marionette.ItemView");JIRA.Marionette.ItemView=JIRA.Libs.Marionette.ItemView.extend({renderTemplate:function(){var c=this.serializeData();c=this.mixinTemplateHelpers(c);var b=this.getTemplate();var a=JIRA.Libs.Marionette.Renderer.render(b,c);return JIRA.Libs.Marionette.$(a)},applyToDom:function(){this.delegateEvents();this.bindUIElements();this.triggerMethod("applyToDom")},unwrapTemplate:function(){if(this.$el.parent().length){var a=this.$el.children();this.$el.replaceWith(a);this.setElement(a)}else{this.setElement(this.$el.children())}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/CollectionView.js' */
AJS.namespace("JIRA.Marionette.CollectionView");JIRA.Marionette.CollectionView=JIRA.Libs.Marionette.CollectionView.extend({_appendHtmlWithIndex:function(a,d,b){var c=a.children();var e=c.length;if(b<=0){a.prepend(d.$el)}else{if(!e||b>=e){a.append(d.$el)}else{d.$el.insertBefore(c.eq(b))}}},appendHtml:function(a,c,b){this._appendHtmlWithIndex(a.$el,c,b)},unwrapTemplate:function(){JIRA.Marionette.ItemView.prototype.unwrapTemplate.call(this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/CompositeView.js' */
AJS.namespace("JIRA.Marionette.CompositeView");JIRA.Marionette.CompositeView=JIRA.Libs.Marionette.CompositeView.extend({appendHtml:function(a,c,b){JIRA.Marionette.CollectionView.prototype._appendHtmlWithIndex(this.getItemViewContainer(a),c,b)},unwrapTemplate:function(){JIRA.Marionette.ItemView.prototype.unwrapTemplate.call(this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Layout.js' */
AJS.namespace("JIRA.Marionette.Layout");JIRA.Marionette.Layout=JIRA.Libs.Marionette.Layout.extend({applyToDom:function(){this.delegateEvents();this.bindUIElements();this._reInitializeRegions();this.triggerMethod("applyToDom")}});_.extend(JIRA.Marionette.Layout.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/Application.js' */
AJS.namespace("JIRA.Marionette.Application");JIRA.Marionette.Application=JIRA.Libs.Marionette.Application.extend({constructor:function(a){JIRA.Libs.Marionette.Application.call(this,a)},start:function(a){if(!a||a.forceStop!==false){this.stop()}JIRA.Libs.Marionette.Application.prototype.start.call(this,a)},stop:function(){_.invoke(this.submodules,"stop")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/AppModule.js' */
AJS.namespace("JIRA.Marionette.AppModule");JIRA.Marionette.AppModule=function(){this.definition=_.bind(this.definition,this)};JIRA.Marionette.AppModule.extend=JIRA.Libs.Marionette.extend;_.extend(JIRA.Marionette.AppModule.prototype,{create:function(){throw new Error("create() must be implemented by AppModules")},generateMasterRequest:false,name:"",commands:{},requests:{},events:[],definition:function(b,d){var c=this.name;var a=this;if(!c){throw new Error("'name' must be defined by AppModules")}b.addInitializer(function(g){var f=a.create.apply(a,_.toArray(arguments));function i(k){if(_.isFunction(k)){k=k(f)}var l={};_.each(k,function(n,m){if(n===true){n=_.bind(f[m],f)}if(m&&c){m=c+":"+m}else{m=c}l[m]=n});return l}function h(l,k){if(_.isFunction(k)){k=k(f)}_.each(k,function(n){var m=c+":"+n;l.listenTo(f,n,function(){this.trigger.apply(this,[m].concat(_.toArray(arguments)))})})}var e=i(a.commands);var j=i(a.requests);if(a.generateMasterRequest){_.extend(j,i({"":function(){return f}}))}d.commands.setHandlers(e);d.reqres.setHandlers(j);h(d,a.events)})}});_.extend(JIRA.Marionette.AppModule.prototype,JIRA.Marionette.Mixins);
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/DialogView.js' */
AJS.namespace("JIRA.Marionette.DialogView");JIRA.Marionette.DialogView=JIRA.Marionette.ItemView.extend({dialog:null,template:jQuery.noop,_generateDialog:function(){var c=this.serializeData();var b=this.getTemplate();var d={id:this.id,content:function(e){e(b(c))},submitHandler:_.bind(this._generateSubmissionXHR,this)};var a=JIRA.Libs.Marionette.getOption(this,"dialogOptions");if(_.isFunction(a)){a=a.apply(this)}return new JIRA.FormDialog(_.extend(d,a))},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.dialog=this._generateDialog();this.dialog.show();this.$el=this.dialog.get$popup();jQuery(this.dialog).on("Dialog.hide",_.bind(function(c,a,b){if(b===JIRA.Dialog.HIDE_REASON.cancel||b===JIRA.Dialog.HIDE_REASON.escape){this.close()}},this));this.triggerMethod("render",this);return this},close:function(){if(this.isClosed){return}var a=this.triggerMethod("before:close");if(a===false){return}jQuery(this.dialog).off("Dialog.hide");this.dialog.hide(true);this.dialog.destroy();this.isClosed=true;this.triggerMethod("close");this.remove()},_generateSubmissionXHR:function(f,a){f.preventDefault();var c=this.dialog.$form;var d=JIRA.Libs.Marionette.getOption(this,"formToRequestData");if(_.isFunction(d)){d=d.call(this,c)}var b=JIRA.SmartAjax.makeRequest({type:c.attr("method"),url:c.attr("action"),contentType:"application/json",dataType:"json",processData:false,data:JSON.stringify(d)}).done(a).done(_.bind(this._onSubmitSuccess,this)).fail(_.bind(this._onSubmitError,this));return b},_onSubmitSuccess:function(a){this.triggerMethod("submit:success",a);this.close()},_onSubmitError:function(a){this.dialog.getButtonsContainer().find("input").removeAttr("disabled");this.dialog.hideFooterLoadingIndicator();this.dialog.$form.removeClass("submitting");this._showErrorFromXHR(a);this.triggerMethod("submit:error")},_displayFieldErrors:function(b){var a=this.dialog.$popup;_.each(b,function(c,d){a.find("#"+d).after("<div class='error'>"+AJS.escapeHTML(c)+"</div>")})},_displayGenericErrors:function(b){var a=this.dialog.$popup.find(".aui-messages");_.each(b,function(d){var c={closeable:true,timeout:5};c.body=AJS.escapeHTML(d);c.shadowed=false;AJS.messages.error(a,c)})},_displayXHRErrors:function(b){var a=this.dialog.$popup.find(".aui-messages");a.append(JIRA.SmartAjax.buildDialogErrorContent(b,true))},_showErrorFromXHR:function(b){this._removeErrorMessages();var c;try{c=JSON.parse(b.responseText)}catch(a){c=null}if(c){this._displayFieldErrors(c.errors);this._displayGenericErrors(c.errorMessages)}else{this._displayXHRErrors(b)}},_removeErrorMessages:function(){this.dialog.$popup.find(".error").remove();this.dialog.$popup.find(".aui-messages").empty()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:marionette', location = 'lib/base/InlineDialogView.js' */
AJS.namespace("JIRA.Marionette.InlineDialogView");JIRA.Marionette.InlineDialogView=JIRA.Marionette.ItemView.extend({dialog:null,template:jQuery.noop,_getDialogOptions:function(){var b={noBind:true};var a=JIRA.Libs.Marionette.getOption(this,"dialogOptions")||{};if(_.isFunction(a)){a=a.apply(this)}a=_.extend({},b,a);a.hideCallback=_.bind(function(){this.close()},this);return a},_getTrigger:function(){var a=JIRA.Libs.Marionette.getOption(this,"trigger");if(_.isFunction(a)){a=a.apply(this)}return a},_generateDialog:function(){var d=this.serializeData();var c=this.getTemplate();var b=this._getDialogOptions();var a=this._getTrigger();return AJS.InlineDialog(a,this.id,function(f,e,g){f.html(c(d));g()},b)},render:function(){this.isClosed=false;this.triggerMethod("before:render",this);this.dialog=this._generateDialog();this.$el=this.dialog;this.id=this.dialog.id;this.dialog.show();this.triggerMethod("render",this);return this},close:function(){if(this.isClosed){return}var a=this.triggerMethod("before:close");if(a===false){return}this.dialog.hide();this.isClosed=true;this.triggerMethod("close");this.remove()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/Analytics.js' */
AJS.namespace("JIRA.Components.Analytics");JIRA.Components.Analytics=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=new JIRA.Components.Analytics.Services.Trigger(a);this.trackerService=new JIRA.Components.Analytics.Services.DomTracker(this.triggerService)},trigger:function(a,b){this.triggerService.trigger(a,b)},registerEvent:function(b){var a=[].concat(b);_.each(a,function(c){this.triggerService.registerEvent(c)},this)},registerTracker:function(a){var b=[].concat(a);_.each(b,function(c){this.trackerService.registerTracker(c)},this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/AnalyticsAppModule.js' */
AJS.namespace("JIRA.Components.Analytics.AppModule");JIRA.Components.Analytics.AppModule=JIRA.Marionette.AppModule.extend({name:"analytics",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{useLog:false});return new JIRA.Components.Analytics(a)},commands:{trigger:true,registerEvent:true,registerTracker:true}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/services/Trigger.js' */
AJS.namespace("JIRA.Components.Analytics.Services.Trigger");JIRA.Components.Analytics.Services.Trigger=JIRA.Marionette.Controller.extend({initialize:function(a){this.useLog=a.useLog;this.allowedEvents=[];this.startTime=new Date().getTime();this.pageSessionGuid=Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2)},trigger:function(b,c){if(!AJS.EventQueue){return}if(!_.contains(this.allowedEvents,b)){return}c=c||{};c.context_pageSession=this.pageSessionGuid;c.context_pageTime=new Date().getTime()-this.startTime;AJS.EventQueue.push({name:b,properties:c});if(this.useLog){var a="***** Analytics log ["+b+"]";a+="["+JSON.stringify(c)+"]";AJS.log(a)}},registerEvent:function(a){this.allowedEvents.push(a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:analytics', location = 'issuenav-analytics/services/DomTracker.js' */
AJS.namespace("JIRA.Components.Analytics.Services.DomTracker");JIRA.Components.Analytics.Services.DomTracker=JIRA.Marionette.Controller.extend({initialize:function(a){this.triggerService=a;this.trackers=[]},registerTracker:function(a){var b=this.triggerService;_.defaults(a,{type:"click",handler:function(d,c){b.trigger(this.name,c)},context:document});b.registerEvent(a.name);a.domHandler=function(c){if(!c.preventFurtherAnalytics){a.handler.apply(a,Array.prototype.slice.call(arguments))}};AJS.$(a.context).on(a.type,a.selector,a.domHandler);this.trackers.push(a)},clear:function(){_.each(this.trackers,function(a){AJS.$(a.context).off(a.type,a.selector,a.domHandler)})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/AttributesMixinCreator.js' */
AJS.namespace("JIRA.Issues.AttributesMixinCreator");(function(){JIRA.Issues.AttributesMixinCreator={create:function(b){var a={};if(_.indexOf(b,"id")===-1){b.unshift("id")}_.each(b,function(d){var e=JIRA.Issues.Mixins.createMethodName("set",d);a[e]=function(h,f){var g={};g[d]=h;this.set(g,f);return this};var c=JIRA.Issues.Mixins.createMethodName("get",d);a[c]=function(){return this.get(d)}});return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/EventsMixinCreator.js' */
(function(){JIRA.Issues.EventsMixinCreator={create:function(b){var a={};var c=function(e){var d=JIRA.Issues.Mixins.createMethodName("bind",e);a[d]=function(){return this.bind.apply(this,[e].concat(_.toArray(arguments)))};var g=JIRA.Issues.Mixins.createMethodName("unbind",e);a[g]=function(){return this.unbind.apply(this,[e].concat(_.toArray(arguments)))};var f=JIRA.Issues.Mixins.createMethodName("trigger",e);a[f]=function(){return this.trigger.apply(this,[e].concat(_.toArray(arguments)))};var h=JIRA.Issues.Mixins.createMethodName("one",e);a[h]=function(){var i=this;var j=arguments[0];var l=function(){i.unbind(e,l);j(arguments)};var k=_.toArray(arguments).slice(1);return this.bind.apply(this,[e,l].concat(k))}};_.each(b,_.bind(c,this));return a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Extensions.js' */
AJS.namespace("JIRA.Issues.BaseModel");AJS.namespace("JIRA.Issues.BaseCollection");AJS.namespace("JIRA.Issues.BaseView");AJS.namespace("JIRA.Issues.BaseRouter");(function(){function applyMixin(ctor,mixin){_.forEach(_.keys(mixin),function(key){var proto=ctor.prototype;if("initialize"===key){var oldInitialize=proto.initialize;proto.initialize=function(){mixin.initialize.apply(this,arguments);if(oldInitialize){oldInitialize.apply(this,arguments)}};return}if("validate"===key){var oldValidate=proto.validate;proto.validate=function(){var errors=mixin.validate.apply(this,arguments);if(errors){return errors}if(oldValidate){return oldValidate.apply(this,arguments)}};return}if("defaults"===key){var defaults=proto.defaults||(proto.defaults={});var mixinDefaults=mixin[key];for(var id in mixinDefaults){if(defaults.hasOwnProperty(id)){throw"Mixin error: object "+ctor+" already has default "+id+" defined for mixin "+mixin}defaults[id]=mixinDefaults[id]}return}if("properties"===key){if(!_.isArray(mixin[key])){throw"Expects properties member on mixin to be an array"}if(!proto.properties){proto.properties=[]}proto.properties=proto.properties.concat(mixin[key]);return}if("namedEvents"===key){if(!_.isArray(mixin[key])){throw"Expects events member on mixin to be an array"}if(!proto.namedEvents){proto.namedEvents=[]}proto.namedEvents=proto.namedEvents.concat(mixin[key]);return}if(proto.hasOwnProperty(key)){throw"Mixin error: object "+ctor+" already has property "+key+" for mixin "+mixin}proto[key]=mixin[key]},this)}function generateMixinExtend(oldExtend){return function(protoProps,classProps){var child;var cleanProtoProps=_.extend({},protoProps);var mixins;if(protoProps&&protoProps.mixins){mixins=protoProps.mixins;delete cleanProtoProps.mixins}child=oldExtend.call(this,cleanProtoProps,classProps);if(mixins){_.each(protoProps.mixins,function(mixin){applyMixin(child,mixin)})}if(child.prototype.namedEvents){applyMixin(child,JIRA.Issues.EventsMixinCreator.create(child.prototype.namedEvents))}if(child.prototype.properties){applyMixin(child,JIRA.Issues.AttributesMixinCreator.create(child.prototype.properties))}child.extend=arguments.callee;return child}}function overrideSetGet(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.set=function(key,value,options){var attrs,properties=this.properties;if(properties){if(_.isObject(key)||key==null){attrs=key}else{attrs={};attrs[key]=value}for(var attr in attrs){if(_.indexOf(properties,attr)<0){throw"Property '"+attr+"' does not exist"}}}return proto.set.apply(this,arguments)};childProto.get=function(attr){if(this.properties&&_.indexOf(this.properties,attr)<0){throw"Property '"+attr+"' does not exist"}return proto.get.apply(this,arguments)}}function addListenMethods(ctor,childCtor){var proto=ctor.prototype;var childProto=childCtor.prototype;childProto.addListener=function(other,event,callback,context){if(arguments.length<3){throw"The 'other', 'event', and 'callback' arguments are mandatory"}var capitalisedEvent=event.charAt(0).toUpperCase()+event.slice(1);var registerMethodName="on"+capitalisedEvent;var unregisterMethodName="off"+capitalisedEvent;var braceRegisterMethodName="bind"+capitalisedEvent;var braceUnregisterMethodName="unbind"+capitalisedEvent;var finalRegisterName;var finalUnRegisterName;if(other[registerMethodName]){finalRegisterName=registerMethodName;finalUnRegisterName=unregisterMethodName||braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have method "+registerMethodName+"'"}if(typeof other[finalUnRegisterName]!=="function"){throw"object does not have method "+unregisterMethodName+"'"}}else{finalRegisterName=braceRegisterMethodName;finalUnRegisterName=braceUnregisterMethodName;if(typeof other[finalRegisterName]!=="function"){throw"object does not have event ["+event+"] registered'"}}other[finalRegisterName](callback,context);this._cleanerUppers=this._cleanerUppers||[];this._cleanerUppers.push(function(){other[finalUnRegisterName](callback,context)})};childProto.removeListeners=function(){if(this._cleanerUppers){_.each(this._cleanerUppers,function(cleanerUpper){cleanerUpper()})}}}function addViewCleanupMethods(ctor,childCtor){var childProto=childCtor.prototype;var superRemove=ctor.prototype.remove;childProto.remove=function(){this.removeListeners();return superRemove.apply(this,arguments)};childProto.deactivate=function(){this.undelegateEvents();this.removeListeners()}}function applyExtensions(ctor){var child=ctor.extend();var oldExtend=ctor.extend;child.extend=generateMixinExtend(oldExtend);return child}function applyModelExtensions(ctor){var child=applyExtensions(ctor);overrideSetGet(ctor,child);return child}function applyViewExtensions(ctor){var child=applyExtensions(ctor);addListenMethods(ctor,child);addViewCleanupMethods(ctor,child);return child}JIRA.Issues.BaseModel=applyModelExtensions(Backbone.Model);JIRA.Issues.BaseCollection=applyExtensions(Backbone.Collection);JIRA.Issues.BaseView=applyViewExtensions(Backbone.View);JIRA.Issues.BaseRouter=applyExtensions(Backbone.Router);var Evented=function(){this.initialize.apply(this,arguments)};_.extend(Evented.prototype,Backbone.Events,{initialize:function(){}});Evented.extend=Backbone.Model.extend;JIRA.Issues.BaseEvented=applyExtensions(Evented);_.mixin({lambda:function(x){return function(){return x}},isNotBlank:function(object){return !!object},bindObjectTo:function(obj,context){_.map(obj,function(value,key){if(_.isFunction(value)){obj[key]=_.bind(value,context)}})}});Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/Mixins.js' */
(function(){JIRA.Issues.Mixins={createMethodName:function(a,b){return a+b.charAt(0).toUpperCase()+b.substr(1)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:backbone-ext', location = 'content/js/base/ModelUtils.js' */
(function(){var d;function c(){this.modelEvents={}}c.prototype.captureEvent=function(g,f){var e=f[0];this.modelEvents[g.cid]||(this.modelEvents[g.cid]={model:g,events:{}});this.modelEvents[g.cid].events[e]=f};c.prototype.replayEvents=function(){_.each(this.modelEvents,function(e){_.each(e.events,function(g,f){Backbone.Events.trigger.apply(e.model,g)})})};function a(f){var e=this;if(f==="change"||f.indexOf("change:")===0){d.log.captureEvent(e,_.toArray(arguments))}else{Backbone.Events.trigger.apply(e,arguments)}}var b=function(){if(d){return{commit:function(){}}}d={log:new c()};var e=JIRA.Issues.Utils.patch(Backbone.Model.prototype,"trigger",a);return{commit:function(){e();d.log.replayEvents();d=null}}};JIRA=JIRA||{};JIRA.Issues=JIRA.Issues||{};JIRA.Issues.ModelUtils=JIRA.Issues.ModelUtils||{};JIRA.Issues.ModelUtils.transaction=function(g,f){var e=b();try{return g.apply(f)}finally{e.commit()}};JIRA.Issues.ModelUtils.makeTransactional=function(f){var g=function(h){return function(){var i=arguments;return JIRA.Issues.ModelUtils.transaction(function(){return h.apply(this,i)},this)}};var e=Array.prototype.slice.call(arguments,1);if(e.length===0){e=_.functions(f)}_.each(e,function(h){if(h.indexOf("_")!==0){f[h]=g(f[h])}})}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.queryparams.js' */
/*! THIS FILE HAS BEEN MODIFIED BY ATLASSIAN, SEE https://github.com/jhudson8/backbone-query-parameters/pull/63/files */
(function(a,b){if(typeof exports==="object"&&a.require){module.exports=b(require("underscore"),require("backbone"))}else{if(typeof define==="function"&&define.amd){define(["underscore","backbone"],function(c,d){return b(c||a._,d||a.Backbone)})}else{b(_,Backbone)}}}(this,function(q,b){var i=/^\?(.*)/,g=/\((.*?)\)/g,e=/(\(\?)?:\w+/g,o=/\*\w+/g,d=/[\-{}\[\]+?.,\\\^$|#\s]/g,h=/^([^\?]*)/,k=/[\:\*]([^\:\?\/]+)/g,j=/^[#\/]|\s+$/g,c=/\/$/;b.Router.arrayValueSplit="|";var f=function(u,t){if(u==null){if(this._hasPushState||!this._wantsHashChange||t){u=this.location.pathname;var s=this.root.replace(c,"");var v=this.location.search;if(!u.indexOf(s)){u=u.substr(s.length)}if(v){u+=v}}else{u=this.getHash()}}return u.replace(j,"")};function l(u,t,s){q.each(Array.prototype.slice.call(arguments,2),function(v){Object.defineProperty(t,v,{get:function(){return u[v]},set:function(w){u[v]=w}})})}l.isSupported=(function(){try{Object.defineProperty({},"x",{});return true}catch(s){return false}})();function a(u){var s=u.location,t={};l(s,t,"assign","ancestorOrigins","origin","hash","search","pathname","port","hostname","host","protocol","href","reload");t.replace=function(){s.replace(u.root+"#"+u.fragment)};t.unPatch=function(){return u.location=s};u.location=t}function r(u){var s=u.history,t={};l(s,t,"length","state","back","forward","go","pushState");t.replaceState=function(w,x,v){v=u.root+u.fragment;return s.replaceState(w,x,v)};t.unPatch=function(){u.history=s};u.history=t}var m=b.History.prototype.start,n=b.History.prototype.loadUrl;q.extend(b.History.prototype,{getFragment:f,getQueryParameters:function(u,s){u=f.apply(this,arguments);var w=u.replace(h,"");var t=w.match(i);if(t){w=t[1];var v={};p(w,function(x,y){y=y.replace(/\+/g,"%20");y=decodeURIComponent(y);if(!v[x]){v[x]=y}else{if(q.isString(v[x])){v[x]=[v[x],y]}else{v[x].push(y)}}});return v}else{return{}}},start:function(){if(l.isSupported){a(this);r(this)}try{return m.apply(this,arguments)}finally{this.location.unPatch&&this.location.unPatch();this.history.unPatch&&this.history.unPatch()}},loadUrl:function(){this.location&&this.location.unPatch&&this.location.unPatch();this.history&&this.history.unPatch&&this.history.unPatch();return n.apply(this,arguments)}});q.extend(b.Router.prototype,{initialize:function(s){this.encodedSplatParts=s&&s.encodedSplatParts},getFragment:f,_routeToRegExp:function(t){var u=(o.exec(t)||{index:-1}),s=(e.exec(t)||{index:-1}),w=t.match(k)||[];t=t.replace(d,"\\$&").replace(g,"(?:$1)?").replace(e,function(y,x){return x?y:"([^\\/\\?]+)"}).replace(o,"([^??]*?)");t+="(\\?.*)?";var v=new RegExp("^"+t+"$");if(u.index>=0){if(s>=0){v.splatMatch=u.index-s.index}else{v.splatMatch=-1}}v.paramNames=q.map(w,function(x){return x.substring(1)});v.namedParameters=this.namedParameters;return v},_extractParameters:function(A,y){var u=A.exec(y).slice(1),z={};if(u.length>0&&q.isUndefined(u[u.length-1])){u.splice(u.length-1,1)}var x=u.length&&u[u.length-1]&&u[u.length-1].match(i);if(x){var s=x[1];var w={};if(s){var B=this;p(s,function(C,D){B._setParamValue(C,D,w)})}u[u.length-1]=w;q.extend(z,w)}var t=u.length;if(A.splatMatch&&this.encodedSplatParts){if(A.splatMatch<0){return u}else{t=t-1}}for(var v=0;v<t;v++){if(q.isString(u[v])){u[v]=decodeURIComponent(u[v]);if(A.paramNames&&A.paramNames.length>=v-1){z[A.paramNames[v]]=u[v]}}}return(b.Router.namedParameters||A.namedParameters)?[z]:u},_setParamValue:function(u,x,w){u=u.replace("[]","");var y=u.split(".");var v=w;for(var t=0;t<y.length;t++){var s=y[t];if(t===y.length-1){v[s]=this._decodeParamValue(x,v[s])}else{v=v[s]=v[s]||{}}}},_decodeParamValue:function(v,u){v=v.replace(/\+/g,"%20");var w=b.Router.arrayValueSplit;if(w&&v.indexOf(w)>=0){var s=v.split(w);for(var t=s.length-1;t>=0;t--){if(!s[t]){s.splice(t,1)}else{s[t]=decodeURIComponent(s[t])}}return s}v=decodeURIComponent(v);if(!u){return v}else{if(q.isArray(u)){u.push(v);return u}else{return[u,v]}}},toFragment:function(t,s){if(s){if(!q.isString(s)){s=this._toQueryString(s)}if(s){t+="?"+s}}return t},_toQueryString:function(u,s){var B=b.Router.arrayValueSplit;function w(D){return String(D).replace(B,encodeURIComponent(B))}if(!u){return""}s=s||"";var z="";for(var t in u){var y=u[t];if(q.isString(y)||q.isNumber(y)||q.isBoolean(y)||q.isDate(y)){y=this._toQueryParam(y);if(q.isBoolean(y)||q.isNumber(y)||q.isString(y)||y){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+w(encodeURIComponent(y))}}else{if(q.isArray(y)){var A="";for(var x=0;x<y.length;x++){var v=this._toQueryParam(y[x]);if(q.isBoolean(v)||v!==null){A+=B+w(v)}}if(A){z+=(z?"&":"")+this._toQueryParamName(t,s)+"="+A}}else{var C=this._toQueryString(y,this._toQueryParamName(t,s,true));if(C){z+=(z?"&":"")+C}}}}return z},_toQueryParamName:function(s,u,t){return(u+s+(t?".":""))},_toQueryParam:function(s){if(q.isNull(s)||q.isUndefined(s)){return null}return s}});function p(u,t){var s=u.split("&");q.each(s,function(w){var v=w.split("=");t(v.shift(),v.join("="))})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.brace.js' */
(function(){var i=this;var k;if(typeof exports!=="undefined"){k=exports}else{k=i.Brace={}}var o=i._;if(!o&&(typeof require!=="undefined")){o=require("underscore")}var n=i.Backbone;if(!n&&(typeof require!=="undefined")){n=require("backbone")}function f(q){if(o.isArray(q)){return o.reduce(q,function(r,s){r[s]=null;return r},{})}return q}function b(q,r){if(!q||r==null){return r}if(typeof q==="string"||q instanceof String){if(typeof r!==""+q){throw"The typeof "+r+" is "+typeof r+" but expected it to be "+q}return r}if(o.isArray(q)||q===Array){if(!l(r)){throw"Array type expected, but nonnull, non-Array value provided."}return q===Array||!q[0]?r:o.map(r,o.bind(b,null,q[0]))}if(typeof q!=="function"){throw"Invalid expected type "+q+". Should be falsy, String, Array, Backbone.Collection constructor, or function."}if(r instanceof q){return r}if(h(q)){return new q(b([q.model],r))}return new q(r)}function h(r,q){return r&&(r.__super__ instanceof (q||n.Collection)||r.__super__===(q||n.Collection).prototype||r===(q||n.Collection))}function l(q){return o.has(q,"length")&&!(q instanceof String||o.has({string:1,"function":1},typeof q)||q instanceof n.Collection)}function m(s,r){var q={};o.each(s,function(u,t){if(!r[t]||p(u,r[t])){q[t]=u}else{if(!u||p(r[t],u)){return}else{throw t+" has conflicted type descriptors."}}});return q}function p(r,q){if(!q||q===r){return true}if(!r||typeof r==="string"){return false}if(r instanceof Array){return q===Array||(q instanceof Array&&p(r[0],q[0]))}if(typeof q!=="function"){return false}if(h(q)){return h(r,q)}return r.prototype instanceof q}function e(q){if(o.isObject(q)){return o.reduce(q,function(r,t,s){if(t&&o.isFunction(t.toJSON)){r[s]=t.toJSON()}return r},q)}else{return q}}function a(r){return function q(){var s=r.call(this);return e(s)}}k.Mixins={createMethodName:function(q,r){return q+r.charAt(0).toUpperCase()+r.substr(1)},applyMixin:function(r,q){o.forEach(o.keys(q),function(z){var w=r.prototype;if("initialize"===z){var y=w.initialize;w.initialize=function(){if(y){y.apply(this,arguments)}q.initialize.apply(this,arguments)};return}if("validate"===z){var s=w.validate;w.validate=function(){if(s){var B=s.apply(this,arguments);if(B){return B}}return q.validate.apply(this,arguments)};return}if("defaults"===z){var v=w.defaults||(w.defaults={});var x=q[z];for(var u in x){if(v.hasOwnProperty(u)){throw"Mixin error: class already has default '"+u+"' defined"}v[u]=x[u]}return}if("namedAttributes"===z){var t=f(w.namedAttributes)||{};var A=f(q[z]);w.namedAttributes=o.extend(t,m(A,t));return}if("namedEvents"===z){if(!o.isArray(q[z])){throw"Expects events member on mixin to be an array"}if(!w.namedEvents){w.namedEvents=[]}w.namedEvents=o.uniq(w.namedEvents.concat(q[z]));return}if(w.hasOwnProperty(z)){throw"Mixin error: class already has property '"+z+"' defined"}w[z]=q[z]},this)}};k.AttributesMixinCreator={create:function(r){var q={};if(!r){r={}}if(!o.has(r,"id")){r.id=null}o.each(r,function(u,t){var v=k.Mixins.createMethodName("set",t);q[v]=function(x,w){return this.set(t,x,w)};var s=k.Mixins.createMethodName("get",t);q[s]=function(){return this.get(t)}});return q},ensureType:b};k.EventsMixinCreator={create:function(r){var q={};var s=function(u){var t=k.Mixins.createMethodName("on",u);q[t]=function(){return this.on.apply(this,[u].concat(o.toArray(arguments)))};var v=k.Mixins.createMethodName("trigger",u);q[v]=function(){return this.trigger.apply(this,[u].concat(o.toArray(arguments)))}};o.each(r,o.bind(s,this));return q}};function d(r){return function q(u,v){var w;var t=o.extend({},u);var s;if(u&&u.mixins){s=u.mixins;delete t.mixins}w=r.call(this,t,v);if(this.prototype.namedEvents){k.Mixins.applyMixin(w,{namedEvents:this.prototype.namedEvents})}if(this.prototype.namedAttributes){k.Mixins.applyMixin(w,{namedAttributes:this.prototype.namedAttributes})}if(s){o.each(u.mixins,function(x){k.Mixins.applyMixin(w,x)})}if(w.prototype.namedEvents){k.Mixins.applyMixin(w,k.EventsMixinCreator.create(w.prototype.namedEvents))}if(w.prototype.namedAttributes){w.prototype.namedAttributes=f(w.prototype.namedAttributes);k.Mixins.applyMixin(w,k.AttributesMixinCreator.create(w.prototype.namedAttributes))}if(w.prototype.toJSON){w.prototype.toJSON=a(w.prototype.toJSON)}w.extend=q;return w}}function g(u,s){var t=u.prototype;var q=s.prototype;var r=t.set;q.set=function(A,B,z){var y,x=this.namedAttributes;if(!x||A==null){return r.apply(this,arguments)}if(o.isObject(A)){y=o.clone(A);z=B}else{y={};y[A]=B}for(var w in y){if(!o.has(y,w)){continue}if(!o.has(x,w)){throw"Attribute '"+w+"' does not exist"}y[w]=b(x[w],y[w])}return r.call(this,y,z)};var v=t.get;q.get=function(w){if(this.namedAttributes&&!o.has(this.namedAttributes,w)){throw"Attribute '"+w+"' does not exist"}return v.apply(this,arguments)}}function c(q){var s=q.extend();var r=q.extend;s.extend=d(r);return s}function j(q){var r=c(q);g(q,r);return r}k.Model=j(n.Model);k.Collection=c(n.Collection);k.View=c(n.View);k.Router=c(n.Router);k.Evented=c(n.View)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'lib/backbone.define.js' */
Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Utils.js' */
JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.DELETE="delete";JIRA.Issues.Actions.UPDATE="update";JIRA.Issues.Actions.INLINE_EDIT="inlineEdit";JIRA.Issues.Actions.ROW_UPDATE="rowUpdate";JIRA.Issues.XsrfTokenHeader={"X-Atlassian-Token":"nocheck"};JIRA.Issues.Utils={isIssueDialog:function(a){return !!a.issueId||_.include(JIRA.Dialogs,a)},isDeleteDialog:function(a){return a.options.id==="delete-issue-dialog"},isEditCommentDialog:function(a){return a.options.id==="edit-comment"},getEffectiveIssueKeyForDialog:function(a){var b=a&&a.$activeTrigger&&a.$activeTrigger.data("issuekey");if(b){return b}else{return JIRA.Issues.Api.getSelectedIssue().getKey()}},getEffectiveIssueIdForDialog:function(a){if(a.issueId){return a.issueId}else{return JIRA.Issues.Api.getSelectedIssue().getId()}},getAction:function(a){if(this.isDeleteDialog(a)){return JIRA.Issues.Actions.DELETE}else{if(this.isEditCommentDialog(a)){return JIRA.Issues.Actions.EDIT_COMMENT}else{return JIRA.Issues.Actions.UPDATE}}},getMessage:function(a){if(!this.isEditCommentDialog(a)){return a.options.issueMsg||"thanks_issue_updated"}},getMeta:function(a){if(this.isEditCommentDialog(a)){return{commentId:a.$activeTrigger.attr("id").replace("edit_comment_","")}}else{return{}}},getUpdateCommandForDialog:function(b){var a=this;if(this.isIssueDialog(b)){return{key:a.getEffectiveIssueKeyForDialog(b),id:a.getEffectiveIssueIdForDialog(b),action:a.getAction(b),message:a.getMessage(b),meta:a.getMeta(b)}}},debounce:function(a,c){var b=Array.prototype.slice.call(arguments,2);if(!a){console.error("JIRA.Issues.Utils.debounce: ctx must be defined")}clearTimeout(a[c+"DebounceTimeout"]);a[c].apply(a,b);if(!a[c+"DebounceTimeout"]){a[c+"Original"]=a[c];a[c]=_.debounce(function(){return a[c+"Original"].apply(a,arguments)},300)}a[c+"DebounceTimeout"]=setTimeout(function(){a[c]=a[c+"Original"];a[c+"DebounceTimeout"]=null},500)},waitForDeferreds:function(e,d,a){a=a||window;var c=[];var b=jQuery.Deferred();_.each(e,function(){var f=d.apply(a,arguments);if(f&&f.promise){c.push(f)}});if(c.length){jQuery.when.apply(jQuery,c).then(function(){b.resolveWith(a)})}else{b.resolveWith(a)}return b.promise()},resolvedPromise:function(){return jQuery.Deferred().resolve().promise()},patch:function(b,a,e){var f=b.hasOwnProperty(a),c=b[a];b[a]=e;return function d(){if(f){b[a]=c}else{delete b[a]}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/AuiOverrides.js' */
AJS.undim=function(){if(AJS.dim.$dim){AJS.dim.$dim.remove();AJS.dim.$dim=null;if(AJS.dim.shim){AJS.dim.shim.remove()}if(AJS.$.browser.msie&&parseInt(AJS.$.browser.version,10)<8){AJS.$("html").removeAttr("style")}else{AJS.$("body").removeAttr("style")}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollIntoView.js' */
/*!
 * jQuery scrollintoview() plugin and :scrollable selector filter
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(g){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};var b={duration:0,direction:"y"};var f=/^(?:html)$/i;var h=function(l,k){k=k||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var j=document.defaultView&&document.defaultView.getComputedStyle?true:false;var i={top:(parseFloat(j?k.borderTopWidth:g.css(l,"borderTopWidth"))||0),left:(parseFloat(j?k.borderLeftWidth:g.css(l,"borderLeftWidth"))||0),bottom:(parseFloat(j?k.borderBottomWidth:g.css(l,"borderBottomWidth"))||0),right:(parseFloat(j?k.borderRightWidth:g.css(l,"borderRightWidth"))||0)};return{top:i.top,left:i.left,bottom:i.bottom,right:i.right,vertical:i.top+i.bottom,horizontal:i.left+i.right}};var d=function(i){var k=g(window);var j=f.test(i[0].nodeName);return{border:j?{top:0,left:0,bottom:0,right:0}:h(i[0]),scroll:{top:(j?k:i).scrollTop(),left:(j?k:i).scrollLeft()},scrollbar:{right:j?0:i.innerWidth()-i[0].clientWidth,bottom:j?0:i.innerHeight()-i[0].clientHeight},rect:(function(){var l=i[0].getBoundingClientRect();return{top:j?0:l.top,left:j?0:l.left,bottom:j?i[0].clientHeight:l.bottom,right:j?i[0].clientWidth:l.right}})()}};g.fn.extend({scrollIntoViewForAuto:function(k){k=g.extend({},b,k);k.direction=c[typeof(k.direction)==="string"&&k.direction.toLowerCase()]||c.both;var o="";if(k.direction.x===true){o="horizontal"}if(k.direction.y===true){o=o?"both":"vertical"}var m=this.eq(0);var j=m.closest(":scrollable("+o+")");if(j.length>0){j=j.eq(0);var n={e:d(m),s:d(j)};var i={top:n.e.rect.top-(n.s.rect.top+n.s.border.top),bottom:n.s.rect.bottom-n.s.border.bottom-n.s.scrollbar.bottom-n.e.rect.bottom,left:n.e.rect.left-(n.s.rect.left+n.s.border.left),right:n.s.rect.right-n.s.border.right-n.s.scrollbar.right-n.e.rect.right};var l={};if(k.direction.y===true){if(i.top<0){l.scrollTop=n.s.scroll.top+i.top-30}else{if(i.top>0&&i.bottom<0){l.scrollTop=n.s.scroll.top+Math.min(i.top,-i.bottom)+30}}}if(k.direction.x===true){if(i.left<0){l.scrollLeft=n.s.scroll.left+i.left}else{if(i.left>0&&i.right<0){l.scrollLeft=n.s.scroll.left+Math.min(i.left,-i.right)}}}if(!g.isEmptyObject(l)){if(f.test(j[0].nodeName)){j=g("html,body")}j.animate(l,k.duration).eq(0).queue(function(p){g.isFunction(k.complete)&&k.complete.call(j[0]);p()})}else{g.isFunction(k.complete)&&k.complete.call(j[0])}}return this}});var a={auto:true,scroll:true,visible:false,hidden:false};g.extend(g.expr[":"],{scrollable:function(l,j,o,i){var n=c[typeof(o[3])==="string"&&o[3].toLowerCase()]||c.both;var m=(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(l,null):l.currentStyle);var p={x:a[m.overflowX.toLowerCase()]||false,y:a[m.overflowY.toLowerCase()]||false,isRoot:f.test(l.nodeName)};if(!p.x&&!p.y&&!p.isRoot){return false}var k={height:{scroll:l.scrollHeight,client:l.clientHeight},width:{scroll:l.scrollWidth,client:l.clientWidth},scrollableX:function(){return(p.x||p.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(p.y||p.isRoot)&&this.height.scroll>this.height.client}};return n.y&&k.scrollableY()||n.x&&k.scrollableX()}});var e=jQuery.fn.scrollIntoView;JIRA.Issues.overrideScrollIntoViewForSplit=function(){jQuery.fn.scrollIntoView=jQuery.fn.scrollIntoViewForAuto};JIRA.Issues.restoreScrollIntoViewForNormal=function(){jQuery.fn.scrollIntoView=e}})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/IssueNavFeatures.js' */
AJS.namespace("JIRA.Issues.Feature");JIRA.Issues.Feature=Class.extend({init:function(a){this.featureKey=a},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});AJS.namespace("JIRA.Issues.DarkFeatures");JIRA.Issues.DarkFeatures={NO_PREFETCH:new JIRA.Issues.Feature("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new JIRA.Issues.Feature("rotp.project.shortcuts")};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/analytics.js' */
AJS.namespace("JIRA.Issues.AnalyticsLoader");JIRA.Issues.AnalyticsLoader=function(){JIRA.Issues.Application.execute("analytics:registerEvent",["kickass.search","kickass.switchtobasic","kickass.switchtoadvanced","kickass.returntosearch","kickass.editField","kickass.editMultipleFields","kickass.editClientDuration","kickass.editClientCancelledDuration","kickass.editSaveonserverDuration","kickass.issueLoadDuration","kickass.openIssueFromTable","kickass.issueTotalSaveDuration","kickass.focusshifteropened","kickass.queryTooComplexSwitchToAdvanced","kickass.basicModeCriteriaCountWhenSearching","kickass.criteriaAutoUpdateEnabled","kickass.issueTableRefresh","kickass.conditionalLoading","kickass.viewIssue","kickass.inlineEdit"]);JIRA.Issues.Application.execute("analytics:trigger","kickass.criteriaAutoUpdateEnabled",{enabled:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.Issues.Application.execute("analytics:registerTracker",[{name:"kickass.clickedOnSystemFilter",selector:".system-filters a",handler:a},{name:"kickass.clickedOnFavouriteFilter",selector:".favourite-filters a.filter-link"},{name:"kickass.clickedOnFavouriteFilterActionsMenu",selector:".favourite-filters a.filter-actions"},{name:"kickass.renamedFilterFromActionsMenu",selector:"#rename-filter-form",type:"submit"},{name:"kickass.deletedFilterFromActionsMenu",selector:"#delete-filter-form",type:"submit"},{name:"kickass.copiedFilterFromActionsMenu",selector:"#copy-filter-dialog form",type:"submit"},{name:"kickass.removeFilterFromFavouritesViaActionsMenu",selector:".unfavourite-filter"},{name:"kickass.saveACopyOfFilterFromSearchHeader",selector:"#save-filter-dialog form",type:"submit"},{name:"kickass.filterChangesSaved",selector:".header-section-primary .save-changes"},{name:"kickass.clickedOnShowFiltersDetailsDropDown",selector:".show-filter-details",type:"mousedown"},{name:"kickass.clickedOnChangePermissions",selector:".filter-permissions .change-permissions"},{name:"kickass.clickedOnUnfavouriteStar",selector:".filter-operations .fav-link.off"},{name:"kickass.clickedOnSaveFilterAs",selector:".save-as-new-filter",handler:f},{name:"kickass.clickedOnPagniationLink",selector:".pagination a",handler:e},{name:"kickass.inbrowsersearch",type:"keydown",handler:c},{name:"kickass.reloadPage",type:"keydown",handler:g},{name:"kickass.moreCriteriaNewlySelectedCount",type:AJS.InlineLayer.EVENTS.beforeHide,handler:d},{name:"kickass.createdNewSearch",selector:".new-search"},{name:"kickass.sortByColumn",selector:".sortable",handler:b},{name:"kickass.findFiltersClicked",selector:".find-filters"}]);function a(j){var i=AJS.$(j.target);JIRA.Issues.Application.execute("analytics:trigger",this.name,{name:h(i.attr("href"))})}function f(){var j=AJS.$(".system-filters a.active").length===1,i=AJS.$(".favourite-filters a.active").length===1;JIRA.Issues.Application.execute("analytics:trigger",this.name,{systemFilterSelected:j,favouriteFilterSelected:i})}function h(i){var j=parseUri(i);return j.queryKey.filter}function e(k){var j=AJS.$(k.target),i=j.text();JIRA.Issues.Application.execute("analytics:trigger",this.name,{page:i})}function c(i){if(i.keyCode===70&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function g(i){if(i.keyCode===82&&(i.metaKey||i.ctrlKey)){JIRA.Issues.Application.execute("analytics:trigger",this.name)}}function d(l,j){if(j&&j.find("#criteria-multi-select").length){var k=AJS.$("#criteria-multi-select");var i=k.find("input[checked]").length-k.find(".selected-group input[checked]").length;JIRA.Issues.Application.execute("analytics:trigger",this.name,{count:i})}}function b(i){var j=jQuery(i.target);if(!j.is("th")){j=j.parent("th")}if(j.length){JIRA.Issues.Application.execute("analytics:trigger",this.name,{direction:j.hasClass("ascending")?"descending":"ascending",column:j.data("id")})}}JIRA.Issues.Application.on("issueEditor:loadComplete",function(i,j){if(!j.fromCache){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.getId(),loadReason:j.loadReason,duration:j.duration,loadedFromDom:false})}JIRA.Issues.Application.execute("analytics:trigger","kickass.issueLoadDuration",{issueId:j.issueId,duration:j.duration,loadReason:j.loadReason,fromCache:j.fromCache})});JIRA.Issues.Application.on("issueEditor:render",function(j,i){if(i.loadedFromDom){JIRA.Issues.Application.execute("analytics:trigger","kickass.viewIssue",{issueId:i.issueId,loadedFromDom:true})}});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(i){JIRA.Issues.Application.execute("analytics:trigger","kickass.inlineEdit",{issueId:i.issueId,savedFieldIds:i.savedFieldIds,duration:i.duration})})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Stalker.js' */
(function(b){var a;b.fn.stalker=function(d){var e=this,h;if(!e.length||e.data("stalker-applied")){return}e.data("stalker-applied",true);d=d||{};d.offsetTop=d.offsetTop||0;function g(){if(a){e.css({position:"",top:"",left:"",right:"",height:""}).removeClass("detached");e.unbind("stalkerHeightUpdated",j);a.remove();a=null}}function f(){if(!a){a=jQuery("<div class='stalker-placeholder' />").css("visibility","hidden").addClass(e[0].className).height(e.outerHeight()).width(e.outerWidth()).insertBefore(e);e.bind("stalkerHeightUpdated",j);e.css({position:"fixed",top:d.offsetTop,left:h.left,right:h.right}).addClass("detached");if(typeof c.timeout==="undefined"){c()}}}function j(){a.height(e.height())}function i(){if(!e.is(":visible")){return}if(!h){h=e.offset()}if(b(window).scrollTop()+d.offsetTop>=h.top){f()}else{g()}}function c(){if(a){i();c.timeout=setTimeout(c,250)}else{delete c.timeout}}b(window).bind("resize scroll",i);i();return{unstalk:function(){g();b(window).unbind("resize scroll",i)}}}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Sidebar.js' */
/*!
 * jQuery UI Sidebar
 * http://jqueryui.com
 *
 * Depends:
 *   jquery.ui.widget.js
 */
(function(a){a.widget("ui.sidebar",{version:"0.1",options:{minWidth:function(b){return 50},maxWidth:function(b){return window.innerWidth},resize:a.noop,easeOff:0},_create:function(){_.bindAll(this,"_handleDrag","_persist","_setContainment","_setHandlePosition","updatePosition");if(this.options.easeOff){this.updatePosition=_.debounce(this.updatePosition,this.options.easeOff)}if(!this.options.id){console.error("ui.sidebar: You must specify an id")}this._addHandle();this._restore();a(window).resize(_.debounce(this.updatePosition,30))},_restore:function(){if(window.localStorage){var b=localStorage.getItem("ui.sidebar."+this.options.id);if(b){this._setWidth(b)}}},_persist:function(){if(window.localStorage){localStorage.setItem("ui.sidebar."+this.options.id,this.element.outerWidth())}},_setContainment:function(){var b=window.innerHeight;this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth(this);this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth(this));this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]})},_handleDrag:function(d,b){var c=b.position.left-this._elementLeft;this._setWidth(c,true)},_setWidth:function(e,d){if(!d){var c=this.options.maxWidth(this);var b=this.options.minWidth(this);if(e>c){e=c}else{if(e<b){e=b}}}e-=this.element.outerWidth()-this.element.width();this.element.width(e);this.options.resize(e)},_addHandle:function(){var b=document.createElement("div");b.setAttribute("class","ui-sidebar");this.handle=a(b).appendTo(this.element);this.handle.draggable({axis:"x",drag:this._handleDrag,stop:this._persist});this.handle.mousedown(this._setContainment);_.defer(this._setHandlePosition)},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var c=this.element.offset();var b=c.left+this.element.outerWidth();this.handle.css({top:c.top,left:b,height:this.element.outerHeight()}).show()}},updatePosition:function(){this._setHandlePosition();this._setWidth(this.handle.offset().left-this._elementLeft);this._persist()}})})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/PopoutSidebar.js' */
(function(a){a.widget("ui.popoutSidebar",{version:"0.1",options:{renderExpanded:a.noop,renderCollapsed:a.noop,persist:a.noop,collapsedWidth:30,expandedWidth:200,minWidth:function(){return 200},maxWidth:function(){return 500},resize:a.noop,dockText:"Dock",undockText:"Undock",dockTitle:"Dock the filter panel so you can always see the list of filters",undockTitle:"Undock the filter panel so it is hidden when not being focused"},CLASS_NAMES:{popout:"ui-popout",placeholder:"ui-popout-placeholder",detached:"ui-popout-detached",expanding:"ui-popout-expanding",expanded:"ui-popout-expanded",collapsed:"ui-popout-collapsed",collapsing:"ui-popout-collapsing"},_create:function(){_.bindAll(this,"_handleDropdown","_registerMousePos","collapse","expand","updateOffsets");if(!this.element.data("popoutsidebar")){this.element.data("popoutsidebar",true);this.element.bind("updateOffsets.popout",this.updateOffsets);this.element.delegate(".ui-dock","click",_.bind(function(b){this.dock(true);b.preventDefault()},this));this.element.delegate(".ui-undock","click",_.bind(function(b){this.undock(true);b.preventDefault()},this));this.isDocked=this.options.isDocked;this.expandedWidth=this.options.expandedWidth;this.useTransitions=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)>8;if(this.options.isDocked){this._renderUnDock()}else{this._enableUndockedMode()}this.updateOffsets()}},_init:function(){if(this.options.isDocked){this._setupHandle()}},_persistState:function(){this.expandedWidth=this.element.outerWidth();this.options.persist(this.isDocked,this.expandedWidth)},_setContainment:function(){var b=window.innerHeight;this._elementLeft=this.element.offset().left;this._minLeft=this._elementLeft+this.options.minWidth();this._maxLeft=Math.max(this._minLeft,this._elementLeft+this.options.maxWidth());this.handle.draggable({containment:[this._minLeft,b,this._maxLeft,b]});this.handle.css("position","absolute")},_setWidth:function(b){b=Math.min(Math.max(this.options.minWidth(),b),this.options.maxWidth());this.element.width(b)},_setupHandle:function(){this._getContents();this.handle=jQuery("<div />").addClass("ui-sidebar").appendTo(this.element);this._setWidth(this.expandedWidth);this._setHandlePosition();this.handle.mousedown(_.bind(this._setContainment,this));this.handle.draggable({axis:"x",drag:_.bind(this._handleDrag,this),stop:_.bind(this._persistState,this)})},_setHandlePosition:function(){this._setContainment();if(this._minLeft===this._maxLeft){this.handle.hide()}else{var b=this.element.offset();var c=b.left+this.element.outerWidth();this.handle.css({left:c}).show()}},_handleDrag:function(d,b){var c=b.position.left;this._setWidth(c);this.options.resize()},_getUndockedClasses:function(){return[this.CLASS_NAMES.detached].join(" ")},_getUndockedStates:function(){return[this.CLASS_NAMES.collapsed,this.CLASS_NAMES.collapsing,this.CLASS_NAMES.expanding,this.CLASS_NAMES.expanded].join(" ")},_setUndockedState:function(b){this.element.removeClass(this._getUndockedStates());this.element.addClass(b)},unbindHoverIntent:function(){this.element.off("mouseleave mouseenter mousemove");this.element[0].hoverIntent_s=0},bindHoverIntent:function(){this.element.hoverIntent({interval:40,over:this.expand,out:this.collapse,sensitivity:8})},_unbindUnDockedEvents:function(){this.unbindHoverIntent();JIRA.unbind(AJS.InlineLayer.EVENTS.show,this._handleDropdown);a(window).unbind("scroll",this.updateOffsets)},_bindUnDockedEvents:function(b){this.bindHoverIntent();a(window).scroll(this.updateOffsets);this.element[0].hoverIntent_s=b?1:0},isUndocked:function(){return this.element.hasClass(this.CLASS_NAMES.detached)},_registerMousePos:function(b){this._clientX=b.clientX;this._clientY=b.clientY},_handleDropdown:function(){a(document).mousemove(this._registerMousePos);if(this.isUndocked()&&AJS.InlineLayer.current.offsetTarget().closest(this.element).size()){this.unbindHoverIntent();JIRA.one(AJS.InlineLayer.EVENTS.hide,_.bind(function(){_.defer(_.bind(function(){if(!AJS.InlineLayer.current){if(JIRA.Dialog.current||this._clientX>this.element.offset().left+this.element.outerWidth()){this.collapse(JIRA.Dialog.current?false:true);this.bindHoverIntent()}else{this.bindHoverIntent();this.element[0].hoverIntent_s=1}a(document).unbind("mousemove",this._registerMousePos)}},this))},this))}},updateOffsets:function(f){if(this.element.is(":visible")){var i=window.innerHeight;var d=a("body").height()>i;if(d){this.element.addClass("ui-sidebar-scrollable")}else{this.element.removeClass("ui-sidebar-scrollable")}if(this.isUndocked()){var c=this._getPlaceholder().offset().top;var g=jQuery(window).scrollTop();var h=Math.max(c-g,0);var b=d?i-h:Math.min(this._getPlaceholder().outerHeight(),i-this._getPlaceholder().offset().top);var e={top:h,height:b};if(f){e.width=f}this.element.css(e)}}},_renderUnDock:function(){if(this.isDocked&&!this.element.find(".ui-undock").size()){this.element.find(".ui-dock").remove();this._renderDockingLink(this.options.undockText,this.options.undockTitle,"ui-undock")}},_renderDock:function(){if(this.isUndocked()&&!this.element.find(".ui-dock").size()){this.element.find(".ui-undock").remove();this._renderDockingLink(this.options.dockText,this.options.dockTitle,"ui-dock")}},_renderDockingLink:function(e,d,b){var c=a("<a class='aui-button aui-button-subtle' href='#'/>").addClass(b).append(a("<span class='icon'/>").text(e)).attr("title",d);this.dockTipsy=new JIRA.Issues.Tipsy({el:c});this._getContents().find(this.options.toggleTarget).append(c)},renderDockState:function(){if(this.isDocked){this._renderUnDock()}else{this._renderDock()}},_enableUndockedMode:function(b){this.element.addClass(this.CLASS_NAMES.popout);if(!this.isUndocked()){this._getPlaceholder().insertBefore(this.element);this.element.addClass(this.CLASS_NAMES.detached).addClass(this.CLASS_NAMES.collapsed).appendTo("body")}this.updateOffsets();this._bindUnDockedEvents(b);JIRA.bind(AJS.InlineLayer.EVENTS.show,this._handleDropdown)},_getPlaceholder:function(){if(!this.placeholder){this.placeholder=a("<div class='navigator-sidebar collapsed' />")}return this.placeholder},toggle:function(){if(!this.isExpanding()&&!this.isCollapsing()){if(this.isDocked){this.undock(false)}else{this.dock(false)}}},undock:function(b){if(!this.isUndocked()){this.isDocked=false;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._persistState();this._getPlaceholder().insertBefore(this.element);this.element.addClass(this._getUndockedClasses()+" "+this.CLASS_NAMES.expanded).appendTo("body");if(b!==false&&this.useTransitions){this._getPlaceholder().width(this.expandedWidth).animate({width:this.options.collapsedWidth},200)}else{this._getPlaceholder().width(this.options.collapsedWidth)}this.updateOffsets(this.expandedWidth);this.collapse(b,_.bind(function(){this._enableUndockedMode(false)},this))}},dock:function(b){if(this.isUndocked()){this.isDocked=true;if(this.dockTipsy){this.dockTipsy.remove();this.dockTipsy=null}this._unbindUnDockedEvents();this._persistState();if(b!==false&&this.useTransitions){this._getPlaceholder().animate({width:this.expandedWidth},200,_.bind(this._dockingComplete,this))}else{this._dockingComplete()}}},_dockingComplete:function(){this.element.removeClass(this._getUndockedClasses());this.element.removeClass(this._getUndockedStates());this.element.css({height:"",width:"",top:""}).insertBefore(this._getPlaceholder());this._getPlaceholder().remove();this.options.renderExpanded(this.element);this._setupHandle();this._renderUnDock();JIRA.Issues.triggerHorizontalResize()},_getContents:function(){if(!this.element.find(".ui-sidebar-content").size()){this.element.wrapInner("<div class='ui-sidebar-content' />")}return this.element.find(".ui-sidebar-content")},expand:function(b){if(this.isCollapsed()){this.updateOffsets();if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.expanding);this.element.animate({width:this.expandedWidth},150,_.bind(function(){this._setUndockedState(this.CLASS_NAMES.expanded);this.options.renderExpanded(this.element);this._renderDock();this._getContents().css("opacity",0).animate({opacity:1},200,_.bind(this._expandingComplete,this))},this))}else{this.element.css("width",this.expandedWidth);this.options.renderExpanded(this.element);this._renderDock();this._expandingComplete()}}else{if(this.isCollapsing()){this.activityAfterTransition="expand"}else{if(this.isExpanding()){this.activityAfterTransition=null}}}},_expandingComplete:function(){JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(true);this._setUndockedState(this.CLASS_NAMES.expanded);if(this.activityAfterTransition==="collapse"){this.activityAfterTransition=null;this.collapse(true)}},collapse:function(b,c){if(this.isExpanded()){if(b!==false&&this.useTransitions){this._setUndockedState(this.CLASS_NAMES.collapsing);this._getContents().animate({opacity:0},150,_.bind(function(){this.options.renderCollapsed(this.element);this.element.width(this.expandedWidth);this.element.animate({width:this.options.collapsedWidth},150,_.bind(function(){this._collapsingComplete(c)},this))},this))}else{this.options.renderCollapsed(this.element);this.element.width("");this._collapsingComplete(c)}}else{if(this.isExpanding()){this.activityAfterTransition="collapse"}else{if(this.isCollapsing()){this.activityAfterTransition=null}}}},_collapsingComplete:function(b){this._setUndockedState(this.CLASS_NAMES.collapsed);JIRA.Issues.triggerHorizontalResize();this._bindUnDockedEvents(false);if(this.activityAfterTransition==="expand"){this.activityAfterTransition=null;this.expand(true)}if(typeof b==="function"){b()}},isCollapsed:function(){return this.element.hasClass(this.CLASS_NAMES.collapsed)},isCollapsing:function(){return this.element.hasClass(this.CLASS_NAMES.collapsing)},isExpanded:function(){return this.element.hasClass(this.CLASS_NAMES.expanded)},isExpanding:function(){return this.element.hasClass(this.CLASS_NAMES.expanding)}})}(jQuery));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/HtmlCatchExceptions.js' */
(function(b){var a=function(c){return function(d){try{c.apply(this,arguments)}catch(f){if(console&&console.error&&typeof d==="string"){console.error("Error while evaluating HTML: "+f.message+", in: ",d)}}return this}};b.fn.htmlCatchExceptions=a(b.fn.html);b.fn.appendCatchExceptions=a(b.fn.append);b.fn.prependCatchExceptions=a(b.fn.prepend);b.catchExceptions=function(c){return b("<div>").htmlCatchExceptions(c).children()}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/ScrollLock.js' */
(function(b){var a=30;b.fn.scrollLock=function(c,d){if(typeof c!=="string"){d=c;c=null}if(!d){d=a}this.on("DOMMouseScroll mousewheel",c,function(f){f.preventDefault();var g;if(f.originalEvent.wheelDelta){g=f.originalEvent.wheelDelta/120}if(f.originalEvent.detail){g=-f.originalEvent.detail/3}this.scrollTop-=g*d})}})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/mixin/SingleSelect.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={properties:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/DefaultMessageOptions.js' */
AJS.namespace("JIRA.Issues.getDefaultMessageOptions",window,function(){return{closeable:true,timeout:5}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/SessionTimedOutDialog.js' */
AJS.namespace("JIRA.Issues.SessionTimedOutDialog");JIRA.Issues.SessionTimedOutDialog={dialogHasShown:false,whiteList:["/secure/Search!Jql.jspa","/secure/SearchRendererEdit!Default.jspa","/rest/issueNav/1/issueTable","/rest/issueNav/latest","/rest/api/2/filter"],onRequestResponse:function(f,g,d){if(!this.dialogHasShown&&this.urlIsInWhiteList(d.url)){var b=JIRA.Issues.LoginUtils.loggedInUserName(),a=g.getResponseHeader("X-AUSERNAME");if(this.userHasChanged(b,a)){this.dialogHasShown=true;var c=new JIRA.FormDialog({content:AJS.$(JIRA.Templates.Issues.Util.anonymousErrorDialog({modifierKey:AJS.Navigator.modifierKey(),redirect:window.location.href.substring(window.location.href.indexOf(contextPath)+contextPath.length)}))});c.show()}}},userHasChanged:function(b,a){if(b===""&&a==="anonymous"){return false}if(b===""&&a&&a!=="anonymous"&&a!==""){return false}if(b!==""&&a==="anonymous"){return true}return false},urlIsInWhiteList:function(b){for(var c=0;c<this.whiteList.length;c++){var a=this.whiteList[c];if(b.indexOf(a)>-1){return true}}return false}};(function(a){a(document).ajaxComplete(function(c,d,b){JIRA.Issues.SessionTimedOutDialog.onRequestResponse(c,d,b)})})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/LoginUtils.js' */
JIRA.Issues.LoginUtils={isLoggedIn:function(){return !!this.loggedInUserName()},loggedInUserName:function(){return AJS.Meta.get("remote-user")},currentContextRelativePath:function(){var b=this._getWindowLocation();var c=b.protocol+"//"+b.host+(contextPath||"");var a=b.href;if(a.indexOf(c)===0){return a.substr(c.length)}return a},redirectUrlToCurrent:function(){var a=this.currentContextRelativePath();return contextPath+"/login.jsp?os_destination="+encodeURIComponent(a)},redirectUrl:function(a){return AJS.contextPath()+"/login.jsp?os_destination="+encodeURIComponent(a)},_getWindowLocation:function(){return window.location}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/cache/IssueCacheManager.js' */
(function(){Backbone.define("JIRA.Issues.Cache.IssueCacheManager",JIRA.Issues.BaseEvented.extend({initialize:function(a){this.searchResults=a.searchResults;this.viewIssueData=a.viewIssueData;this.searchResults.bind("issueDeleted",this._onIssueDeleted,this);this.searchResults.bind("nextIssueSelected",this._onNextIssueSelected,this);this.searchResults.bind("prevIssueSelected",this._onPrevIssueSelected,this);this._prefetchCandidate=null},prefetchIssues:function(){if(this._prefetchCandidate&&this._prefetchCandidate.key){this._prefetchIssue(this._prefetchCandidate.key);this._prefetchCandidate=null}},scheduleIssueToBePrefetched:function(a){this._prefetchCandidate=a},_onIssueDeleted:function(a){this.viewIssueData.remove(a.key)},_onNextIssueSelected:function(a){this._prefetchCandidate=a.nextNextIssue},_onPrevIssueSelected:function(a){this._prefetchCandidate=a.prevPrevIssue},_prefetchIssue:function(a){if(!JIRA.Issues.DarkFeatures.NO_PREFETCH.enabled()){this.viewIssueData.get(a,false,{prefetch:true})}}}))})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/SimpleIssue.js' */
Backbone.define("JIRA.Issues.SimpleIssue",JIRA.Issues.BaseModel.extend({properties:["id","key"],defaults:{id:null,key:null},hasIssue:function(){return !!this.getId()}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/search/issue/FullScreenIssue.js' */
Backbone.define("JIRA.Issues.FullScreenIssue",JIRA.Issues.BaseView.extend({namedEvents:["issueHidden"],initialize:function(a){_.extend(this,a);_.bindAll(this,"onLoadComplete","showError");if(this.issueContainer.hasClass("hidden")){this.issueContainer.detach();this.issueContainer.removeClass("hidden")}if(this.searchContainer.hasClass("hidden")){this.searchContainer.detach();this.searchContainer.removeClass("hidden")}},bindSearchService:function(a){this.listenTo(a,{issueUpdated:function(d,b,c){if(c.action!=="inlineEdit"&&c.action!=="rowUpdate"){return this.updateIssue(c)}},selectedIssueChanged:function(b){if(b.hasIssue()){JIRA.Issues.Application.execute("issueEditor:abortPending");this.show({id:b.getId(),key:b.getKey(),pager:a.getPager()});this.updatePager(a.getPager())}else{if(this.isVisible()){this.hide();JIRA.trace("jira.returned.to.search");JIRA.trace("jira.psycho.returned.to.search");JIRA.Issues.Application.execute("analytics:trigger","kickass.returntosearch")}}}})},deactivate:function(){this.stopListening();if(this.active){if(this.stalker){this.stalker.unstalk()}JIRA.Issues.Application.off("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.off("issueEditor:loadError",this.showError);JIRA.Issues.Application.execute("issueEditor:abortPending");this.active=false}},activate:function(){if(!this.active){JIRA.Issues.Application.on("issueEditor:loadComplete",this.onLoadComplete);JIRA.Issues.Application.on("issueEditor:loadError",this.showError);this.active=true}},onLoadComplete:function(a,b){this.stalker=AJS.$(".js-stalker",this.issueContainer).stalker();this._makeIssueVisible();if(b.isNewIssue){this._scrollToTop()}},_makeIssueVisible:function(){JIRA.Issues.Application.execute("issueEditor:beforeShow");this._setBodyClasses({error:false,issue:true,search:true});if(!this.isVisible()){this.issueContainer.insertBefore(this.searchContainer);this.searchContainer.detach();JIRA.trace("jira.psycho.issue.refreshed",{id:JIRA.Issues.Application.request("issueEditor:getIssueId")});JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.issueContainer,JIRA.CONTENT_ADDED_REASON.pageLoad])}},updateIssue:function(c){var a,b;b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(this.isVisible()){a=JIRA.Issues.Application.request("issueEditor:refreshIssue",c);a.done(function(){if(!b&&c.message){JIRA.Issues.showNotification(c.message,c.key)}})}else{a=jQuery.Deferred().resolve().promise()}return a},showError:function(){this._setBodyClasses({error:true,issue:false,search:false})},isVisible:function(){return this.issueContainer.closest("body").length>0},_scrollToTop:function(){AJS.$(window).scrollTop(0)},_setBodyClasses:function(a){AJS.$("body").toggleClass("page-type-message",a.error).toggleClass("navigator-issue-only",a.issue).toggleClass("page-type-navigator",a.search)},hide:function(){this._setBodyClasses({error:false,issue:false,search:true});if(this.isVisible()){this.searchContainer.insertBefore(this.issueContainer);this.issueContainer.detach();this.trigger("issueHidden")}},updatePager:function(a){JIRA.Issues.Application.execute("pager:update",a)},show:function(a){this.activate();JIRA.Issues.Application.execute("issueEditor:setContainer",this.issueContainer);return JIRA.Issues.Application.request("issueEditor:loadIssue",a).always(_.bind(function(){AJS.$(".js-stalker",this.issueContainer).stalker();this.updatePager(a.pager);this.issueCacheManager.prefetchIssues()},this))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/Resize.js' */
(function(){var a="horizontalResize",b="verticalResize";JIRA.Issues.offHorizontalResize=function(c){AJS.$(document).off(a,c)};JIRA.Issues.onHorizontalResize=function(c){AJS.$(document).on(a,c)};JIRA.Issues.triggerHorizontalResize=_.throttle(function(){AJS.$(document).trigger(a)},100);JIRA.Issues.offVerticalResize=function(c){AJS.$(document).off(b,c)};JIRA.Issues.onVerticalResize=function(c){AJS.$(document).on(b,c)};JIRA.Issues.triggerVerticalResize=_.throttle(function(){AJS.$(document).trigger(b)},100);jQuery(window).resize(JIRA.Issues.triggerVerticalResize)}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/UserParms.js' */
JIRA.Issues.UserParms={createSharedObjects:function(){return this.get().createSharedObjects},get:function(){if(!this.data){this.data=AJS.$("#user-parms").data("user-parms")||{}}return this.data}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:common', location = 'content/js/util/QueryStringParser.js' */
AJS.namespace("JIRA.Issues.QueryStringParser");JIRA.Issues.QueryStringParser={parser:/(?:^|&)([^&=]*)=?([^&]*)/g,parse:function(b){if(!b&&b!==0){return{}}b=""+b;if("?"===b.charAt(0)){b=b.substring(1)}var a={};b.replace(this.parser,function(d,c,f){var e=decodeURIComponent((f||"").replace(/\+/g," "));a[decodeURIComponent(c)]=e});return a}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/orderby.soy' */
// This file was automatically generated from orderby.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.OrderBy == 'undefined') { JIRA.Templates.OrderBy = {}; }


JIRA.Templates.OrderBy.orderBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.sortBy && opt_data.sortBy.fieldId) ? '<a class="order-by ' + ((opt_data.sortBy.order == 'ASC') ? 'ascending' : 'descending') + '" data-field-id="' + soy.$$escapeHtml(opt_data.sortBy.fieldId) + '" data-direction="' + soy.$$escapeHtml(opt_data.sortBy.order) + '" href="#" title="' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '"><span>' + soy.$$escapeHtml(AJS.format("Order by {0}",opt_data.sortBy.fieldName)) + '</span></a>' : '<a class="order-by" title="' + soy.$$escapeHtml("Order by") + '"><span>' + soy.$$escapeHtml("Order by") + '</span></a>', '<a class="order-options" title="', soy.$$escapeHtml("Select the field that issues are ordered by."), '">', soy.$$escapeHtml("Select the field that issues are ordered by."), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.OrderBy.orderByOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="order-by-options" multiple="multiple" class="hidden"><optgroup data-footer-text="', soy.$$escapeHtml(opt_data.footer), '">');
  var optionList35 = opt_data.options;
  var optionListLen35 = optionList35.length;
  for (var optionIndex35 = 0; optionIndex35 < optionListLen35; optionIndex35++) {
    var optionData35 = optionList35[optionIndex35];
    output.append('<option title="', soy.$$escapeHtml(optionData35.fieldName), '" value="', soy.$$escapeHtml(optionData35.fieldId), '" data-meta="', soy.$$escapeHtml(optionData35.meta), '">', soy.$$escapeHtml(optionData35.fieldName), '</option>');
  }
  output.append('</optgroup></select>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByModel.js' */
JIRA.Issues.OrderByModel=JIRA.Issues.Brace.Model.extend({namedEvents:["sort"],namedAttributes:["sortBy","jql"],initialize:function(){this.on("change:jql",this.updateSelectedSort,this)},updateSelectedSort:function(){jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions/primary",data:JSON.stringify({jql:this.getJql()}),contentType:"application/json",success:_.bind(function(a){this.setSortBy(a)},this)})},toggleSort:function(){this.setJql(this.getSortBy().toggleJql);this.triggerSort(this.getJql())},doSort:function(a){this.setJql(a);this.triggerSort(this.getJql())}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByView.js' */
JIRA.Issues.OrderByView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.OrderBy.orderBy,events:{"click a.order-by":"_onClickOrderBy","click a.order-options":"_toggleShowDropDown"},initialize:function(){this.model.on("change:sortBy",this.render,this)},render:function(){this.$el.html(this.template(this.model.toJSON()));return this},deactivate:function(){this.orderByDropDown&&this.orderByDropDown.deactivate();this.undelegateEvents()},_onClickOrderBy:function(c){var b=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(b);if(!b.isDefaultPrevented()){var a=AJS.$(c.currentTarget).data("field-id");if(a){this.model.toggleSort()}}c.preventDefault()},_toggleShowDropDown:function(a){if(!this.orderByDropDown){this.orderByDropDown=new JIRA.Issues.OrderByDropDownView({model:this.model,offsetTarget:this.$("a.order-by"),onHideCallback:_.bind(function(){this.orderByDropDown=null},this)})}this.orderByDropDown.toggle();a.preventDefault()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderByDropDownView.js' */
JIRA.Issues.OrderByDropDownView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.bindAll(this,"_onDropdownHidden","_onDropdownShown");this.offsetTarget=a.offsetTarget;this._onHideCallback=a.onHideCallback;this._pending=null;this._inlineLayer=null},deactivate:function(){this._inlineLayer&&this._inlineLayer.hide();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},toggle:function(){if(!this._inlineLayer){this._pending=AJS.$.ajax(this._ajaxDefaults());this._inlineLayer=this._createInlineLayer(this._pending);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.show,this._onDropdownShown);this._inlineLayer.bind(AJS.InlineLayer.EVENTS.hide,this._onDropdownHidden);this._inlineLayer.show()}else{this._inlineLayer.hide()}},_createInlineLayer:function(a){var b=_.bind(function(d){this._deferredAddTipsyToFooter(d);return this._renderInitialContent(d)},this);var c=new AJS.InlineLayer({offsetTarget:this.offsetTarget,content:function(){return a.pipe(b)},width:218});if(this._onHideCallback){c.bind(AJS.InlineLayer.EVENTS.hide,this._onHideCallback)}return c},_initSingleSelect:function(b){var c=b.find("select");c.bind("selected",_.bind(this._onFieldSelected,this));this.selectControl=new AJS.CheckboxMultiSelect({element:c,itemAttrDisplayed:"label",suggestionsHandler:AJS.SelectSuggestHandler,ajaxOptions:this._ajaxDefaults({data:_.bind(function(d){return JSON.stringify(this._ajaxOptionsData(d))},this),query:true,minQueryLength:0,formatResponse:_.bind(function(d){this._removeTipsy();var f=new AJS.GroupDescriptor();_.each(d.fields,function(g){f.addItem(new AJS.ItemDescriptor({title:g.fieldName,value:g.fieldId,label:g.fieldName,meta:{sortJql:g.sortJql}}))});var e=this._getFooterText(d);if(e){f.footerText(e);this._deferredAddTipsyToFooter(d)}return[f]},this)})});var a=b.find("#order-by-options-input");a.focus()},_ajaxDefaults:function(b){var a={url:AJS.contextPath()+"/rest/orderbycomponent/latest/orderByOptions",type:"POST",contentType:"application/json",data:JSON.stringify(this._ajaxOptionsData())};return _.extend(a,b)},_ajaxOptionsData:function(b){var a=this.model.getJql();var c=this.model.getSortBy();return{query:b,jql:a?a:undefined,sortBy:c?c.fieldId:undefined}},_renderInitialContent:function(a){var b=_.map(a.fields,function(c){return _.extend({},c,{meta:JSON.stringify({sortJql:c.sortJql})})});return AJS.$("<div></div>").addClass("order-dropdown").html(JIRA.Templates.OrderBy.orderByOptions({options:b,footer:this._getFooterText(a)}))},_onDropdownShown:function(b,a,c){this._initSingleSelect(a)},_onDropdownHidden:function(b,a,c){this._removeTipsy();AJS.$("div.order-dropdown").remove();this._inlineLayer=null},_onFieldSelected:function(c,b){var a=new AJS.$.Event(JIRA.Events.ISSUE_TABLE_REORDER);JIRA.trigger(a);if(!a.isDefaultPrevented()){_.defer(_.bind(function(){if(this.selectControl.outstandingRequest){this.selectControl.outstandingRequest.reject()}AJS.InlineLayer.current.hide();var d=b.meta();this.model.doSort(d.sortJql)},this))}},_getFooterText:function(a){if(typeof a.matchesCount==="number"&&typeof a.maxResults==="number"){var b=a.matchesCount-a.maxResults;if(b>0){return AJS.format("{0} more fields...",b)}}return""},_deferredAddTipsyToFooter:function(d){if(this._inlineLayer){var b=d.matchesCount;var e=Math.min(d.matchesCount,d.maxResults);var c=AJS.format("Showing {0} of {1} matching fields. Find more fields by typing in the search box.",e,b);var a=this;_.defer(function(){a._tipsyTrigger=new JIRA.Issues.Tipsy({el:a._inlineLayer.$layer.find(".aui-list-section-footer"),tipsy:{title:function(){return c},className:"tipsy-front"}})})}},_removeTipsy:function(){if(this._tipsyTrigger){this._tipsyTrigger.hide();this._tipsyTrigger=null}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:orderby', location = 'orderby/OrderBy.js' */
JIRA.Events.ISSUE_TABLE_REORDER="issueTableReorder";JIRA.Components.OrderBy={create:function(c){var b,a;c=c||{};b=new JIRA.Issues.OrderByModel({sortBy:c.sortBy,jql:c.jql});a=new JIRA.Issues.OrderByView({model:b});return{onSort:function(){b.onSort.apply(b,arguments);return this},offSort:function(d){b.off("sort",d);return this},render:function(){a.render();return this},setElement:function(d){a.setElement(d);return this},setJql:function(d){b.setJql(d);return this},setSortBy:function(d){b.setSortBy(d);return this}}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.soy' */
// This file was automatically generated from ColumnPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.ColumnPicker == 'undefined') { JIRA.Templates.Dialogs.ColumnPicker = {}; }


JIRA.Templates.Dialogs.ColumnPicker.popup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><form action="#" method="post"  class="aui top-label column-picker"><div class="check-list-top-panel"><h3>', soy.$$escapeHtml("Columns"), '</h3>');
  if (opt_data.columns.length > 1) {
    output.append('<p class="aui-buttons">');
    var columnList9 = opt_data.columns;
    var columnListLen9 = columnList9.length;
    for (var columnIndex9 = 0; columnIndex9 < columnListLen9; columnIndex9++) {
      var columnData9 = columnList9[columnIndex9];
      output.append('<button type="button" class="config-chooser aui-button ', (columnData9.isActive) ? ' active' : '', '" id="columns-chooser-', soy.$$escapeHtml(columnData9.name), '" data-value="', soy.$$escapeHtml(columnData9.name), '"', (columnData9.isDisabled) ? 'aria-disabled="true"' : '', '>', soy.$$escapeHtml(columnData9.description), '</button>');
    }
    output.append('</p>');
  }
  output.append('</div>');
  var columnList28 = opt_data.columns;
  var columnListLen28 = columnList28.length;
  for (var columnIndex28 = 0; columnIndex28 < columnListLen28; columnIndex28++) {
    var columnData28 = columnList28[columnIndex28];
    output.append('<div class="', soy.$$escapeHtml(columnData28.name), '-column-sparkler hidden"></div>');
  }
  output.append((! opt_data.isAutoUpdate) ? '<div class="button-panel"><input accesskey="' + soy.$$escapeHtml("s") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)) + '" class="aui-button submit" type="submit" value="' + soy.$$escapeHtml("Done") + '"/> <a accesskey="' + soy.$$escapeHtml("`") + '" title="' + soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)) + '" class="aui-button aui-button-link close-dialog" href="javascript:">' + soy.$$escapeHtml("Cancel") + '</a></div>' : '', '</form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle column-picker-trigger" title="', soy.$$escapeHtml("Columns"), '">', soy.$$escapeHtml("Columns"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-link restore-defaults">', soy.$$escapeHtml(opt_data.linkText), '</button>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPicker.js' */
if(!JIRA.Components){JIRA.Components={}}JIRA.Components.ColumnPicker=JIRA.Issues.Brace.Model.extend({initialize:function(a,b){this.columnPickerModel=new JIRA.Issues.ColumnPickerModel({autoUpdate:b.autoUpdate});this.columnPickerView=new JIRA.Issues.ColumnPickerView({columnPickerModel:this.columnPickerModel});_.each(b.providers,_.bind(function(c){if(c instanceof JIRA.Issues.ColumnConfigModel){this.columnPickerModel.addColumnProvider(c.getName(),c)}else{this.columnPickerModel.addColumnProvider(c.id,this._createProviderModel(c));if(c.columns){this.columnPickerModel.syncColumns(c.id,c.columns)}}},this));this.setCurrentColumnConfig(b.providers[0].id);if(b.el){this.columnPickerView.setElement(b.el).render()}},_createProviderModel:function(a){return JIRA.Issues.ColumnConfigModel.create(a.id,a.label,_.omit(a,"id","label","columns"))},getCurrentColumnConfig:function(){return this.columnPickerModel.getCurrentColumnConfig()},setElement:function(a){this.columnPickerView.setElement(a);return this},render:function(){this.columnPickerView.render();return this},clearFilterConfiguration:function(){this.columnPickerModel.clearFilterConfiguration();return this},adjustHeight:function(){this.columnPickerView.adjustHeight();return this},setCurrentColumnConfig:function(a){this.columnPickerModel.setCurrentColumnConfig(a);return this},saveColumns:function(a){this.columnPickerModel.saveColumns(a);return this},syncColumns:function(a,b){this.columnPickerModel.syncColumns(a,b);return this},getColumnConfig:function(){this.columnPickerModel.getColumnConfig()},onColumnsSync:function(b,a){this.columnPickerModel.onColumnsSync(b,a);return this},on:function(b,c,a){this.columnPickerModel.on(b,c,a);return this},off:function(a,b){this.columnPickerModel.off(a,b);return this}});JIRA.Components.ColumnPicker.create=function(a){return new JIRA.Components.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerModel.js' */
JIRA.Issues.ColumnPickerModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["columnConfig","savedColumnConfig","search","availableColumns","autoUpdate"],namedEvents:["columnsSync","changeColumnConfigDisabled","destroyColumnConfig"],allColumnsUrl:AJS.contextPath()+"/rest/gadget/1.0/availableColumns",shouldRefreshSearchOnActivation:function(){return this.getCurrentColumnConfig().shouldRefreshSearchOnActivation()},shouldCloseOnActivation:function(){return this.getCurrentColumnConfig().shouldCloseOnActivation()},shouldLoadDefaultsOnActivation:function(){return this.getCurrentColumnConfig().shouldLoadDefaultsOnActivation()},shouldRevertOnHide:function(){return this.getCurrentColumnConfig().shouldRevertOnHide()},loadDefaultColumns:function(){this.getCurrentColumnConfig().loadDefaultColumns()},initialize:function(){this.columnsData={}},refreshSearchWithColumns:function(a){a=a||this.getCurrentColumnConfig();this.triggerColumnsSync(a.getName(),a.getColumns())},fetchAvailableColumnsIfNeeded:function(){if(!this.has("availableColumns")){jQuery.ajax(this.allColumnsUrl).done(_.bind(function(a){this.setAvailableColumns(a.availableColumns)},this))}},getCurrentColumnConfig:function(a){if(!a){a=this.getColumnConfig()}return this.columnsData[a]},revertColumnConfig:function(){if(this.shouldRevertOnHide()&&this.getSavedColumnConfig()!=this.getColumnConfig()){this._previousAttributes.columnConfig=this.getSavedColumnConfig();this.setColumnConfig(this.getSavedColumnConfig(),{silent:true})}},setCurrentColumnConfig:function(a){this.setColumnConfig(a);this.setSavedColumnConfig(a)},syncColumns:function(a,b){_.each(this.columnsData,function(c){if(c.getName()==a){c.setColumns(b);c.setSavedColumns(b)}})},saveColumns:function(a){this.getCurrentColumnConfig().setColumns(a);this.getCurrentColumnConfig().save();this.getCurrentColumnConfig().triggerColumnsSync()},addColumnProvider:function(b,a){this.columnsData[b]=a;a.on("columnsSync sync destroy",_.bind(function(){this.refreshSearchWithColumns(a)},this));a.on("change:isDisabled",_.bind(function(d,c){this.triggerChangeColumnConfigDisabled(d,c)},this));a.on("destroy",_.bind(function(c){this.triggerDestroyColumnConfig(c)},this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerView.js' */
JIRA.Issues.ColumnPickerView=JIRA.Issues.Brace.View.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_generateInlineDialogContent","_onDOMCloseDialogClick","_onDOMConfigChooserClick","_onDOMDialogHide","_onDOMFormSubmit","_onDOMTriggerClick","_onModelChangeAvailableColumns","_onModelChangeColumnConfig","_onModelChangeColumnConfigDisabled","_onModelDestroyColumnConfig");this.subViews={}},dialog:null,activeSubview:null,_onDOMConfigChooserClick:function(b){var a=jQuery(b.target);if(a.attr("aria-disabled")){return}this.columnPickerModel.setColumnConfig(a.data("value")||"user")},_activateNewSubView:function(a){a.activate();if(this.columnPickerModel.shouldCloseOnActivation()){this.dialog.hide()}else{this.activeSubview=a;this.activeSubview.show();this.adjustHeight()}if(this.columnPickerModel.shouldRefreshSearchOnActivation()){this.columnPickerModel.refreshSearchWithColumns()}if(this.columnPickerModel.shouldLoadDefaultsOnActivation()){this.columnPickerModel.loadDefaultColumns()}},_onDOMFormSubmit:function(a){a.preventDefault();this.activeSubview.saveColumns();this.dialog.hide()},_onDOMCloseDialogClick:function(a){this.dialog.hide()},_onDOMTriggerClick:function(a){this.dialog.show();this.activeSubview=this.subViews[this.columnPickerModel.getCurrentColumnConfig().getName()];this.activeSubview.show();this._activateConfigChooserButton(this.columnPickerModel.getCurrentColumnConfig().getName());this.columnPickerModel.fetchAvailableColumnsIfNeeded()},_activateConfigChooserButton:function(a){this.dialog.find(".config-chooser.active").removeClass("active");this.dialog.find("#columns-chooser-"+a).addClass("active")},_onDOMDialogHide:function(a){this.columnPickerModel.revertColumnConfig();this.activeSubview.hide()},_onModelChangeColumnConfig:function(d,b){var a=this.subViews[b];this._activateConfigChooserButton(a.model.getName());var c=this.subViews[d.previous("columnConfig")];if(c!=a){c.hide();c.deactivate();this._activateNewSubView(a)}},_onModelChangeAvailableColumns:function(b,a){_.each(this.subViews,function(c){c.createSparklerControl(a)})},_onModelDestroyColumnConfig:function(){this.dialog.hide()},_onModelChangeColumnConfigDisabled:function(b,a){var c=this.dialog.find("#columns-chooser-"+b.getName());if(a){c.attr("aria-disabled",true)}else{c.removeAttr("aria-disabled")}},render:function(){if(!this.$trigger){this.$trigger=jQuery(JIRA.Templates.Dialogs.ColumnPicker.trigger())}this.$el.append(this.$trigger);this.$trigger.click(this._onDOMTriggerClick);this._renderInlineDialog()},adjustHeight:function(){if(AJS.InlineDialog.current&&AJS.InlineDialog.current.id==="column-picker-dialog"&&this.activeSubview){var c=jQuery(this.activeSubview.el).find(".aui-list-scroll");var d=((window.innerHeight-this.$trigger.offset().top)-90);var b=d-this.dialog.height();var a=Math.max(Math.min(c.height()+b,270),80);c.css("height",a);return true}return false},_generateInlineDialogContent:function(c,a,b){if(!this.dialogContent){c.html(JIRA.Templates.Dialogs.ColumnPicker.popup({modifierKey:AJS.Navigator.modifierKey(),isAutoUpdate:this.columnPickerModel.getAutoUpdate(),columns:_.map(this.columnPickerModel.columnsData,_.bind(function(d){return{name:d.getName(),description:d.getDescription(),selected:false,isDisabled:d.isDisabled(),isActive:this.columnPickerModel.getCurrentColumnConfig()==d}},this))}));c.find(".config-chooser").click(this._onDOMConfigChooserClick);c.find("form").submit(this._onDOMFormSubmit);c.find(".close-dialog").click(this._onDOMCloseDialogClick);c.click(function(d){d.stopPropagation()});this._createSubViews(c);this.dialogContent=c.children()}else{c.append(this.dialogContent)}b()},_renderInlineDialog:function(){if(this.dialog){return}this.dialog=AJS.InlineDialog(this.$trigger,"column-picker-dialog",this._generateInlineDialogContent,{offsetY:15,addActiveClass:true,hideDelay:null,noBind:true,initCallback:_.bind(function(){var a=this;var b=function(){if(!a.adjustHeight()){setTimeout(b,100)}};b()},this),hideCallback:this._onDOMDialogHide})},_createSubViews:function(a){_.each(this.columnPickerModel.columnsData,_.bind(function(b){this.subViews[b.getName()]=new JIRA.Issues.ColumnPickerSparklerView({el:a.find("."+b.getName()+"-column-sparkler"),model:b,autoUpdate:this.columnPickerModel.getAutoUpdate()})},this));if(this.columnPickerModel.has("availableColumns")){this._onModelChangeAvailableColumns(this.columnPickerModel,this.columnPickerModel.getAvailableColumns())}this.columnPickerModel.on("change:availableColumns",this._onModelChangeAvailableColumns);this.columnPickerModel.on("change:columnConfig",this._onModelChangeColumnConfig);this.columnPickerModel.onChangeColumnConfigDisabled(this._onModelChangeColumnConfigDisabled);this.columnPickerModel.onDestroyColumnConfig(this._onModelDestroyColumnConfig)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnConfigModel.js' */
JIRA.Issues.ColumnConfigModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["name","columns","autoUpdate","savedColumns","description","previousColumns","actionBarText","isActive"],namedEvents:["columnsSync"],defaults:{actionBarText:"Restore Defaults",isActive:false},idAttribute:"name",initialize:function(a,b){_.extend(this,b)},getDefaultColumns:function(){var a=jQuery.Deferred();this.defaultColumns().done(_.bind(function(b){var c=this.parse(b);if(c&&c.columns){a.resolve(c.columns)}else{a.reject(null)}},this));return a.promise()},parse:function(a){if(!a){return{}}return{columns:_.compact(_.pluck(a,"value"))}},isDisabled:function(){return false},isEditDisabled:function(){return false},defaultColumns:function(){var a=jQuery.Deferred();a.resolve([]);return a.promise()},_sortColumnsUsingOriginalOrder:function(a,b){return _.intersection(a,b).concat(_.difference(b,a))},setUnsortedColumns:function(a){a=this._sortColumnsUsingOriginalOrder(this.getColumns(),a);this.setPreviousColumns(this.getColumns(),{silent:true});this.setColumns(a)},toJSON:function(){return{columns:this.getColumns()}},revertUnsavedColumns:function(a){if(this.getSavedColumns()!=this.getColumns()){this.setColumns(this.getSavedColumns(),a)}},loadDefaultColumns:function(){this.getDefaultColumns().done(_.bind(function(a){this.setColumns(a)},this))},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return true},shouldLoadDefaultsOnActivation:function(){return false},shouldRevertOnHide:function(){return true}});JIRA.Issues.ColumnConfigModel.create=function(b,d,c,a){return new JIRA.Issues.ColumnConfigModel({autoUpdate:a,name:b,description:d},c)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSparklerView.js' */
JIRA.Issues.ColumnPickerSparklerView=JIRA.Issues.Brace.View.extend({initialize:function(a){this._maxResults=(typeof a.maxResults=="number")?a.maxResults:this.MAX_DISPLAYED_ITEMS;this._autoUpdate=!!a.autoUpdate;this.$el.scrollLock(".aui-list-scroll");if(!this._autoUpdate){this.model.on("change:columns",_.bind(this._setSelectedColumns,this))}},MAX_DISPLAYED_ITEMS:25,_sparkler:null,activate:function(){this.model.setIsActive(true)},deactivate:function(){this.model.setIsActive(false)},hide:function(){this.model.revertUnsavedColumns({silent:true});this.$el.addClass("hidden");var a=this.$el.find("input[id *= column-sparkler-input]");a.val("")},show:function(){this.$el.removeClass("hidden");this._setSelectedColumns();var a=this.$el.find("input[id *= column-sparkler-input]");if(!a.is(":disabled")){a.focus()}},addMessage:function(a){if(this.$el.find(".aui-message."+a.type).length===0){AJS.messages[a.type](this.$el,{body:a.content,closeable:false,insert:"prepend",id:a.id})}},_disableEditIfNeeded:function(){if(this.model.isEditDisabled()){this._disableEdit()}else{this._enableEdit()}},_showEditDisabledMessage:function(){this.addMessage({content:"You cannot update the columns for a filter owned by another user.",type:"warning",id:this.model.getName()+"-edit-disabled-message"})},_hideEditDisabledMessage:function(){this.$el.find("#"+this.model.getName()+"-edit-disabled-message").remove()},_disableEdit:function(){this._sparkler.disable();this.$el.find("input[type='checkbox']").attr("disabled","disabled");this.$el.find(".check-list-item").addClass("disabled");this.$el.find(".no-suggestions").addClass("disabled");this.$el.find(".restore-defaults").attr("aria-disabled","true");this._showEditDisabledMessage()},_enableEdit:function(){this._sparkler.enable();this.$el.find("input[type='checkbox']").removeAttr("disabled");this.$el.find(".check-list-item").removeClass("disabled");this.$el.find(".no-suggestions").removeClass("disabled");this.$el.find(".restore-defaults").removeAttr("aria-disabled");this._hideEditDisabledMessage()},createSparklerControl:function(a){if(this._sparkler){this._sparkler.remove()}var b=this._buildQueryableSelect(a);this.$el.append(b);this._sparkler=new AJS.CheckboxMultiSelect({element:b,maxInlineResultsDisplayed:this._maxResults,suggestionsHandler:JIRA.Issues.ColumnPickerSuggestHandler,actionBar:this.model.getActionBarText()});this._setSelectedColumns();if(this._autoUpdate){b.bind("selected",_.bind(this.saveColumns,this));b.bind("unselect",_.bind(this.saveColumns,this))}this._sparkler.$field.focus();this.$el.on("actionclick",_.bind(function(c){c.preventDefault();this.model.unset("columns");this.model.destroy()},this));this.model.on("change:editDisabled",_.bind(this._disableEditIfNeeded,this))},saveColumns:function(){this.model.setUnsortedColumns(this._sparkler.model.getSelectedValues());this.model.save(null,{wait:false})},_setSelectedColumns:function(){var a=this.model.getColumns();var b=this._sparkler;if(b&&a&&a.length){_.each(b.model.getDisplayableUnSelectedDescriptors(),function(c){if(_.contains(a,c.value())){b.selectItem(c)}});_.each(b.model.getDisplayableSelectedDescriptors(),function(c){if(!_.contains(a,c.value())){b.unselectItem(c)}});b.render();this._disableEditIfNeeded()}},_buildQueryableSelect:function(c){var a=this;var b=_.map(c,function(d){return new AJS.ItemDescriptor(_.extend(d,{title:d.label}))});return jQuery(AJS.Templates.queryableSelect({id:a.model.getName()+"-column-sparkler",descriptors:[new AJS.GroupDescriptor({items:b})]}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:columnpicker', location = 'columnpicker/ColumnPickerSuggestHandler.js' */
JIRA.Issues.ColumnPickerSuggestHandler=AJS.SelectSuggestHandler.extend({createActionBar:function(b){if(!b){return null}var a=jQuery(JIRA.Templates.Dialogs.ColumnPicker.restoreDefaultsLink({linkText:b}));a.click(function(c){if(jQuery(c.target).attr("aria-disabled")!=="true"){a.trigger("actionclick")}c.preventDefault()});return jQuery("<li class='check-list-group-actions'></li>").append(a)},formatSuggestions:function(d,e){var f=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());var c=new AJS.GroupDescriptor({styleClass:"selected-group",items:f});d.splice(0,0,c);var a=_.find(d,function(g){return g.items().length});if(a){a.actionBarHtml(this.createActionBar(this.options.actionBar))}if(e.length>0){d=AJS.SuggestHelper.removeDuplicates(d);var b=AJS.SuggestHelper.extractItems(d).sort(function(h,g){h=h.label().toLowerCase();g=g.label().toLowerCase();return h.localeCompare(g)});d=[new AJS.GroupDescriptor({items:b})]}return d}});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/datePicker.soy' */
// This file was automatically generated from datePicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DateSearcher == 'undefined') { JIRA.Templates.DateSearcher = {}; }


JIRA.Templates.DateSearcher.dateMeasurement = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select class="js-measurement"><option value="m">', soy.$$escapeHtml("minutes"), '</option><option value="h">', soy.$$escapeHtml("hours"), '</option><option value="d">', soy.$$escapeHtml("days"), '</option><option value="w">', soy.$$escapeHtml("weeks"), '</option></select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderWithinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Within the last {0} {1}",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.withinTheLast = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" class="js-dp-type-toggle" id="withinTheLastRadio"/>');
  var param19 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param19);
  JIRA.Templates.DateSearcher.renderWithinTheLast({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param19.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.nowOverdue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<label><input type="radio" class="js-dp-type-toggle" />', soy.$$escapeHtml("Now overdue"), '</label>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} ago",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.moreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param33 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param33);
  JIRA.Templates.DateSearcher.renderMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param33.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("More than {0} {1} overdue",opt_data.inputField,opt_data.dateMeasurementField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueMoreThan = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="moreThanRadio"/>');
  var param43 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param43);
  JIRA.Templates.DateSearcher.renderDueMoreThan({inputField: '<input class="js-val" type="text" maxlength="15" />', dateMeasurementField: param43.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Due in next {0} {1} {2} overdue",opt_data.inputField,opt_data.dateMeasurementField,opt_data.clauseField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dueInNext = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dueInNextRadio"/>');
  var param53 = new soy.StringBuilder();
  JIRA.Templates.DateSearcher.dateMeasurement(null, param53);
  JIRA.Templates.DateSearcher.renderDueInNext({inputField: '<input class="js-val" maxlength="15" type="text" />', dateMeasurementField: param53.toString(), clauseField: '<select class="js-clause"><option value="orIs">' + soy.$$escapeHtml("or is") + '</option><option value="andNot">' + soy.$$escapeHtml("and not") + '</option></select>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderDateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("Between {0} and {1}",opt_data.startField,opt_data.endField));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.dateBetween = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" class="js-dp-type-toggle" id="dateBetweenRadio"/>');
  JIRA.Templates.DateSearcher.renderDateBetween({startField: '<input class="js-start-date" maxlength="15" placeholder="11-Jan-2012" type="text" /><span class="js-start-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>', endField: '<input class="js-end-date" maxlength="12" placeholder="30-Jan-2012" type="text" /><span class="js-end-date-trigger aui-icon icon-date">' + soy.$$escapeHtml("Select a date") + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.renderInRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("In range {0} to {1}",opt_data.startInput,opt_data.endInput));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DateSearcher.inRange = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type="radio" tabIndex="-1" maxlength="15" class="js-dp-type-toggle" id="inRangeRadio"/>');
  JIRA.Templates.DateSearcher.renderInRange({startInput: '<input class="js-start-range" placeholder="-3w 4d 12h" type="text" />', endInput: '<input class="js-end-range" maxlength="15" placeholder="3w 4d 12h" type="text" />'}, output);
  return opt_sb ? '' : output.toString();
};

/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/DateSearcher.js' */
(function($){var _excludeList=["js-dp-type-toggle","js-val","js-measurement","js-clause","js-start-date","js-end-date","js-start-range","js-end-range"];var _labelfyContent=function(content,radioKey){var $content=jQuery("<div></div>").html(content).contents();var transformed=[];$content.each(function(index,element){var $element=jQuery(element);var value=jQuery("<div/>").html(element).html();if(!_.contains(_excludeList,$element.attr("class"))){value=value.replace(/^\s+|\s+$/g,"&nbsp;");transformed.push("<label for='"+radioKey+"'>"+value+"</label>")}else{transformed.push(value)}});return transformed.join("")};var _generateSearcherAndBindHandler=function(data){var radioKey=data.radioKey+"Radio";var outputContent=data.$el.html(_labelfyContent(data.rawTemplate,radioKey));outputContent.find(":not(.js-dp-type-toggle):not(select):input").mousedown(function(){var $label=outputContent.find("label");if($label.length>0){$label[0].click()}});return outputContent};var NowOverdue=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"nowOverdue"},template:JIRA.Templates.DateSearcher.nowOverdue,getValues:function(){return{to:0}},updateFromValues:function(values){if(!values.from&&values.to==="0"){return true}},render:function(){return this.$el.html(this.template())}});var WithinTheLast=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"withinTheLast"},template:JIRA.Templates.DateSearcher.withinTheLast,getValues:function(){var val=this.$(".js-val").val();if(val){return{from:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.to&&values.from&&values.from.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.from);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var MoreThan=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"moreThan"},template:JIRA.Templates.DateSearcher.moreThan,getValues:function(){var val=this.$(".js-val").val();if(val){return{to:"-"+val+this.$el.find(".js-measurement").val()}}},updateFromValues:function(values){if(!values.from&&values.to&&values.to.charAt(0)=="-"){var vals=this.model.parseRelativeStr(values.to);this.$(".js-val").val(vals.val.slice(1));if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(verb){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DueMoreThan=MoreThan.extend({className:"field-group",template:JIRA.Templates.DateSearcher.dueMoreThan});var DueInNext=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dueInNext"},template:JIRA.Templates.DateSearcher.dueInNext,getValues:function(){var val=this.$el.find(".js-val").val();if(val){return{from:this.$el.find(".js-clause").val()==="andNot"?"0":null,to:val+this.$(".js-measurement").val()}}},updateFromValues:function(values){if((!values.from||values.from==="0")&&values.to){var vals=this.model.parseRelativeStr(values.to);var clause=values.from==="0"?"andNot":"orIs";this.$(".js-val").val(vals.val);this.$(".js-clause").val(clause);if(vals.measurement){this.$(".js-measurement").val(vals.measurement)}return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DatesBetween=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"dateBetween"},template:JIRA.Templates.DateSearcher.dateBetween,getValues:function(){return{startDate:this.$el.find(".js-start-date").val(),endDate:this.$el.find(".js-end-date").val()}},updateFromValues:function(values){if(values.startDate||values.endDate){this.$el.find(".js-start-date").val(values.startDate);this.$el.find(".js-end-date").val(values.endDate);return true}},bindCalendar:function(inputClass,triggerClass){var trigger=this.$el.find("."+triggerClass)[0];var input=this.$el.find("."+inputClass)[0];var calendarParams=_.extend({},this.model.calendarConfig,{inputField:input,button:trigger});Calendar.setup(calendarParams)},render:function(){_generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]});this.bindCalendar("js-end-date","js-end-date-trigger");this.bindCalendar("js-start-date","js-start-date-trigger");return this.$el}});var InRange=Backbone.View.extend({className:"field-group",attributes:{"data-date-type":"inRange"},template:JIRA.Templates.DateSearcher.inRange,getValues:function(){return{from:this.$el.find(".js-start-range").val(),to:this.$el.find(".js-end-range").val()}},updateFromValues:function(values){if(values.from||values.to){this.$el.find(".js-start-range").val(values.from);this.$el.find(".js-end-range").val(values.to);return true}},render:function(){return _generateSearcherAndBindHandler({$el:this.$el,rawTemplate:this.template(),radioKey:this.attributes["data-date-type"]})}});var DateSeacherModel=Backbone.Model.extend({initialize:function(options){this.from$El=options.$el.find(".js-date-picker-from").hide();this.to$El=options.$el.find(".js-date-picker-to").hide();this.startDate$El=options.$el.find(".js-date-picker-start-date").hide();this.endDate$El=options.$el.find(".js-date-picker-end-date").hide();this.errors=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.js-date-picker-errors"));this.calendarConfig=JIRA.parseOptionsFromFieldset(options.$el.find("fieldset.datepicker-params"))},parseRelativeStr:function(str){var measurement=str.slice(str.length-1);var val=str.slice(0,str.length-1);return{val:val,measurement:measurement}},update:function(updateParams){this.clear();if(updateParams){if(typeof updateParams.from!=="undefined"){this.from$El.val(updateParams.from)}if(typeof updateParams.to!=="undefined"){this.to$El.val(updateParams.to)}if(typeof updateParams.startDate!=="undefined"){this.startDate$El.val(updateParams.startDate)}if(typeof updateParams.endDate!=="undefined"){this.endDate$El.val(updateParams.endDate)}}},toJSON:function(){return{from:this.from$El.val(),to:this.to$El.val(),startDate:this.startDate$El.val(),endDate:this.endDate$El.val(),errors:this.errors}},clear:function(){this.from$El.val("");this.to$El.val("");this.startDate$El.val("");this.endDate$El.val("")}});JIRA.DateSearcher=Backbone.View.extend({initialize:function(options){var instance=this;this.verb=options.verb;this.model=new DateSeacherModel({$el:this.$el});this.setElement($("<div />").addClass("js-picker-ui").appendTo(this.$el));this.views=[];var useInputEvent=!jQuery.browser.msie||parseInt(jQuery.browser.version,10)<10;_.each(options.dateTypes,function(dateType){var view=new dateType({model:instance.model});instance.views.push(view);if(useInputEvent){view.$el.delegate(":text","input",function(){instance.update(view)})}else{view.$el.delegate(":text","keydown",function(){var $this=jQuery(this);var currentVal=$this.val();$this.one("keyup",function(){if($this.val()!==currentVal){instance.update(view)}})});view.$el.delegate(":text","change",function(){instance.update(view)})}view.$el.delegate(":radio,select,input","change",function(){instance.update(view)}).delegate(".icon-date","click",function(){instance.update(view)})})},update:function(selectedView,error){this.model.update(selectedView.getValues());_.each(this.views,function(view){if(view===selectedView){view.$(":radio").prop("checked",true)}else{view.$(":radio").prop("checked",false)}})},render:function(){var instance=this;var values=this.model.toJSON();_.each(this.views,function(view){instance.$el.append(view.render(instance.verb))});$.each(this.views,function(i,view){if(this.updateFromValues(values)){instance.update(this);if(values.errors){$.each(values.errors,function(i,error){$("<div />").addClass("error").text(error).appendTo(view.$el);return false})}return false}});window.setTimeout(function(){instance.$el.find(":radio:checked").focus()},30)}});JIRA.DateSearcher.createDueDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[NowOverdue,DueMoreThan,DueInNext,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createResolvedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCreatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createUpdatedDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()};JIRA.DateSearcher.createCustomDateSearcher=function(el){return new JIRA.DateSearcher({el:el,dateTypes:[WithinTheLast,MoreThan,DatesBetween,InRange]}).render()}})(AJS.$);
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initDateSearchers.js' */
jQuery(function(){function initDueDateSearcher($ctx){$ctx.find(".js-duedate-searcher").each(function(){JIRA.DateSearcher.createDueDateSearcher(this)})}function initResolvedDateSearcher($ctx){$ctx.find(".js-resolutiondate-searcher").each(function(){JIRA.DateSearcher.createResolvedDateSearcher(this)})}function initCreatedDateSearcher($ctx){$ctx.find(".js-created-searcher").each(function(){JIRA.DateSearcher.createCreatedDateSearcher(this)})}function initUpdatedDateSearcher($ctx){$ctx.find(".js-updated-searcher").each(function(){JIRA.DateSearcher.createUpdatedDateSearcher(this)})}function initCustomFieldDateSearcher($ctx){$ctx.find(".js-customdate-searcher").each(function(){JIRA.DateSearcher.createCustomDateSearcher(this)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initDueDateSearcher(context);initResolvedDateSearcher(context);initCreatedDateSearcher(context);initUpdatedDateSearcher(context);initCustomFieldDateSearcher(context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initSparklers.js' */
jQuery(function(){function initSparklers($ctx){$ctx.find(".js-default-checkboxmultiselect").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselect")){$select.data("checkboxmultiselect",new AJS.CheckboxMultiSelect({element:this}))}else{$select.data("checkboxmultiselect").render()}})}function initStatusLozengeSparklers($ctx){$ctx.find(".js-default-checkboxmultiselectstatuslozenge").each(function(){var $select=AJS.$(this);if(!$select.data("checkboxmultiselectstatuslozenge")){$select.data("checkboxmultiselectstatuslozenge",new AJS.CheckboxMultiSelectStatusLozenge({element:this}))}else{$select.data("checkboxmultiselectstatuslozenge").render()}})}function initLabelSparkler($ctx){$ctx.find(".js-label-checkboxmultiselect").each(function(){var cms=new AJS.CheckboxMultiSelect({element:this,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels/suggest",query:true,minQueryLength:0,formatResponse:function(response){var selectedValues=cms.model.getSelectedValues();return[new AJS.GroupDescriptor({items:_.map(_.sortBy(_.reject(response.suggestions,function(suggestion){return _.contains(selectedValues,suggestion.label)}),"label"),function(suggestion){return new AJS.ItemDescriptor({highlighted:true,html:suggestion.html,label:suggestion.label,value:suggestion.label,title:suggestion.label})})})]}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$context,reason){if(reason===JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed){initSparklers($context);initStatusLozengeSparklers($context);initLabelSparkler($context)}})});
/* module-key = 'jira.webresources:searchers', location = '/includes/jira/searchers/initUserSparkler.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,$ctx){function _formatUserGroupResponse(response){var users=_formatUserResponse(response.users,true);var groups=_formatGroupResponse(response.groups,true);var items=[].concat(users).concat(groups);return[new AJS.GroupDescriptor({items:items})]}function _formatUserResponse(response,prefix){return _.map(response.users,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:item.avatarUrl,label:item.displayName,value:(prefix?"user:":"")+item.name})})}function _formatGroupResponse(response,prefix){return _.map(response.groups,function(item){return new AJS.ItemDescriptor({highlighted:true,html:item.html,icon:AJS.contextPath()+"/images/icons/icon_groups_16.png",label:item.name,value:(prefix?"group:":"")+item.name})})}jQuery(".js-usergroup-checkboxmultiselect",$ctx).each(function(){var ajaxData={};AJS.$("fieldset.user-group-searcher-params",$ctx).each(function(){ajaxData=JIRA.parseOptionsFromFieldset(AJS.$(this))});ajaxData.showAvatar=true;new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:10,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groupuserpicker",data:ajaxData,query:true,formatResponse:_formatUserGroupResponse}})});jQuery(".js-user-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/user/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatUserResponse(items,false)}}})});jQuery(".js-group-checkboxmultiselect",$ctx).each(function(){new AJS.CheckboxMultiSelect({element:this,maxInlineResultsDisplayed:5,content:"mixed",ajaxOptions:{url:AJS.contextPath()+"/rest/api/latest/groups/picker",data:{showAvatar:true},query:true,formatResponse:function(items){return _formatGroupResponse(items,false)}}})})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/util/URLSerializer.js' */
(function(){var b="browse/",d="issues/";var c=function(e){return e};var a=function(e){if(typeof e==="string"){return parseInt(e,10)}return e};JIRA.Issues.URLSerializer={getURLFromState:function(g){g=g||{};var f=[];var e;if(g.selectedIssueKey){e=b+g.selectedIssueKey}else{e=d}if(g.filter!=null){f.push("filter="+g.filter)}if(g.jql!=null&&(g.filterJql==null||g.jql!==g.filterJql)){f.push("jql="+encodeURIComponent(g.jql))}if(g.startIndex&&!g.selectedIssueKey){f.push("startIndex="+g.startIndex)}return e+(f.length?"?"+f.join("&"):"")},getStateFromURL:function(e){var g={},i=e.split("?")[0],j,h;h={filter:null,jql:null,selectedIssueKey:null,startIndex:0};if(e.indexOf(b)==0){h.selectedIssueKey=i.split("/")[1]}if(e.indexOf("?")!==-1){j=e.substr(e.indexOf("?"));g=JIRA.Issues.QueryStringParser.parse(j);var f=_.pick(g,"focusedCommentId","attachmentSortBy","attachmentOrder");if(!_.isEmpty(f)){h.viewIssueQuery=f}}return _.inject(this.PARAMETER_TRANSFORM,function(n,k,l){var m=g[l];if(m!==undefined){n[l]=k(m)}return n},_.extend(h))},PARAMETER_TRANSFORM:{filter:c,jql:c,startIndex:a}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueSearchManager.js' */
Backbone.define("JIRA.Issues.IssueSearchManager",JIRA.Issues.BaseEvented.extend({namedEvents:["beforeSearch","searchError"],initialize:function(a){_.extend(this,a);this.issueKeys=new JIRA.Components.IssueViewer.Legacy.AsyncData()},hasInitialSearch:function(){return !!this.initialIssueTableState},search:function(c){var b,a;c=_.extend({},c);if(_.isNumber(c.startIndex)===false){c.startIndex=0}if(this.activeResultsReq){if(JSON.stringify(this.activeRequestData)===JSON.stringify(c)){return jQuery.Deferred().reject().promise()}else{this.activeResultsReq.abort()}}this.activeRequestData=c;this.triggerBeforeSearch();if(this.hasInitialSearch()){b=jQuery.Deferred().resolve(this.initialIssueTableState);a="jira.search.finished.initial";this.initialIssueTableState=null;this.initialIssueIds=null}else{b=this.activeResultsReq=this._doSearch(c);a="jira.search.finished.secondary"}b.always(_.bind(function(){this.activeResultsReq=null;this.activeRequestData=null;JIRA.trace(a)},this));b.done(_.bind(this._updateIssueKeysOnSearchSuccess,this));b.fail(_.bind(function(){this.issueKeys.reset();this.triggerSearchError();_.defer(JIRA.trace,"jira.search.finished")},this));return b.pipe(function(d){if(d.issueTable){delete d.issueTable.issueKeys}return d}).promise()},_doSearch:function(c){var b=/^-?\d+$/;if(c.filterId&&!b.test(c.filterId)){var a={status:400,responseText:JSON.stringify({errors:[AJS.format("Invalid filter id \'\'{0}\'\'. Filter id must be a number.",c.filterId)]})};return jQuery.Deferred().reject(a).promise()}return jQuery.ajax({type:"POST",url:AJS.contextPath()+"/rest/issueNav/1/issueTable",headers:JIRA.Issues.XsrfTokenHeader,data:_.extend(c,{layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()})})},_updateIssueKeysOnSearchSuccess:function(a){var c=a.issueTable.issueIds;var b=a.issueTable.issueKeys;if(c&&b){var d={};_.each(c,function(f,e){d[f]={value:b[e],error:false}});this.issueKeys.reset(d)}else{var d=JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(a.issueTable.table);this.issueKeys.reset(d)}},getRowsForIds:function(b,a){if(!b.length){return jQuery.Deferred().resolve({}).promise()}var c=jQuery.ajax({data:_.extend({id:b,layoutKey:JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()},a),type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/1/issueTable/stable"});c.fail(_.bind(function(){this.triggerSearchError()},this));return c.pipe(function(d){return d.issueTable}).done(_.bind(function(d){this.issueKeys.setMultiple(JIRA.Issues.IssueSearchManager._extractIssueKeysFromTable(d.table,b));_.defer(JIRA.trace,"jira.search.finished")},this)).promise()},setAsInaccessible:function(a){return this.issueKeys.setError(a)}},{_extractIssueKeysFromTable:function(a,b){var c={};AJS.$(a).find(".issuerow").each(function(f){var d=AJS.$(this);var g=b?b[f]:d.attr("rel");var e=d.data("issuekey")||null;if(g){c[g]=e?{value:e,error:false}:{error:true}}});return c}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchResults.js' */
(function(a){Backbone.define("JIRA.Issues.SearchResults",JIRA.Issues.BaseModel.extend({defaults:{issueIds:[],selectedIssue:new JIRA.Issues.SimpleIssue(),highlightedIssue:new JIRA.Issues.SimpleIssue(),total:0},properties:["columnSortJql","highlightedIssue","issueIds","issueIdsForPage","jiraHasIssues","pageSize","resultsId","selectedIssue","startIndex","sortBy","columns","table","total","initialPayload","columnConfig"],namedEvents:["prevIssueSelected","nextIssueSelected","issueUpdated","issueDeleted","issueDoesNotExist","stableUpdate"],initialize:function(b,c){JIRA.Issues.ModelUtils.makeTransactional(this,"resetFromSearch","selectNextIssue","selectPrevIssue");this.issueUpdateCallbacks=[];this._issueSearchManager=c.issueSearchManager;this._initialSelectedIssue=c.initialSelectedIssue;this._columnConfig=c.columnConfig},getStartIndexForPage:function(b){return b*this.getPageSize()},hasIssue:function(b){return _.indexOf(this.getIssueIds(),b)!==-1},getPager:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var e=this.getIssueIds();var f=this.getSelectedIssue().getId();var c=_.indexOf(e,f);var g=this.getTotal();var h=e.length;var d={position:JIRA.NumberFormatter.format(c+1),resultCount:JIRA.NumberFormatter.format(g)};if(c>0){var i=this._getPrevIssueId(f);if(i){d.previousIssue={id:i,key:this._getIssueKeyForId(i)}}}if(c<g-1&&c<h-1){var b=this._getNextIssueId(f);if(b){d.nextIssue={id:b,key:this._getIssueKeyForId(b)}}}return d}},getNumberOfPages:function(){return this._getPageNumberForStartIndex(this.getDisplayableTotal()-1)},removeIssue:function(e){e=parseInt(e,10);var d=this.getIssueIds()[0]===e,c=this.getHighlightedIssue().getId()===e,b=_.last(this.getIssueIds())===e;if(c){if(!b){this.highlightNextIssue({replace:true})}else{if(!d){this.highlightPrevIssue({replace:true})}}}this.setIssueIds(_.without(this.getIssueIds(),e));this.setTotal(this.getTotal()-1);this.triggerIssueDeleted({id:e,key:this._getIssueKeyForId(e)})},isFirstIssueHighlighted:function(){if(!this.hasHighlightedIssue()){return false}return this.getHighlightedIssue().getId()===this.getIssueIds()[0]},updateIssueById:function(c,b){return this.updateIssue(c,b)},updateIssue:function(f,b){var d=f.action===JIRA.Issues.Actions.DELETE,e=f.id,c=[];b=_.defaults({},b,{showMessage:true,filter:null});if(d){this.removeIssue(e);b.showMessage&&this._notifyOfIssueUpdate(f);return jQuery.Deferred().resolve().promise()}else{return this.getResultForId(e,b.filter).done(_.bind(function(g){_.each(this.issueUpdateCallbacks,function(i){var h=i.handler.call(i.ctx||window,e,g,f);if(h&&h.promise){c.push(h)}});a.when(c).done(_.bind(function(){b.showMessage&&this._notifyOfIssueUpdate(f)},this))},this))}},_notifyOfIssueUpdate:function(b){b.message&&JIRA.Issues.showNotification(b.message,b.key);JIRA.trace("jira.search.stable.update")},getResultForId:function(d,c){var b={columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()};if(c&&!c.getIsSystem()){b=_.extend({filterId:c.getId()},b)}return this._issueSearchManager.getRowsForIds([d],b)},isHighlightedIssueAccessible:function(){if(!this.hasHighlightedIssue()){return null}return !this._issueSearchManager.issueKeys.hasError(this.getHighlightedIssue().getId())},getDisplayableTotal:function(){return this.getIssueIds().length},selectIssueByKey:function(c,b){if(!c){this.unselectIssue();return}var d=this._getIssueIdForKey(c);if(!d||d==-1){this._unhighlightIssue();this.getSelectedIssue().set({id:-1,key:c});this.triggerIssueDoesNotExist()}else{this._selectExistingIssueById(d,b)}},_unhighlightIssue:function(){this.getHighlightedIssue().set({id:null,key:null})},selectFirstInPage:function(b){this.selectIssueById(this.getIssueIds()[this.getStartIndex()],b)},getPrevPageStartIndex:function(){var b=(this.getStartIndex()||0)-this.getPageSize();return(b<0)?null:b},getNextPageStartIndex:function(){var b=this.getPositionOfLastIssueInPage();return(b>=this.getDisplayableTotal())?null:b},getPositionOfLastIssueInPage:function(){var c=this.getStartIndex();var b=this._pageSize();return Math.min(c+b,this.getDisplayableTotal())},highlightFirstInPage:function(){this.highlightIssueById(this.getIssueIds()[this.getStartIndex()])},selectIssueById:function(c,b){if(!c){this.unselectIssue()}else{this._selectExistingIssueById(c,b)}},_selectExistingIssueById:function(c,b){if(c!==this.getSelectedIssue().getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c=c?parseInt(c,10):null;this.getSelectedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);this.highlightIssueById(c)}},highlightIssueById:function(c,b){b=_.defaults({},b,{replace:false});if(c&&c!==this.getHighlightedIssue().getId()){c=c?parseInt(c,10):null;this.getHighlightedIssue().set({id:c,key:c?this._getIssueKeyForId(c):null},b);if(c){this.setStartIndex(this._getStartIndexForIssueId(c))}}},getState:function(){return{selectedIssueKey:this.getSelectedIssue().getKey(),startIndex:this.getStartIndex()}},resetFromSearch:function(b){b.resultsId=_.uniqueId();this.getSelectedIssue().set({id:null,key:null});this.set({sortBy:null});this.set("startIndex",b.startIndex,{silent:true});this.set(_.pick(b,this.properties));if(typeof b.selectedIssueKey==="string"){this.selectIssueByKey(b.selectedIssueKey)}else{if(this.hasIssues()){this.highlightFirstInPage()}else{this.getHighlightedIssue().set({id:null,key:null})}}},hasIssues:function(){return !!this.getIssueIds().length},isIssueOnPage:function(b){return _.indexOf(this.getPageIssueIds(),b)!==-1},isFirstIssueSelected:function(){if(this.hasIssue(this.getSelectedIssue().getId())){var c=this.getIssueIds();var d=this.getSelectedIssue().getId();var b=_.indexOf(c,d);return b===0}return false},getResultsForPage:function(c){_.extend(c,{columnConfig:this._columnConfig.columnPickerModel.getColumnConfig()});if(this.getTable()){var b=this.getTable();this.setTable(null,{silent:true});_.defer(function(){JIRA.trace("jira.search.finished")});return a.Deferred().resolve(b).promise()}return this.getResultsForIds(this.getPageIssueIds(),c)},getResultsForIds:function(e,d){var b=this;var c=a.Deferred();this._issueSearchManager.getRowsForIds(e,d).done(function(f){var g=_.isArray(f.table);if(!g){b.setColumnConfig(f.columnConfig);b.setColumns(f.columns);b.setColumnSortJql(f.columnSortJql)}c.resolve(f.table)}).fail(c.reject).always(function(){_.defer(function(){JIRA.trace("jira.search.finished")})});return c},applyState:function(b){this.set(_.pick(b,this.properties))},unselectIssue:function(b){var c=this.getSelectedIssue();if(c.getId()&&JIRA.Issues.Application.request("issueEditor:canDismissComment")){c.set({id:null,key:null},b)}},hasSelectedIssue:function(){return !!this.getSelectedIssue().getId()},hasHighlightedIssue:function(){return !!this.getHighlightedIssue().getId()},getPageIssueIds:function(){var d=this.getStartIndex();var c=this._pageSize();var b=this.getIssueIds();return b?b.slice(d,Math.min(d+c,b.length)):[]},getPageIssues:function(){return _.map(this.getPageIssueIds(),function(b){return{id:b,key:this._getIssueKeyForId(b)}},this)},getPageNumber:function(){return Math.floor(this.getStartIndex()/this._pageSize())},getPositionOfIssueInPage:function(b){return this.getPositionOfIssueInSearchResults(b)%this._pageSize()},getPositionOfIssueInSearchResults:function(b){return _.indexOf(this.getIssueIds(),b)},selectNextIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getSelectedIssue().getId());this._triggerNextIssueSelectedEvent(c);return this._selectIssue(c,b)},selectPrevIssue:function(b){if(!this.hasSelectedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getSelectedIssue().getId());this._triggerPrevIssueSelectedEvent(c);return this._selectIssue(c,b)},_selectIssue:function(c,b){this.selectIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightNextIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getNextIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},highlightPrevIssue:function(b){if(!this.hasHighlightedIssue()){return a.Deferred().reject().promise()}var c=this._getPrevIssueId(this.getHighlightedIssue().getId());this.highlightIssueById(c,b);return a.Deferred().resolve(c).promise()},goToPage:function(d,c){c=_.defaults({},c,{replace:false});if(d===null||d===this.getStartIndex()){return a.Deferred().resolve().promise()}var b=this.getIssueIds()[d];this.highlightIssueById(b,c);return a.Deferred().resolve(b).promise()},onHighlightedIssueChange:function(c,b){this.getHighlightedIssue().on("change",c,b)},offHighlightedIssueChange:function(c,b){this.getHighlightedIssue().off("change",c,b)},onSelectedIssueChange:function(c,b){this.getSelectedIssue().on("change",c,b)},offSelectedIssueChange:function(c,b){this.getSelectedIssue().off("change",c,b)},onColumnConfigChange:function(c,b){this.on("change:columnConfig",c,b)},offColumnConfigChange:function(c,b){this.off("change:columnConfig",c,b)},onColumnsChange:function(c,b){this.on("change:columns",c,b)},offColumnsChange:function(c,b){this.off("change:columns",c,b)},onStartIndexChange:function(c,b){this.on("change:startIndex",c,b)},onNewIssueIds:function(c,b){this.on("change:issueIds",c,b)},offNewIssueIds:function(c,b){this.off("change:issueIds",c,b)},offStartIndexChange:function(c,b){this.off("change:startIndex",c,b)},onNewPayload:function(c,b){this.on("change:resultsId",c,b)},offNewPayload:function(c,b){this.off("change:resultsId",c,b)},onIssueUpdated:function(c,b){this.issueUpdateCallbacks.push({handler:c,ctx:b})},offIssueUpdated:function(c){var b=[];this.issueUpdateCallbacks=_.each(this.issueUpdateCallbacks,function(d){if(d.handler!==c){b.push(d)}});this.issueUpdateCallbacks=b},_getNextIssueId:function(c){var b=this.getIssueIds();return b[Math.min(_.indexOf(b,c)+1,this.getDisplayableTotal()-1)]},getNextIssueForId:function(c){var b=this._getNextIssueId(c);return{id:b,key:this._getIssueKeyForId(b)}},getNextIssueForSelectedIssue:function(){return this.getNextIssueForId(this.getSelectedIssue().getId())},_getPrevIssueId:function(c){var b=this.getIssueIds();return b[Math.max(0,_.indexOf(this.getIssueIds(),c)-1)]},_getStartIndexForIssueId:function(d){var c=_.indexOf(this.getIssueIds(),d),b=this._pageSize();return Math.max(0,Math.floor(c/b)*b)},_getIssueIdForKey:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.key){return this._initialSelectedIssue.id}return this._getIssueKeysToIds()[b]},_getIssueKeyForId:function(b){if(this._initialSelectedIssue&&b===this._initialSelectedIssue.id){return this._initialSelectedIssue.key}return this._getIssueIdsToKeys()[b]},_getIssueIdsToKeys:function(){return this._issueSearchManager.issueKeys.getAllCached()},_getIssueKeysToIds:function(){var b={};var c=this._issueSearchManager.issueKeys.getAllCached();_.each(c,function(e,d){b[e]=d});return b},_getPageNumberForStartIndex:function(b){return Math.floor(b/this._pageSize())},_pageSize:function(){return this.getPageSize()},_triggerPrevIssueSelectedEvent:function(c){if(c!==this.getSelectedIssue().getId()){var b=this._getPrevIssueId(c);this.trigger("prevIssueSelected",{prevIssue:{id:c,key:this._getIssueKeyForId(c)},prevPrevIssue:{id:b,key:this._getIssueKeyForId(b)}})}},_triggerNextIssueSelectedEvent:function(b){if(b!==this.getSelectedIssue().getId()){var c=this._getNextIssueId(b);this.trigger("nextIssueSelected",{nextIssue:{id:b,key:this._getIssueKeyForId(b)},nextNextIssue:{id:c,key:this._getIssueKeyForId(c)}})}}}))})(AJS.$);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchModule.js' */
Backbone.define("JIRA.Issues.SearchModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._issueSearchManager=a.issueSearchManager;this._searchPageModule=a.searchPageModule;this._searchResults=new JIRA.Issues.SearchResults(null,{issueSearchManager:this._issueSearchManager,initialSelectedIssue:a.initialSelectedIssue,columnConfig:this._searchPageModule.columnConfig});JIRA.Issues.Application.reqres.setHandler("issueNav:currentSearchRequest",this.getCurrentSearchRequest,this);JIRA.Issues.Application.commands.setHandler("issueNav:refreshSearch",this.refresh,this)},doSort:function(a){if(a){this._searchPageModule.update({jql:a,startIndex:null,selectedIssueKey:null},true)}},getFilterId:function(){var a=this._searchPageModule.getFilter();return a&&a.getId()},getJql:function(){return this._searchPageModule.getJql()},getEffectiveJql:function(){return this._searchPageModule.getEffectiveJql()},getResults:function(){return this._searchResults},getState:function(){return this._searchPageModule.getState()},getCurrentSearchRequest:function(){return{jql:this.getJql(),filterId:this.getFilterId()}},isStandAloneIssue:function(a){a=a||this._searchPageModule.getState();return !!a.selectedIssueKey&&!_.isString(a.jql)&&!a.filter},onBeforeSearch:function(b,a){this._issueSearchManager.bindBeforeSearch(b,a)},offBeforeSearch:function(b,a){this._issueSearchManager.unbindBeforeSearch(b,a)},onSearchError:function(b,a){this._issueSearchManager.bindSearchError(b,a)},offSearchError:function(b,a){this._issueSearchManager.unbindSearchError(b,a)},refresh:function(){return this._searchPageModule.refreshSearch()},stableUpdate:function(a){this._searchResults.triggerStableUpdate(_.extend({force:true},a))}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/SearchPageModule.js' */
Backbone.define("JIRA.Issues.SearchPageModule",JIRA.Issues.BaseModel.extend({namedEvents:["changeFilterProps"],properties:["currentLayout","layouts","filter","jql","searchId"],defaults:function(){return{filter:null,jql:null}},initialize:function(a,b){_.extend(this,b);this.registerColumnPicker();this.setLayouts({});this.registerLayout("list-view",{label:"List View",iconClass:"icon-view-list",view:JIRA.Issues.FullScreenLayout});this.registerLayout("split-view",{label:"Detail View",iconClass:"icon-view-split",view:JIRA.Issues.SplitScreenLayout});this._onFilterChanged();this.on("change:filter",this._onFilterChanged,this);JIRA.Issues.Application.on("issueEditor:close",this.returnToSearch,this);JIRA.Issues.Application.on("issueEditor:loadComplete",function(c,d){if(!this.standalone&&!d.reason){this.searchResults.selectIssueById(c.getId(),{reason:"issueLoaded"});this.searchResults.updateIssueById({id:c.getId(),action:"rowUpdate"},{filter:this.getFilter()});if(c.getKey()){var e=this._getUpdateState({selectedIssueKey:c.getKey()});if(this._validateNavigate(e)){this.issueNavRouter.replaceState(e)}}}},this);JIRA.Issues.Application.on("issueEditor:saveSuccess",function(c){this.searchResults.updateIssueById({id:c.issueId,action:"inlineEdit"},{filter:this.getFilter()})},this)},registerColumnPicker:function(){this.columnConfig=JIRA.Issues.ColumnPicker.create({search:this})},getInactiveLayouts:function(){var a=[];_.each(this.getLayouts(),function(c,b){if(b!==JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()){a.push(c)}},this);return a},getActiveLayout:function(){return this.getLayouts()[JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()]},changeLayout:function(c,b){var d=this.getLayout(c),e,a=this.getCurrentLayout();JIRA.Issues.changingLayout=true;jQuery("body, html").scrollTop(0);b=_.defaults({},b,{ajax:true,render:true});if(d){if(a instanceof d.view){return}if(a&&a.close){a.close();this.searchResults.unselectIssue({replace:true})}JIRA.Issues.LayoutPreferenceManager.setPreferredLayoutKey(c,b);e=new d.view({fullScreenIssue:this.fullScreenIssue,issueContainer:this.issueContainer,issueCacheManager:this.issueCacheManager,search:this.search,searchContainer:this.searchContainer,searchHeaderModule:this.searchHeaderModule,columnConfig:this.columnConfig});e.on("close",function(){this.searchContainer.find(".navigator-content").addClass("pending")},this);e.on("render",function(){this.searchContainer.find(".navigator-content").removeClass("pending");JIRA.trigger(JIRA.Events.LAYOUT_RENDERED,[c])},this);b.render&&e.render();this.setCurrentLayout(e);this.standalone=false}},createLayout:function(){if(!this.getCurrentLayout()){this.changeLayout(JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey(),{render:false});this.fullScreenIssue.deactivate()}},_onFilterChanged:function(){var a=this.previous("filter");if(a){a.off("change",this.triggerChangeFilterProps,this)}var b=this.getFilter();if(b){b.on("change",this.triggerChangeFilterProps,this)}},getLayout:function(a){return this.getLayouts()[a]||null},getSortedLayouts:function(){return _.sortBy(this.getLayouts(),"label")},registerLayout:function(a,b){b.id=a;this.getLayouts()[a]=b},getJqlDeferred:function(){var b=jQuery.Deferred();var a=this;_.defer(function(){a.queryModule.searchersReady().always(function(){_.defer(function(){b.resolve(a.getEffectiveJql())})})});return b.promise()},registerIssueSearchManager:function(a){this.issueSearchManager=a},registerIssueCacheManager:function(a){this.issueCacheManager=a},registerQueryModule:function(a){this.queryModule=a;this.queryModule.onJqlChanged(this.queryModuleSearchRequested,this);this.queryModule.onJqlError(this.disableLayoutSwitcher,this);this.queryModule.onJqlSuccess(this.enableLayoutSwitcher,this);this.queryModule.onVerticalResize(JIRA.Issues.triggerVerticalResize);this.queryModule.onQueryTooComplexSwitchToAdvanced(function(){JIRA.Issues.Application.execute("analytics:trigger","kickass.queryTooComplexSwitchToAdvanced")});this.queryModule.onBasicModeCriteriaCountWhenSearching(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.basicModeCriteriaCountWhenSearching",b)});this.queryModule.onChangedPreferredSearchMode(function(b){JIRA.Issues.Application.execute("analytics:trigger","kickass.switchto"+b)});JIRA.Shifter.register(JIRA.Issues.SearchShifter({isBasicMode:_.bind(this.queryModule.isBasicMode,this.queryModule),isFullScreenIssue:_.bind(this.isFullScreenIssueVisible,this),searcherCollection:this.queryModule.getSearcherCollection()}))},disableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.disableLayoutSwitcher()}},enableLayoutSwitcher:function(){if(this.layoutSwitcher){this.layoutSwitcher.enableLayoutSwitcher()}},registerLayoutSwitcher:function(a){this.layoutSwitcher=a},registerFilterModule:function(a){if(this.filterModule){this.filterModule.off("filterRemoved");this.filterModule.off("filterSelected")}this.filterModule=a;this.filterModule.on("filterRemoved",function(c){var b=this.getFilter();if(b&&c.filterId===b.getId()){this.resetToBlank()}},this);this.filterModule.on("filterSelected",function(b){this.resetToFilter(b.filterId)},this)},registerSearch:function(b){this.search=b;this.searchResults=this.search.getResults();this.searchResults.on("change:resultsId",this._handleSearchResultsChange,this);this.searchResults.onStartIndexChange(this._handleSearchResultsChange,this);this.searchResults.onSelectedIssueChange(this._handleSearchResultsChange,this);var a=this.columnConfig;this.on("change:filter",function(){a.clearFilterConfiguration()});this.searchResults.onColumnsChange(function(c){var d=c.getColumnConfig();if(d){a.syncColumns(d,c.getColumns())}});this.searchResults.onColumnConfigChange(function(c){var d=c.getColumnConfig();if(d){a.setCurrentColumnConfig(d);a.syncColumns(d,c.getColumns())}});a.onColumnsSync(function(c){b.stableUpdate({columnConfig:c})});this.searchResults.onSelectedIssueChange(_.bind(function(c){if(!c.hasIssue()){JIRA.Issues.Application.execute("issueEditor:removeIssueMetadata")}},this))},_handleSearchResultsChange:function(b,a){a=a||{};a.replace?this.issueNavRouter.replaceState(this.getState()):this.issueNavRouter.pushState(this.getState())},registerSearchHeaderModule:function(a){this.searchHeaderModule=a},registerFullScreenIssue:function(a){this.fullScreenIssue=a;this.fullScreenIssue.bindIssueHidden(function(){JIRA.Issues.Application.execute("issueEditor:dismiss");this.updateWindowTitle(this.getFilter());JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.searchContainer,JIRA.CONTENT_ADDED_REASON.returnToSearch])},this)},registerViewContainers:function(a){this.issueContainer=a.issueContainer;this.searchContainer=a.searchContainer},registerIssueNavRouter:function(a){this.issueNavRouter=a},prevIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().prevIssue();return true}return false},nextIssue:function(){if(this._overlayIsVisible()){return false}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")&&!this.standalone){this.getCurrentLayout().nextIssue();return true}return false},isCurrentlyLoadingIssue:function(){return JIRA.Issues.Application.request("issueEditor:isCurrentlyLoading")},_overlayIsVisible:function(){return AJS.$(".aui-blanket").filter(":visible").length>0},getEffectiveIssueId:function(a){return this.getEffectiveIssue().getId()},updateIssue:function(c){var b=c.action===JIRA.Issues.Actions.DELETE,a=this.fullScreenIssue.isVisible();if(b){return this._deleteIssue(c)}else{if(a){return this.fullScreenIssue.updateIssue(c).done(_.bind(function(){!this.standalone&&this.searchResults.updateIssue(c,{showMessage:false,filter:this.getFilter()})},this))}else{return this.searchResults.updateIssue(c,{filter:this.getFilter()})}}},_deleteIssue:function(c){var a=this.fullScreenIssue.isVisible(),b=c.key==JIRA.Issues.Application.request("issueEditor:getIssueKey");if(!a){return this.searchResults.updateIssue(c)}else{if(!b){return this.fullScreenIssue.updateIssue(c)}else{if(this.standalone){this.resetToBlank();JIRA.Issues.showNotification(c.message,c.key);return jQuery.Deferred().resolve().promise()}else{this.returnToSearch();return this.searchResults.updateIssue(c)}}}},getEffectiveIssueKey:function(){return this.getEffectiveIssue().getKey()},getEffectiveIssue:function(){var b=this.searchResults.hasHighlightedIssue(),c=this.searchResults.hasSelectedIssue(),a;a=new JIRA.Issues.SimpleIssue({id:JIRA.Issues.Application.request("issueEditor:getIssueId"),key:JIRA.Issues.Application.request("issueEditor:getIssueKey")});if(this.standalone){return a}else{if(c){return this.searchResults.getSelectedIssue()}else{if(b){return this.searchResults.getHighlightedIssue()}else{return a}}}},isHighlightedIssueAccessible:function(){return this.search.getResults().isHighlightedIssueAccessible()},returnToSearch:function(){if(this.standalone){this.resetToBlank();JIRA.trace("jira.returned.to.search")}else{if(this.fullScreenIssue.isVisible()){this.searchResults.unselectIssue();JIRA.Issues.Application.execute("issueEditor:beforeHide");if(this.queryModule.refreshLayout){this.queryModule.refreshLayout()}}else{JIRA.trace("jira.returned.to.search")}}jQuery.event.trigger("updateOffsets.popout")},toggleFilterPanel:function(){return this.filterModule.toggleFilterPanel()},issueTableSortRequested:function(a,b){this.update({jql:a,startIndex:b})},issueTableSearchError:function(a){if(a.status!==0){this.filterModule.filtersComponent.markFilterHeaderAsInvalid();var c;try{c=JSON.parse(a.responseText)}catch(b){c={errorMessages:["Error occurred communicating with the server. Please reload the page and try again."]}}this.queryModule.onSearchError(c)}},issueTableSearchSuccess:function(a){this.update({startIndex:a.startIndex});this.queryModule.onSearchSuccess(a.warnings)},issueTableStableUpdate:function(a){this.update({startIndex:a})},confirmNavigation:function(a){a=_.defaults({},a,{confirm:function(c){return window.confirm(c)},ignoreDirtiness:false});var b=JIRA.DirtyForm.getDirtyWarning()||JIRA.Issue.getDirtyCommentWarning();return !!a.ignoreDirtiness||b===undefined||a.confirm(b)},isFullScreenIssueVisible:function(){return this.fullScreenIssue&&this.fullScreenIssue.isVisible()},isIssueVisible:function(){var a=JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey();if(this.isFullScreenIssueVisible()){return true}else{if(a==="list-view"){return this.fullScreenIssue.isVisible()}else{if(a==="split-view"){return this.search.getResults().hasIssues()}}}return false},queryModuleSearchRequested:function(a){this.update({jql:a,startIndex:0,selectedIssueKey:null,searchId:_.uniqueId()})},filterModuleSaved:function(a){this.reset({filter:a.getId()})},discardFilterChanges:function(){this.update({jql:null,selectedIssueKey:null},true)},getState:function(){var a=this.getFilter();var b={filter:a&&a.getId(),filterJql:a&&a.getJql(),jql:this.getJql()};if(this.standalone){b.selectedIssueKey=JIRA.Issues.Application.request("issueEditor:getIssueKey")}else{_.extend(b,this.search.getResults().getState())}return b},_doSearch:function(a){a=a||{};var b={};var d;var c=this.getFilter();b.startIndex=a.startIndex;if(c){b.filterId=c.getId()}if(a.columnConfig){b.columnConfig=a.columnConfig}b.jql=this.getEffectiveJql();d=this.issueSearchManager.search(b);d.done(_.bind(function(e){if(this.fullScreenIssue.isVisible()&&!AJS.Meta.get("serverRenderedViewIssue")){JIRA.Issues.Application.execute("issueEditor:beforeHide")}this.searchResults.resetFromSearch(_.extend(a,e.issueTable));this.queryModule.onSearchSuccess(e.warnings);jQuery.event.trigger("updateOffsets.popout")},this)).fail(_.bind(function(e){if(e.statusText!=="abort"){if(e.status==400&&a.selectedIssueKey){this.reset({selectedIssueKey:a.selectedIssueKey},{replace:true})}else{this.searchResults.resetFromSearch(_.extend(_.pick(a,"selectedIssueKey"),this.searchResults.defaults));this.issueTableSearchError(e)}}},this));return d},updateWindowTitle:function(a){if(this.isFullScreenIssueVisible()){return}var b=a,c=AJS.format("{0} - {1}","Issue Navigator",JIRA.Settings.ApplicationTitle.get());if(b&&b.getIsValid()){document.title="["+b.getName()+"] "+c}else{document.title=c}},_applyState:function(d,g,c){c=c||{};var f=_.extend(this.toJSON(),this.search.getResults().toJSON());var b=_.pick(d,this.properties);this.set(b);var e=_.extend(this.toJSON(),d);this.updateWindowTitle(this.getFilter());if(g){var a=(d.filter&&d.jql==null)?d.filter.getJql():d.jql;this.queryModule.resetToQuery(a,{focusQuery:c.isNewSearch}).always(_.bind(function(){this.queryModule.setVisible(!d.filter||d.filter.getIsValid())},this))}if(this.shouldPerformNewSearch(f,e)){var h=this._doSearch(e)}else{var h=jQuery.Deferred().resolve();if("selectedIssueKey" in d){this.searchResults.selectIssueByKey(d.selectedIssueKey)}if("startIndex" in d&&!d.selectedIssueKey){this.searchResults.goToPage(d.startIndex)}}this._showIntroDialogs(h)},shouldPerformNewSearch:function(f,e){var g=f.filter&&f.filter.getId();var a=e.filter&&e.filter.getId();var c=g!==a;var d=e.jql!==f.jql;var b=e.searchId!==f.searchId;return c||d||b},refreshSearch:function(){return this._doSearch(_.extend({},this.getState(),{selectedIssueKey:undefined}))},_navigateToState:function(b,c,a){a=a||{};if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){this.queryModule.queryChanged();AJS.InlineLayer.current&&AJS.InlineLayer.current.hide();return null}if(this._validateNavigate(b)){a.replace?this.issueNavRouter.replaceState(b):this.issueNavRouter.pushState(b)}if(this.search.isStandAloneIssue(b)){this.resetToStandaloneIssue(b)}else{return this.applyState(b,c,a)}},_validateNavigate:function(b){var a=JIRA.Issues.URLSerializer.getURLFromState;return a(b)!==a(this.getState())},_getUpdateState:function(a){return _.extend({},this.getState(),a)},update:function(b,c,a){this._navigateToState(this._getUpdateState(b),c,a)},reset:function(c,b){var a=_.extend({},this.defaults(),c);a.searchId=_.uniqueId();this._navigateToState(a,true,b)},_deactivateCurrentLayout:function(){var a=this.getCurrentLayout();if(a){a.close&&a.close();this.setCurrentLayout(null)}},resetToStandaloneIssue:function(a){this._deactivateCurrentLayout();this.set(this.defaults());this.standalone=true;this.fullScreenIssue.show({key:a.selectedIssueKey,viewIssueQuery:a.viewIssueQuery})},applyState:function(d,f,c){var b,a=d.filter&&!(d.filter instanceof JIRA.Components.Filters.Models.Filter),e=this.initSystemFilters();JIRA.Issues.Application.execute("issueEditor:abortPending");this.createLayout();if(a){b=jQuery.Deferred();e.always(_.bind(function(){this.filterModule.getFilterById(d.filter).always(function(g){d.filter=g;b.resolve()})},this))}jQuery.when(b,e).always(_.bind(function(){this._applyState(d,f,c)},this))},updateFromRouter:function(a){if(this.search.isStandAloneIssue(a)){this.resetToStandaloneIssue(a)}else{this.applyState(a,!this._isSearchStateEqual(a))}},hasSelectedIssue:function(){return this.search.getResults().getSelectedIssue().getKey()},resetToFilter:function(a){this.reset({filter:a,searchId:_.uniqueId()})},resetToBlank:function(a){this.reset({jql:""},a)},isDirty:function(){var a=this.getFilter();return !!a&&a.getJql()!==this.getEffectiveJql()},getSearchMode:function(){return this.queryModule.getSearchMode()},getActiveBasicModeSearchers:function(){return this.queryModule.getActiveBasicModeSearchers()},setSessionSearch:function(a){AJS.$.ajax({data:{filterId:a.getId()},type:"PUT",url:AJS.contextPath()+"/rest/issueNav/1/issueTable/sessionSearch/"})},openFocusShifter:function(){JIRA.Issues.FocusShifter.show()},setAsInaccessible:function(a){this.issueTableModule.setAsInaccessible(a)},showInlineIssueLoadError:function(b){var a=JIRA.Components.IssueViewer.Templates.Body.errorsLoading();JIRA.Messages.showErrorMsg(a,{closeable:true})},getEffectiveJql:function(){var b=this.getFilter(),a=this.getJql();if(_.isString(a)){return a}else{if(b){return b.getJql()||""}else{return""}}},initSystemFilters:function(){return this.filterModule.initSystemFilters()},addOwnerToSystemFilters:function(c){var d=AJS.Meta.get("remote-user");if(!d){return c}var b=AJS.Meta.get("remote-user-fullname");var a=AJS.Meta.get("remote-user-avatar-url");return _.map(c,function(e){e.ownerUserName=d;e.ownerDisplayName=b;e.avatarUrl=a;return e})},handleLeft:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleLeft()}},handleRight:function(){if(this._allowLeftRightNavigation()){this.getCurrentLayout()&&this.getCurrentLayout().handleRight()}},handleUp:function(){if(!this._allowUpDownNavigation()){return false}if(this.searchResults.isFirstIssueHighlighted()){return false}return this.prevIssue()},handleDown:function(){if(!this._allowUpDownNavigation()){return false}return this.nextIssue()},_allowLeftRightNavigation:function(){return !AJS.keyboardShortcutsDisabled},_allowUpDownNavigation:function(){if(AJS.keyboardShortcutsDisabled){return false}if(AJS.InlineLayer.current||AJS.Dropdown.current||JIRA.Dialog.current||AJS.$(".aui-dropdown2:visible").length>0){return false}return this.getCurrentLayout()&&!this.getCurrentLayout().isIssueViewActive()},_isSearchStateEqual:function(a){var b=["filter","jql","startIndex"];return _.isEqual(_.pick(a,b),_.pick(this.getState(),b))},removeOpenTipsies:JIRA.Issues.Tipsy.revalidate,_showIntroDialogs:function(b){var a=(this.filterModule&&this.filterModule.filterPanelView)?this.filterModule.filterPanelView.panelReady:undefined;if(!this._shownIntroDialog&&this.layoutSwitcher){jQuery.when(b,a).done(_.bind(function(){this.layoutSwitcher.createHelptipForSwitchingToDetailView(1);this.filterModule.createHelptipForFilterPanelDocking(2);AJS.HelpTip.Manager.showSequences()},this));this._shownIntroDialog=true}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssuesApi.js' */
JIRA.Issues.Api=(function(){var a;return{initialize:function(b){a=b.searchPageModule},editFieldOnSelectedIssue:function(c){var b=JIRA.Issues.Api.getFieldsOnSelectedIssue(),d=b&&b.get(c),e=d&&d.isEditable();if(e&&a){JIRA.Issues.Application.execute("issueEditor:editField",d)}return e},focusSearch:function(){AJS.$(".criteria-selector:first, #advanced-search").focus().select()},getSelectedIssue:function(){return a.getEffectiveIssue()},getSelectedIssueId:function(){return a.getEffectiveIssueId()},getSelectedIssueKey:function(){return a.getEffectiveIssueKey()},getFieldsOnSelectedIssue:function(){var b=JIRA.Issues.Application.request("issueEditor:fields");return b.length?b:undefined},hasSavesInProgress:function(){return JIRA.Issues.Application.request("issueEditor:hasSavesInProgress")},isCurrentlyLoadingIssue:function(){return a.isCurrentlyLoadingIssue()},isSelectedIssueAccessible:function(){return a.isHighlightedIssueAccessible()},issueIsVisible:function(){return a.isIssueVisible()},nextIssue:function(){a.nextIssue()},openFocusShifter:function(){if(a.isIssueVisible()){a.openFocusShifter()}},prevIssue:function(){a.prevIssue()},refreshSelectedIssue:function(b){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)},returnToSearch:function(b){a.returnToSearch({ignoreDirtiness:b})},showInlineIssueLoadError:function(b){a.showInlineIssueLoadError(b)},switchLayouts:function(c){var b=-1,d=a.getCurrentLayout(),f=a.getSortedLayouts(),e;_.find(f,function(h,g){if(d instanceof h.view){b=g;return true}});e=f[(b+1)%f.length];a.changeLayout(e.id,c)},isQueryValid:function(){return a.queryModule.isQueryValid()},isFullScreenIssueVisible:function(){return a.isFullScreenIssueVisible()},viewSelectedIssue:function(){if(!JIRA.Issues.Api.isSelectedIssueAccessible()){return}var b=JIRA.Issues.Api.getSelectedIssueKey();if(!a.isIssueVisible()){a.update({selectedIssueKey:b})}},toggleFilterPanel:function(){a.toggleFilterPanel()},waitForSavesToComplete:function(){var b=jQuery.Deferred();window.setTimeout(function(){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}else{JIRA.bind(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE,function(c){if(!JIRA.Issues.Api.hasSavesInProgress()){b.resolve()}})}},10)},updateIssue:function(b,c){c=c||"thanks_issue_updated";return a.updateIssue({key:b.key,id:b.id,action:JIRA.Issues.Actions.UPDATE,message:c,meta:{}})}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueAPI.js' */
JIRA.Issues.IssueAPI=(function(){var a;var b={getIssueId:function(){return JIRA.Issues.Api.getSelectedIssueId()},getIssueKey:function(){return JIRA.Issues.Api.getSelectedIssueKey()}};return{override:function(c){c=_.defaults({},c,{target:JIRA.Issue});a=c.searchPageModule;_.extend(c.target,b)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-mess', location = 'content/js/search/IssueNavigatorAPI.js' */
JIRA.Issues.IssueNavigatorAPI=(function(){var a;var b={isNavigator:function(){return a.isIssueVisible()}};var c={focusSearch:JIRA.Issues.Api.focusSearch,isNavigator:b.isNavigator,selectNextIssue:JIRA.Issues.Api.nextIssue,selectPreviousIssue:JIRA.Issues.Api.prevIssue,viewSelectedIssue:JIRA.Issues.Api.viewSelectedIssue};return{override:function(d){a=d.searchPageModule;JIRA.IssueNavigator=_.extend(JIRA.IssueNavigator,b);JIRA.IssueNavigator.Shortcuts=_.extend(JIRA.IssueNavigator.Shortcuts,c)}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewer.js' */
AJS.namespace("JIRA.Components.IssueViewer");JIRA.Components.IssueViewer=JIRA.Marionette.Controller.extend({namedEvents:["loadComplete","loadError","close","replacedFocusedPanel"],initialize:function(a){a=a||{};this.model=new JIRA.Components.IssueViewer.Models.Issue();this.eventBus=new JIRA.Components.IssueViewer.Legacy.IssueEventBus();this.viewIssueData=new JIRA.Components.IssueViewer.Legacy.ViewIssueData();this._buildIssueLoader();this._buildErrorController({showReturnToSearchOnError:a.showReturnToSearchOnError});this._buildIssueController();JIRA.bind(JIRA.Events.REFRESH_ISSUE_PAGE,_.bind(function(c,d,b){if(this.model.isCurrentIssue(d)){this.refreshIssue(b)}},this))},_buildIssueLoader:function(){this.issueLoader=new JIRA.Components.IssueViewer.Services.IssueLoader();this.listenTo(this.issueLoader,"error",function(b,a){this.trigger("loadError",a);this.errorController.render(b,a.issueKey);this.removeIssueMetadata();JIRA.trace("jira.issue.refreshed",{id:a.issueId});JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[a.issueId])});this.listenTo(this.issueLoader,"issueLoaded",this._onIssueLoaded)},_buildErrorController:function(a){a=a||{};this.errorController=new JIRA.Components.IssueViewer.Controllers.Error({contextPath:AJS.contextPath(),showReturnToSearchOnError:a.showReturnToSearchOnError});this.listenTo(this.errorController,"before:render",function(){this.issueController.close()});this.listenTo(this.errorController,"returnToSearch",function(){this.trigger("close")});this.listenAndRethrow(this.errorController,"render")},_buildIssueController:function(){this.issueController=new JIRA.Components.IssueViewer.Controllers.Issue({model:this.model});this.listenTo(this.issueController,"render",function(b,a){JIRA.Components.IssueViewer.Utils.hideDropdown();this.errorController.close();this.trigger("render",b,a);JIRA.trace("jira.psycho.issue.refreshed",{id:this.model.getId()})});this.listenAndRethrow(this.issueController,"replacedFocusedPanel");this.listenTo(this.issueController,"panelRendered",function(a,b){this.eventBus.triggerPanelRendered(a,b)});this.listenTo(this.issueController,"close",function(){JIRA.Components.IssueViewer.Utils.hideDropdown()})},_updateModel:function(b,a){this.model.update(b,a)},_onIssueLoaded:function(a,h,i){var g=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();var e=i.issueEntity;var b=!h.mergeIntoCurrent&&i.initialize!==false;var f=!this.model.isCurrentIssue(e.id);var c=!!e.detailView;if(!h.isUpdate||b){this.model.resetToDefault();this.errorController.close()}this._updateModel(a,{initialize:b,changed:h.changed,mergeIntoCurrent:h.mergeIntoCurrent});if(!h.isUpdate||b){this.issueController.close()}this.issueController.show();if(g&&h.fromCache){this.refreshIssue(e,{fromCache:true,mergeIntoCurrent:!h.error,detailView:c})}JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model);if(e.bringToFocus){e.bringToFocus()}this.trigger("loadComplete",this.model,{isNewIssue:f,issueId:e.id,duration:h.loadDuration,loadReason:h.fromCache?"issues-cache-refresh":undefined,fromCache:h.fromCache});var d={id:e.id};if(h.fromCache){JIRA.trace("jira.issue.loadFromCache",d)}else{JIRA.trace("jira.issue.loadFromServer",d)}JIRA.trace("jira.issue.refreshed",d);JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[e.id])},abortPending:function(){this.issueLoader.cancel()},canDismissComment:function(){return this.issueController.canDismissComment()},beforeHide:function(){JIRA.Components.IssueViewer.Utils.hideLightbox();JIRA.Components.IssueViewer.Utils.hideDropdown();this.abortPending();this.removeIssueMetadata()},beforeShow:function(){JIRA.Components.IssueViewer.Services.Metadata.addIssueMetadata(this.model)},getIssueId:function(){return this.model.getEntity().id||null},getIssueKey:function(){return this.model.getEntity().key||null},_loadIssueFromDom:function(a){if(!a.id||a.id==-1){this.errorController.applyToDom("notfound",a.key);this.trigger("loadError")}else{this.issueController.applyToDom({id:a.id||-1,key:a.key,viewIssueQuery:a.viewIssueQuery})}AJS.Meta.set("serverRenderedViewIssue",null);var b={id:this.getIssueId()};JIRA.trace("jira.issue.refreshed",b)},loadIssue:function(b){var a=AJS.$("#key-val"),c=AJS.Meta.get("serverRenderedViewIssue");if(c){b.id=a.attr("rel")||-1;this._loadIssueFromDom(b);return jQuery.Deferred().resolve().promise()}else{if(!this.canDismissComment()||!b.key){return jQuery.Deferred().reject()}this.issueController.showLoading();return this.issueLoader.load({issueEntity:b,viewIssueData:this.viewIssueData})}},refreshIssue:function(a){var b;a=_.defaults({},a,{mergeIntoCurrent:true});if(this.model.hasIssue()){b=this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:a.mergeIntoCurrent,detailView:a.detailView});if(a.complete){b=b.done(a.complete).fail(a.complete)}this.issueController.showLoading()}else{b=jQuery.Deferred().resolve().promise()}return b},removeIssueMetadata:function(){JIRA.Components.IssueViewer.Services.Metadata.removeIssueMetadata(this.model)},setContainer:function(a){this.errorController.setElement(a);this.issueController.setElement(a)},isCurrentlyLoading:function(){return this.issueLoader.isLoading()},updateIssueWithQuery:function(a){this.model.updateIssueQuery(a);this.issueLoader.update({viewIssueData:this.viewIssueData,issueEntity:this.model.getEntity(),mergeIntoCurrent:true})},dismiss:function(){this.model.resetToDefault();this.errorController.close();this.issueController.close()},close:function(){if(this.canDismissComment()){this.dismiss();this.trigger("close")}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/IssueViewerAppModule.js' */
AJS.namespace("JIRA.Components.IssueViewer.AppModule");JIRA.Components.IssueViewer.AppModule=JIRA.Marionette.AppModule.extend({name:"issueViewer",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueViewer({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(){return{abortPending:true,beforeHide:true,beforeShow:true,removeIssueMetadata:true,updateIssueWithQuery:true,close:true,setContainer:true,dismiss:true}},requests:function(){return{loadIssue:true,canDismissComment:true,getIssueId:true,getIssueKey:true,refreshIssue:true,isCurrentlyLoading:true}},events:function(){return["loadComplete","loadError","close","render","replacedFocusedPanel"]}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/Issue.soy' */
// This file was automatically generated from Issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }


JIRA.Components.IssueViewer.Templates.layout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="issue-edit-form"><div class="issue-header-container"></div><div class="issue-body-container"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueHeader.soy' */
// This file was automatically generated from IssueHeader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Header == 'undefined') { JIRA.Components.IssueViewer.Templates.Header = {}; }


JIRA.Components.IssueViewer.Templates.Header.opsbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ops-cont"><div class="ops-menus aui-toolbar">');
  if (opt_data.issue.operations) {
    var linkGroupList6 = opt_data.issue.operations.linkGroups;
    var linkGroupListLen6 = linkGroupList6.length;
    for (var linkGroupIndex6 = 0; linkGroupIndex6 < linkGroupListLen6; linkGroupIndex6++) {
      var linkGroupData6 = linkGroupList6[linkGroupIndex6];
      if (linkGroupData6.id && linkGroupData6.id == 'view.issue.opsbar') {
        output.append('<div class="toolbar-split toolbar-split-left">');
        var subGroupList10 = linkGroupData6.groups;
        var subGroupListLen10 = subGroupList10.length;
        for (var subGroupIndex10 = 0; subGroupIndex10 < subGroupListLen10; subGroupIndex10++) {
          var subGroupData10 = subGroupList10[subGroupIndex10];
          JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData10, parentGroup: linkGroupData6}, output);
        }
        output.append('</div>');
      } else if (linkGroupData6.id && linkGroupData6.id == 'jira.issue.tools') {
        output.append('<div class="toolbar-split toolbar-split-right">');
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: linkGroupData6}, output);
        output.append('</div>');
      }
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.legacyIssueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content"><div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, output);
  }
  output.append('</div><div id="heading-avatar"><img id="project-avatar" alt="" class="project-avatar-48" height="48" src="', soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), '" width="48"></div><ul class="breadcrumbs"><li><a id="project-name-val" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.project.key), '">', soy.$$escapeHtml(opt_data.issue.project.name), '</a> </li>', (opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a> </li>' : '', '<li><a class="issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.issue.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" id="key-val" rel="', soy.$$escapeHtml(opt_data.issue.id), '">', soy.$$escapeHtml(opt_data.issue.key), '</a></li></ul><h1 id="summary-val">', soy.$$escapeHtml(opt_data.issue.summary), '</h1><div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.issueHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-header-content">');
  var param72 = new soy.StringBuilder();
  if (opt_data.issue.project) {
    var param75 = new soy.StringBuilder();
    JIRA.Templates.Headers.projectAvatar({id: soy.$$escapeHtml(opt_data.issue.project.id), projectKey: soy.$$escapeHtml(opt_data.issue.project.key), projectName: soy.$$escapeHtml(opt_data.issue.project.name), avatarUrl: soy.$$escapeHtml(opt_data.issue.project.avatarUrls['48x48']), avatarAlt: soy.$$escapeHtml(opt_data.issue.project.name), isSystemAvatar: opt_data.issue.project.systemAvatar, hasProjectShortcut: opt_data.hasProjectShortcut}, param75);
    aui.page.pageHeaderImage({content: param75.toString()}, param72);
    aui.page.pageHeaderMain({content: '<ol class="aui-nav aui-nav-breadcrumbs"><li><a id="project-name-val" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.project.key) + '">' + soy.$$escapeHtml(opt_data.issue.project.name) + '</a></li>' + ((opt_data.issue.parent && opt_data.issue.parent.id) ? '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.parent.key) + '" id="parent_issue_summary" title="' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '">' + soy.$$escapeHtml(opt_data.issue.parent.key) + ' ' + soy.$$escapeHtml(opt_data.issue.parent.summary) + '</a></li>' : '') + '<li><a class="issue-link" data-issue-key="' + soy.$$escapeHtml(opt_data.issue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.issue.key) + '" id="key-val" rel="' + soy.$$escapeHtml(opt_data.issue.id) + '">' + soy.$$escapeHtml(opt_data.issue.key) + '</a></li></ol><h1 id="summary-val">' + soy.$$escapeHtml(opt_data.issue.summary) + '</h1>'}, param72);
  }
  var param127 = new soy.StringBuilder('<div id="issue-header-pager">');
  if (opt_data.pager) {
    JIRA.Components.IssueViewer.Templates.Header.pager(opt_data.pager, param127);
  }
  param127.append('</div>');
  aui.page.pageHeaderActions({content: param127.toString()}, param72);
  aui.page.pageHeader({content: param72.toString()}, output);
  output.append('<div class="command-bar">');
  if (opt_data.serverRenderedViewIssue) {
    JIRA.Components.IssueViewer.Templates.Header.opsbar(opt_data, output);
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.linkGroup = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.group.header && opt_data.group.header.label) {
    if (opt_data.group.links.length > 0 || opt_data.group.groups.length > 0) {
      JIRA.Components.IssueViewer.Templates.Header.dropdownLink(opt_data.group, output);
    }
  } else {
    output.append('<ul ', (opt_data.group.id) ? 'id="opsbar-' + soy.$$escapeHtml(opt_data.group.id) + '" ' : '', 'class="toolbar-group pluggable-ops">');
    var linkList155 = opt_data.group.links;
    var linkListLen155 = linkList155.length;
    for (var linkIndex155 = 0; linkIndex155 < linkListLen155; linkIndex155++) {
      var linkData155 = linkList155[linkIndex155];
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: linkData155}, output);
    }
    if (opt_data.group.groups.length == 1 && opt_data.group.groups[0].links.length == 0 && opt_data.group.groups[0].groups.length == 1 && opt_data.group.groups[0].groups[0].links.length == 1) {
      JIRA.Components.IssueViewer.Templates.Header.toolbarItem({link: opt_data.group.groups[0].groups[0].links[0]}, output);
    } else {
      var subGroupList164 = opt_data.group.groups;
      var subGroupListLen164 = subGroupList164.length;
      for (var subGroupIndex164 = 0; subGroupIndex164 < subGroupListLen164; subGroupIndex164++) {
        var subGroupData164 = subGroupList164[subGroupIndex164];
        JIRA.Components.IssueViewer.Templates.Header.linkGroup({group: subGroupData164}, output);
      }
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item toolbar-dropdown"><div><a href="#" ', (opt_data.header.id) ? ' id="' + soy.$$escapeHtml(opt_data.header.id) + '"' : '');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.header.title, label: opt_data.header.label}, output);
  output.append(' data-hide-on-scroll=".split-view .issue-container" data-contain-to-window="true" class="toolbar-trigger ', (opt_data.links.length > 0 || opt_data.groups.length > 0) ? ' js-default-dropdown' : '', (opt_data.header.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.header.styleClass) : '', '" >', (opt_data.header.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.header.iconClass) + '"></span> ' : '', '<span class="dropdown-text">', soy.$$truncate(soy.$$escapeHtml(opt_data.header.label), 25, true), '</span><span class="icon drop-menu"></span></a><div class="aui-list hidden">');
  if (opt_data.links.length > 0) {
    output.append('<ul class="aui-list-section aui-first', (opt_data.groups.length == 0) ? ' aui-last' : '', '">');
    var linkList204 = opt_data.links;
    var linkListLen204 = linkList204.length;
    for (var linkIndex204 = 0; linkIndex204 < linkListLen204; linkIndex204++) {
      var linkData204 = linkList204[linkIndex204];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData204, output);
    }
    output.append('</ul>');
  }
  var groupList208 = opt_data.groups;
  var groupListLen208 = groupList208.length;
  for (var groupIndex208 = 0; groupIndex208 < groupListLen208; groupIndex208++) {
    var groupData208 = groupList208[groupIndex208];
    output.append('<ul class="aui-list-section', (opt_data.links.length == 0 && groupIndex208 == 0) ? ' aui-first' : '', (groupIndex208 == groupListLen208 - 1) ? ' aui-last' : '', '">');
    var linkList217 = groupData208.links;
    var linkListLen217 = linkList217.length;
    for (var linkIndex217 = 0; linkIndex217 < linkListLen217; linkIndex217++) {
      var linkData217 = linkList217[linkIndex217];
      JIRA.Components.IssueViewer.Templates.Header.dropdownItem(linkData217, output);
    }
    output.append('</ul>');
  }
  output.append('</div></div></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.dropdownItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item"><a  href="', (opt_data.href) ? soy.$$escapeHtml(opt_data.href) : '#', '" class="aui-list-item-link', (opt_data.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.styleClass) : '', '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr(opt_data, output);
  output.append((opt_data.id) ? 'id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', '><span class="trigger-label">', soy.$$truncate(soy.$$escapeHtml(opt_data.label), 25, true), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.toolbarItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="toolbar-item"><a id="', soy.$$escapeHtml(opt_data.link.id), '"');
  JIRA.Components.IssueViewer.Templates.Header.titleAttr({title: opt_data.link.title, label: opt_data.link.label}, output);
  output.append('class="toolbar-trigger', (opt_data.link.styleClass) ? ' ' + soy.$$escapeHtml(opt_data.link.styleClass) : '', '" href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '">', (opt_data.link.iconClass) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.link.iconClass) + '"></span> <span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>' : '<span class="trigger-label">' + soy.$$truncate(soy.$$escapeHtml(opt_data.link.label), 25, true) + '</span>', '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Header.titleAttr = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : (opt_data.label && opt_data.label.length && opt_data.label.length > 25) ? 'title="' + soy.$$escapeHtml(opt_data.label) + '"' : '');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueBody.soy' */
// This file was automatically generated from IssueBody.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Body == 'undefined') { JIRA.Components.IssueViewer.Templates.Body = {}; }


JIRA.Components.IssueViewer.Templates.Body.issueBody = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column"></div><div id="viewissuesidebar" class="aui-item issue-side-column"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issueBodyWithPanels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group issue-body"><div class="aui-item issue-main-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList10 = opt_data.panels.leftPanels;
    var panelListLen10 = panelList10.length;
    for (var panelIndex10 = 0; panelIndex10 < panelListLen10; panelIndex10++) {
      var panelData10 = panelList10[panelIndex10];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData10, output);
    }
  }
  output.append('</div><div id="viewissuesidebar" class="aui-item issue-side-column">');
  if (opt_data.serverRenderedViewIssue) {
    var panelList16 = opt_data.panels.rightPanels;
    var panelListLen16 = panelList16.length;
    for (var panelIndex16 = 0; panelIndex16 < panelListLen16; panelIndex16++) {
      var panelData16 = panelList16[panelIndex16];
      JIRA.Components.IssueViewer.Templates.Body.issuePanel(panelData16, output);
    }
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.issuePanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.renderHeader) {
    output.append('<div id=', soy.$$escapeHtml(opt_data.id), ' class="module toggle-wrap"><div id="', soy.$$escapeHtml(opt_data.id), '_heading" class="mod-header"><ul class="ops">');
    var linkList28 = opt_data.headerLinks.links;
    var linkListLen28 = linkList28.length;
    for (var linkIndex28 = 0; linkIndex28 < linkListLen28; linkIndex28++) {
      var linkData28 = linkList28[linkIndex28];
      output.append('<li>');
      JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData28}, output);
      output.append('</li>');
    }
    if (opt_data.headerLinks.groups.length > 0) {
      output.append('<li class="drop"><div class="aui-dd-parent"><a href="#" class="icon drop-menu js-default-dropdown" title="', soy.$$escapeHtml("Options"), '"><span>', soy.$$escapeHtml("Options"), '</span></a><div class="aui-dropdown-content aui-list">');
      var groupList41 = opt_data.headerLinks.groups;
      var groupListLen41 = groupList41.length;
      for (var groupIndex41 = 0; groupIndex41 < groupListLen41; groupIndex41++) {
        var groupData41 = groupList41[groupIndex41];
        output.append((groupData41.header && groupData41.header.label) ? '<h5>' + soy.$$escapeHtml(groupData41.header.label) + '</h5>' : '', '<ul ', (groupData41.header && groupData41.header.id) ? 'id="' + soy.$$escapeHtml(groupData41.header.id) + '"' : '', 'class="aui-list-section', (groupData41.header && groupData41.header.styleClass) ? ' ' + soy.$$escapeHtml(groupData41.header.styleClass) : '', (groupIndex41 == 0) ? ' aui-first' : '', (groupIndex41 == groupListLen41 - 1) ? ' aui-last' : '', '">');
        var linkList65 = groupData41.links;
        var linkListLen65 = linkList65.length;
        for (var linkIndex65 = 0; linkIndex65 < linkListLen65; linkIndex65++) {
          var linkData65 = linkList65[linkIndex65];
          output.append('<li class="aui-list-item">');
          JIRA.Components.IssueViewer.Templates.Body.simpleLink({link: linkData65, additionalStyleClass: 'aui-list-item-link'}, output);
          output.append('</li>');
        }
        output.append('</ul>');
      }
      output.append('</div></div></li>');
    }
    output.append('</ul>');
    if (opt_data.subpanelHtmls.length > 0) {
      output.append('<div class="mod-header-panels">');
      var subPanelList79 = opt_data.subpanelHtmls;
      var subPanelListLen79 = subPanelList79.length;
      for (var subPanelIndex79 = 0; subPanelIndex79 < subPanelListLen79; subPanelIndex79++) {
        var subPanelData79 = subPanelList79[subPanelIndex79];
        output.append('<div class="mod-header-panel">', subPanelData79, '</div>');
      }
      output.append('</div>');
    }
    output.append('<h2 class="toggle-title">', soy.$$escapeHtml(opt_data.label), '</h2></div><div class="mod-content">', opt_data.html, '</div></div>');
  } else {
    output.append(opt_data.html);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data != null && opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data != null && opt_data.errorMessages) {
    output.append('<ul>');
    var msgList104 = opt_data.errorMessages;
    var msgListLen104 = msgList104.length;
    for (var msgIndex104 = 0; msgIndex104 < msgListLen104; msgIndex104++) {
      var msgData104 = msgList104[msgIndex104];
      output.append('<li>', soy.$$escapeHtml(msgData104), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.focusShifter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message closeable" id="focus-shifter"><label><span>', soy.$$escapeHtml("viewissue.focusshifter"), '</span><div id="focus-shifter-content"></div></label><span class="aui-icon icon-close"></span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Body.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/templates/IssueError.soy' */
// This file was automatically generated from IssueError.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.IssueViewer == 'undefined') { JIRA.Components.IssueViewer = {}; }
if (typeof JIRA.Components.IssueViewer.Templates == 'undefined') { JIRA.Components.IssueViewer.Templates = {}; }
if (typeof JIRA.Components.IssueViewer.Templates.Error == 'undefined') { JIRA.Components.IssueViewer.Templates.Error = {}; }


JIRA.Components.IssueViewer.Templates.Error.NoPermission = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Permission Violation", body: "It seems that you have tried to perform an operation which you are not permitted to perform.", error: 'warning', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.DoesNotExist = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Issue Does Not Exist", body: "The issue you are trying to view does not exist.", error: 'error', returnToSearch: ! opt_data.hideReturnToSearch}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.Generic = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.IssueViewer.Templates.Error.viewIssueError({title: "Unexpected Error", body: "There was an unexpected error while loading the issue.", error: 'error', returnToSearch: false}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Components.IssueViewer.Templates.Error.viewIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="issue-content" class="form-body"><header class="issue-header"><div class="issue-header-content"><header class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1>', soy.$$escapeHtml(opt_data.title), '</h1></div><div class="aui-page-header-actions"><div id="issue-header-pager"></div></div></div></header></div></header><div class="issue-body-content"><div class="aui-message ', soy.$$escapeHtml(opt_data.error), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.error), '"></span><p>', soy.$$escapeHtml(opt_data.body), '</p><p>', soy.$$escapeHtml("If you think this message is wrong, please contact your"), '<a href="', soy.$$escapeHtml(""), '/secure/ContactAdministrators!default.jspa"> ', soy.$$escapeHtml("JIRA administrators"), '</a>.</p>', (opt_data.returnToSearch) ? '<p><a id="return-to-search" class="push-state" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></p>' : '', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Panel");JIRA.Components.IssueViewer.Models.Panel=JIRA.Issues.Brace.Model.extend({namedAttributes:["entity","updateLocked"],initialize:function(){JIRA.bind(JIRA.Events.LOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",true)}},this));JIRA.bind(JIRA.Events.UNLOCK_PANEL_REFRESHING,_.bind(function(a,b){if(b===this.getEntity().id){this.set("updateLocked",false)}},this))},update:function(c,a,b){if(!this.getUpdateLocked()){this.set("entity",c);this.trigger("updated",a,b)}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsCollection.js' */
AJS.namespace("JIRA.Components.IssueViewer.Collections.Panels");JIRA.Components.IssueViewer.Collections.Panels=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueViewer.Models.Panel,update:function(c,b){var a=this;this.each(function(d){var e=d.id;var f=_.any(c,function(g){return g.id===e});if(!f){this.remove(d)}},this);_.each(c,function(e,f){var d=this.get(e.id);if(d){d.update(e,b.fieldsInProgress,b.fieldsSaved)}else{this.add({id:e.id,entity:e},{at:f})}},this)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/PanelsGroupModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.PanelsGroup");JIRA.Components.IssueViewer.Models.PanelsGroup=JIRA.Issues.Brace.Model.extend({namedAttributes:["leftPanels","rightPanels","infoPanels"],defaults:function(){return{leftPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),rightPanels:new JIRA.Components.IssueViewer.Collections.Panels([]),infoPanels:new JIRA.Components.IssueViewer.Collections.Panels([])}},update:function(b,a){this.get("leftPanels").update(b.leftPanels,a);this.get("rightPanels").update(b.rightPanels,a);this.get("infoPanels").update(b.infoPanels,a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/entities/IssueModel.js' */
AJS.namespace("JIRA.Components.IssueViewer.Models.Issue");JIRA.Components.IssueViewer.Models.Issue=JIRA.Issues.Brace.Model.extend({namedEvents:["updated"],namedAttributes:["entity","id","key","panels"],defaults:function(){return{entity:{},panels:new JIRA.Components.IssueViewer.Models.PanelsGroup()}},update:function(c,b){var a=false;if(c.issue){this.updateFromEntity(c.issue);a=true}if(c.panels){this.getPanels().update(c.panels,b);a=true}if(a){this.trigger("updated",b)}},resetToDefault:function(){this.clear();this.set(this.defaults())},updateFromEntity:function(a){this.set({id:a.id,key:a.key,entity:a})},isCurrentIssue:function(a){return this.get("id")==a},hasIssue:function(){return this.has("id")},updateIssueQuery:function(a){if(!this.hasIssue()){return}this.getEntity().viewIssueQuery=a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanel");JIRA.Components.IssueViewer.Views.IssuePanel=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Body.issuePanel,modelEvents:{updated:"update"},update:function(a,i){var b=this.renderTemplate();var d=this.$el;var h=this;if(b.text()===d.text()){return}function f(){return _.any(a,function(j){return d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(j)).length===1})}function c(){var j=d.find(document.activeElement).length>0;var m=!!jQuery.browser.msie&&jQuery.browser.version<=8;if(!m){d.replaceWith(b)}else{var l=d[0].nextSibling;var k=d[0].parentNode;d.remove();if(l){jQuery(l).before(b)}else{jQuery(k).append(b)}}if(j){h.trigger("replacedFocusedPanel")}h.setElement(b)}function e(k){var l=h.model.id;var j=h.$el;h.trigger("panelRendered",l,j);JIRA.trigger(JIRA.Events.PANEL_REFRESHED,[l,j,d]);_.each(k,function(m){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[m,JIRA.CONTENT_ADDED_REASON.panelRefreshed])})}if(!f()){c();e([h.$el])}else{var g=[];_.each(i,function(l){var k=d.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(k.length===1){var j=b.find(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(l));if(j.length===1){k.replaceWith(j);g.push(j)}else{k.closest("li, dl").remove()}}});e(g)}this.bindUIElements()},onRender:function(){this.setElement(this.$el.children());var a=this.model.getEntity().styleClass;if(a){this.$el.addClass(a)}JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},serializeData:function(){return this.model.getEntity()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssuePanelsView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssuePanels");JIRA.Components.IssueViewer.Views.IssuePanels=JIRA.Marionette.CollectionView.extend({itemView:JIRA.Components.IssueViewer.Views.IssuePanel,_updatingFromDom:false,appendHtml:function(a,d,b){var c=a.$el.children();var e=c.length;if(b<=0){a.$el.prepend(d.$el)}else{if(!e||b>=e){a.$el.append(d.$el)}else{d.$el.insertBefore(c.eq(b))}}},applyToDom:function(){var a=this;this._updatingFromDom=true;this.$el.children().filter(".module").each(function(){var b=this.id;if(b==="addcomment"){b="addcommentmodule"}a.collection.add(new JIRA.Components.IssueViewer.Models.Panel({id:b,entity:{id:b}}))});this._updatingFromDom=false},renderItemView:function(){if(!this._updatingFromDom){JIRA.Marionette.CollectionView.prototype.renderItemView.apply(this,arguments)}},buildItemView:function(b){var a=JIRA.Marionette.CollectionView.prototype.buildItemView.apply(this,arguments);if(this._updatingFromDom){a.setElement(this.$el.find("#"+b.id))}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueBodyView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueBody");JIRA.Components.IssueViewer.Views.IssueBody=JIRA.Marionette.Layout.extend({tagName:"div",className:"issue-body-content",regions:{leftPanels:{selector:".issue-main-column",regionType:JIRA.Marionette.LinkRegion},rightPanels:{selector:".issue-side-column",regionType:JIRA.Marionette.LinkRegion},infoPanels:{selector:".issue-body",regionType:JIRA.Marionette.LinkRegion}},template:JIRA.Components.IssueViewer.Templates.Body.issueBody});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueOpsbarView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueOpsbar");JIRA.Components.IssueViewer.Views.IssueOpsbar=JIRA.Marionette.ItemView.extend({template:JIRA.Components.IssueViewer.Templates.Header.opsbar,ui:{shareButton:".viewissue-share",exportButton:"#viewissue-export",loginButton:"#ops-login-lnk",commentButton:"#comment-issue"},serializeData:function(){return{issue:this.model.getEntity()}},onApplyToDom:function(){this.onRender()},onRender:function(){this.ui.loginButton.hide();this.ui.commentButton.addClass("inline-comment");new JIRA.Issues.Tipsy({el:this.ui.shareButton,showCondition:":not(.active)"});new JIRA.Issues.Tipsy({el:this.ui.exportButton,showCondition:":not(.active)",tipsy:{gravity:"ne"}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueHeaderView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.IssueHeader");JIRA.Components.IssueViewer.Views.IssueHeader=JIRA.Marionette.Layout.extend({className:"issue-header js-stalker",id:"stalker",tagName:"header",template:JIRA.Components.IssueViewer.Templates.Header.issueHeader,modelEvents:{updated:"update"},regions:{opsbar:".command-bar",pager:"#issue-header-pager"},serializeData:function(){return{issue:this.model.getEntity(),hasProjectShortcut:JIRA.Components.IssueViewer.Services.DarkFeatures.PROJECT_SHORTCUTS.enabled()}},update:function(a){if(a.initialize){this._updateWindowTitle()}else{var b=_.include(a.fieldsInProgress,"summary");if(b){this.renderOpsBar()}else{this.render()}}this.trigger("updated")},onApplyToDom:function(){var a=new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model});a.setElement(this.opsbar.el);this.opsbar.attachView(a);this.opsbar.currentView.applyToDom()},onRender:function(){this.renderOpsBar();this._updateWindowTitle();this.trigger("panelRendered","header",this.$el)},renderOpsBar:function(){this.opsbar.show(new JIRA.Components.IssueViewer.Views.IssueOpsbar({model:this.model}));JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.panelRefreshed])},_updateWindowTitle:function(){var a=this.model.getEntity();var c=a.key;var b=a.summary;var d=AJS.Meta.get("app-title");if(d&&b&&c){document.title="["+c+"] "+b+" - "+d}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/issue/IssueView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Issue");JIRA.Components.IssueViewer.Views.Issue=JIRA.Marionette.Layout.extend({template:JIRA.Components.IssueViewer.Templates.layout,className:"issue-container",regions:{header:{selector:".issue-header-container",regionType:JIRA.Marionette.ReplaceRegion},body:{selector:".issue-body-container",regionType:JIRA.Marionette.ReplaceRegion}},modelEvents:{updated:"update"},showLoading:function(){this.$el.addClass("loading")},hideLoading:function(){this.$el.removeClass("loading")},focusComment:function(a){this.$("#activitymodule .focused").removeClass("focused");this.$("#comment-"+a).addClass("focused");this.$(".js-stalker").trigger("refresh")},update:function(a){if(a.initialize){this.render()}if(a.reason&&a.reason.action===JIRA.Issues.Actions.EDIT_COMMENT){this.focusComment(a.reason.meta.commentId)}this._bringViewIssueElementIntoView()},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1");this._bringViewIssueElementIntoView();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.pageLoad]);if(JIRA.Events.REFRESH_TOGGLE_BLOCKS){JIRA.trigger(JIRA.Events.REFRESH_TOGGLE_BLOCKS,[this.model.getId()])}},onApplyToDom:function(){this._bringViewIssueElementIntoView()},_bringViewIssueElementIntoView:function(){var a=this.model.get("entity").viewIssueQuery;if(a){var b;if(a.focusedCommentId){b="#comment-"+a.focusedCommentId}else{if(a.attachmentSortBy||a.attachmentOrder){b="#attachmentmodule"}}if(b){AJS.$(b).scrollIntoView({marginBottom:200,marginTop:200})}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.Error");JIRA.Components.IssueViewer.Views.Error=JIRA.Marionette.Layout.extend({className:"issue-container",regions:{pager:"#issue-header-pager"},remove:function(){this.stopListening();this.$el.empty();return this},onRender:function(){this.$el.addClass(this.className);this.$el.attr("tabindex","-1")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorGenericView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorGeneric");JIRA.Components.IssueViewer.Views.ErrorGeneric=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.Generic});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNotFoundView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNotFound=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.DoesNotExist,initialize:function(a){a=a||{};this.showReturnToSearchOnError=a.showReturnToSearchOnError},triggers:{"click #return-to-search":"returnToSearch"},serializeData:function(){var a=this.showReturnToSearchOnError;if(_.isFunction(a)){a=a()}return{hideReturnToSearch:!a}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/views/error/ErrorNoPermissionView.js' */
AJS.namespace("JIRA.Components.IssueViewer.Views.ErrorNoPermission");JIRA.Components.IssueViewer.Views.ErrorNoPermission=JIRA.Components.IssueViewer.Views.Error.extend({template:JIRA.Components.IssueViewer.Templates.Error.NoPermission});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/IssueController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Issue");JIRA.Components.IssueViewer.Controllers.Issue=JIRA.Marionette.Controller.extend({initialize:function(a){this.model=a.model},_createViews:function(){this.view=this._createMainView();this.bodyView=this._createBodyView();this.headerView=this._createHeaderView();this.leftPanelsView=this._createPanelsView(this.model.getPanels().getLeftPanels());this.rightPanelsView=this._createPanelsView(this.model.getPanels().getRightPanels());this.infoPanelsView=this._createPanelsView(this.model.getPanels().getInfoPanels())},_createMainView:function(){return new JIRA.Components.IssueViewer.Views.Issue({model:this.model,el:this.$el})},_createBodyView:function(){return new JIRA.Components.IssueViewer.Views.IssueBody({model:this.model})},_createHeaderView:function(){var a=new JIRA.Components.IssueViewer.Views.IssueHeader({model:this.model});this.listenAndRethrow(a,"panelRendered");this.listenTo(a,"updated",function(){this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{issueId:this.model.getId()})});return a},_createPanelsView:function(b){var a=new JIRA.Components.IssueViewer.Views.IssuePanels({collection:b});this.listenTo(a,"itemview:replacedFocusedPanel",function(){this.trigger("replacedFocusedPanel")});this.listenTo(a,"itemview:panelRendered",function(c,e,d){this.trigger("panelRendered",e,d)});return a},createView:function(){this._createViews();this.listenTo(this.view,"render",function(){this.view.header.show(this.headerView);this.view.body.show(this.bodyView);this.bodyView.leftPanels.show(this.leftPanelsView);this.bodyView.rightPanels.show(this.rightPanelsView);this.bodyView.infoPanels.show(this.infoPanelsView);this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:false,issueId:this.model.getId()})})},createViewFromDom:function(){this._createViews();this.listenTo(this.view,"applyToDom",function(){function a(d,b,c){b.setElement(c);b.applyToDom();d.attachView(b)}a(this.view.body,this.bodyView,this.view.$el.find(".issue-body-content"));a(this.view.body,this.headerView,this.view.$el.find("#stalker"));a(this.bodyView.leftPanels,this.leftPanelsView,this.bodyView.$el.find(this.bodyView.leftPanels.el));a(this.bodyView.rightPanels,this.rightPanelsView,this.bodyView.$el.find(this.bodyView.rightPanels.el));a(this.bodyView.infoPanels,this.infoPanelsView,this.bodyView.$el.find(this.bodyView.infoPanels.el));this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:true,issueId:this.model.getId()})})},setElement:function(a){this.$el=a;if(this.view){this.view.setElement(a)}},applyToDom:function(a){a.id=+a.id;this.model.updateFromEntity(a);this.createViewFromDom();this.view.applyToDom()},show:function(){if(!this.view){this.createView();this.view.render()}else{this.trigger("render",{pager:this.view.$(this.headerView.pager.el)},{loadedFromDom:false,issueId:this.model.getId()})}this.view.hideLoading()},close:function(){if(this.view){this.view.close()}this.hideLoading();delete this.view},hideLoading:function(){this.view&&this.view.hideLoading()},showLoading:function(){this.view&&this.view.showLoading()},canDismissComment:function(){var b;var a=JIRA.Issue.CommentForm;if(!a.getForm().data("dismissed")){b=a.handleBrowseAway();if(b){if(!confirm(b)){a.focus();return false}else{a.getForm().data("dismissed",true)}}}return true}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/controllers/ErrorController.js' */
AJS.namespace("JIRA.Components.IssueViewer.Controllers.Error");JIRA.Components.IssueViewer.Controllers.Error=JIRA.Marionette.Controller.extend({initialize:function(a){this.contextPath=a.contextPath;this.showReturnToSearchOnError=a.showReturnToSearchOnError},render:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorView(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},applyToDom:function(b,a){switch(b){case"auth":this._renderErrorAuth(a);break;case"forbidden":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNoPermission());break;case"notfound":this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorNotFound({showReturnToSearchOnError:this.showReturnToSearchOnError}));break;case"generic":default:this._renderErrorViewFromDom(new JIRA.Components.IssueViewer.Views.ErrorGeneric());break}},close:function(){if(this.view){this.view.close();delete this.view}},setElement:function(a){this._$el=a;if(this.view){this.view.setElement(a)}},_renderErrorAuth:function(b){var a=this.contextPath+"/login.jsp?os_destination="+encodeURIComponent("/browse/"+b);window.location.replace(a)},_renderErrorView:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.render();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.$(this.view.pager.el)},{loadedFromDom:false,issueId:null})},_renderErrorViewFromDom:function(a){this.trigger("before:render");JIRA.Components.IssueViewer.Utils.hideDropdown();this.view=a;this.view.setElement(this._$el);this.view.applyToDom();this.listenAndRethrow(this.view,"returnToSearch");this.trigger("render",{pager:this.view.$(this.view.pager.el)},{loadedFromDom:true,issueId:null})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/IssueLoaderService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.IssueLoader");JIRA.Components.IssueViewer.Services.IssueLoader=JIRA.Marionette.Controller.extend({initialize:function(){this._promiseManager=jQuery.RecurringPromise();this._updatingPromise=this._promiseManager.sub();this._updatingPromise.done(_.bind(this._onUpdatingDone,this)).fail(_.bind(this._onUpdatingError,this));this._loadingPromise=this._promiseManager.sub();this._loadingPromise.done(_.bind(this._onLoadingDone,this)).fail(_.bind(this._onLoadingError,this))},cancel:function(){this._promiseManager.reset()},update:function(f){var d=f.issueEntity,c=f.mergeIntoCurrent,h=f.viewIssueData,g=!!f.detailView;var e=jQuery.Deferred(),b;function a(i){return function(){return{taskKey:i,data:arguments,startIssueLoad:new Date()}}}b=this._updatingPromise.add(h.get(d.key,true,{issueEntity:d,loadingDeferred:e,mergeIntoCurrent:c,startIssueLoad:new Date(),detailView:g}).pipe(a("issue"),a("issue")));b.fail(function(){e.reject.apply(e,arguments)});return e.promise()},load:function(c){var a=c.issueEntity;var e=c.viewIssueData;var d=!!a.detailView;this._currentlyLoading=true;var b=jQuery.Deferred();this._loadingPromise.add(e.get(a.key,false,{issueEntity:a,loadFields:false,loadingDeferred:b,startIssueLoad:new Date(),detailView:d}));return b.promise()},isLoading:function(){return this._currentlyLoading},_onLoadingDone:function(c,d,b){var a=b.issueEntity;var e=a.id=c.issue.id;a.key=c.issue.key;if(!c.pager){c.pager=a.pager}JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this._currentlyLoading=false;d.loadDuration=new Date()-b.startIssueLoad;this.trigger("issueLoaded",c,d,b);b.loadingDeferred.resolve(c,d,b)},_onUpdatingDone:function(a){var b=a.data[1];if(b){b.isUpdate=true}this._onLoadingDone.apply(this,a.data)},_onLoadingError:function(d,f,b){var a=b.issueEntity;var g=a.id;var c={issueId:a.id,issueKey:a.key,response:d};this._currentlyLoading=false;var e;switch(d.status){case 401:e="auth";break;case 403:e="forbidden";break;case 404:e="notfound";break;default:e="generic";break}this.trigger("error",e,c);b.loadingDeferred.reject()},_onUpdatingError:function(a){this._onLoadingError.apply(this,a.data)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/MetadataService.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.Metadata");JIRA.Components.IssueViewer.Services.Metadata={removeIssueMetadata:function(b){var a=b.getEntity();if(a.metadata){_.each(a.metadata,function(d,c){AJS.Meta.set(c,null)})}else{if(AJS.Meta.get("issue-key")){AJS.Meta.set("issue-key",null)}}},addIssueMetadata:function(b){var a=b.getEntity();_.each(a.metadata,function(d,c){AJS.Meta.set(c,d)})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/services/DarkFeatures.js' */
AJS.namespace("JIRA.Components.IssueViewer.Services.DarkFeatures");JIRA.Components.IssueViewer.Services.DarkFeatures=(function(){var a=Class.extend({init:function(b){this.featureKey=b},enabled:function(){return AJS.DarkFeatures.isEnabled(this.featureKey)}});return{NO_PREFETCH:new a("ka.NO_PREFETCH"),PROJECT_SHORTCUTS:new a("rotp.project.shortcuts")}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/Utils.js' */
JIRA.Components.IssueViewer.Utils={hideLightbox:function(){AJS.$.fancybox.close()},hideDropdown:function(){if(AJS.InlineDialog.current&&(!JIRA.Issues.IntroDialog||_.contains(JIRA.Issues.IntroDialog.dialogs,AJS.InlineDialog.current))&&AJS.InlineDialog.current.id!=="column-picker-dialog"){AJS.InlineDialog.current.hide()}if(AJS.InlineLayer.current){var a=AJS.InlineLayer.current.options.offsetTarget();if(a instanceof jQuery){if(!a.is(":visible")){AJS.InlineLayer.current.hide()}}}}};JIRA.Events.ISSUE_REFRESHED="issueRefreshed";JIRA.Events.PANEL_REFRESHED="panelRefreshed";JIRA.Issues.Actions=JIRA.Issues.Actions||{};JIRA.Issues.Actions.EDIT_COMMENT="editComment";
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueEventBus.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueEventBus");JIRA.Components.IssueViewer.Legacy.IssueEventBus=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId"],namedEvents:["save","saveSuccess","savingStarted","saveError","panelRendered","replacedFocusedPanel","fieldSubmitted","dismiss","refreshIssue","issueRefreshed","updateFromDom","updateStatusColor","quickEditKeyPressed","openFocusShifter"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/AsyncData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.AsyncData");JIRA.Components.IssueViewer.Legacy.AsyncData=JIRA.Issues.Brace.Evented.extend({namedEvents:["change"],initialize:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.disableCache=a.disableCache;this.maxCacheSize=a.maxCacheSize}},get:function(b,a,i){var g=jQuery.Deferred();var d=this.disableCache?{}:this.data;var f=_.bind(function(m,l){var k=this._set(d,b,_.defaults(m,{accessIndex:this.accessIndex++}),true,i);var j=_.defaults({changed:k},l,d[b]);if(i&&i.mergeIntoCurrent){j.mergeIntoCurrent=true}if(d[b]&&!d[b].error){g.resolve(d[b].value,j,i)}else{g.reject(d[b]&&d[b].value,j,i)}},this);var c=_.bind(function(j){var k=this.fetch(b,i);this.setPending(b,k,function(l){f({value:l,error:false,updated:new Date()},{initialLoad:j})},function(l){var m={error:true,updated:new Date()};if(l!==undefined){m.value=l}f(m,{initialLoad:j,error:true})})},this);var e=function(){f({},{fromCache:true})};var h=_.bind(function(){this.pendings[b].always(_.bind(f,this,{},{initialLoad:true}))},this);if(a||this.disableCache){c(false)}else{if(this.hasCached(b)){e()}else{if(this.hasPending(b)){h()}else{c(true)}}}return g.promise()},setPending:function(d,b,a,c){if(this.hasPending(d)){this.pendings[d].update(b)}else{this.pendings[d]=jQuery.ConcurrentDeferred(b)}return this.pendings[d].done(function(e){a(e)}).fail(function(e){c(e)})},getIdByValue:function(a){var b;for(b in this.data){if(this.data[b].value===a){return b}}return null},getMeta:function(a){return this.data[a]||{}},getAllCached:function(){var a={};_.each(this.data,function(b,c){a[c]=b.value});return a},hasCached:function(b){var a=this.getMeta(b);return a.value!==undefined||a.error===true},hasError:function(b){var a=this.getMeta(b);return a.error===true},hasPending:function(b){var a=this.pendings[b];return a?a.isPending():false},set:function(b,a){return this._set(this.data,b,{value:a,updated:new Date()},true)},remove:function(a){if(this.data[a]){delete this.data[a];this.triggerChange();return true}return false},setError:function(c,a){var b={error:true,updated:new Date()};if(a!==undefined){b.value=a}return this._set(this.data,c,b,true)},setMultiple:function(b){var a=new Date();var c=false;_.each(b,_.bind(function(d,e){d=_.pick(d,"value","error");d.updated=a;if(this._set(this.data,e,d,false)){c=true}},this));if(c){this.triggerChange()}return c},reset:function(a){this.data={};this.pendings={};this.accessIndex=0;if(a){this.setMultiple(a)}else{this.triggerChange()}},_set:function(e,g,f,c,b){if(this.disableCache&&e===this.data){e={}}var d=e[g]?_.clone(e[g]):{};var a=this.mergeFetchedAndCached(d,f,b?b:{},e[g]);if(c&&(!e[g]||a||e[g].error!==d.error)&&e===this.data){this.triggerChange()}if(!e[g]&&this.maxCacheSize&&_.keys(e).length===this.maxCacheSize){if(f.accessIndex){this._dropItem(e);e[g]=d}}else{e[g]=d}return a},_dropItem:function(c){var a=null;for(var b in c){if(!c[b].accessIndex){a=b;break}else{if(a===null||c[b].accessIndex<c[a].accessIndex){a=b}}}if(a!==null){delete c[a]}},fetch:function(d,b){var c=this.getMeta(d);var a=jQuery.Deferred();if(!this.hasCached(d)||c.error){a.reject(c.value)}else{a.resolve(c.value)}return a.promise()},mergeFetchedAndCached:function(b,d,a,c){_.extend(b,d);return !c||c.value!==b.value||c.error!==b.error}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/ViewIssueData.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.ViewIssueData");JIRA.Components.IssueViewer.Legacy.ViewIssueData=JIRA.Components.IssueViewer.Legacy.AsyncData.extend({initialize:function(a){JIRA.Components.IssueViewer.Legacy.AsyncData.prototype.initialize.call(this,_.defaults(a||{},{disableCache:JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled(),maxCacheSize:+AJS.Meta.get("viewissue-max-cache-size")}))},fetch:function(e,d){var h={issueKey:e,decorator:"none",prefetch:!!d.prefetch};h.shouldUpdateCurrentProject=!d.detailView;if(d.mergeIntoCurrent){if(this.data&&this.data[e]&&this.data[e].value&&this.data[e].value.issue){h.lastReadTime=this.data[e].value.readTime;h.fields=[];_.each(this.data[e].value.fields,function(i){h.fields.push(i.id+":"+i.contentId)});h.issue=["summary:"+this.data[e].value.issue.summaryContentId];h.links=[];var g=function(i){_.each(i.links,function(j){h.links.push(j.id+":"+j.contentId)});_.each(i.groups,function(j){g(j)})};_.each(this.data[e].value.issue.operations.linkGroups,function(i){g(i)});h.panels=[];var a=this;var b=function(i){_.each(a.data[e].value.panels[i],function(j){h.panels.push(j.completeKey+":"+j.contentId)})};b("leftPanels");b("rightPanels");b("infoPanels")}}if("loadFields" in d){h.loadFields=d.loadFields}if(d.issueEntity){_.defaults(h,d.issueEntity.viewIssueQuery)}var f=jQuery.ajax({url:contextPath+"/secure/AjaxIssueAction!default.jspa",headers:{"X-SITEMESH-OFF":true},data:h,type:d.mergeIntoCurrent?"POST":"GET"});var c=f.pipe(function(i){return i},function(i){return _.pick(i,"status","responseText","statusText")});c.abort=function(){f.abort.apply(f,arguments)};return c},mergeFetchedAndCached:function(l,m,d){if(this._skipMerging(l,m,d)){_.extend(l,m);return null}_.each(_.pairs(m),function(s){if(s[0]!=="value"){l[s[0]]=s[1]}});var q=m.value;var k=[];var b=[];var h=[];_.each(q.removedContentIds,function(u,t){var s;if(t==="fields"){s=k}else{if(t==="panels"){s=b}else{if(t==="links"){s=h}}}if(s){_.each(u,function(v){s.push(v)})}});var g=q.fields;var e=q.issue.operations.linkGroups;var o=q.panels;var j=q.issue.summary;if(this._nothingChanged(k,b,h,g,o,e,j)){return null}var p={updated:{},added:{},deleted:{}};var i=l.value;var f=this._comparator;var c=false;var n=false;var a=false;var r=false;if(k.length>0||g.length>0){this._mergeFields(g,i,p,k);c=true}if(b.length>0||o.leftPanels.length>0||o.rightPanels.length>0||o.infoPanels.length>0){this._mergePanels(o,i,p,b,f);n=true}if(h.length>0||e.length>0){this._mergeLinks(e,i,p,h,f);a=true}if(j){this._mergeSummary(q,i,p);r=true}return p},_skipMerging:function(c,b,a){return _.isEmpty(c)||!a.mergeIntoCurrent||!c.value||!c.value.issue||b.error===true},_nothingChanged:function(e,a,g,b,d,c,f){return e.length==0&&a.length==0&&g.length==0&&b.length==0&&c.length==0&&d.leftPanels.length==0&&d.rightPanels.length==0&&d.infoPanels.length==0&&!f},_mergeFields:function(c,e,d,a){d.added.fields=[];d.updated.fields=[];d.deleted.fields=[];_.each(c,function(f){var g=_.find(e.fields,function(h){return h.id==f.id});if(g){d.updated.fields.push(f.id)}else{d.added.fields.push(f.id)}});var b=c;_.each(e.fields,function(f){if(_.contains(a,f.id)){d.deleted.fields.push(f.id)}else{if(!_.contains(d.updated.fields,f.id)){b.push(f)}}});e.fields=b},_mergeSummary:function(c,b,a){a.updated.issue=["summary"];b.issue.summary=c.issue.summary;b.issue.summaryContentId=c.issue.summaryContentId},_mergePanels:function(e,d,c,a,b){c.added.panels={};c.updated.panels={};c.deleted.panels={};var f=function(g){c.added.panels[g]=[];c.updated.panels[g]=[];c.deleted.panels[g]=[];_.each(e[g],function(i){var j=_.find(d.panels[g],function(k){return k.id==i.id});if(j){c.updated.panels[g].push(i.id)}else{c.added.panels[g].push(i.id)}});var h=e[g];_.each(d.panels[g],function(i){if(_.contains(a,i.completeKey)){c.deleted.panels[g].push(i.id)}else{if(!_.contains(c.updated.panels[g],i.id)){h.push(i)}}});h.sort(b);d.panels[g]=h};f("leftPanels");f("rightPanels");f("infoPanels")},_mergeLinks:function(e,d,c,a,b){c.added.groups={};c.updated.groups={};c.deleted.groups={};var f=[];this._mergeOperationsLinks(e,d,f,c,a,b);this._mergeToolsLinks(e,d,f,c,a,b);d.issue.operations.linkGroups=f},_mergeOperationsLinks:function(j,d,c,a,k,b){a.added.groups["view.issue.opsbar"]=[];a.updated.groups["view.issue.opsbar"]=[];a.deleted.groups["view.issue.opsbar"]=[];var i=_.find(d.issue.operations.linkGroups,function(l){return"view.issue.opsbar"===l.id});var h=_.find(j,function(l){return"view.issue.opsbar"===l.id});var g={};var e={};if(h){_.each(h.groups,function(l){var m=_.find(i.groups,function(o){return l.id===o.id});if(m){a.updated.groups["view.issue.opsbar"].push(l.id)}else{a.added.groups["view.issue.opsbar"].push(l.id)}_.each(l.links,function(o){g[o.id]=o;e[o.id]=l.id});if(l.groups&&l.groups.length>0){var n=l.groups[0];_.each(n.groups,function(o){_.each(o.links,function(p){g[p.id]=p;e[p.id]=o.id})})}})}if(i){var f=[];if(h){_.each(h.groups,function(l){if(_.contains(a.added.groups["view.issue.opsbar"],l.id)){f.push(l)}})}_.each(i.groups,function(q){var p=[];var m=null;if(h){m=_.find(h.groups,function(t){return q.id===t.id});if(m){_.each(m.links,function(t){var u=_.find(q.links,function(v){return t.id===v.id});if(!u){p.push(t)}})}}var n=false;var l=function(u,t){_.each(u.links,function(v){var w=e[v.id];if(w&&w!==u.id){n=true}else{if(g[v.id]){t.push(g[v.id])}else{if(!_.contains(k,v.id)){t.push(v)}else{n=true}}}})};l(q,p);p.sort(b);q.links=p;var o=null;if(m&&m.groups&&m.groups.length>0){o=m.groups[0]}var s=null;if(q.groups&&q.groups.length>0){s=q.groups[0];var r=[];if(o){_.each(o.groups,function(t){var u=_.find(s.groups,function(v){return t.id===v.id});if(!u){r.push(t)}})}_.each(s.groups,function(v){var u=[];if(o){var t=_.find(o.groups,function(w){return w.id===v.id});if(t){_.each(t.links,function(w){var x=_.find(v.links,function(y){return w.id===y.id});if(!x){u.push(w)}})}}l(v,u);if(u.length>0){u.sort(b);v.links=u;r.push(v)}});if(r.length>0){r.sort(b);s.groups=r}else{s=null;n=true}}else{if(o){s=m.groups[0]}}q.groups=[];if(s){q.groups[0]=s}if(p.length>0||s){f.push(q);if(n&&!_.contains(a.updated.groups["view.issue.opsbar"],q.id)){a.updated.groups["view.issue.opsbar"].push(q.id)}}else{a.deleted.groups["view.issue.opsbar"].push(q.id)}});if(f.length>0){f.sort(b);i.groups=f;c.push(i)}}else{if(h){c.push(h)}}a.added.groups["view.issue.opsbar"].sort();a.deleted.groups["view.issue.opsbar"].sort();a.updated.groups["view.issue.opsbar"].sort()},_mergeToolsLinks:function(j,g,f,a,k,b){a.updated.groups["jira.issue.tools"]=false;var m=_.find(g.issue.operations.linkGroups,function(n){return"jira.issue.tools"===n.id});var l=_.find(j,function(n){return"jira.issue.tools"===n.id});var h={};if(l){a.updated.groups["jira.issue.tools"]=true;_.each(l.links,function(n){h[n.id]=n});if(l.groups&&l.groups.length>0){_.each(l.groups[0].links,function(n){h[n.id]=n})}}if(m){var c=[];if(l){_.each(l.links,function(n){var o=_.find(m.links,function(p){return n.id===p.id});if(!o){c.push(n)}})}_.each(m.links,function(n){if(h[n.id]){c.push(h[n.id])}else{if(!_.contains(k,n.id)){c.push(n)}}});c.sort(b);m.links=c;var i=null;if(l&&l.groups&&l.groups.length>0){i=l.groups[0]}if(m.groups&&m.groups.length>0){var e=m.groups[0];var d=[];if(i){_.each(i.links,function(n){var o=_.find(e.links,function(p){return n.id===p.id});if(!o){d.push(n)}})}_.each(e.links,function(n){if(h[n.id]){d.push(h[n.id])}else{if(!_.contains(k,n.id)){d.push(n)}}});m.groups=[];if(d.length>0){d.sort(b);e.links=d;m.groups[0]=e}}else{if(i){m.groups=[i]}}f.push(m)}else{if(l){f.push(l)}}},_comparator:function(b,a){if(b.weight&&a.weight){if(b.weight>a.weight){return 1}if(b.weight<a.weight){return -1}return 0}if(b.weight&&!a.weight){return 1}if(!b.weight&&a.weight){return -1}return 0},updateIssue:function(a,c){var b=this.getMeta(a);if(b&&b.value){b.value.fields=c.fields||{}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueviewer', location = 'issueviewer/js/legacy/IssueFieldUtil.js' */
AJS.namespace("JIRA.Components.IssueViewer.Legacy.IssueFieldUtil");JIRA.Components.IssueViewer.Legacy.IssueFieldUtil={getFieldSelector:function(a){if(a==="issuetype"){return"#type-val"}else{if(a==="fixVersions"){return"#fixfor-val"}else{if(a==="summary"){return"#summary-val"}else{if(a==="labels"){return"#wrap-labels .value"}else{if(a==="duedate"){return"#due-date"}else{return"#"+a+"-val"}}}}}},matchesFieldSelector:function(a){return jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(a)).length===1},transformFieldHtml:function(a){a.fields=_.map(a.fields,function(c){var b=AJS.$("<div />").htmlCatchExceptions(c.editHtml);b.find("legend,label").eq(0).remove();return{id:c.id,label:c.label,editHtml:b.html(),required:c.required,contentId:c.contentId}});return a},getAccessKeyModifier:function(){var b=AJS.$("#home_link_drop").attr("title"),a=/\(([\w\+]+)\+\w\)/i;if(a.test(b)){return a.exec(b)[1]}else{return"Alt"}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditor.js' */
AJS.namespace("JIRA.Components.IssueEditor");JIRA.Components.IssueEditor=JIRA.Components.IssueViewer.extend({namedEvents:["loadComplete","loadError","returnToSearch","saveSuccess","saveError","editField","fieldSubmitted","replacedFocusedPanel"],initialize:function(a){JIRA.Components.IssueViewer.prototype.initialize.call(this,a);this._buildFieldsLoader();this._buildIssueSaver();this._buildEditIssueController();this._buildFieldsController();this._handleUnload();this.listenAndRethrow(this.eventBus,"fieldSubmitted")},_buildFieldsLoader:function(){this.fieldsLoader=new JIRA.Components.IssueEditor.Services.FieldsLoader({contextPath:contextPath});this.listenTo(this.fieldsLoader,"fieldsLoaded",function(a){this.viewIssueData.updateIssue(a.issueKey,a);a.issueId=Number(a.issueId);var b=a.fields&&a.fields.length;if(b){this.editIssueController.update(a)}else{this.editIssueController.reset()}JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})});this.listenTo(this.fieldsLoader,"fieldsError",function(a){this.fieldsController.showError(a.errorCollection,a.isTimeout);JIRA.trace("jira.issue.fields.loaded",{id:a.issueId})})},_buildIssueSaver:function(){this.saveInProgressManager=new JIRA.Components.IssueEditor.Services.SaveInProgressManager();this.issueSaver=new JIRA.Components.IssueEditor.Services.IssueSaver({saveInProgressManager:this.saveInProgressManager,model:this.model});this.listenTo(this.issueSaver,"error",function(d){var f=d.issueId;var c=d.attemptedSavedIds;var b=d.response;var e=d.duration;if(!this.model.isCurrentIssue(f)){this._showSaveError({issueId:f,issueKey:d.issueKey,response:b});return}this.eventBus.triggerSaveError(f,c,b);var a=b&&b.fields&&b.fields.length;if(!a&&b){this.editIssueController.reset();this.model.update(b,{fieldsSaved:[],fieldsInProgress:[]})}this.trigger("saveError",{issueId:f,duration:e,deferred:false});JIRA.trace("jira.issue.refreshed",{id:f})});this.listenTo(this.issueSaver,"saveStarted",function(a,b){this.eventBus.triggerSavingStarted(b)});this.listenTo(this.issueSaver,"save",function(i){var g=i.issueId;var c=i.issueKey;var f=i.savedFieldIds;var e=i.response;var h=i.shouldSkipSaveIssueSuccessHandler;var d=i.duration;if(this.model.isCurrentIssue(g)&&!h){this.eventBus.triggerSaveSuccess(g,c,f,e);this.viewIssueData.set(c,e);var a=this.editIssueController.getEditsInProgress();this.model.update(e,{fieldsSaved:f,fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.trace("jira.psycho.issue.refreshed",{id:g});var b=e.fields&&e.fields.length;if(b){this.editIssueController.update({fields:e.fields,issueId:g,issueKey:c},{editable:true,editIssueController:this.editIssueController,issueModel:this.model,issueId:g,fieldsSaved:f,initialize:false,fieldsInProgress:this.editIssueController.getEditsInProgress()})}JIRA.trace("jira.issue.refreshed",{id:g})}this.trigger("saveSuccess",{issueId:g,issueKey:c,savedFieldIds:f,duration:d})})},_buildEditIssueController:function(){this.editIssueController=new JIRA.Components.IssueEditor.Controllers.EditIssue({issueEventBus:this.eventBus});this.listenTo(this.editIssueController,"save",function(e,a,c,d,b){this.issueSaver.setSkipSaveIssueSuccessHandler(false);this.issueSaver.save(e,a,c,d,b)});this.listenAndRethrow(this.editIssueController,"editField")},_buildFieldsController:function(){this.fieldsController=new JIRA.Components.IssueEditor.Controllers.Fields()},_onIssueLoaded:function(d,e,b){if(d.issue.isEditable){var c=!JIRA.Components.IssueViewer.Services.DarkFeatures.NO_PREFETCH.enabled();if(c&&!e.error&&!e.fromCache){this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:b.issueEntity})}}var a=!e.mergeIntoCurrent&&b.initialize!==false;if(!e.isUpdate||a){this.editIssueController.reset()}JIRA.Components.IssueViewer.prototype._onIssueLoaded.call(this,d,e,b);if(d.fields){this.editIssueController.update({fields:d.fields,issueId:d.issue.id,issueKey:d.issue.key});JIRA.trace("jira.issue.fields.loaded",{id:d.issue.id})}},_handleUnload:function(){var a=_.bind(function(){var b;if(this.editIssueController.getDirtyEditsInProgress().length>0){b="You are still editing this page. Are you sure you want to leave?"}return b},this);this.unloadInterceptor=new JIRA.Components.IssueEditor.Services.UnloadInterceptor();this.unloadInterceptor.addAfterEvent(a);this.on("destroy",function(){this.unloadInterceptor.removeAfterEvent(a)})},_updateModel:function(c,a){var b=c.fields&&c.fields.length;if(b){this.editIssueController.update(c.fields,{fieldsInProgress:this.editIssueController.getEditsInProgress(),changed:a.changed})}a=_.extend({},a,{fieldsInProgress:this.editIssueController.getEditsInProgress()});JIRA.Components.IssueViewer.prototype._updateModel.call(this,c,a)},_loadIssueFromDom:function(a){if(AJS.Meta.get("server-view-issue-is-editable")){this.editIssueController.setIssueId(a.id);this.editIssueController.setIssueKey(a.key);this.fieldsLoader.load({viewIssueData:this.viewIssueData,issueEntity:a});AJS.Meta.set("server-view-issue-is-editable",null)}JIRA.Components.IssueViewer.prototype._loadIssueFromDom.call(this,a)},editField:function(c){if(!c.isEditable()){return}var a=this.model.getEntity();var b=_.bind(function(){if(c.matchesFieldSelector()){c.edit()}else{new JIRA.Components.IssueEditor.Views.ModalFieldView({issueEventBus:this.eventBus,model:c,issue:a}).show()}},this);if(!c.getSaving()){b()}else{JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){b()})}},abortPending:function(){this.fieldsLoader.cancel();JIRA.Components.IssueViewer.prototype.abortPending.call(this)},beforeHide:function(){this.issueSaver.setSkipSaveIssueSuccessHandler(true);JIRA.Components.IssueViewer.prototype.beforeHide.call(this)},setContainer:function(a){this.editIssueController.setIssueViewContext(a);JIRA.Components.IssueViewer.prototype.setContainer.call(this,a)},dismiss:function(){this.editIssueController.reset();JIRA.Components.IssueViewer.prototype.dismiss.call(this)},getFields:function(){return this.editIssueController.getFields()},hasSavesInProgress:function(){return this.saveInProgressManager.hasSavesInProgress()},_showSaveError:function(b){var c,a;c=new JIRA.Components.IssueEditor.Views.SaveError(b).render();a=_.partial(this.stopListening,c);this.listenTo(c,{close:a,issueLinkClick:this.loadIssue})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/IssueEditorAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.AppModule");JIRA.Components.IssueEditor.AppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",generateMasterRequest:true,create:function(a){a=_.defaults({},a,{showReturnToSearchOnError:function(){return false}});return new JIRA.Components.IssueEditor({showReturnToSearchOnError:a.showReturnToSearchOnError})},commands:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.commands.call(this,a);return _.extend(b,{editField:true})},requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return a.getFields()},hasSavesInProgress:true})},events:function(b){var a=JIRA.Components.IssueViewer.AppModule.prototype.events.call(this,b);return a.concat(["saveSuccess","saveError","editField","fieldSubmitted"])}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/NoInlineAppModule.js' */
AJS.namespace("JIRA.Components.IssueEditor.NoInlineAppModule");JIRA.Components.IssueEditor.NoInlineAppModule=JIRA.Components.IssueViewer.AppModule.extend({name:"issueEditor",requests:function(a){var b=JIRA.Components.IssueViewer.AppModule.prototype.requests.call(this,a);return _.extend(b,{fields:function(){return[]},hasSavesInProgress:function(){return false}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/templates/Fields.soy' */
// This file was automatically generated from Fields.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueEditor == 'undefined') { JIRA.Templates.IssueEditor = {}; }
if (typeof JIRA.Templates.IssueEditor.Fields == 'undefined') { JIRA.Templates.IssueEditor.Fields = {}; }


JIRA.Templates.IssueEditor.Fields.saveErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var issueLink__soy3 = new soy.StringBuilder('<a class="issue" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '">', soy.$$escapeHtml(opt_data.issueKey), '</a>');
  issueLink__soy3 = issueLink__soy3.toString();
  output.append(AJS.format("Saving of \x3cstrong\x3e{0}\x3c/strong\x3e failed!",issueLink__soy3));
  if (opt_data.errors.length > 0) {
    output.append('<ul>');
    var messageList16 = opt_data.errors;
    var messageListLen16 = messageList16.length;
    for (var messageIndex16 = 0; messageIndex16 < messageListLen16; messageIndex16++) {
      var messageData16 = messageList16[messageIndex16];
      output.append('<li>', soy.$$escapeHtml(messageData16), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="', soy.$$escapeHtml(opt_data.issue.id), '-form" class="ajs-dirty-warning-exempt aui" action= "#"><div class="inline-edit-fields">', opt_data.issue.editHtml, '</div><span class="overlay-icon throbber" /><div class="save-options"><button type="submit" class="aui-button submit" accessKey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-success">', soy.$$escapeHtml("Save"), '</span></button><button type="cancel" class="aui-button cancel" accessKey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.accessKey)), '"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Cancel"), '</span></button></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><h2 class="dialog-title">', soy.$$escapeHtml(AJS.format("Edit {0} for {1}",opt_data.field.label,opt_data.issue.key)), '</h2><form action="" class="aui" method="post"><div class="form-body">', opt_data.field.editHtml, '</div><div class="buttons-container form-footer"><div class="buttons"><input class="button" type="submit" value="', soy.$$escapeHtml("Submit"), '"/><a class="cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error">');
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else if (opt_data.messages.length > 0) {
    output.append('<ul>');
    var messageList59 = opt_data.messages;
    var messageListLen59 = messageList59.length;
    for (var messageIndex59 = 0; messageIndex59 < messageListLen59; messageIndex59++) {
      var messageData59 = messageList59[messageIndex59];
      output.append('<li>', soy.$$escapeHtml(messageData59), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueEditor.Fields.errorsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isTimeout) ? soy.$$escapeHtml("The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.") : soy.$$escapeHtml("There were errors loading the issue."));
  if (opt_data.errorMessages) {
    output.append('<ul>');
    var msgList75 = opt_data.errorMessages;
    var msgListLen75 = msgList75.length;
    for (var msgIndex75 = 0; msgIndex75 < msgListLen75; msgIndex75++) {
      var msgData75 = msgList75[msgIndex75];
      output.append('<li>', soy.$$escapeHtml(msgData75), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldModel.js' */
AJS.namespace("JIRA.Components.IssueEditor.Models.Field");JIRA.Components.IssueEditor.Models.Field=JIRA.Issues.Brace.Model.extend({namedEvents:["editingStarted","focusRequested","editingCancelled","save","saveError","savingStarted","saveComplete","saveSuccess","updateRequired","validationError","modelDestroyed"],namedAttributes:["id","initParams","params","editHtml","viewHtml","required","fieldType","editing","saving","error","label","contentId"],initialize:function(){if(this.collection){var a=this;this.collection.on("reset",function(){a.triggerModelDestroyed()})}this.on("change:viewHtml",function(){var b=this.previous("viewHtml");if(b){jQuery.cleanData(b)}});this.onModelDestroyed(function(){var b=this.getViewHtml();if(b){jQuery.cleanData(b)}})},blurEdit:function(){if(this.getEditing()){if(this.isDirty()||this.hasValidationError()){this.save()}else{this.cancelEdit()}}},setValidationError:function(c,b,a){this.setSaving(false);this.setError(b);this.edit({ignoreBlur:true});this.triggerSaveError();this.triggerValidationError(c,a)},handleSaveError:function(){this.setSaving(false);this.triggerSaveError()},cancelEdit:function(b){if(!this.cancelLocked){var a=new AJS.$.Event(JIRA.Events.BEFORE_INLINE_EDIT_CANCEL);JIRA.trigger(a,[this.getId(),this.getFieldType(),b]);if(!a.isDefaultPrevented()){this.cancelLocked=true;if(this.getEditing()||this.getSaving()){this.setEditing(false);this.setSaving(false);this.unset("params");this.unset("initParams");this.triggerEditingCancelled();this.unset("viewHtml")}delete this.cancelLocked}}},edit:function(a){if(!this.getEditing()){this.setEditing(true);this.triggerEditingStarted(this,a)}else{if(!a||!a.ignoreBlur){this.triggerFocusRequested(this,a)}}},getCurrentParams:function(){this.triggerUpdateRequired();var c={};if(this.getParams()){c=this.getParams()}else{if(this.getInitParams()){c=this.getInitParams()}else{var b=AJS.$("<div />").html(this.getEditHtml());this.setInitParams(this._serializeObject(b));c=this.getInitParams()}}var a={};_.each(c,function(e,d){a[d]=e});return a},isEditable:function(){if(this.getEditHtml()){return AJS.$(this.getEditHtml()).find("textarea, :text,:radio,:checkbox, select").length!==0}return false},hasValidationError:function(){return !!this.getError()},switchElToEdit:function(a){if(!this.getViewHtml()){this.setViewHtml(a.contents())}a.contents().detach();a.html(JIRA.Templates.IssueEditor.Fields.field({issue:this.toJSON(),accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));if(!this.getInitParams()){this.setInitParams(this._serializeObject(a))}this.setEditing(true)},update:function(a){if(this.getEditing()){this.setParams(this._serializeObject(a))}},handleSaveSuccess:function(){this.setSaving(false);this.setEditing(false);this.unset("viewHtml");this.unset("initParams");this.setError(null);this.triggerSaveSuccess()},handleSaveStarted:function(){this.setSaving(true);this.triggerSavingStarted()},save:function(){if(!this.getSaving()){this.triggerUpdateRequired();this.triggerSave(this)}},isDirty:function(){this.triggerUpdateRequired();return this._isDirty(this.getCurrentParams())},_isDirty:function(a){return JSON.stringify(a)!==JSON.stringify(this.getInitParams())},matchesFieldSelector:function(){return JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.matchesFieldSelector(this.id)},_serializeObject:function(b){var c={};var a=AJS.$(b).find(":input").serializeArray();jQuery.each(a,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c}},{IS_EDITABLE:function(a){return a.isEditable()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/entities/FieldCollection.js' */
AJS.namespace("JIRA.Components.IssueEditor.Collections.Fields");JIRA.Components.IssueEditor.Collections.Fields=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.IssueEditor.Models.Field,initialize:function(){this.on("editingStarted",this._handleEditingStarted,this)},_handleEditingStarted:function(b,a){a=a||{};if(a.ignoreBlur){return}this.each(function(c){if(b!==c&&c.getEditing()){c.blurEdit()}})},update:function(e,c){var a=this;if(c&&c.changed){var b=c.changed;var f=b.updated?b.updated.fields:[];var d=b.added?b.added.fields:[];_.each(e,function(h){if(_.contains(f,h.id)){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}}else{if(_.contains(d,h.id)){a.add(h)}}})}else{_.each(e,function(h){var g=a.get(h.id);if(g){if(g.hasValidationError()){delete h.editHtml}g.set(h,{silent:true});a.trigger("updated",g)}else{a.add(h)}})}},cancelEdit:function(){this.each(function(a){a.cancelEdit()})},isDirty:function(){return this.any(function(a){return a.isDirty()})},getDirtyFields:function(){return this.filter(function(a){return a.isDirty()})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/FieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.FieldView");JIRA.Components.IssueEditor.Views.FieldView=JIRA.Marionette.ItemView.extend({events:{"click .cancel":"onClickCancel",keyup:"onKeyCancel","click .submit":"onSubmit",click:"onEdit",mousedown:"saveSelectedText","submit form":"onSubmit",'keydown select[multiple="multiple"]':"_enterToSubmitMultiSelect","keypress select":"_enterToSubmitSelect","beforeBlurInput *":"_preventBlurByEsc"},initialize:function(b){this.model.on("validationError",this.handleValidationError,this);this.model.on("editingStarted",this.switchToEdit,this);this.model.on("focusRequested",this.focus,this);this.model.on("editingCancelled",this.switchToRead,this);this.model.on("saveError",this.handleSaveError,this);this.model.on("updateRequired",this.updateModel,this);this.model.on("savingStarted",this.handleSavingStarted,this);this.model.on("modelDestroyed",this.destroy,this);this.decorate();this.issueEventBus=b.issueEventBus;this.issueEventBus.on("panelRendered",this.handlePanelRendered,this);this.model.setFieldType(this.$el.data("fieldtypecompletekey"));this._editDelay=0;var a=this;JIRA.bind(JIRA.Events.INLINE_EDIT_BLURRED,function(d,c){if(c===a.model.getId()){a._onPossibleBlur()}});JIRA.bind(JIRA.Events.INLINE_EDIT_REQUESTED,function(d,c){if(c!==a.model.getId()&&a._editDelay!==0){clearTimeout(a._editDelay);a._editDelay=0}})},destroy:function(){this.issueEventBus.off("panelRendered",this.handlePanelRendered)},decorate:function(){if(this.model.isEditable()&&!this.model.getEditing()){this.$el.addClass("editable-field inactive");this.$el.append('<span class="overlay-icon aui-icon aui-icon-small aui-iconfont-edit" />');this._addToolTip()}},getEditElements:function(){return this.$el.find(".inline-edit-fields")},_addToolTip:function(){this.$el.attr("title","Click to edit");jQuery("a:not([title])",this.$el).attr("title","Follow link")},_removeToolTip:function(){this.$el.removeAttr("title")},_stealAccessKeys:function(){jQuery("[accessKey='"+"s"+"']").attr("accessKey","_s");jQuery("[accessKey='"+"`"+"']").attr("accessKey","_x")},_returnAccessKeys:function(){jQuery("[accessKey=_s]").attr("accessKey","s");jQuery("[accessKey=_x]").attr("accessKey","`")},_handleEditingStarted:function(a){var b=this.$el.find(".field-tools");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.inlineEditStarted]);JIRA.trigger(JIRA.Events.INLINE_EDIT_STARTED,[this.model.getId(),this.model.getFieldType(),this.getEditElements(),this.$el]);this.$el.find(".textarea").css("height",Math.max(this._originalHeight,60)).expandOnInput(window.innerHeight-jQuery("#stalker").height()-100);if(a){this.$el.find(":input:visible:first").focus()}if(!this.$el.find(".error").size()){this.$el.find("select.aui-ss-select").each(function(){var c=jQuery(this);if(c.data("static-suggestions")){c.trigger("showSuggestions")}})}this.$el.find(".save-options").attr("tabindex",1).prepend(b)},handleValidationError:function(b,a){this.$el.html(JIRA.Templates.IssueEditor.Fields.field({issue:{id:this.model.id,editHtml:b},accessKey:JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getAccessKeyModifier()}));this.$el.find(".error").addClass("inline-edit-error").attr("data-field",this.model.id);this._handleEditingStarted(a)},handlePanelRendered:function(a,b){var c=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(this.model.id),b);if(c.length===1){this.$el=c;this.el=this.$el[0];this.decorate();this.delegateEvents()}},handleSaveError:function(){this.$el.find(":input").removeAttr("disabled").trigger("enable");this.$el.removeClass("saving saving-"+this.model.id)},handleSavingStarted:function(){this.$el.find(":input").attr("disabled","disabled").trigger("disable");this.$el.addClass("saving saving-"+this.model.id)},updateModel:function(){this.model.update(this.$el)},reveal:function(){var a=40;this.$el.scrollIntoView({direction:"y",marginBottom:a,marginTop:AJS.$("#stalker").outerHeight(true)+a});this.$el.trigger("reveal")},focus:function(){this.reveal();this.$el.find(":input").removeAttr("disabled");if(jQuery(".aui-blanket").length===0){var a=this.$el.find(":input:visible:first");a.focus();if(!this.$el.hasClass("field-ignore-highlight")){a.select()}}},switchToEdit:function(){this.trigger("editField",{fieldId:this.model.getId()});this._stealAccessKeys();this._removeToolTip();this.$el.removeClass("inactive saving").addClass("active");this._originalHeight=this.$el.height();this.model.switchElToEdit(this.$el);this._handleEditingStarted();this.focus()},switchToRead:function(){this._addToolTip();this.$el.addClass("inactive").removeClass("active");this.$el.html(this.model.getViewHtml());this.$el.closest("form").unbind("submit",this.onSubmit);this._returnAccessKeys()},onKeyCancel:function(a){if(a.keyCode===27){this.model.cancelEdit(JIRA.Issues.CANCEL_REASON.escPressed);a.preventDefault()}},onClickCancel:function(a){this.model.cancelEdit();a.preventDefault()},onSubmit:function(b){var a=new jQuery.Event("before-submit");this.$el.find("form").trigger(a);if(!a.isDefaultPrevented()){this.$el.find(":focus").blur();this.issueEventBus.triggerFieldSubmitted();this.model.save();this._returnAccessKeys()}b.preventDefault()},onEdit:function(f){var e=AJS.$(f.target).is(".overlay-icon.aui-iconfont-edit");var c=AJS.$(f.target).closest("a, .uneditable").length===0&&this.$el.hasClass("inactive");var d=this._getCurrentlySelectedText()===""&&!this._previouslySelectedText;var b=c&&(e||d);if(this._editDelay!==0){clearTimeout(this._editDelay);this._editDelay=0}else{if(b){JIRA.trigger(JIRA.Events.INLINE_EDIT_REQUESTED,[this.model.getId()]);var a=this;if(e){jQuery(document).one("click",function(g){if(!g.isDefaultPrevented()){a.model.edit()}})}else{this._editDelay=setTimeout(function(){if(!f.isDefaultPrevented()&&a.$el.hasClass("inactive")&&a._getCurrentlySelectedText()===""){a.model.edit()}a._editDelay=0},250)}}}},_onPossibleBlur:function(){if(this.model.getSaving()){return}if(jQuery(".aui-blanket").length>0){return}this.model.blurEdit()},_preventBlurByEsc:function(a){a.preventDefault()},_getCurrentlySelectedText:function(){if(jQuery(document.activeElement).is(":input")){return""}if(document.selection&&document.selection.createRange){return document.selection.createRange().text||""}if(window.getSelection){return window.getSelection().toString()}return""},_enterToSubmitSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){a.preventDefault();jQuery(a.target).closest("form").submit()}}},_enterToSubmitMultiSelect:function(a){if(!a.isDefaultPrevented()){if(a.which===13){jQuery(a.target).blur()}}},saveSelectedText:function(){this._previouslySelectedText=this._getCurrentlySelectedText()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/ModalFieldView.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.ModalFieldView");JIRA.Components.IssueEditor.Views.ModalFieldView=JIRA.Marionette.ItemView.extend({errorsTemplate:JIRA.Templates.IssueEditor.Fields.modalFieldGeneralErrors,template:JIRA.Templates.IssueEditor.Fields.modalField,initialize:function(a){_.bindAll(this,"_onHide","_onSubmit","_remove","_showGeneralError","_showValidationError","_updateModel");JIRA.bind("Dialog.hide",this._onHide);this.issueEventBus=a.issueEventBus;this.issueEventBus.on("saveError",this._showGeneralError);this.model.onSaveSuccess(this._remove);this.model.onUpdateRequired(this._updateModel);this.model.onValidationError(this._showValidationError)},_enable:function(){var b=this._getDialog();b.hideFooterLoadingIndicator();var a=b.$popup;a.find(":input").removeAttr("disabled").trigger("enable");a.find(":input:first").focus().select();a.find(":submit").removeAttr("disabled")},_getDialog:function(){if(!this._dialog){this._dialog=new JIRA.FormDialog({id:"modal-field-view",submitHandler:this._onSubmit,content:_.bind(function(a){a(this.template({field:this.model.toJSON(),issue:this.options.issue}))},this)});this._dialog.get$popup().data("field-id",this.model.getId())}return this._dialog},_onHide:function(a,b){if(b===this._getDialog().get$popup()){this._remove()}},_onSubmit:function(c,b){c.preventDefault();this.model.save();b();var a=this._getDialog();a.showFooterLoadingIndicator();a.$popup.find(":input").attr("disabled","disabled").trigger("disable")},close:function(){this._remove()},_remove:function(b){var a=this._getDialog();if(a.get$popup().is(":visible")){a.hide()}a.destroy();this.model.cancelEdit();JIRA.unbind("Dialog.hide",this._onHide);this.issueEventBus.off("saveError",this._showGeneralError);this.model.off("saveSuccess",this._remove);this.model.off("updateRequired",this._updateModel);this.model.off("validationError",this._showValidationError)},show:function(){this.model.edit();this._getDialog().show()},_showGeneralError:function(f,b,a){this._enable();var d=this._getDialog().$popup;var g=a&&a.errorCollection;if(g){var c=!_.isEmpty(g.errors),e=!_.isEmpty(g.errorMessages);if(!c&&e){d.find(".form-body").append(this.errorsTemplate({messages:g.errorMessages}))}}},_showValidationError:function(a){this._enable();this._getDialog().$popup.find(".form-body").html(a)},_updateModel:function(){this.model.update(this._getDialog().$popup)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/LoadingError.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.LoadingError");JIRA.Components.IssueEditor.Views.LoadingError=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueEditor.Fields.errorsLoading,initialize:function(b,a){this.errorMessages=b;this.isTimeout=a},serializeData:function(){return{errorMessages:this.errorMessages,isTimeout:this.isTimeout}},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/views/SaveError.js' */
AJS.namespace("JIRA.Components.IssueEditor.Views.SaveError");JIRA.Components.IssueEditor.Views.SaveError=JIRA.Marionette.ItemView.extend({events:{"simpleClick .issue":"onIssueLinkClick"},template:JIRA.Templates.IssueEditor.Fields.saveErrorMessage,getErrorMessages:function(){var a,b=[];a=this.options.response.errorCollection;a&&(b=a.errorMessages.concat(_.values(a.errors)));return b},onIssueLinkClick:function(b){var a;a={id:this.options.issueId,key:this.options.issueKey};b.preventDefault();this.trigger("issueLinkClick",a);this.close()},onRender:function(){this.setElement(JIRA.Messages.showErrorMsg(this.$el.html(),{closeable:true,timeout:0}))},serializeData:function(){return{errors:this.getErrorMessages(),issueKey:this.options.issueKey}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/EditIssueController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.EditIssue");JIRA.Components.IssueEditor.Controllers.EditIssue=JIRA.Issues.Brace.Model.extend({namedAttributes:["issueId","issueKey","issueViewContext","fields","issueEventBus"],namedEvents:["save","editField"],initialize:function(){_.bindAll(this,"_handleSaveError","_handleSaveSuccess","_handleSavingStarted","cancelUneditedFields","createFieldView","handleFieldUpdate","save");this.set({fields:new JIRA.Components.IssueEditor.Collections.Fields()},{silent:true});this.getFields().bind("add",this.createFieldView).bind("updated",this.handleFieldUpdate).bind("save",this.save);this.getIssueEventBus().onSavingStarted(this._handleSavingStarted);this.getIssueEventBus().onSaveSuccess(this._handleSaveSuccess);this.getIssueEventBus().onSaveError(this._handleSaveError);this.getIssueEventBus().onSave(this.save);this.getIssueEventBus().onSave(this.cancelUneditedFields)},_saveById:function(b){var a=this.getFields().get(b);if(a){a.blurEdit()}},_handleSaveError:function(d,c,b){var a=this;if(b){this.applyErrors(b)}else{_.each(c,function(f){var e=a.getFields().get(f);if(e){e.handleSaveError()}})}},_handleSavingStarted:function(a){this.getFields().each(function(b){if(_.include(a,b.id)){b.handleSaveStarted()}})},handleFieldUpdate:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id));if(!a.hasClass("editable-field")){this.createFieldView(b)}},applyErrors:function(d,c){var a=d.errorCollection;if(a&&a.errors){this.getFields().each(function(e){if(a.errors[e.id]){var f=_.find(d.fields,function(g){return g.id==e.id});if(f){e.setValidationError(f.editHtml,a.errors[e.id],c);c=false}}})}if(a.errorMessages&&a.errorMessages.length){var b=JIRA.Templates.IssueEditor.Fields.saveErrorMessage({errors:a.errorMessages,issueKey:this.getIssueKey()});JIRA.Messages.showErrorMsg(b,{closeable:true})}},reset:function(){this.getFields().reset()},cancelEdit:function(){this.getFields().each(function(a){a.cancelEdit()})},_handleSaveSuccess:function(c,a,d){var b=this.getFields().filter(function(e){return _.indexOf(d,e.id)>=0});_.each(b,function(e){e.handleSaveSuccess()})},getDirtyEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()&&a.isDirty()}),"id")},getEditsInProgress:function(){return _.pluck(this.getFields().filter(function(a){return a.getEditing()}),"id")},save:function(b,a){var e={},d=[];var c=[b];if(!b){c=this.getFields().filter(function(f){return !f.getSaving()&&f.getEditing()&&f.isDirty()})}else{if(!b.getEditing()||b.getSaving()){return}}_.each(c,function(f){d.push(f.getId());_.extend(e,f.getCurrentParams())});if(d.length>0){this.triggerSave(this.getIssueId(),this.getIssueKey(),d,e,a)}},cancelUneditedFields:function(){this.getFields().each(function(a){if(a.getEditing()&&!a.isDirty()&&!a.hasValidationError()){a.cancelEdit()}})},update:function(b,a){if(b.fields){if(a&&a.fieldsInProgress){_.each(b.fields,function(c){if(_.contains(a.fieldsInProgress,c.id)){c.editing=true}})}this.getFields().update(b.fields,a)}if(b.issueId){this.setIssueId(b.issueId)}if(b.issueKey){this.setIssueKey(b.issueKey)}},createFieldView:function(b){var a=jQuery(JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.getFieldSelector(b.id),this.getIssueViewContext());if(a.length===1){var c=new JIRA.Components.IssueEditor.Views.FieldView({model:b,el:a,issueEventBus:this.getIssueEventBus()});c.on("editField",_.bind(function(d){this.trigger("editField",d)},this))}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/controllers/FieldsController.js' */
AJS.namespace("JIRA.Components.IssueEditor.Controllers.Fields");JIRA.Components.IssueEditor.Controllers.Fields=JIRA.Marionette.Controller.extend({showError:function(b,a){if(b||a){var c=b.errorMessages||[];this.close();this.triggerMethod("before:render");this.view=new JIRA.Components.IssueEditor.Views.LoadingError(b,a);this.view.render();this.listenTo(this.view,"close",this.close);this.triggerMethod("render")}},close:function(){if(this.view){this.view.close();this.stopListening(this.view);delete this.view}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/FieldsLoaderService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.FieldsLoader");JIRA.Components.IssueEditor.Services.FieldsLoader=JIRA.Marionette.Controller.extend({initialize:function(a){this.recurringPromise=jQuery.RecurringPromise().sub();this.recurringPromise.done(_.bind(function(b){this.trigger("fieldsLoaded",b)},this)).fail(_.bind(function(b){this.trigger("fieldsError",b)},this));this.contextPath=a.contextPath},load:function(b){var a=this._buildUpdateTask(b);this.recurringPromise.add(a)},cancel:function(){this.recurringPromise.reset()},_getFieldsData:function(d,a){var c=jQuery.ajax({url:this.contextPath+"/secure/AjaxIssueEditAction!default.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},data:{issueId:d}});var b=c.pipe(function(e){var f=JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);return{issueId:d,issueKey:a,fields:f.fields}},function(j){var g={};var h;switch(j.status){case 400:h=false;try{var f=JSON.parse(j.responseText)||{};g=f.errorCollection}catch(i){}break;case 401:h=false;g=null;break;default:h=true;g={};break}return{issueId:d,fields:null,errorCollection:g,isTimeout:"timeout"===j.statusText,fatalError:h}});b.abort=function(){c.abort.apply(c,arguments)};return b},_buildUpdateTask:function(c){var e=c.viewIssueData;var a=c.issueEntity;var d=c.lastEditData;var b=jQuery.Deferred();e.setPending(a.id,this._getFieldsData(a.id,a.key),function(f){b.resolve(f)},function(f){if(f.fatalError){b.reject(f)}else{b.resolve(f)}});return b.promise()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/IssueSaverService.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.IssueSaver");JIRA.Components.IssueEditor.Services.IssueSaver=JIRA.Marionette.Controller.extend({initialize:function(a){this.saveInProgressManager=a.saveInProgressManager;this.model=a.model;this._saveStarted=[];this.saveInProgressManager.onSavingStarted(_.bind(function(b,c){this._saveStarted.push((new Date()).getTime());this.trigger("saveStarted",b,c)},this));this.saveInProgressManager.onSaveSuccess(_.bind(function(d,b,e,c){if(c&&c.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c)}this.trigger("save",{issueId:d,issueKey:b,savedFieldIds:e,response:c,shouldSkipSaveIssueSuccessHandler:this._shouldSkipSaveIssueSuccessHandler,duration:(new Date()).getTime()-this._saveStarted.shift()})},this));this.saveInProgressManager.onSaveError(_.bind(function(e,b,d,c){if(c&&c.fields){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c)}this.trigger("error",{issueId:e,issueKey:b,attemptedSavedIds:d,response:c,duration:(new Date()).getTime()-this._saveStarted.shift()})},this))},setSkipSaveIssueSuccessHandler:function(a){this._shouldSkipSaveIssueSuccessHandler=a},save:function(e,a,c,d,b){this.saveInProgressManager.saveIssue(e,a,c,d,b)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/SaveInProgressManager.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.SaveInProgressManager");JIRA.Components.IssueEditor.Services.SaveInProgressManager=JIRA.Issues.Brace.Model.extend({namedAttributes:["savesInProgress"],namedEvents:["beforeSaving","savingStarted","saveSuccess","saveError"],initialize:function(){this.setSavesInProgress([])},saveIssue:function(g,b,d,c,h){this.triggerBeforeSaving();var i=this,a,e;e=_.extend(c,{issueId:g,atl_token:atl_token(),singleFieldEdit:true,fieldsToForcePresent:d});var f=_.extend({type:"POST",url:contextPath+"/secure/AjaxIssueAction.jspa?decorator=none",headers:{"X-SITEMESH-OFF":true},error:function(j){i._handleSaveError(g,b,d,j)},success:function(n,l,m,j){var k=j.data;if(typeof k=="string"){i._handleHtmlResponse(g,b,d,k)}else{JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(k);i.triggerSaveSuccess(g,b,d,k)}},complete:function(){i.removeSaveInProgress(a);JIRA.trigger(JIRA.Events.INLINE_EDIT_SAVE_COMPLETE)},data:e},h);a=JIRA.SmartAjax.makeRequest(f);this.addSaveInProgress(a);this.triggerSavingStarted(g,d,c)},hasSavesInProgress:function(){return this.getSavesInProgress().length>0},removeSaveInProgress:function(a){this.setSavesInProgress(_.without(this.getSavesInProgress(),a))},addSaveInProgress:function(a){var b=this.getSavesInProgress();b.push(a);this.setSavesInProgress(b)},_handleHtmlResponse:function(h,b,c,e){var a=this;var g=AJS.$(AJS.extractBodyFromResponse(e));var f=g.find("#atl_token").val();if(f){AJS.$("#atlassian-token").attr("content",f)}var d=new JIRA.FormDialog({offsetTarget:"body",content:g});this.triggerSaveError(h,b,c);d._handleServerSuccess=function(i){d.hide();var j=a._parseResponse(i);if(j){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(e);a.triggerSaveSuccess(h,b,c,j)}};d._handleServerError=function(j){d.hide();var i=a._parseResponse(j.responseText);if(i){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(i);a.triggerSaveError(h,b,c,i)}};d.show()},_handleSaveError:function(e,a,b,d){var c=this._parseResponse(d.responseText);if(c){JIRA.Components.IssueViewer.Legacy.IssueFieldUtil.transformFieldHtml(c);this.triggerSaveError(e,a,b,c)}},_parseResponse:function(a){try{return JSON.parse(a)}catch(b){this._showFatalErrorMessage();return null}},_showFatalErrorMessage:function(){var a="<p>"+"Communications Breakdown"+"</p><p>"+"Close this dialog and press refresh in your browser"+"</p>";JIRA.Messages.showErrorMsg(a,{closeable:true})}});JIRA.Events.INLINE_EDIT_SAVE_COMPLETE="inlineEditSaveComplete";
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/services/UnloadInterceptor.js' */
AJS.namespace("JIRA.Components.IssueEditor.Services.UnloadInterceptor");JIRA.Components.IssueEditor.Services.UnloadInterceptor=JIRA.Marionette.Controller.extend({initialize:function(){this._afterEventHandlers=[];this.originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=_.bind(this.onBeforeUnload,this)},addAfterEvent:function(a){this._afterEventHandlers.push(a)},removeAfterEvent:function(a){this._afterEventHandlers=_.without(this._afterEventHandlers,a)},onBeforeUnload:function(){var a,b=arguments;if(_.isFunction(this.originalBeforeUnload)){a=this.originalBeforeUnload.apply(window,b)}if(!a){a=_.reduce(this._afterEventHandlers,function(c,f,d,e){if(c){return c}return f.apply(window,b)},a)}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:issueeditor', location = 'issueeditor/js/InlineEditUtils.js' */
JIRA.Events.INLINE_EDIT_STARTED="inlineEditStarted";JIRA.Events.BEFORE_INLINE_EDIT_CANCEL="inlineEditCancelled";JIRA.Events.INLINE_EDIT_BLURRED="inlineEditBlurred";JIRA.Events.INLINE_EDIT_FOCUSED="inlineEditFocused";JIRA.Events.INLINE_EDIT_REQUESTED="inlineEditRequested";JIRA.Events.LOCK_PANEL_REFRESHING="lockPanelRefreshing";JIRA.Events.UNLOCK_PANEL_REFRESHING="unlockPanelRefreshing";JIRA.Events.REFRESH_ISSUE_PAGE="refreshIssuePage";JIRA.Issues.CANCEL_REASON={escPressed:"escPressed"};AJS.$(function(){AJS.namespace("JIRA.Components.IssueEditor.InlineEditUtils");JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT=50;var a=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggers={Default:function(e,i){i=i.nextAll(".save-options").andSelf();var h=":input, a[href], [tabindex]";var g;var f=b(i);var d={focus:function(){if(!f){f=true;JIRA.trigger(JIRA.Events.INLINE_EDIT_FOCUSED,[e])}},blur:function(){if(g){clearTimeout(g)}g=setTimeout(c,JIRA.Components.IssueEditor.InlineEditUtils.BLUR_FOCUS_TIMEOUT)}};i.attr("tabindex",1).bind(d).delegate(h,d);function c(){if(!b(i)){f=false;JIRA.trigger(JIRA.Events.INLINE_EDIT_BLURRED,[e])}}}};function b(d){var c=document.activeElement;return d.find(c).length>0||d.filter(c).length>0}JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping={system:{summary:a.Default,priority:a.Default,issuetype:a.Default,components:a.Default,versions:a.Default,fixVersions:a.Default,assignee:a.Default,reporter:a.Default,environment:a.Default,description:a.Default,labels:a.Default,duedate:a.Default},custom:{"com.atlassian.jira.plugin.system.customfieldtypes:cascadingselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:datetime":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:float":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:grouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:labels":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multigrouppicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiuserpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:project":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:select":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:url":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:userpicker":a.Default,"com.atlassian.jira.plugin.system.customfieldtypes:version":a.Default}};JIRA.bind(JIRA.Events.INLINE_EDIT_STARTED,function(h,d,c,i){var g;if(c){g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[c];if(!g){var f=c.replace(/.+:(.+)/,"$1");g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.custom[f]}}else{g=JIRA.Components.IssueEditor.InlineEditUtils.BlurTriggerMapping.system[d]}if(g){g(d,i)}})});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerTemplate.soy' */
// This file was automatically generated from PagerTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ViewIssue == 'undefined') { JIRA.Templates.ViewIssue = {}; }
if (typeof JIRA.Templates.ViewIssue.Header == 'undefined') { JIRA.Templates.ViewIssue.Header = {}; }


JIRA.Templates.ViewIssue.Header.pager = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="ajax ops page-navigation"><li class="previous">', (opt_data.previousIssue && opt_data.position != 1) ? '<a data-id="' + soy.$$escapeHtml(opt_data.previousIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" id="previous-issue" rel="' + soy.$$escapeHtml(opt_data.previousIssue.key) + '" title="' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'"><span class="icon icon-page-prev"><span>' + soy.$$escapeHtml("Previous Issue") + ' \'' + soy.$$escapeHtml(opt_data.previousIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-prev-deactivated" title="' + soy.$$escapeHtml("Not available - this is the first issue") + '"></span>' : '', '</li><li class="showing">', (opt_data.position && opt_data.resultCount) ? soy.$$escapeHtml(AJS.format("{0} of {1}",opt_data.position,opt_data.resultCount)) : '', '</li><li class="next">', (opt_data.nextIssue && opt_data.position != opt_data.resultCount) ? '<a data-id="' + soy.$$escapeHtml(opt_data.nextIssue.id) + '" data-key="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" id="next-issue" rel="' + soy.$$escapeHtml(opt_data.nextIssue.key) + '" title="' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'"><span class="icon icon-page-next"><span>' + soy.$$escapeHtml("Next Issue") + ' \'' + soy.$$escapeHtml(opt_data.nextIssue.key) + '\'</span></span></a>' : (opt_data.position && opt_data.resultCount) ? '<span class="icon icon-page-next-deactivated" title="' + soy.$$escapeHtml("Not available - this is the last issue") + '"></span>' : '', '</li>', (opt_data.hasSearchLink) ? '<li class="return"><a id="return-to-search" href="' + soy.$$escapeHtml("") + '/issues/" title="' + soy.$$escapeHtml("Return to search") + '">' + soy.$$escapeHtml("Return to search") + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/Pager.js' */
(function(b,a){b.namespace("JIRA.Components.Pager");a.Components.Pager=function(e){var d,c;this.initialize=function(){d=new a.Components.Pager.Model()};this.update=function(f){if(f){d.update(f)}else{d.clear()}};this.show=function(f,g){if(!c){c=new a.Components.Pager.Controller({model:d});c.on("goBack",e.goBack);c.on("nextItem",e.nextItem);c.on("previousItem",e.previousItem)}c.show(f,g)};this.close=function(){if(c){c.close()}c=null;d.clear()}}})(AJS,JIRA);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerModel.js' */
(function(a,b){b.define("JIRA.Components.Pager.Model",a.Issues.BaseModel.extend({properties:["nextIssue","previousIssue","position","resultCount","hasSearchLink"],update:function(c){c.hasSearchLink=!c.isSplitView;delete c.isSplitView;this.set(c)}}))})(JIRA,Backbone);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerView.js' */
(function(a,b,c){AJS.namespace("JIRA.Components.Pager.View");a.Components.Pager.View=a.Marionette.ItemView.extend({template:function(d){return _.isEmpty(d)?"":a.Templates.ViewIssue.Header.pager(d)},events:{"simpleClick #return-to-search":"_onReturnToSearchClick"},triggers:{"simpleClick #next-issue":"nextItem","simpleClick #previous-issue":"previousItem"},ui:{nextIssue:"#next-issue",previousIssue:"#previous-issue",returnToSearch:"#return-to-search"},modelEvents:{change:"render"},onRender:function(){if(AJS.activeShortcuts){AJS.activeShortcuts.j&&AJS.activeShortcuts.j._addShortcutTitle(this.$el.find(this.ui.nextIssue));AJS.activeShortcuts.k&&AJS.activeShortcuts.k._addShortcutTitle(this.$el.find(this.ui.previousIssue));AJS.activeShortcuts.u&&AJS.activeShortcuts.u._addShortcutTitle(this.$el.find(this.ui.returnToSearch))}},_onReturnToSearchClick:function(d){d.preventDefault();this.trigger("goBack");b("body").focus()}})})(JIRA,AJS.$,Backbone);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerController.js' */
(function(a,c,b){c.define("JIRA.Components.Pager.Controller",a.Marionette.Controller.extend({initialize:function(d){this.model=d.model},getView:function(d){if(!this.pagerView){this.pagerView=new a.Components.Pager.View({model:this.model,el:d});this.listenTo(this.pagerView,"close",this.destroyView);this.listenAndRethrow(this.pagerView,["goBack","nextItem","previousItem"])}else{if(d){this.pagerView.setElement(d)}}return this.pagerView},show:function(d){this.getView(d).render()},onClose:function(){this.pagerView.close()},destroyView:function(){delete this.pagerView}}))})(JIRA,Backbone,JIRA.Libs.Marionette);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:pager', location = 'content/js/modules/pager/PagerAppModule.js' */
(function(b,a){b.namespace("JIRA.Components.Pager.AppModule");a.Components.Pager.AppModule=function(c,e){var d=new a.Components.Pager({nextItem:function(){a.Issues.Api.nextIssue()},previousItem:function(){a.Issues.Api.prevIssue()},goBack:function(){e.execute("returnToSearch")}});e.addInitializer(function(){d.initialize();e.commands.setHandlers({"pager:update":d.update,"pager:render":d.show,"pager:close":d.close})})}})(AJS,JIRA);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/Application.js' */
AJS.namespace("JIRA.Issues.Application");JIRA.Issues.Application=new JIRA.Marionette.Application();JIRA.Issues.Application.addInitializer(function(){this.module("JIRA.Components.Pager",JIRA.Components.Pager.AppModule);if(AJS.Meta.get("is-inline-edit-enabled")!==false){this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.AppModule().definition)}else{this.module("JIRA.Components.IssueEditor",new JIRA.Components.IssueEditor.NoInlineAppModule().definition)}this.module("JIRA.Components.Analytics",new JIRA.Components.Analytics.AppModule().definition)});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/FocusShifterService.js' */
AJS.namespace("JIRA.Issues.FocusShifter");JIRA.Issues.FocusShifter.init=function(){return JIRA.Shifter.register(function(){var b;if(JIRA.Issues.Api.issueIsVisible&&!JIRA.Issues.Api.issueIsVisible()){b=[]}else{var a=JIRA.Issues.Api.getFieldsOnSelectedIssue();b=a?JIRA.Issues.FocusShifter.getSuggestions(a):[]}return{id:"edit-fields",name:"Edit Fields",context:JIRA.Issue.getIssueKey(),weight:100,getSuggestions:function(){return jQuery.Deferred().resolve(b)},onSelection:function(c){JIRA.Issues.Api.editFieldOnSelectedIssue(c)}}})};JIRA.Issues.FocusShifter.show=function(){JIRA.Shifter.show()};JIRA.Issues.FocusShifter.getSuggestions=function(a){return _.chain(a.models).filter(JIRA.Components.IssueEditor.Models.Field.IS_EDITABLE).filter(function(b){return b.id!=="comment"}).map(function(b){return{label:b.getLabel(),value:b.id}}).value()};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/js/viewissue/util/Overrides.js' */
JIRA.Messages.showMsgOnReload=function(b,a){JIRA.one(JIRA.Events.ISSUE_REFRESHED,function(){a.type=JIRA.Messages.Types[a.type];JIRA.Messages.showMsg(b,a)})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:viewissue', location = 'content/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.Util == 'undefined') { JIRA.Templates.Issues.Util = {}; }


JIRA.Templates.Issues.Util.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.Util.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable");JIRA.Components.IssueTable=JIRA.Marionette.Controller.extend({initialize:function(a){this.issueTableView=new JIRA.Issues.IssueTableView({columnConfig:a.columnConfig});this._createSearchService(a);this._createTableController(a);JIRA.Issues.Application.on("issueEditor:loadError",this._handleIssueLoadError,this)},_createSearchService:function(a){this.searchService=a.searchService;this.listenTo(this.searchService,{"before:search":function(){this.issueTableController.showPending()},search:function(c,b){this.latestResults={table:c,sortOptions:b.getSortBy(),totalDisplayableIssues:b.getDisplayableTotal(),startIndex:b.getStartIndex(),pageSize:b.getPageSize(),pageNumber:b.getPageNumber(),numberOfPages:b.getNumberOfPages(),totalIssues:b.getTotal(),currentSearch:JIRA.Issues.Application.request("issueNav:currentSearchRequest"),jiraHasIssues:b.getJiraHasIssues(),hasIssues:b.hasIssues()};this.show();this.highlightIssue(b.getHighlightedIssue().id,false)},"error:search":function(){this.issueTableController.showErrorMessage()},issueUpdated:function(c,b){this.issueTableController.updateIssue(c,b.table)},issueHighlighted:function(b){this.issueTableController.highlightIssue(b)},selectedIssueChanged:function(c,b){if(!c.hasIssue()){this.issueTableController.highlightIssue(b.id)}}})},_createTableController:function(b){var a=b.columnConfig;var c=b.el;this.issueTableController=new JIRA.Components.IssueTable.Controllers.IssueTable({el:c});this.listenTo(this.issueTableController,{goToPage:function(d){this.searchService.goToPage(d)},columnsChanged:function(d){a.saveColumns(d)},highlightIssue:function(d){this.trigger("highlightIssue",d)},sort:function(d){this.searchService.sort(d)},refresh:function(){this.searchService.runCurrentSearch()},renderTable:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed]);JIRA.trace("jira.search.stable.update")},renderEmpty:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRefreshed]);JIRA.trace("jira.search.stable.update")},issueRowUpdated:function(d){JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[d,JIRA.CONTENT_ADDED_REASON.issueTableRowRefreshed]);JIRA.trace("jira.search.finished")}})},show:function(){if(!this.latestResults){this.searchService.updateExitingResults()}else{this.issueTableController.show(this.latestResults);this.trigger("render");this.issueTableView._onSearchDone(this.issueTableController.view.$el)}},close:function(){this.issueTableController.close();this.stopListening(this.searchService);JIRA.Issues.Application.off("issueEditor:loadError",this._handleIssueLoadError,this);delete this.issueTableController;delete this.searchService},handleIssueInaccessible:function(a){this.issueTableController.markIssueAsInaccessible(a)},highlightIssue:function(b,a){this.issueTableController.highlightIssue(b,a)},_handleIssueLoadError:function(a){if(a.response.status===404){this.issueTableController.markIssueAsInaccessible(a.issueId)}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-results.soy' */
// This file was automatically generated from issuenav-results.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.resultsCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNav.resultsCountHelper({start: '<span class="results-count-start">' + soy.$$escapeHtml(opt_data.start) + '</span>', end: '<span class="results-count-end">' + soy.$$escapeHtml(opt_data.end) + '</span>', total: '<span class="results-count-total results-count-link">' + soy.$$escapeHtml(opt_data.total) + '</span>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.resultsCountHelper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="results-count aui-item"><span class="results-count-text">', AJS.format("{0}\x26ndash;{1} of {2}",opt_data.start,opt_data.end,opt_data.total), '</span>');
  JIRA.Templates.IssueNav.refreshResults(null, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.endOfStableMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p>', soy.$$escapeHtml("Too many search results to display. Refine your search criteria and try again."), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.refreshResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="refresh-table" title="', soy.$$escapeHtml("Refresh results"), '">', soy.$$escapeHtml("Refresh results"), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-pagination.soy' */
// This file was automatically generated from issuenav-pagination.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.pagination = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="pagination" data-displayable-total="', soy.$$escapeHtml(opt_data.displayableTotal), '">');
  var MAX_PAGES_DISPLAYED__soy6 = 5;
  var lastPage__soy7 = Math.floor((opt_data.displayableTotal - 1) / opt_data.pageSize);
  var pageNumber__soy8 = Math.floor(opt_data.startIndex / opt_data.pageSize);
  var urlFragment__soy9 = new soy.StringBuilder(soy.$$escapeHtml(""), '/', opt_data.searchQuery, '&startIndex=');
  urlFragment__soy9 = urlFragment__soy9.toString();
  var prevStartIndex__soy15 = opt_data.startIndex - opt_data.pageSize;
  output.append((prevStartIndex__soy15 >= 0) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(prevStartIndex__soy15) + '" data-start-index="' + soy.$$escapeHtml(prevStartIndex__soy15) + '" class="icon icon-previous" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8,lastPage__soy7 + 1)) + '"><span>&lt;&lt; ' + soy.$$escapeHtml("Previous") + '</span></a>' : '');
  JIRA.Templates.IssueNavTable.numberLinksLogicBranch({startPage: pageNumber__soy8 - Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), endPage: pageNumber__soy8 + Math.floor(MAX_PAGES_DISPLAYED__soy6 / 2), lastPage: lastPage__soy7, urlFragment: urlFragment__soy9, currentPage: pageNumber__soy8 + 1, maxPagesDisplayed: MAX_PAGES_DISPLAYED__soy6, pageSize: opt_data.pageSize, displayableTotal: opt_data.displayableTotal}, output);
  var nextStartIndex__soy37 = Math.min(opt_data.startIndex + opt_data.pageSize, opt_data.displayableTotal);
  output.append((nextStartIndex__soy37 < opt_data.displayableTotal) ? '<a href="' + soy.$$escapeHtml(urlFragment__soy9) + soy.$$escapeHtml(nextStartIndex__soy37) + '" data-start-index="' + soy.$$escapeHtml(nextStartIndex__soy37) + '" class="icon icon-next" title="' + soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",pageNumber__soy8 + 2,lastPage__soy7 + 1)) + '"><span>' + soy.$$escapeHtml("Next") + ' &gt;&gt;</span></a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinksLogicBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastPage < opt_data.maxPagesDisplayed) {
    JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.lastPage}), output);
  } else {
    if (opt_data.startPage < 0) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: 0, endPage: opt_data.endPage - opt_data.startPage}), output);
    } else if (opt_data.endPage > opt_data.lastPage) {
      JIRA.Templates.IssueNavTable.numberLinks(soy.$$augmentData(opt_data, {startPage: opt_data.startPage - (opt_data.endPage - opt_data.lastPage), endPage: opt_data.lastPage}), output);
    } else {
      JIRA.Templates.IssueNavTable.numberLinks(opt_data, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.numberLinks = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var size__soy72 = opt_data.endPage - opt_data.startPage + 1;
  if (size__soy72 > 1) {
    var iLimit75 = Math.round(size__soy72);
    for (var i75 = 0; i75 < iLimit75; i75++) {
      var pageIndex__soy76 = i75 + opt_data.startPage;
      var pageNumber__soy77 = pageIndex__soy76 + 1;
      var pageStartIndex__soy78 = pageIndex__soy76 * opt_data.pageSize;
      var pageEndIndex__soy79 = Math.min(pageStartIndex__soy78 + opt_data.pageSize, opt_data.displayableTotal);
      var pageBoundaries__soy80 = new soy.StringBuilder(soy.$$escapeHtml(AJS.format("Issues {0} - {1}",pageStartIndex__soy78 + 1,pageEndIndex__soy79)));
      pageBoundaries__soy80 = pageBoundaries__soy80.toString();
      output.append(' ', (pageNumber__soy77 == opt_data.currentPage) ? '<strong title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</strong>' : '<a href="' + soy.$$escapeHtml(opt_data.urlFragment) + soy.$$escapeHtml(pageStartIndex__soy78) + '" data-page="' + soy.$$escapeHtml(pageNumber__soy77) + '" data-start-index="' + soy.$$escapeHtml(pageStartIndex__soy78) + '" title="' + soy.$$escapeHtml(pageBoundaries__soy80) + '">' + soy.$$escapeHtml(pageNumber__soy77) + '</a>');
    }
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/templates/issuenav-table.soy' */
// This file was automatically generated from issuenav-table.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavTable == 'undefined') { JIRA.Templates.IssueNavTable = {}; }


JIRA.Templates.IssueNavTable.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="list-view"><div class="issue-table-info-bar"><div class="results-count"></div><div class="column-picker-trigger-container"></div></div><div class="issue-table-container"></div><div class="end-of-stable-message"></div><div class="aui-group count-pagination"><div class="aui-item results-count"></div><div class="aui-item pagination"></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-adbox jira-adbox-medium no-results ', soy.$$escapeHtml(opt_data.cssClass), '"><h3>', opt_data.message, '</h3>', (opt_data.hint) ? '<p class="no-results-hint">' + opt_data.hint + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.TopResultsCountBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-table-info-bar"><div class="results-count"></div><div class="column-picker-trigger-container"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.listOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list">');
  var groupList24 = opt_data.groups;
  var groupListLen24 = groupList24.length;
  for (var groupIndex24 = 0; groupIndex24 < groupListLen24; groupIndex24++) {
    var groupData24 = groupList24[groupIndex24];
    output.append((groupData24.label) ? '<h5>' + soy.$$escapeHtml(groupData24.label) + '</h5>' : '', '<ul ', (groupData24.id) ? 'id="' + soy.$$escapeHtml(groupData24.id) + '"' : '', ' class="aui-list-section', (groupIndex24 == 0) ? ' aui-first' : '', (groupIndex24 == groupListLen24 - 1) ? ' aui-last' : '', '">');
    var itemList44 = groupData24.items;
    var itemListLen44 = itemList44.length;
    for (var itemIndex44 = 0; itemIndex44 < itemListLen44; itemIndex44++) {
      var itemData44 = itemList44[itemIndex44];
      output.append('<li class="aui-list-item"><a class="aui-list-item-link" ', (itemData44.id) ? 'id="' + soy.$$escapeHtml(itemData44.id) + '"' : '', ' ', (itemData44.rel) ? 'rel="' + soy.$$escapeHtml(itemData44.rel) + '"' : '', ' href="', (! itemData44.relativeLink) ? soy.$$escapeHtml("") : '', soy.$$escapeHtml(itemData44.link), '" ', (itemData44.title) ? 'title="' + soy.$$escapeHtml(itemData44.title) + '"' : '', '>', soy.$$escapeHtml(itemData44.label), '</a></li>');
    }
    output.append('</ul>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.views = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.sections.issue && opt_data.sections.issue.length > 0) {
    output.append('<div class="issue-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.issue}, output);
    output.append('</div>');
  }
  if (opt_data.sections.filter && opt_data.sections.filter.length > 0) {
    output.append('<div class="filter-panel aui-dropdown2-section">');
    JIRA.Templates.IssueNavTable.listOptions({groups: opt_data.sections.filter}, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.tools = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.IssueNavTable.listOptions(opt_data, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavTable.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="issuerow inaccessible-issue" rel="', soy.$$escapeHtml(opt_data.issueID), '"><td class="nav" colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/EmptyResults.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.EmptyResults");JIRA.Components.IssueTable.Views.EmptyResults=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNavTable.noResults,serializeData:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.options.jiraHasIssues===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";this.linkType="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";this.linkType="create"}}return{message:d,hint:e,cssClass:b}},onRender:function(){this.$el.addClass("empty-results");var a=this.$(".no-results-hint a");if(!JIRA.Issues.LoginUtils.isLoggedIn()){a.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link")}else{a.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa")}this.hidePending()},showPending:function(){this.$el.addClass("pending")},hidePending:function(){this.$el.removeClass("pending")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/EndOfStableMessage.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.EndOfStableMessage");JIRA.Components.IssueNavigator.Views.EndOfStableMessage=JIRA.Marionette.ItemView.extend({className:"end-of-stable-message",serializeData:function(){return this.options},getTemplate:function(){return(this.shouldRender)?JIRA.Templates.IssueNav.endOfStableMessage:jQuery.noop},onBeforeRender:function(){this.shouldRender=this._hasMoreIssues()&&this._onLastPage()},onRender:function(){if(this.shouldRender){this.$el.addClass("visible")}else{this.$el.removeClass("visible")}},_hasMoreIssues:function(){return !!(this.options.total-this.options.displayableTotal)},_onLastPage:function(){return this.options.pageNumber===this.options.numberOfPages}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.IssueTable");JIRA.Components.IssueTable.Views.IssueTable=JIRA.Marionette.ItemView.extend({events:{"blur .hidden-link":function(a){jQuery(a.target).attr("tabIndex",-1)},"click tr.issuerow":function(a){var c=jQuery(a.target).closest(".issuerow");var b=Number(c.attr("rel"));this.trigger("highlightIssue",b)},"click .sortable":function(a){a.preventDefault();this.trigger("sort",jQuery(a.currentTarget).data("id"))}},inaccessibleIssueRowTemplate:JIRA.Templates.IssueNavTable.inaccessibleIssueRow,initialize:function(a){this.resultsTable=a.resultsTable;this.sortOptions=a.sortOptions||{}},render:function(){this.triggerMethod("before:render",this);var a=jQuery(this.resultsTable)[0];this.$el.empty().append(a);this.triggerMethod("render",this);return this},onRender:function(){this._decorateTableHeaderWithSortOptions();this._addDraggable();this._removeEmptyTextNodes()},onClose:function(){this._removeDraggable()},_decorateTableHeaderWithSortOptions:function(){var a=this.$el.find(".rowHeader .sortable");a.each(function(){this.onclick=null});var d=this.sortOptions;if(d.fieldId){var c=a.filter(function(){return this.getAttribute("data-id")===d.fieldId});if(c.size()&&!c.hasClass("descending")&&!c.hasClass("ascending")){a.removeClass("descending ascending active").addClass("colHeaderLink");var b=d.order==="DESC"?"descending":"ascending";c.removeClass("colHeaderLink").addClass("active "+b)}}},_addDraggable:function(){this.$("#issuetable").dragtable({maxMovingRows:1,containment:"body",axis:false,revert:false,clickDelay:250,tolerance:"intersect",dragaccept:":not(.headerrow-actions)",persistState:_.bind(this._saveColumns,this)})},_removeDraggable:function(){this.$("#issuetable").dragtable("destroy")},_removeEmptyTextNodes:function(){this.$el.find("table, tbody, thead, tr").contents().filter(function(){return this.nodeType===3}).remove()},_saveColumns:function(){var a=[];this.$("#issuetable").find("th").each(function(){var b=jQuery(this).data("id");if(_.isNotBlank(b)){a.push(b)}});this.trigger("columnsChanged",a)},highlightIssue:function(d,a){var c=this._getIssueRow(d);var b=this.$(".focused");b.removeClass("focused");c.addClass("focused");if(c.length&&c.closest(document.body).length){if(a!==false){c.find(".hidden-link").removeAttr("tabIndex").focus()}c.scrollIntoView({marginBottom:50})}},_getIssueRow:function(b,a){a=a||this.$el;return a.find(".issuerow").filter(function(){return this.getAttribute("rel")==b})},markIssueAsInaccessible:function(a){this._getIssueRow(a).replaceWith(this.inaccessibleIssueRowTemplate({columnCount:this.$el.find("thead > tr > th").length,issueID:a}))},updateIssue:function(c,b){var a=this._getIssueRow(c,jQuery(b));this._getIssueRow(c).replaceWith(a);this.highlightIssue(c);this.trigger("issueRowUpdated",a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/IssueTableLayout.js' */
AJS.namespace("JIRA.Components.IssueTable.Views.IssueTableLayout");JIRA.Components.IssueTable.Views.IssueTableLayout=JIRA.Marionette.Layout.extend({template:JIRA.Templates.IssueNavTable.structure,regions:{pagination:".pagination",table:".issue-table-container",resultsCount:".results-count",refreshResults:{selector:".refresh-table",regionType:JIRA.Marionette.ReplaceRegion},endOfStableMessage:{selector:".end-of-stable-message",regionType:JIRA.Marionette.ReplaceRegion}},onRender:function(){this.hidePending()},showPending:function(){this.$el.addClass("pending")},hidePending:function(){this.$el.removeClass("pending")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/Pagination.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.Pagination");JIRA.Components.IssueNavigator.Views.Pagination=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNavTable.pagination,events:{"simpleClick a[data-start-index]":function(a){a.preventDefault();var b=a.target.getAttribute("data-start-index");this.trigger("goToPage",parseInt(b,10))}},serializeData:function(){return{startIndex:this.options.startIndex,pageSize:this.options.pageSize,searchQuery:this._getPagingUri(),displayableTotal:this.options.total}},_getPagingUri:function(){return JIRA.Issues.URLSerializer.getURLFromState({selectedIssueKey:null,jql:this.options.currentSearch.jql,filter:this.options.currentSearch.filterId})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/RefreshResults.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.RefreshResults");JIRA.Components.IssueNavigator.Views.RefreshResults=JIRA.Marionette.ItemView.extend({tagName:"span",template:JIRA.Templates.IssueNav.refreshResults,triggers:{"click a":"refresh"}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/views/ResultsCount.js' */
AJS.namespace("JIRA.Components.IssueNavigator.Views.ResultsCount");JIRA.Components.IssueNavigator.Views.ResultsCount=JIRA.Marionette.ItemView.extend({template:JIRA.Templates.IssueNav.resultsCount,serializeData:function(){var b=this.options.total;var c=this.options.startIndex+1;var a=this.options.startIndex+this.options.pageSize;return{start:c,end:Math.min(a,b),total:b}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/issuetable/controllers/IssueTable.js' */
AJS.namespace("JIRA.Components.IssueTable.Controllers.IssueTable");JIRA.Components.IssueTable.Controllers.IssueTable=JIRA.Marionette.Controller.extend({initialize:function(a){this.$el=jQuery(a.el)},_createMainView:function(){return new JIRA.Components.IssueTable.Views.IssueTableLayout()},_createTableView:function(a,c){var b=new JIRA.Components.IssueTable.Views.IssueTable({resultsTable:a,sortOptions:c});this.listenAndRethrow(b,"columnsChanged");this.listenAndRethrow(b,"highlightIssue");this.listenAndRethrow(b,"issueRowUpdated");this.listenAndRethrow(b,"sort");return b},_createResultsCount:function(a){return new JIRA.Components.IssueNavigator.Views.ResultsCount(a)},_createPagination:function(b){var a=new JIRA.Components.IssueNavigator.Views.Pagination(b);this.listenAndRethrow(a,"goToPage");return a},_createRefreshResults:function(){var a=new JIRA.Components.IssueNavigator.Views.RefreshResults();this.listenAndRethrow(a,"refresh");return a},_createEndOfStableMessage:function(a){return new JIRA.Components.IssueNavigator.Views.EndOfStableMessage(a)},_createEmptyResultsView:function(a){return new JIRA.Components.IssueTable.Views.EmptyResults(a)},_layoutIsRendered:function(){return this.view&&this.view instanceof JIRA.Components.IssueTable.Views.IssueTableLayout},close:function(){if(this.view){this.view.close();delete this.view}},show:function(a){if(a.hasIssues){this._showTable(a)}else{this._showEmptyResults(a)}},showErrorMessage:function(a){this._showEmptyResults(a)},showPending:function(){if(this.view){this.view.showPending();if(this._layoutIsRendered()){this.view.table.currentView._removeDraggable()}}},_showTable:function(b){b=b||{};this.close();this.view=this._createMainView();var e=this._createTableView(b.table,b.sortOptions);var d=this._createResultsCount({total:b.totalIssues,startIndex:b.startIndex,pageSize:b.pageSize});var a=this._createPagination({startIndex:b.startIndex,pageSize:b.pageSize,total:b.totalIssues,currentSearch:b.currentSearch});var c=this._createRefreshResults();var f=this._createEndOfStableMessage({total:b.totalIssues,displayableTotal:b.totalDisplayableIssues,pageNumber:b.pageNumber,numberOfPages:b.numberOfPages});this.listenTo(this.view,{render:function(){this.view.table.show(e);this.view.resultsCount.show(d);this.view.pagination.show(a);this.view.refreshResults.show(c);this.view.endOfStableMessage.show(f)}});this.view.render();this.$el.empty().append(this.view.$el);this.trigger("renderTable",this.$el)},_showEmptyResults:function(a){this.close();this.view=this._createEmptyResultsView(a);this.view.render();this.$el.empty().append(this.view.$el);this.trigger("renderEmpty",this.$el)},highlightIssue:function(b,a){if(this._layoutIsRendered()){this.view.table.currentView.highlightIssue(b,a)}},markIssueAsInaccessible:function(a){if(this._layoutIsRendered()){this.view.table.currentView.markIssueAsInaccessible(a)}},updateIssue:function(b,a){if(this._layoutIsRendered()){this.view.table.currentView.updateIssue(b,a)}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuetable-component', location = 'content/js/components/search/Search.js' */
AJS.namespace("JIRA.Components.SearchService");JIRA.Components.SearchService=JIRA.Marionette.Controller.extend({initialize:function(a){this.searchModule=a.searchModule;this.searchResults=a.searchResults;this.columnConfig=a.columnConfig;_.bindAll(this,"_onIssueUpdated","_onHighlightedIssueChange","_onSelectedIssueChange");this.listenTo(this.searchResults,"change:resultsId change:startIndex stableUpdate issueDeleted",function(){this._doSearch()});this.searchResults.onIssueUpdated(this._onIssueUpdated);this.searchResults.onHighlightedIssueChange(this._onHighlightedIssueChange);this.searchResults.onSelectedIssueChange(this._onSelectedIssueChange)},_onSelectedIssueChange:function(a){this.trigger("selectedIssueChanged",a,this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(c,a,b){this.trigger("issueUpdated",c,a,b)},_onHighlightedIssueChange:function(a){this.trigger("issueHighlighted",a.getId())},close:function(){this.stopListening();this.searchResults.offIssueUpdated(this._onIssueUpdated);this.searchResults.offHighlightedIssueChange(this._onHighlightedIssueChange)},_doSearch:function(){this.searchInProgress=true;this.trigger("before:search");var a=this.searchModule.getFilterId();var b=a<0;a=(b||_.isNull(a))?undefined:a;this.searchResults.getResultsForPage({jql:this.searchModule.getEffectiveJql(),filterId:a}).always(_.bind(function(){this.searchInProgress=false},this)).done(_.bind(function(c){if(!this.searchResults.hasHighlightedIssue()){this.searchResults.highlightFirstInPage()}this.trigger("search",c,this.searchResults)},this)).fail(_.bind(function(){this.trigger("error:search")},this))},goToPage:function(a){if(this.searchInProgress){return}this.searchResults.goToPage(a)},sort:function(b){if(this.searchInProgress){return}var c=this.searchModule.getResults().getColumnSortJql();var a=c[b];if(a){this.searchModule.doSort(a)}},runCurrentSearch:function(){if(this.searchInProgress){return}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");this.searchModule.refresh()}},updateExitingResults:function(){if(this.searchInProgress){return}if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");this._doSearch()}},highlightIssue:function(a){this.searchResults.highlightIssueById(a)},getPager:function(){return this.searchResults.getPager()},selectNextIssue:function(){this.searchResults.highlightNextIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectNextIssue()}},selectPreviousIssue:function(){this.searchResults.highlightPrevIssue();if(this.searchResults.hasSelectedIssue()){this.searchResults.selectPrevIssue()}},unselectIssue:function(){this.searchResults.unselectIssue()},hasSelectedIssue:function(){return this.searchResults.hasSelectedIssue()},getHighlightedIssue:function(){return this.searchResults.getHighlightedIssue().id}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/templates/issuenav-searchheader.soy' */
// This file was automatically generated from issuenav-searchheader.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavSearchHeader == 'undefined') { JIRA.Templates.IssueNavSearchHeader = {}; }


JIRA.Templates.IssueNavSearchHeader.layoutSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-buttons"><button id="layout-switcher-button" class="aui-button drop-arrow js-default-dropdown" type="button"><span class="aui-icon aui-icon-small ', soy.$$escapeHtmlAttribute(opt_data.activeLayout.iconClass), '"></span></button><div class="aui-list hidden"><h5>', soy.$$escapeHtml("Views"), '</h5><ul class="aui-list-section aui-first aui-last">');
  var layoutList8 = opt_data.layouts;
  var layoutListLen8 = layoutList8.length;
  for (var layoutIndex8 = 0; layoutIndex8 < layoutListLen8; layoutIndex8++) {
    var layoutData8 = layoutList8[layoutIndex8];
    output.append('<li class="aui-list-item layout-switcher-item"><a href="#" class="aui-list-item-link" data-layout-key="', soy.$$escapeHtmlAttribute(layoutData8.id), '"><span class="aui-icon aui-icon-small ', (opt_data.activeLayout.id == layoutData8.id) ? 'aui-iconfont-success' : '', '"></span>', soy.$$escapeHtml(layoutData8.label), '</a>');
  }
  output.append('</ul></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/LayoutSwitcherView.js' */
Backbone.define("JIRA.Issues.LayoutSwitcherView",JIRA.Issues.BaseView.extend({template:JIRA.Templates.IssueNavSearchHeader.layoutSwitcher,initialize:function(a){_.bindAll(this,"_onLayoutSwitchClick");this.searchPageModule=a.searchPageModule;this.searchPageModule.on("change:currentLayout",this.render,this)},render:function(){this.$el.html(this.template({layouts:this.searchPageModule.getSortedLayouts(),activeLayout:this.searchPageModule.getActiveLayout()}));this._addLayoutSwitcherTooltip();this.$el.find(".aui-list-item-link").click(this._onLayoutSwitchClick);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.layoutSwitcherReady]);return this},enableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").removeClass("disabled").removeAttr("disabled");return this},disableLayoutSwitcher:function(){this.$el.find("#layout-switcher-button").addClass("disabled").attr("disabled","");return this},createHelptipForSwitchingToDetailView:function(b){var a;if(this._shouldShowIntro()&&this.$el.is(":visible")){a=new AJS.HelpTip({id:"split-view-intro",title:"Choose how you view issues",url:AJS.Meta.get("issue-search-help-url"),bodyHtml:"Switch between the details and list views to suit your preference.",anchor:".view-selector button",isSequence:true,weight:b})}return a},_shouldShowIntro:function(){return this.searchPageModule.search.getResults().hasIssues()},_addLayoutSwitcherTooltip:function(){function a(){var b=AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts");if(b){return AJS.format("Change view (Type \'\'{0}\'\')",AJS.KeyboardShortcut.getKeyboardShortcutKeys("switch.search.layouts"))}else{return "Change view"}}new JIRA.Issues.Tipsy({el:this.$el.find("#layout-switcher-button"),showCondition:":not(.active)",tipsy:{title:a,gravity:"ne"}})},_onLayoutSwitchClick:function(c,a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){var b=AJS.$(c.target).closest("[data-layout-key]").data("layout-key");c.preventDefault();this.searchPageModule.changeLayout(b,a)}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-searchheader', location = 'content/js/search/searchheader/SearchHeaderModule.js' */
Backbone.define("JIRA.Issues.SearchHeaderModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule},registerSearch:function(a){this._search=a},createToolsView:function(a){new JIRA.Issues.IssueTableHeaderOperationsView({el:a,search:this._search,searchPageModule:this._searchPageModule})}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/Filters.js' */
AJS.namespace("JIRA.Components.Filters");JIRA.Components.Filters=JIRA.Marionette.Controller.extend({initialize:function(a){this._initializeDialogController();this.searchPageModule=a.searchPageModule;this._initializeCollections(a);this._initializeSystemFiltersController();this._initializeFavouriteFiltersController();this._initializeFilterHeaderController()},_initializeCollections:function(a){this.systemFiltersCollection=new JIRA.Components.Filters.Collections.SystemFilters(a.systemFilters);this.favouriteFiltersCollection=new JIRA.Components.Filters.Collections.FavouriteFilters([]);this.listenTo(this.favouriteFiltersCollection,{"change:favourite":function(c,b){if(!b){this.favouriteFiltersCollection.remove(c)}},remove:function(b){this.trigger("filterRemoved",{filterId:b.getId()})}})},_initializeDialogController:function(){this.dialogController=new JIRA.Components.Filters.Controllers.Dialog();this.listenTo(this.dialogController,"delete:success",function(a){this.favouriteFiltersCollection.remove(a);JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been deleted.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions());JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"delete:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"rename:success",function(a){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been renamed.",AJS.escapeHtml(a.getName())),JIRA.Issues.getDefaultMessageOptions());JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"rename:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"copy:success",function(a){this.trigger("newFilter",a);this._addFavouriteFilter(a);JIRA.trace("jira.filter.saved")},this);this.listenTo(this.dialogController,"copy:error",function(){JIRA.trace("jira.filter.saved")});this.listenTo(this.dialogController,"saveas:success",function(a){this.trigger("newFilter",a);this._addFavouriteFilter(a);JIRA.trace("jira.filter.saved")},this);this.listenTo(this.dialogController,"saveas:error",function(){JIRA.trace("jira.filter.saved")})},_initializeSystemFiltersController:function(){this.systemFiltersController=new JIRA.Components.Filters.Controllers.List({collection:this.systemFiltersCollection,className:"system-filters",errorMessage:"Failed to retrieve system filters from server.",loadingMessage:"Loading system filters...",emptyMessage:"There are no system filters.",loginMessage:AJS.format("You must be {0}logged in{1} to view system filters.",'<a class="login-link" href="'+JIRA.Issues.LoginUtils.redirectUrlToCurrent()+'">',"</a>")});this.systemFiltersController.on("selectFilter",function(a){this.headerController.closeDetails();this.trigger("filterSelected",a.id)},this)},_initializeFavouriteFiltersController:function(){this.favouriteFiltersController=new JIRA.Components.Filters.Controllers.ListWithActions({collection:this.favouriteFiltersCollection,className:"favourite-filters",title:"Favorite Filters",errorMessage:"Failed to retrieve favorite filters from server.",loadingMessage:"Loading favorite filters...",emptyMessage:"You don\'t have any favorite filters.",loginMessage:AJS.format("You must be {0}logged in{1} to view favorite filters.",'<a class="login-link" href="'+JIRA.Issues.LoginUtils.redirectUrlToCurrent()+'">',"</a>")});this.favouriteFiltersController.on("selectFilter",function(a){this.headerController.closeDetails();this.trigger("filterSelected",a.id)},this);this.favouriteFiltersController.on("deleteFilter",function(a){this.showDeleteDialog(a.id)},this);this.favouriteFiltersController.on("renameFilter",function(a){this.showRenameDialog(a.id)},this);this.favouriteFiltersController.on("copyFilter",function(a){this.showCopyDialog(a.id)},this);this.favouriteFiltersController.on("unfavouriteFilter",function(a){a.saveFavourite(false)},this)},_initializeFilterHeaderController:function(){this.headerController=new JIRA.Components.Filters.Controllers.Header();this.listenTo(this.headerController,"saveAs",function(a){this.showSaveAsDialog(a)});this.listenTo(this.headerController,"save",function(b){var a=AJS.escapeHtml(b.getName());b.saveFilter(this.searchPageModule.getEffectiveJql()).done(_.bind(function(){JIRA.Messages.showSuccessMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e has been successfully saved.",a),JIRA.Issues.getDefaultMessageOptions());this.trigger("savedFilter",b)},this)).fail(function(){JIRA.Messages.showErrorMsg(AJS.format("The filter \u003cstrong\u003e{0}\u003c/strong\u003e could not be saved.",a),JIRA.Issues.getDefaultMessageOptions())})});this.listenTo(this.headerController,"discard",function(){this.trigger("filterDiscarded")});this.listenTo(this.headerController,"favourite",function(a){a=this._addFavouriteFilter(a);this.highlightFilter(a);this.trigger("fitlerFavourited",a)})},_addFavouriteFilter:function(b){var a=!!b.getFavourite();var c=!!this.favouriteFiltersCollection.get(b.getId());if(a&&!c){this.favouriteFiltersCollection.add(b)}return this.favouriteFiltersCollection.get(b.getId())},getFilterById:function(b){var d=this.systemFiltersCollection.get(b)||this.favouriteFiltersCollection.get(b);var a=jQuery.Deferred();if(d){a.resolve(d)}else{var c=new JIRA.Components.Filters.Models.Filter({id:b});c.fetch({success:_.bind(function(){if(c.getFavourite()){this.favouriteFiltersCollection.add(c,{merge:true});a.resolve(this.favouriteFiltersCollection.get(c.id))}else{if(c.getIsSystem()){this.systemFiltersCollection.add(c,{merge:true});a.resolve(this.systemFiltersCollection.get(c.id))}else{a.resolve(c)}}},this),error:function(){c.setIsValid(false);a.reject.apply(this,arguments)}})}return a.promise()},showDeleteDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showDeleteDialog(b)},this))},showRenameDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showRenameDialog(b)},this))},showCopyDialog:function(a){this.getFilterById(a).done(_.bind(function(b){this.dialogController.showCopyDialog(b)},this))},showSaveAsDialog:function(a){this.searchPageModule.getJqlDeferred().done(_.bind(function(b){this.dialogController.showSaveAsDialog(a,b)},this))},showSystemFilters:function(a){this.systemFiltersController.show(a)},showFavouriteFilters:function(a){this.favouriteFiltersController.show(a)},showFilterHeader:function(a){this.headerController.show({el:a.el,model:a.model,isDirty:a.isDirty})},updateFilterHeader:function(a){this.headerController.update({model:a.model,isDirty:a.isDirty})},highlightFilter:function(a){this.systemFiltersController.highlightFilter(a);this.favouriteFiltersController.highlightFilter(a)},markFilterHeaderAsInvalid:function(){this.headerController.markAsInvalid()},fetchSystemFilters:function(){return this.systemFiltersCollection.fetch()},fetchFavouriteFilters:function(){return this.favouriteFiltersCollection.fetch({reset:true})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/Filter.js' */
AJS.namespace("JIRA.Components.Filters.Models.Filter");JIRA.Components.Filters.Models.Filter=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","description","jql","favourite","isSystem","sharePermissions","subscriptions","ownerUserName","ownerDisplayName","avatarUrl","requiresLogin","isValid"],defaults:{isSystem:false,isValid:true},urlRoot:AJS.contextPath()+"/rest/api/2/filter/",getOwner:function(){return this.getOwnerDisplayName()||this.getOwnerUserName()},isFavouriteFilter:function(){return !this.getIsSystem()&&!!this.getFavourite()},url:function(){return this.urlRoot+encodeURIComponent(this.id)+"?expand=subscriptions[-5:]"},isMyFilter:function(){return !this.getIsSystem()&&this.getOwnerUserName()===JIRA.Issues.LoginUtils.loggedInUserName()},parse:function(a){if(a.subscriptions&&a.subscriptions.items){a.subscriptions.items.reverse()}return{id:a.id,name:a.name,description:a.description,jql:a.jql,isSystem:a.isSystem,favourite:a.favourite,sharePermissions:a.sharePermissions||[],subscriptions:a.subscriptions,ownerUserName:a.owner&&a.owner.name,ownerDisplayName:a.owner&&a.owner.displayName,avatarUrl:a.owner&&a.owner.avatarUrls["48x48"],requiresLogin:a.requiresLogin}},getNumberOfAdditionalSubscriptions:function(){var a=this.getSubscriptions();return a.size>a.items.length?a.size-a.items.length:0},saveFavourite:function(b){var a=this;var c=this.getFavourite();this.setFavourite(b);if(this.pendingRequest){this.pendingRequest.abort()}this.pendingRequest=JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/1.0/filters/"+encodeURIComponent(this.getId())+"/favourite",type:b?"PUT":"DELETE"}).done(function(d){var e=AJS.$(d).text().match(/favourite state: (\w+)/)[1]==="true";delete a.pendingRequest;a.setFavourite(e)}).fail(function(){a.setFavourite(c)});return this.pendingRequest},saveFilter:function(c){if(this.pendingRequest){this.pendingRequest.abort()}var b=this.toJSON();var d={id:b.id,name:b.name,jql:c,favourite:b.favourite};var a=this;this.pendingRequest=JIRA.SmartAjax.makeRequest({url:this.url(),type:"PUT",contentType:"application/json",data:JSON.stringify(d)}).done(function(e){a.set(a.parse(e))}).then(function(){delete a.pendingRequest;JIRA.trace("jira.filter.saved")});return this.pendingRequest},toJSON:function(){var a=JIRA.Issues.BaseModel.prototype.toJSON.apply(this);_.extend(a,{requiresLoginForUser:this._requiresLoginForUser(this.getRequiresLogin()),navUrl:this._constructNavUrl(this.getId(),this.getRequiresLogin())});return a},_requiresLoginForUser:function(a){return !JIRA.Issues.LoginUtils.isLoggedIn()&&a},_constructNavUrl:function(a,b){var c="/issues/?filter="+a;if(this._requiresLoginForUser(b)){return JIRA.Issues.LoginUtils.redirectUrl(c)}else{return AJS.contextPath()+c}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/Filters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.Filters");JIRA.Components.Filters.Collections.Filters=JIRA.Issues.Brace.Collection.extend({model:JIRA.Components.Filters.Models.Filter,fetch:function(){var a=JIRA.Issues.Brace.Collection.prototype.fetch.apply(this,arguments);a.done(_.bind(function(){this.fetchState="fetched";this.trigger("change:fetchState",this.fetchState)},this));a.fail(_.bind(function(){this.fetchState="error";this.trigger("change:fetchState",this.fetchState)},this));return a},initialize:function(b,a){a=a||{};this.fetchState=a.fetchState}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/SystemFilters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.SystemFilters");JIRA.Components.Filters.Collections.SystemFilters=JIRA.Components.Filters.Collections.Filters.extend({_setFetchState:function(b){var a=b!==this.fetchState;this.fetchState=b;if(a){this.trigger("change:fetchState",this.fetchState)}},url:AJS.contextPath()+"/rest/issueNav/latest/systemFilters",fetch:function(){if(this.length>0){this._setFetchState("fetched");return jQuery.Deferred().resolve()}return JIRA.Components.Filters.Collections.Filters.prototype.fetch.apply(this,_.toArray(arguments))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/entities/FavouriteFilters.js' */
AJS.namespace("JIRA.Components.Filters.Collections.FavouriteFilters");JIRA.Components.Filters.Collections.FavouriteFilters=JIRA.Components.Filters.Collections.Filters.extend({url:AJS.contextPath()+"/rest/api/2/filter/favourite?expand=subscriptions[-5:]",comparator:function(b,a){return b.getName().toLowerCase().localeCompare(a.getName().toLowerCase())}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/actions.soy' */
// This file was automatically generated from actions.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Actions == 'undefined') { JIRA.Components.Filters.Templates.Actions = {}; }


JIRA.Components.Filters.Templates.Actions.DropDown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-list"><ul class="aui-list-section">', (opt_data.canEdit) ? '<li class="aui-list-item"><a href="" class="aui-list-item-link rename-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Rename") + '</a></li>' : '', '<li class="aui-list-item"><a href="" class="aui-list-item-link copy-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Copy"), '</a></li></ul><ul class="aui-list-section', (! opt_data.canEdit) ? ' aui-last' : '', '"><li class="aui-list-item"><a href="" class="aui-list-item-link unfavourite-filter" data-id="', soy.$$escapeHtmlAttribute(opt_data.filter.id), '">', soy.$$escapeHtml("Remove from favorites"), '</a></li></ul>', (opt_data.canEdit) ? '<ul class="aui-list-section aui-last"><li class="aui-list-item"><a href="" class="aui-list-item-link delete-filter" data-id="' + soy.$$escapeHtmlAttribute(opt_data.filter.id) + '">' + soy.$$escapeHtml("Delete") + '</a></li></ul>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/dialogs.soy' */
// This file was automatically generated from dialogs.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Dialogs == 'undefined') { JIRA.Components.Filters.Templates.Dialogs = {}; }


JIRA.Components.Filters.Templates.Dialogs.Rename = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="rename-filter-form" method="put"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Rename Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2><div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name" value="', soy.$$escapeHtmlAttribute(opt_data.filter.name), '" class="text long-field"></div></div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Dialogs.Delete = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/rest/api/2/filter/', soy.$$escapeHtmlAttribute(opt_data.filter.id), '" class="aui" id="delete-filter-form" method="delete"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Delete Filter"), ': ', soy.$$escapeHtml(opt_data.filter.name), '</h2>');
  if (opt_data.filter.subscriptions.items.length) {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("The filter {0} has the following subscriptions. Are you sure you want to delete it?",opt_data.filter.name)), '</p>');
    JIRA.Components.Filters.Templates.Details.SubscriptionList(opt_data, output);
    output.append('<p class="form-description"><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/ViewSubscriptions.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '">', soy.$$escapeHtml("Manage subscriptions"), '</a></p>');
  } else {
    output.append('<p class="form-description">', soy.$$escapeHtml(AJS.format("Are you sure you want to delete the filter {0}?",opt_data.filter.name)), '</p>');
  }
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Delete"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Dialogs.Save = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><form action="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.contextPath)), '/rest/api/2/filter/" class="aui" id="save-filter-form" method="post"><div class="aui-messages"></div><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.headerText), '</h2>', (opt_data.copyFromAnotherUser) ? '<p class="form-description">' + ((opt_data.filterOwnerName) ? soy.$$escapeHtml(AJS.format("This filter was created by {0}. You can save a copy of this filter but you cannot modify the original.",opt_data.filterOwnerName)) : soy.$$escapeHtml("You can save a copy of this filter but you cannot modify the original.")) + '</p>' : '', '<div class="field-group"><label for="filterName">', soy.$$escapeHtml("Filter Name"), '<span class="aui-icon icon-required"><span class="content">Required</span></span></label><input type="text" id="filterName" name="name"', (opt_data.prefilledFilterName) ? ' value="' + soy.$$escapeHtmlAttribute(opt_data.prefilledFilterName) + '"' : '', 'class="text long-field"><div class="description">', soy.$$escapeHtml("Enter a name for this Filter"), '</div>');
  var fieldList95 = opt_data.hiddenFields;
  var fieldListLen95 = fieldList95.length;
  for (var fieldIndex95 = 0; fieldIndex95 < fieldListLen95; fieldIndex95++) {
    var fieldData95 = fieldList95[fieldIndex95];
    output.append('<input type="hidden" name="', soy.$$escapeHtmlAttribute(fieldData95.name), '" value="', (fieldData95.value) ? soy.$$escapeHtmlAttribute(fieldData95.value) : '', '" />');
  }
  output.append('</div>', (opt_data.isDefaultShareScopeGlobal) ? '<div class="aui-message info shadowed"><p class="title"><span class="aui-icon icon-info"></span><strong>' + soy.$$escapeHtml("By default your filters are shared with everyone.") + '</strong></p><input type="checkbox" id="setSharingPrivate" class="checkbox"><label for="setSharingPrivate">' + soy.$$escapeHtml("My filters should be private by default.") + '</label></div>' : '', '</div><div class="buttons-container form-footer"><div class="buttons"><input accesskey="', soy.$$escapeHtmlAttribute("s"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" type="submit" value="', soy.$$escapeHtmlAttribute("Submit"), '" /><a accesskey="', soy.$$escapeHtmlAttribute("`"), '" title="', soy.$$escapeHtmlAttribute(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel" href="javascript:">', soy.$$escapeHtml("Cancel"), '</a></div></div></form></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/list.soy' */
// This file was automatically generated from list.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.List == 'undefined') { JIRA.Components.Filters.Templates.List = {}; }


JIRA.Components.Filters.Templates.List.Module = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-panel-section">', (opt_data.title) ? '<h4 class="filter-title">' + soy.$$escapeHtml(opt_data.title) + '</h4>' : '', '<div class="filter-content" /></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.Message = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="filter-info ', soy.$$escapeHtmlAttribute(opt_data.className), '">', opt_data.text, '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.List = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="saved-filter filter-list ', soy.$$escapeHtmlAttribute(opt_data.className), '"></ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.List.Filter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="filter-link', (opt_data.requiresLoginForUser) ? ' requires-login' : '', '" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.navUrl)), '" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" title="', soy.$$escapeHtmlAttribute(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</a>', (opt_data.useActions) ? '<a href="#" class="filter-actions" data-id="' + soy.$$escapeHtmlAttribute(opt_data.id) + '"><span>' + soy.$$escapeHtml("Filter Actions") + '</span></a>' : '', '</li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/header.soy' */
// This file was automatically generated from header.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Header == 'undefined') { JIRA.Components.Filters.Templates.Header = {}; }


JIRA.Components.Filters.Templates.Header.Main = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="header-section-primary"><h1 class="search-title" title="', soy.$$escapeHtmlAttribute(opt_data.title), '">', soy.$$escapeHtml(opt_data.title), '</h1><ul class="filter-operations">', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<li class="filter-edited-item"><span>' + soy.$$escapeHtml("Edited") + '</span></li>' : '');
  if (opt_data.primaryButton) {
    output.append('<li>', (opt_data.primaryOps && opt_data.primaryOps.length) ? '<div class="aui-buttons">' : '', '<a href="', (opt_data.primaryButton.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.primaryButton.href)) : '#', '" class="aui-button ', soy.$$escapeHtmlAttribute(opt_data.primaryButton.styleClass), '">', soy.$$escapeHtml(opt_data.primaryButton.label), '</a>');
    if (opt_data.primaryOps && opt_data.primaryOps.length) {
      output.append('<button class="aui-button aui-dropdown2-trigger js-edited-trigger" aria-owns="js-edited-content" aria-haspopup="true" data-container=".aui-buttons"></button></div><div id="js-edited-content" class="aui-dropdown2 aui-style-default"><ul>');
      var opList33 = opt_data.primaryOps;
      var opListLen33 = opList33.length;
      for (var opIndex33 = 0; opIndex33 < opListLen33; opIndex33++) {
        var opData33 = opList33[opIndex33];
        output.append('<li><a href="', (opData33.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData33.href)) : '#', '" ', (opData33.styleClass) ? 'class="' + soy.$$escapeHtmlAttribute(opData33.styleClass) + '"' : '', '>', soy.$$escapeHtml(opData33.label), '</a></li>');
      }
      output.append('</ul></div>');
    }
    output.append('</li>');
  }
  if (opt_data.owner) {
    var opList54 = opt_data.secondaryOps;
    var opListLen54 = opList54.length;
    for (var opIndex54 = 0; opIndex54 < opListLen54; opIndex54++) {
      var opData54 = opList54[opIndex54];
      output.append('<li><a href="', (opData54.href) ? soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opData54.href)) : '#', '" ', (opData54.title) ? 'title="' + soy.$$escapeHtmlAttribute(opData54.title) + '"' : '', ' class="', soy.$$escapeHtmlAttribute(opData54.styleClass), '">', (opData54.label) ? soy.$$escapeHtml(opData54.label) : '', '</a></li>');
    }
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/templates/details.soy' */
// This file was automatically generated from details.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Components == 'undefined') { JIRA.Components = {}; }
if (typeof JIRA.Components.Filters == 'undefined') { JIRA.Components.Filters = {}; }
if (typeof JIRA.Components.Filters.Templates == 'undefined') { JIRA.Components.Filters.Templates = {}; }
if (typeof JIRA.Components.Filters.Templates.Details == 'undefined') { JIRA.Components.Filters.Templates.Details = {}; }


JIRA.Components.Filters.Templates.Details.Main = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Components.Filters.Templates.Details.Description(opt_data, output);
  JIRA.Components.Filters.Templates.Details.Permissions(opt_data, output);
  if (opt_data.userIsLoggedIn) {
    JIRA.Components.Filters.Templates.Details.Subscriptions(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Description = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section">');
  if (opt_data.owner) {
    JIRA.Components.Filters.Templates.Details.Owner(opt_data, output);
  }
  output.append((opt_data.filter.description) ? '<p class="filter-name">' + soy.$$escapeHtml(opt_data.filter.description) + ((opt_data.permissions.userHasEditPermission) ? ' <a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">(' + soy.$$escapeHtml("Edit") + ')</a>' : '') + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Permissions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section sub-section"><h4 class="section-header">', soy.$$escapeHtml("Permissions"), '</h4>');
  if (opt_data.sharePermissions && opt_data.sharePermissions.length > 0) {
    output.append('<p>', soy.$$escapeHtml("This filter is visible to:"), '</p><ul class="shared-filters">');
    var shareList49 = opt_data.sharePermissions;
    var shareListLen49 = shareList49.length;
    for (var shareIndex49 = 0; shareIndex49 < shareListLen49; shareIndex49++) {
      var shareData49 = shareList49[shareIndex49];
      JIRA.Components.Filters.Templates.Details.SharePermissionItem({type: shareData49.type, project: (shareData49.project) ? '<a href="' + soy.$$escapeHtml("") + '/browse/' + soy.$$escapeHtml(shareData49.project.key) + '">' + soy.$$escapeHtml(shareData49.project.name) + '</a>' : '', projectRole: (shareData49.role) ? soy.$$escapeHtml(shareData49.role.name) : '', group: (shareData49.group) ? soy.$$escapeHtml(shareData49.group.name) : ''}, output);
    }
    output.append('</ul>');
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter is only visible to you."), '</p>');
  }
  output.append((opt_data.permissions.userHasEditSharingPermission) ? '<p><a class="edit-permissions" href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/EditFilter!default.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Edit permissions") + '</a></p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Subscriptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filter-details-section full-section"><h4>', soy.$$escapeHtml("Subscriptions"), '</h4>');
  if (opt_data.subscriptions.items.length) {
    output.append('<p>', soy.$$escapeHtml("This filter has the following subscriptions:"), '</p>');
    JIRA.Components.Filters.Templates.Details.SubscriptionList(opt_data, output);
  } else {
    output.append('<p>', soy.$$escapeHtml("This filter has no subscriptions."), '</p>');
  }
  output.append('<ul class="manage-links"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/FilterSubscription!default.jspa?filterId=', soy.$$escapeUri(opt_data.filter.id), '&returnUrl=', soy.$$escapeUri(opt_data.returnUrl), '">', soy.$$escapeHtml("New subscription"), '</a></li>', (opt_data.subscriptions.items.length) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml("Manage subscriptions") + '</a></li>' : '', '</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.SharePermissionItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.type == 'global') ? '<li>' + soy.$$escapeHtml("Everyone") + '</li>' : (opt_data.type == 'group') ? '<li>' + AJS.format("{0}Group{1}: {2}",'<strong>','</strong>',opt_data.group) + '</li>' : (opt_data.projectRole) ? '<li>' + AJS.format("{0}Project{1}: {2} {3}Role{4}: {5}",'<strong>','</strong>',opt_data.project,'<strong>','</strong>',opt_data.projectRole) + '</li>' : '<li>' + AJS.format("{0}Project{1}: {2}",'<strong>','</strong>',opt_data.project) + '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.SubscriptionList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul>');
  var subList150 = opt_data.filter.subscriptions.items;
  var subListLen150 = subList150.length;
  for (var subIndex150 = 0; subIndex150 < subListLen150; subIndex150++) {
    var subData150 = subList150[subIndex150];
    output.append((subData150.group) ? '<li>' + soy.$$escapeHtml(subData150.group.name) + '</li>' : '<li>' + soy.$$escapeHtml(subData150.user.displayName) + '</li>');
  }
  output.append((opt_data.filter.subscriptions.additionalLength) ? '<li><a href="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")) + '/secure/ViewSubscriptions.jspa?filterId=' + soy.$$escapeUri(opt_data.filter.id) + '">' + soy.$$escapeHtml(AJS.format("{0} more",opt_data.filter.subscriptions.additionalLength)) + '</a></li>' : '', '</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.Owner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-owner">', (opt_data.avatarUrl) ? '<span class="aui-avatar aui-avatar-large search-owner-avatar"><span class="aui-avatar-inner"><img src="' + soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.avatarUrl)) + '" /></span></span>' : '', '<span class="search-owner-name">');
  var ownerLink__soy181 = new soy.StringBuilder();
  JIRA.Components.Filters.Templates.Details.OwnerLink(opt_data, ownerLink__soy181);
  ownerLink__soy181 = ownerLink__soy181.toString();
  output.append(AJS.format("Owned by {0}",ownerLink__soy181), '</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Components.Filters.Templates.Details.OwnerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.ownerUrl)), '" class="user-hover" rel="', soy.$$escapeHtmlAttribute(opt_data.ownerUserName), '">', soy.$$escapeHtml(opt_data.owner), '</a>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Actions.js' */
AJS.namespace("JIRA.Components.Filters.Views.Actions");JIRA.Components.Filters.Views.Actions=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.Actions.DropDown,triggers:{"click .rename-filter":"renameFilter","click .copy-filter":"copyFilter","click .unfavourite-filter":"unfavouriteFilter","click .delete-filter":"deleteFilter"},triggerView:null,dropDown:null,initialize:function(a){this.triggerView=a.triggerView},serializeData:function(){return{filter:this.model,canEdit:JIRA.Issues.LoginUtils.loggedInUserName()===this.model.getOwnerUserName()}},onBeforeRender:function(){this.dropDown=new AJS.Dropdown({alignment:AJS.LEFT,styleClass:"filter-actions-dropdown",content:_.bind(function(){return this.$el},this),positioningController:new JIRA.Issues.WindowPositioning(),trigger:this.triggerView.getActionsTrigger()});this.dropDown.bind("hideLayer",_.bind(this.close,this))},onRender:function(){this.dropDown.show();this._markFilterAsSelected()},onClose:function(){this.dropDown.hide();this.dropDown.layerController.placeholder().remove();this.dropDown=null;this._markFilterAsUnselected()},_markFilterAsSelected:function(){var a=this.triggerView.getActionsTrigger();a.find("span").addClass("active");a.closest("li").addClass("hover")},_markFilterAsUnselected:function(){var a=this.triggerView.getActionsTrigger();a.find("span").removeClass("active");a.closest("li").removeClass("hover")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Copy.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Copy");JIRA.Components.Filters.Views.Dialogs.Copy=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Save,id:"copy-filter-dialog",dialogOptions:function(){var a=this;return{content:function(b){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a.template(_.extend({isDefaultShareScopeGlobal:c&&c.scope==="GLOBAL"},a.serializeData())))})}}},formToRequestData:function(a){return{name:a.find("[name=name]").val(),id:this.model.getId(),favourite:true}},serializeData:function(){var a=this.model;return{headerText:"Copy Filter"+" : "+a.getName(),prefilledFilterName:AJS.format("Copy of {0}",a.getName()),modifierKey:AJS.Navigator.modifierKey(),contextPath:AJS.contextPath(),filter:a.toJSON(),copyFromAnotherUser:a.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:a.getOwnerDisplayName(),hiddenFields:[]}},onSubmitSuccess:function(){if(this.$el.find("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})})}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Delete.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Delete");JIRA.Components.Filters.Views.Dialogs.Delete=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Delete,id:"delete-filter-dialog",serializeData:function(){var a={modifierKey:AJS.Navigator.modifierKey()};if(this.model){a.filter=this.model.toJSON()}else{a.filter={subscriptions:{items:[]}}}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/Rename.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.Rename");JIRA.Components.Filters.Views.Dialogs.Rename=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Rename,id:"rename-filter-dialog",serializeData:function(){return{modifierKey:AJS.Navigator.modifierKey(),filter:this.model.toJSON()}},formToRequestData:function(a){return{name:a.find("[name=name]").val(),id:this.model.getId(),favourite:true}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/dialogs/SaveAs.js' */
AJS.namespace("JIRA.Components.Filters.Views.Dialogs.SaveAs");JIRA.Components.Filters.Views.Dialogs.SaveAs=JIRA.Marionette.DialogView.extend({template:JIRA.Components.Filters.Templates.Dialogs.Save,id:"save-filter-dialog",initialize:function(a){this.jql=a.jql},dialogOptions:function(){var a=this;return{content:function(b){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",contentType:"application/json"}).done(function(c){b(a.template(_.extend({isDefaultShareScopeGlobal:c&&c.scope==="GLOBAL"},a.serializeData())))})}}},formToRequestData:function(b){var a={name:b.find("[name=name]").val(),jql:this.jql,favourite:true};if(this.model&&!this.model.getIsSystem()){a.id=this.model.getId()}return a},serializeData:function(){var b={headerText:"Save Filter",modifierKey:AJS.Navigator.modifierKey(),contextPath:AJS.contextPath(),hiddenFields:[]};var a=this.model;if(a){_.extend(b,{filter:a?a.toJSON():{},copyFromAnotherUser:a.getOwnerUserName()!==AJS.Meta.get("remote-user"),filterOwnerName:a.getOwnerDisplayName()})}return b},onSubmitSuccess:function(){if(this.$el.find("#setSharingPrivate").prop("checked")){JIRA.SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/api/2/filter/defaultShareScope",type:"PUT",contentType:"application/json",processData:false,data:JSON.stringify({scope:"PRIVATE"})})}},onSubmitError:function(){this.dialog.$form.find("#filterName").focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Filter.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Filter");JIRA.Components.Filters.Views.List.Filter=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.List.Filter,ui:{filterLink:".filter-link"},triggers:{"simpleClick .filter-link:not(.requires-login)":"selectFilter"},modelEvents:{change:"render"},onRender:function(){this.unwrapTemplate()},highlight:function(){this.ui.filterLink.addClass("active");this.ui.filterLink.scrollIntoView()},unhighlight:function(){this.ui.filterLink.removeClass("active")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/FilterWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.FilterWithActions");JIRA.Components.Filters.Views.List.FilterWithActions=JIRA.Components.Filters.Views.List.Filter.extend({ui:_.extend({actionsTrigger:".filter-actions"},JIRA.Components.Filters.Views.List.Filter.prototype.ui),triggers:_.extend({"click .filter-actions":"openActions"},JIRA.Components.Filters.Views.List.Filter.prototype.triggers),templateHelpers:{useActions:true},getActionsTrigger:function(){return this.ui.actionsTrigger}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/List.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.List");JIRA.Components.Filters.Views.List.List=JIRA.Marionette.CompositeView.extend({template:JIRA.Components.Filters.Templates.List.List,itemView:JIRA.Components.Filters.Views.List.Filter,itemViewContainer:".filter-list",onRender:function(){this.unwrapTemplate()},templateHelpers:function(){return{className:this.className}},unhighlightAllFilters:function(){this.children.apply("unhighlight")},highlightFilter:function(b){var a=this.children.findByModel(b);if(a){a.highlight()}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/ListWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.ListWithActions");JIRA.Components.Filters.Views.List.ListWithActions=JIRA.Components.Filters.Views.List.List.extend({itemView:JIRA.Components.Filters.Views.List.FilterWithActions,useActions:false,initialize:function(a){a=_.defaults({},a,{useActions:false});this.useActions=a.useActions}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Message.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Message");JIRA.Components.Filters.Views.List.Message=JIRA.Marionette.ItemView.extend({template:JIRA.Components.Filters.Templates.List.Message,text:"",initialize:function(a){this.text=a.text},onRender:function(){this.unwrapTemplate()},templateHelpers:function(){return{text:this.text,className:this.className}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/list/Module.js' */
AJS.namespace("JIRA.Components.Filters.Views.List.Module");JIRA.Components.Filters.Views.List.Module=JIRA.Marionette.Layout.extend({template:JIRA.Components.Filters.Templates.List.Module,title:"",regions:{content:".filter-content"},initialize:function(a){a=_.defaults({},a,{title:""});this.title=a.title},templateHelpers:function(){return{title:this.title}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Header.js' */
AJS.namespace("JIRA.Components.Filters.Views.Header");JIRA.Components.Filters.Views.Header=JIRA.Marionette.ItemView.extend({operations:{save:{styleClass:"save-changes",label:"Save"},saveAs:{styleClass:"save-as-new-filter",label:"Save as",href:AJS.contextPath()+"/secure/SaveAsFilter!default.jspa"},discardChanges:{styleClass:"discard-filter-changes",label:"Discard changes"},details:{styleClass:"show-filter-details",title:"View information about this filter",label:"Details"},favouriteOn:{title:"Remove this filter from your Favorite Filters",label:"Remove this filter from your Favorite Filters",styleClass:"fav-link icon on"},favouriteOff:{title:"Add this filter to your Favorite Filters",label:"Add this filter to your Favorite Filters",styleClass:"fav-link icon off"}},template:JIRA.Components.Filters.Templates.Header.Main,ui:{filterFavouriteButton:".fav-link",filterEditedLabel:".filter-edited-item",saveButtons:".save-as-new-filter, .save-changes",detailsTrigger:".show-filter-details",dropdownContent:"#js-edited-content"},triggers:{"click .fav-link":"toogleFavourite","click .save-as-new-filter":{event:"saveAs",preventDefault:true,stopPropagation:false},"click .save-changes":{event:"save",preventDefault:true,stopPropagation:false},"click .discard-filter-changes":{event:"discard",preventDefault:true,stopPropagation:false}},events:{"click .show-filter-details":function(){this.trigger("details",this.ui.detailsTrigger)}},_generatePrimaryOperations:function(){var a=[];if(this.isDirty&&this.model.isMyFilter()){a.push(this.operations.save)}if(!!JIRA.Issues.LoginUtils.loggedInUserName()){a.push(this.operations.saveAs)}if(this.isDirty){a.push(this.operations.discardChanges)}return a},_generateSecondaryOperations:function(){var b=[];if(!this.model.getIsSystem()){b.push(this.operations.details)}if(!!JIRA.Issues.LoginUtils.loggedInUserName()&&!this.model.getIsSystem()){var a=this.model.isFavouriteFilter()?this.operations.favouriteOn:this.operations.favouriteOff;b.href=AJS.contextPath()+"/secure/EditFilter!default.jspa?filterId="+this.model.id;b.push(a)}return b},serializeData:function(){if(!this.model){return{title:"Search",primaryButton:this.operations.saveAs}}if(!this.model.getIsValid()){return{title:"Search"}}var a=this._generatePrimaryOperations();var c=this._generateSecondaryOperations();var b={title:this.model.getName(),primaryButton:a.shift(),primaryOps:a,secondaryOps:c};if(this.model.getOwner()){_.extend(b,{owner:this.model.getOwner()||"",ownerUserName:this.model.getOwnerUserName()||"",avatarUrl:this.model.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(this.model.getOwnerUserName())})}return b},render:function(a){this.model=a.model;this.isDirty=a.isDirty;return JIRA.Marionette.ItemView.prototype.render.call(this)},onRender:function(){this.ui.dropdownContent.on("aui-dropdown2-show",_.bind(function(b){var a=this.$el;this.$el=jQuery(b.target);this.delegateEvents();this.$el=a},this));new JIRA.Issues.Tipsy({el:this.ui.filterFavouriteButton})},markAsInvalid:function(){this.ui.saveButtons.addClass("disabled")}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/views/Details.js' */
AJS.namespace("JIRA.Components.Filters.Views.Details");JIRA.Components.Filters.Views.Details=JIRA.Marionette.InlineDialogView.extend({template:JIRA.Components.Filters.Templates.Details.Main,id:"filter-details-overlay",dialogOptions:{addActiveClass:true,hideDelay:3600000,offsetX:-36,width:400},initialize:function(a){this.trigger=a.triggerEl},serializeData:function(){var b=this.model;var c=_.sortBy(b.getSharePermissions(),function(f){var g=[f.type];f.group&&g.push(f.group.name);f.project&&g.push(f.project.name);f.role&&g.push(f.role.name);return g});var e=_.clone(b.getSubscriptions());var a=JIRA.Issues.LoginUtils.loggedInUserName()===b.getOwnerUserName();e.additionalLength=b.getNumberOfAdditionalSubscriptions();var d={filter:b.toJSON(),sharePermissions:c,subscriptions:e,permissions:{userHasEditSharingPermission:a&&(!!JIRA.Issues.UserParms.createSharedObjects()||c.length>0),userHasEditPermission:a},userIsLoggedIn:JIRA.Issues.LoginUtils.isLoggedIn(),returnUrl:window.location};if(b.getOwner()){_.extend(d,{owner:b.getOwner()||"",ownerUserName:b.getOwnerUserName()||"",avatarUrl:b.getAvatarUrl(),ownerUrl:AJS.contextPath()+"/secure/ViewProfile.jspa?name="+encodeURIComponent(b.getOwnerUserName())})}return d},onRender:function(){this.dialog.bind("click",function(a){a.stopPropagation()})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/Dialog.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.Dialog");JIRA.Components.Filters.Controllers.Dialog=JIRA.Marionette.Controller.extend({initialize:function(){this.activeView=null},_closeActiveDialog:function(){if(this.activeView){this.activeView.close();this.stopListening(this.activeView);this.activeView=null}},_showDialog:function(c,b,a){_.defaults(a,{viewOptions:{},onSuccess:jQuery.noop,onError:jQuery.noop});this._closeActiveDialog();this.activeView=new c(_.extend({model:b},a.viewOptions));this.listenTo(this.activeView,"submit:success",function(d){a.onSuccess.call(this,d,b)});this.listenTo(this.activeView,"submit:error",function(){a.onError.call(this,b)});this.activeView.render()},showDeleteDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Delete,a,{onSuccess:function(c,b){this.trigger("delete:success",b)},onError:function(b){this.trigger("delete:error",b)}})},showRenameDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Rename,a,{onSuccess:function(c,b){b.set("name",c.name);this.trigger("rename:success",b)},onError:function(b){this.trigger("rename:error",b)}})},showCopyDialog:function(a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.Copy,a,{onSuccess:function(c){var b=new JIRA.Components.Filters.Models.Filter(c,{parse:true});this.trigger("copy:success",b)},onError:function(b){this.trigger("copy:error",b)}})},showSaveAsDialog:function(b,a){this._showDialog(JIRA.Components.Filters.Views.Dialogs.SaveAs,b,{viewOptions:{jql:a},onSuccess:function(d){var c=new JIRA.Components.Filters.Models.Filter(d,{parse:true});this.trigger("saveas:success",c)},onError:function(c){this.trigger("saveas:error",c)}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/List.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.List");JIRA.Components.Filters.Controllers.List=JIRA.Marionette.Controller.extend({view:null,initialize:function(a){this.collection=a.collection;this.title=a.title;this.className=a.className;this.errorMessage=a.errorMessage;this.loadingMessage=a.loadingMessage;this.emptyMessage=a.emptyMessage;this.loginMessage=a.loginMessage},show:function(a){if(this.view){this.close()}this.view=new JIRA.Components.Filters.Views.List.Module({el:a,title:this.title});this.view.render();this._showInternalView(this.collection.fetchState);this.listenTo(this.collection,"change:fetchState",this._showInternalView)},close:function(){if(this.view){this.stopListening(this.collection,"change:fetchState",this._showRegion);this.stopListening(this.view);this.view.close();this.view=null}},highlightFilter:function(a){if(this._listView){this._listView.unhighlightAllFilters();if(a){this._listView.highlightFilter(a)}}},_showInternalView:function(a){switch(a){case"error":this._showError();break;case"fetched":this._showList();break;default:this._showLoading();break}},_showLoading:function(){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.loadingMessage}))},_showError:function(){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.errorMessage}))},_showList:function(){var a=this.collection;if(a.length){this._showListWithItems()}else{this._showEmptyList()}},_getListViewConstructor:function(){return JIRA.Components.Filters.Views.List.List},_showListWithItems:function(){var a=this._getListViewConstructor();this._listView=new a({collection:this.collection,className:this.className});this.view.content.show(this._listView);this.trigger("render");this.listenTo(this.collection,"remove",function b(){if(!this.collection.length){this.stopListening(this.collection,"remove",b);this._showEmptyList()}});this.listenTo(this._listView,"itemview:selectFilter",function(d,c){this.trigger("selectFilter",c.model)});this.listenTo(this._listView,"itemview:render",function(){this.trigger("render")});this.triggerMethod("list:render",this._listView)},_showEmptyList:function(){if(JIRA.Issues.LoginUtils.isLoggedIn()){this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.emptyMessage}))}else{this.view.content.show(new JIRA.Components.Filters.Views.List.Message({className:this.className,text:this.loginMessage}))}this.listenToOnce(this.collection,"add",function(){this._showListWithItems()})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/ListWithActions.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.ListWithActions");JIRA.Components.Filters.Controllers.ListWithActions=JIRA.Components.Filters.Controllers.List.extend({actionsView:null,_getListViewConstructor:function(){return JIRA.Components.Filters.Views.List.ListWithActions},close:function(){this._closeActions();JIRA.Components.Filters.Controllers.List.prototype.close.call(this)},highlightFilter:function(a){this._closeActions();JIRA.Components.Filters.Controllers.List.prototype.highlightFilter.call(this,a)},_showActions:function(c,b){var a=(this.actionsView&&this.actionsView.model===b);this._closeActions();if(!a){this.actionsView=new JIRA.Components.Filters.Views.Actions({triggerView:c,model:b});this.actionsView.render();this.listenTo(this.actionsView,"deleteFilter",function(d){this._closeActions();this.trigger("deleteFilter",d.model)});this.listenTo(this.actionsView,"renameFilter",function(d){this._closeActions();this.trigger("renameFilter",d.model)});this.listenTo(this.actionsView,"copyFilter",function(d){this._closeActions();this.trigger("copyFilter",d.model)});this.listenTo(this.actionsView,"unfavouriteFilter",function(d){this._closeActions();this.trigger("unfavouriteFilter",d.model)})}},_closeActions:function(){if(this.actionsView){this.actionsView.close();this.stopListening(this.actionsView);this.actionsView=null}},onListRender:function(){this.listenTo(this._listView,"itemview:selectFilter",function(){this._closeActions()});this.listenTo(this._listView,"itemview:openActions",function(b,a){this._showActions(a.view,a.model)})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:filters-component', location = 'content/js/components/filters/controllers/Header.js' */
AJS.namespace("JIRA.Components.Filters.Controllers.Header");JIRA.Components.Filters.Controllers.Header=JIRA.Marionette.Controller.extend({initialize:function(){this.view=null},close:function(){if(this.view){this.view.close();this.stopListening(this.view);this.view=null;this.trigger("close")}},closeDetails:function(){if(this.detailsView){this.detailsView.close();this.stopListening(this.detailsView);this.detailsView=null}},showDetails:function(a){if(this.detailsView){this.closeDetails()}this.detailsView=new JIRA.Components.Filters.Views.Details({model:this.model,triggerEl:a});this.listenTo(this.detailsView,"close",this.closeDetails);this.detailsView.render()},show:function(a){if(this.view){this.close()}this.view=new JIRA.Components.Filters.Views.Header({el:a.el});this.isInvalid=false;this.listenTo(this.view,{saveAs:function(b){if(!JIRA.Issues.LoginUtils.isLoggedIn()||this.isInvalid){return}this.trigger("saveAs",b.model)},save:function(b){if(!JIRA.Issues.LoginUtils.isLoggedIn()||this.isInvalid){return}this.trigger("save",b.model)},discard:function(){this.trigger("discard")},details:function(b){this.showDetails(b)},toogleFavourite:function(d){var c=d.model;if(!c){return}var b=!!c.getFavourite();c.saveFavourite(!b);if(!b){this.trigger("favourite",c)}},close:this.close});this.update(a)},update:function(a){if(!this.view){return}this.isInvalid=false;this.view.render({model:a.model,isDirty:a.isDirty});this.model=a.model},markAsInvalid:function(){if(this.view){this.view.markAsInvalid()}this.isInvalid=true}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/templates/issuenav-filter.soy' */
// This file was automatically generated from issuenav-filter.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavFilter == 'undefined') { JIRA.Templates.IssueNavFilter = {}; }


JIRA.Templates.IssueNavFilter.collapsedFiltersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="toggle-filter-panel" href="#" title="', soy.$$escapeHtmlAttribute(AJS.format("Dock the filters panel ({0})",'[')), '"></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavFilter.filtersPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="filters-content"><h4 class="filter-title">', soy.$$escapeHtml("Filters"), '</h4><ul class="filter-options"><li><a href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/issues/?jql=" class="new-search aui-button" title="', soy.$$escapeHtmlAttribute("Create a new search filter"), '">', soy.$$escapeHtml("New filter"), '</a></li><li><a class="find-filters" href="', soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri("")), '/secure/ManageFilters.jspa?filterView=search">', soy.$$escapeHtml("Find filters"), '</a></li></ul><div class="filter-panel-system-container"></div><div class="filter-panel-favourites-container"></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelView.js' */
Backbone.define("JIRA.Issues.FilterPanelView",JIRA.Issues.BaseView.extend({events:{"simpleClick .system-filters a.filter-link:not(.requires-login)":"_onClickFilter","simpleClick .new-search":"_onClickNewSearch","click .ui-dock":"_onDockFilterPanelClick","click .ui-undock":"_onUndockFilterPanelClick"},collapsedTemplate:JIRA.Templates.IssueNavFilter.collapsedFiltersPanel,template:JIRA.Templates.IssueNavFilter.filtersPanel,initialize:function(a){_.bindAll(this,"adjustFavouriteFiltersHeight");if(a.easeOff){this._adjustFavouriteFiltersHeight=_.debounce(this._adjustFavouriteFiltersHeight,a.easeOff)}JIRA.Issues.onVerticalResize(this.adjustFavouriteFiltersHeight);this.panelReady=jQuery.Deferred();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,_.bind(function(c,b){if(b){delete this._splitViewSidebarElement}else{this._splitViewSidebarElement=AJS.$(".list-results-panel:first")}},this))},adjustFavouriteFiltersHeight:function(){var e=AJS.$(".jira-feedback-link-container.subtle-style").outerHeight(true),c=e?e+10:0,b=this.$(".favourite-filters"),a=b.length&&b.offset().top,d=window.innerHeight;b.css("height",d-a-c)},_onDockFilterPanelClick:function(){AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed")},_onUndockFilterPanelClick:function(){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed")},toggleDockState:function(){this.$el.popoutSidebar("toggle")},_onClickFilter:function(b){b.preventDefault();var a=jQuery(b.target).data("id");this.trigger("filterSelected",a)},_onClickNewSearch:function(a){a.preventDefault();this.trigger("filterSelected",null)},render:function(){if(!this.model.isDocked()){AJS.$(".navigator-container").addClass("navigator-sidebar-collapsed");this._renderCollapsed()}else{AJS.$(".navigator-container").removeClass("navigator-sidebar-collapsed");this._renderOpen()}var a=AJS.KeyboardShortcut.getKeyboardShortcutKeys("toggle.filter.panel");this.$el.popoutSidebar({isDocked:this.model.isDocked(),expandedWidth:this.model.getWidth(),renderExpanded:_.bind(this._renderOpen,this),renderCollapsed:_.bind(this._renderCollapsed,this),undockText:"Undock",undockTitle:AJS.format("Undock the filter panel so it is hidden when not being focused (Type \'\'{0}\'\')",a),dockText:"Dock",dockTitle:AJS.format("Dock the filter panel so you can always see the list of filters (Type \'\'{0}\'\')",a),toggleTarget:".filter-title:first",persist:_.bind(function(c,b){this.model.setDocked(c);this.model.setWidth(b)},this),resize:_.bind(function(){this._splitViewSidebarElement&&this._splitViewSidebarElement.sidebar("updatePosition")},this)});if(this.model.shouldShowDockIntro()){this.$el.popoutSidebar("collapse",false)}if(this.model.isDocked()){this.$el.popoutSidebar("renderDockState")}this._fireDockAnalytics();this.panelReady.resolve();return this.$el},_fireDockAnalytics:function(){if(localStorage.getItem("dockStatesAnalyticsEnabled")){var a=this.model.isDocked();if(localStorage.getItem("dockStateAnalytic")!==""+a){localStorage.setItem("dockStateAnalytic",a);JIRA.Issues.Application.execute("analytics:trigger","kickass.filters.docked",{isDocked:this.model.isDocked()})}}},_renderCollapsed:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().addClass("left noborder");this.$el.addClass("collapsed").html(this.collapsedTemplate({isDocked:this.model.isDocked()}));this.trigger("renderCollapsed");JIRA.Issues.triggerHorizontalResize();a.appendTo("body");return this},_renderOpen:function(){var a=jQuery(".jira-feedback-link-container.subtle-style").detach().removeClass("left noborder");this.$el.removeClass("collapsed");this.$el.width(this.model.getWidth());this.$el.html(this.template({}));this.trigger("renderOpen");a.appendTo(this.$el);JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.filterPanelOpened]);JIRA.Issues.triggerHorizontalResize();return this},_renderSelectedFilter:function(){}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/Browser.js' */
(function(a){AJS.namespace("JIRA.Issues.Browser");JIRA.Issues.Browser={getWindowWidth:function(){return window.innerWidth}}}(AJS.$));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterPanelModel.js' */
(function(){var b="issues.sidebar.docked";var a="issues.sidebar.width";Backbone.define("JIRA.Issues.FilterPanelModel",JIRA.Issues.BaseModel.extend({properties:["activeFilter"],defaults:{activeFilter:null},initialize:function(c,d){_.extend(this,_.defaults(d,{storage:window.localStorage}))},setDocked:function(c){this._getStorage().setItem("dockStatesAnalyticsEnabled",true);return this._getStorage().setItem(b,c)},setWidth:function(c){return this._getStorage().setItem(a,c)},getWidth:function(){var c=parseInt(this._getStorage().getItem(a),10);return((c>0)?c:200)},_getStorage:function(){return this.storage||window.localStorage},isDockedPrefGiven:function(){return this._getStorage().getItem(b)!==null},shouldShowDockIntro:function(){return !this.isDocked()&&!this.isDockedPrefGiven()},isExpanded:function(){return this.shouldShowDockIntro()?false:this.isDocked()},isDocked:function(){var c=this._getStorage();return c.getItem(b)==null||c.getItem(b)==="true"}}))}());
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/filters/FilterModule.js' */
Backbone.define("JIRA.Issues.FilterModule",JIRA.Issues.BaseEvented.extend({initialize:function(a){this._searchPageModule=a.searchPageModule;this.filterPanelModel=a.filterPanelModel||new JIRA.Issues.FilterPanelModel({},{searchPageModule:a.searchPageModule});this.filtersComponent=new JIRA.Components.Filters({systemFilters:a.systemFilters,searchPageModule:this._searchPageModule});this.filtersComponent.fetchFavouriteFilters();this.filtersComponent.on("newFilter",function(b){this._searchPageModule.filterModuleSaved(b);if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._searchPageModule.setSessionSearch(b)}},this);this.filtersComponent.on("filterRemoved",function(b){this.trigger("filterRemoved",b)},this);this.filtersComponent.on("filterSelected",this._onFilterSelected,this);this.filtersComponent.on("filterDiscarded",function(){this._searchPageModule.discardFilterChanges()},this);this.filtersComponent.on("savedFilter",function(b){this._searchPageModule.setSessionSearch(b);this.filtersComponent.highlightFilter(b)},this);this._searchPageModule.on("change changeFilterProps",function(){this.filtersComponent.updateFilterHeader({model:this._searchPageModule.getFilter(),isDirty:this._searchPageModule.isDirty()})},this);this.filterPanelModel.bind("change:activeFilter",this._markFilterAsActive,this);this.filterPanelModel.set("activeFilter",this._searchPageModule.getFilter());this._searchPageModule.bind("change:filter",function(b,c){this.filterPanelModel.set("activeFilter",c)},this)},canEditColumns:function(){var a=this._searchPageModule.getFilter();return a&&a.isMyFilter()},initSystemFilters:function(){return this.filtersComponent.fetchSystemFilters()},getFilterById:function(a){return this.filtersComponent.getFilterById(a)},createView:function(a){this.filterPanelView=new JIRA.Issues.FilterPanelView({el:a.$filterPanelEl,model:this.filterPanelModel,searchPageModule:this._searchPageModule,easeOff:(!!jQuery.browser.msie&&jQuery.browser.version<=8)?500:0});this.filterPanelView.on("renderOpen",function(){this.filtersComponent.showSystemFilters(this.filterPanelView.$el.find(".filter-panel-system-container"));this.filtersComponent.showFavouriteFilters(this.filterPanelView.$el.find(".filter-panel-favourites-container"));this._markFilterAsActive();this.filterPanelView.adjustFavouriteFiltersHeight()},this);this.filterPanelView.on("filterSelected",this._onFilterSelected,this);this.filterPanelView.render();return this.filterPanelView},_markFilterAsActive:function(){var a=this.filterPanelModel.get("activeFilter");this.filtersComponent.highlightFilter(a)},toggleFilterPanel:function(){this.filterPanelView.toggleDockState()},createHelptipForFilterPanelDocking:function(c){var b;var d=this.filterPanelModel;var a=this.filterPanelView;if(d.shouldShowDockIntro()&&a.$el.is(":visible")){b=new AJS.HelpTip({id:"filters-dock-intro",title:"Did you notice?",bodyHtml:"You can dock the filter bar to always show your list of filters.",anchor:".ui-dock",isSequence:true,weight:c,callbacks:{beforeShow:function(){a.$el.popoutSidebar("expand",false)},init:function(){if(a.$el.popoutSidebar("isUndocked")){a.$el.popoutSidebar("unbindHoverIntent")}},hide:function(){if(a.$el.popoutSidebar("isUndocked")){a.$el.popoutSidebar("bindHoverIntent");a.$el.popoutSidebar("collapse")}}}})}return b},_onFilterSelected:function(a){if(a===null){this._searchPageModule.resetToBlank({isNewSearch:true})}else{this._searchPageModule.resetToFilter(a)}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-filter', location = 'content/js/search/util/WindowPositioning.js' */
JIRA.Issues.WindowPositioning=AJS.InlineLayer.StandardPositioning.extend({_calculateOverflow:function(c){var b=this.layer().css("position")==="fixed",a=c.top+this.layer().outerHeight(true),e=window.innerHeight,d=jQuery(window).scrollTop();if(b){return Math.max(0,a-e)}else{return Math.max(0,a-d-e)}},left:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left+=this.offsetTarget().outerWidth();a.top-=b}return a},right:function(){var a=this._super(),b=this._calculateOverflow(a);if(b>0){a.left-=this.offsetTarget().outerWidth();a.top-=b}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common-templates', location = 'content/templates/issuenav.soy' */
// This file was automatically generated from issuenav.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNav == 'undefined') { JIRA.Templates.IssueNav = {}; }


JIRA.Templates.IssueNav.issueTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<thead><tr></tr></thead><tbody></tbody>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-type issue-icon-result persist-result"><div>', soy.$$escapeHtml("T"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_issuetype = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-type issue-icon-result persist-result"><img src="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.name), '" title="', soy.$$escapeHtml(opt_data.issue.fields.issuetype.description), '" align="absmiddle" border="0" height="16" width="16"></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-key persist-result"><div>', soy.$$escapeHtml("Key"), '</div></th><th class="issue-summary issue-text-result persist-result"><div>', soy.$$escapeHtml("Summary"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_keysummary = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-key-summary issue-text-result persist-result" colspan="2"><div><a href="', soy.$$escapeHtml(opt_data.contextPath), '/browse/', soy.$$escapeHtml(opt_data.issue.key), '" class="issue"><span class="secondary-text">', soy.$$escapeHtml(opt_data.issue.key), '</span>', soy.$$escapeHtml(opt_data.issue.fields.summary), '</a></div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-status"><div>', soy.$$escapeHtml("Status"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-status"><div class="status-lozenge">', soy.$$escapeHtml(opt_data.issue.fields.status.name), '</div></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-user"><div>', soy.$$escapeHtml("Assignee"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-user">', (opt_data.issue.fields.assignee) ? '<img src="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.avatarUrls['16x16']) + '" alt="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" height="16" width="16" /><a class="user-hover" rel="' + soy.$$escapeHtml(opt_data.issue.fields.assignee.name) + '" href="#">' + soy.$$escapeHtml(opt_data.issue.fields.assignee.displayName) + '</a>' : soy.$$escapeHtml("Unassigned"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-datetime"><div>', soy.$$escapeHtml("Updated"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_updated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-datetime"><time datetime="', soy.$$escapeHtml(opt_data.issue.fields.updated), '">', soy.$$escapeHtml(opt_data.TMP_FORMATTED_DATE), '</time></td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.columnHeader_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<th class="issue-resolution"><div>', soy.$$escapeHtml("Resolution"), '</div></th>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.column_resolution = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="issue-resolution">', (opt_data.issue.fields.resolution) ? soy.$$escapeHtml(opt_data.issue.fields.resolution.name) : soy.$$escapeHtml("Unresolved"), '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNav.issueResultsError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="error"><td colspan="', soy.$$escapeHtml(opt_data.columnCount), '">', soy.$$escapeHtml(opt_data.errorText), '</td></tr>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/ColumnPicker.js' */
JIRA.Issues.ColumnPicker=JIRA.Components.ColumnPicker.extend({initialize:function(a,b){var c=[this._getUserColumnProvider(),this._getFilterColumnProvider()];if(JIRA.isAdmin()){c.push(this._getSystemColumnProvider())}JIRA.Components.ColumnPicker.prototype.initialize.call(this,null,{providers:c});this.search=b.search;this.search.on("change:filter",function(){var d=this.filterColumn;var f=d.isEditDisabled();var e=d.isDisabled();d.trigger("change:isDisabled",d,e);d.trigger("change:editDisabled",d,e||f)},this)},isSystemMode:function(){return this.columnPickerModel.getColumnConfig()==="system"},sanitizeColumnConfig:function(a){a=a.toLowerCase();var b=a=="system"&&!this.isSystemMode();return b?"user":a},syncColumns:function(a,b){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.syncColumns.call(this,a,b)},clearFilterConfiguration:function(){this.filterColumn.unset("columns");this.filterColumn.unset("savedColumns")},setCurrentColumnConfig:function(a){a=this.sanitizeColumnConfig(a);return JIRA.Components.ColumnPicker.prototype.setCurrentColumnConfig.call(this,a)},_getFilterColumnProvider:function(){var a=this;return this.filterColumn=JIRA.Issues.ColumnConfigModel.create("filter","Filter",{url:function(){return AJS.contextPath()+"/rest/api/2/filter/"+a.search.getState().filter+"/columns"},isDisabled:function(){return !a.search.getFilter()||a.search.getFilter().getIsSystem()},isEditDisabled:function(){return !a.search.filterModule.canEditColumns()},shouldRefreshSearchOnActivation:function(){return this.has("savedColumns")},shouldCloseOnActivation:function(){return this.has("savedColumns")},shouldLoadDefaultsOnActivation:function(){return !this.has("savedColumns")},defaultColumns:_.bind(function(){if(this.userColumns.has("columns")){var b=jQuery.Deferred();b.resolve(_.map(this.userColumns.getColumns(),function(c){return{value:c}}));return b.promise()}else{return jQuery.ajax(this.userColumns.url()).promise()}},this)})},_getSystemColumnProvider:function(){return JIRA.Issues.ColumnConfigModel.create("system","System",{url:_.lambda(AJS.contextPath()+"/rest/api/2/settings/columns"),defaultColumns:function(){return jQuery.ajax(this.url()).promise()},shouldRefreshSearchOnActivation:function(){return true},shouldCloseOnActivation:function(){return false},shouldLoadDefaultsOnActivation:function(){return true},shouldRevertOnHide:function(){return false}})},_getUserColumnProvider:function(){this.userColumns=JIRA.Issues.ColumnConfigModel.create("user","My Defaults",{url:_.lambda(AJS.contextPath()+"/rest/api/2/user/columns")});return this.userColumns}});JIRA.Issues.ColumnPicker.create=function(a){return new JIRA.Issues.ColumnPicker(null,a)};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/IssueTableView.js' */
(function(a){Backbone.define("JIRA.Issues.IssueTableView",JIRA.Issues.BaseView.extend({syncSystemModeMessage:function(){var c=a("#system-mode-warning-msg");var d=this.columnConfig.isSystemMode();if(d&&!c.length){var b=JIRA.Messages.showWarningMsg("You are on System Mode. The column changes might affect all users. \u003ca href=# class=exit\u003eExit System Mode\u003c/a\u003e.",{id:"system-mode-warning-msg",closeable:false,timeout:0});b.find(".exit").click(_.bind(function(f){f.preventDefault();this.columnConfig.setCurrentColumnConfig("user")},this))}else{c.remove()}},initialize:function(b){this.columnConfig=b.columnConfig;this.columnConfig.on("change:columnConfig",this.syncSystemModeMessage,this);JIRA.Issues.onVerticalResize(_.bind(this.adjustColumnConfigHeight,this))},deactivate:function(){JIRA.Issues.offVerticalResize(this.adjustColumnConfigHeight)},_onSearchDone:function(b){this.columnConfig.setElement(b.find(".column-picker-trigger-container")).render()},adjustColumnConfigHeight:function(){this.columnConfig.adjustHeight()}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-table', location = 'content/js/components/table/HeaderOperationsView.js' */
JIRA.Issues.IssueTableHeaderOperationsView=JIRA.Issues.BaseView.extend({initialize:function(a){_.bindAll(this,"_onSearchSuccess","_updateFilterPageResources");_.extend(this,a);this.initTools();this.initViews();this.initShare();this._results=this.search.getResults();this._results.onNewPayload(this._onSearchSuccess)},initViews:function(){var a=this.searchPageModule;a.on("change",this._updateFilterPageResources);this._updateFilterPageResources();new JIRA.Issues.Tipsy({el:this.$el.find(".header-views"),showCondition:":not(.active)"});var b=this._spinnerTimeoutKeeper(".header-views");AJS.Dropdown.create({styleClass:"header-views-menu aui-style-default",trigger:AJS.$(".header-views",this.$el),ajaxOptions:function(){var d={jql:a.getEffectiveJql()},c=a.getFilter();if(c&&!c.getIsSystem()){d.filterId=c.getId();if(a.isDirty()){d.jql=a.getJql();d.modified=true}}b.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/views",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:d,dataType:"json",cache:false,formatSuccess:function(e){b.end();return AJS.$(JIRA.Templates.IssueNavTable.views({sections:e,contextPath:contextPath}))}}}})},initTools:function(){var a=this,b=this.searchPageModule;AJS.$("body").delegate("#use-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("user");a.searchPageModule.columnConfig.refreshSearchWithColumns()});AJS.$("body").delegate("#use-filter-cols","click",function(d){d.preventDefault();a.searchPageModule.columnConfig.setCurrentColumnConfig("filter");a.searchPageModule.columnConfig.refreshSearchWithColumns()});new JIRA.Issues.Tipsy({el:this.$el.find(".header-tools"),showCondition:":not(.active)",tipsy:{gravity:"ne"}});var c=this._spinnerTimeoutKeeper(".header-tools");AJS.Dropdown.create({styleClass:"header-tools-menu",trigger:AJS.$(".header-tools",a.$el),ajaxOptions:function(){var e,d=b.getFilter();e={jql:b.getEffectiveJql(),searchResultsTotal:a._results.getTotal(),searchResultsPages:a._results.getNumberOfPages(),useColumns:a.searchPageModule.columnConfig.getCurrentColumnConfig().getName()!="user",skipColumns:b.getActiveLayout().id==="split-view"};if(d&&!d.getIsSystem()){e.filterId=d.getId();if(b.isDirty()){e.jql=b.getJql()}}c.start();return{url:contextPath+"/rest/issueNav/1/issueNav/operations/tools",type:"POST",headers:JIRA.Issues.XsrfTokenHeader,data:e,dataType:"json",cache:false,formatSuccess:function(f){c.end();if(f&&f.length==0){return AJS.$('<div class="menu-empty-content"></span>'+"No Available Option(s)"+"<div>")}else{return AJS.$(JIRA.Templates.IssueNavTable.tools({groups:f,contextPath:contextPath}))}}}}})},initShare:function(){new JIRA.Issues.Tipsy({el:this.$el.find(".issuenav-share"),showCondition:":not(.active)"})},_onSearchSuccess:function(){AJS.$(".header-tools").toggle(this.search.getResults().getDisplayableTotal()>0)},_updateFilterPageResources:function(){var d=this.$el.find(".operations-view-data > fieldset"),b=this.searchPageModule;d.empty();if(b.getFilter()&&!b.isDirty()){AJS.$('<input type="hidden" id="filterId" />').val(b.getFilter().getId()).appendTo(d);AJS.$('<input type="hidden" id="jql" />').val("").appendTo(d)}else{AJS.$('<input type="hidden" id="filterId" />').val("");AJS.$('<input type="hidden" id="jql" />').val(b.getJql()).appendTo(d)}var c=b.getFilter(),a=c&&c.getId();if(a&&!c.getIsSystem()&&!b.isDirty()){AJS.Meta.set("filter-id",a);AJS.Meta.set("filter-jql",undefined)}else{AJS.Meta.set("filter-id",undefined);AJS.Meta.set("filter-jql",b.getEffectiveJql())}},_spinnerTimeoutKeeper:function(a){var b=undefined;return{start:function(){if(b){b=clearTimeout(b)}b=setTimeout(function(){b=undefined;AJS.$(a).addClass("spinner")},1000)},end:function(){b=clearTimeout(b);AJS.$(a).removeClass("spinner")}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'util/utils.js' */
_.mixin({lambda:function(a){return function(){return a}},isNotBlank:function(a){return !!a}});if(!JIRA.Issues){JIRA.Issues={}}JIRA.bind(JIRA.Events.CHECKBOXMULITSELECT_READY,function(b,a){a.closest(".form-body").addClass("checkboxmultiselect-container")});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/util.soy' */
// This file was automatically generated from util.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issues == 'undefined') { JIRA.Templates.Issues = {}; }
if (typeof JIRA.Templates.Issues.ComponentUtil == 'undefined') { JIRA.Templates.Issues.ComponentUtil = {}; }


JIRA.Templates.Issues.ComponentUtil.throbber = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="icon throbber" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.simpleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a', (opt_data.link.id) ? ' id="' + soy.$$escapeHtml(opt_data.link.id) + '"' : '', 'href="', (opt_data.link.href) ? soy.$$escapeHtml(opt_data.link.href) : '#', '"', (opt_data.link.styleClass || opt_data.additionalStyleClass) ? 'class="' + soy.$$escapeHtml(opt_data.link.styleClass) + ((opt_data.additionalStyleClass) ? ' ' + soy.$$escapeHtml(opt_data.additionalStyleClass) : '') + '"' : '', (opt_data.link.title) ? 'title="' + soy.$$escapeHtml(opt_data.link.title) + '"' : '', '><span>', soy.$$escapeHtml(opt_data.link.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueNotFound = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("issues.components.query.search.selected.issue.nonexistent.html",opt_data.issueAnchor));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.issueAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="issue-key" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.issueKey), '"> ', soy.$$escapeHtml(opt_data.issueKey), ' </a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.buildMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length == 1) {
    output.append(soy.$$escapeHtml(opt_data.messages[0]));
  } else {
    output.append('<ul>');
    var messageList52 = opt_data.messages;
    var messageListLen52 = messageList52.length;
    for (var messageIndex52 = 0; messageIndex52 < messageListLen52; messageIndex52++) {
      var messageData52 = messageList52[messageIndex52];
      output.append('<li>', soy.$$escapeHtml(messageData52), '</li>');
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.auiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.messages.length > 0) {
    output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.typeClass), '"><span class="aui-icon icon-', soy.$$escapeHtml(opt_data.typeClass), '"></span>');
    JIRA.Templates.Issues.ComponentUtil.buildMessage(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'error', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.warningMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: opt_data.messages ? opt_data.messages : [opt_data.msg]}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issues.ComponentUtil.anonymousErrorDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-dialog-content"><div class="form-body"><h2 class="dialog-title">', soy.$$escapeHtml("Session Expired"), '</h2>');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'warning', messages: ["It looks like your session has timed out, or you have been logged out of JIRA. You will need to log back in to continue."]}, output);
  output.append('</div><div class="buttons-container form-footer"><div class="buttons"><a accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button submit" href="', soy.$$escapeHtml(""), '/login.jsp?os_destination=', soy.$$escapeHtml(opt_data.redirect), '">', soy.$$escapeHtml("Log in again"), '</a><a accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="aui-button aui-button-link cancel">', soy.$$escapeHtml("Ignore"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SingleSelectMixin.js' */
AJS.namespace("JIRA.Issues.Mixin.SingleSelect");JIRA.Issues.Mixin.SingleSelect={namedAttributes:["collection"],selectById:function(a){this.setSelected(this.getCollection().get(a))},selectAt:function(a){this.setSelected(this.getCollection().at(a))},clearSelection:function(){this.setSelected()},next:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.first())}}else{var b=c.indexOf(d);var a=(b+1)%c.length;this.setSelected(c.at(a))}},prev:function(){var d=this.getSelected(),c=this.getCollection();if(!d){if(c.length>0){this.setSelected(c.last())}}else{var b=c.indexOf(d);var a=(b+c.length-1)%c.length;this.setSelected(c.at(a))}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-basic.soy' */
// This file was automatically generated from query-basic.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryBasic == 'undefined') { JIRA.Templates.IssueNavQueryBasic = {}; }


JIRA.Templates.IssueNavQueryBasic.basicQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container">', (opt_data.hasOrderBy) ? '<div class="list-ordering-container"><div class="list-ordering"></div></div>' : '', '<div class="search-criteria-container"><div class="search-criteria"><ul class="criteria-list"><li class="text-query hidden"><div class="text-query-container"><input class="search-entry text ajs-dirty-warning-exempt" id="searcher-query" type="text" name="text" placeholder="', soy.$$escapeHtmlAttribute("Contains text"), '" /></div></li><li class="criteria-actions"></li>', (opt_data.hasSearchButton) ? '<li><button class="aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtmlAttribute("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button></li>' : '', '</ul></div><div class="search-criteria-extended"><ul class="criteria-list"></ul></div></div></div><div class="search-options-container"><div class="mode-switcher"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" data-id="', soy.$$escapeHtmlAttribute(opt_data.id), '" class="criteria-selector aui-button aui-button-subtle drop-arrow" /><a href="#" class="remove-filter" title="', soy.$$escapeHtmlAttribute("Remove criterion"), '" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-remove"></span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="criteria-wrap">', (opt_data.extended || ! opt_data.viewHtml) ? '<span class="fieldLabel">' + soy.$$escapeHtml(opt_data.name) + ':</span> ' : '', (opt_data.viewHtml) ? opt_data.viewHtml : soy.$$escapeHtml("All"), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="issue-filter" action="#" class="searchfilter aui top-label aui-popup-content"><div class="form-body"></div>', (opt_data.displayBackButton) ? '<a href="#" class="back">' + soy.$$escapeHtml("Back") + '</a>' : '', (opt_data.displayUpdateCancel) ? '<div class="buttons-container form-footer"><div class="buttons"><input type="submit" name="filter" class="aui-button filter" value="' + soy.$$escapeHtmlAttribute("Update") + '" /><a href="#" class="aui-button aui-button-link cancel-update">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '', '</form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-no-edit-content">');
  JIRA.Templates.Issues.ComponentUtil.auiMessage({typeClass: 'info', messages: [AJS.format("To search by {0} please switch to advanced.",opt_data.fieldName)]}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.clauseButtonView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button type="button" class="add-criteria aui-button ', (opt_data.isSubtle) ? 'aui-button-subtle' : '', ' drop-arrow" title="', soy.$$escapeHtmlAttribute("Add more fields to search with"), '">', soy.$$escapeHtml("More"), '</button>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="searcher-groups available"><ul>');
  var groupList71 = opt_data.searcherGroups;
  var groupListLen71 = groupList71.length;
  for (var groupIndex71 = 0; groupIndex71 < groupListLen71; groupIndex71++) {
    var groupData71 = groupList71[groupIndex71];
    output.append('<li class="twixi-block ', (groupIndex71 == 0) ? 'expanded' : 'collapsed', '" data-id="', soy.$$escapeHtmlAttribute(groupData71.id), '"><div class="twixi-trigger">', soy.$$escapeHtml(groupData71.name), '</div><ul class="twixi-content">');
    var searcherList83 = groupData71.searchers;
    var searcherListLen83 = searcherList83.length;
    for (var searcherIndex83 = 0; searcherIndex83 < searcherListLen83; searcherIndex83++) {
      var searcherData83 = searcherList83[searcherIndex83];
      output.append('<li><a href="#" data-id="', soy.$$escapeHtmlAttribute(searcherData83.id), '" class="searcher-option" >', soy.$$escapeHtml(searcherData83.name), '</a></li>');
    }
    output.append('</ul></li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><a href="#" class="aui-button aui-button-link">', soy.$$escapeHtml("Close"), '</a></div></div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextQueryBuilder.js' */
AJS.namespace("JIRA.Issues.TextQueryBuilder");JIRA.Issues.TextQueryBuilder={BACKSLASH_PATTERN:/\\/g,MULTIPLE_WHITESPACE_PATTERN:/\s+/g,QUOTE_PATTERN:/\"/g,DOUBLE_BACKSLASH:"\\\\",buildJql:function(a){if(!a){return""}a=""+a;a=AJS.$.trim(a);a=a.replace(this.BACKSLASH_PATTERN,this.DOUBLE_BACKSLASH);a=a.replace(this.MULTIPLE_WHITESPACE_PATTERN," ");a=a.replace(this.QUOTE_PATTERN,'\\"');return this.createQueryClause(a)},createQueryClause:function(a){return'text ~ "'+a+'"'}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryModule.js' */
JIRA.Issues.BasicQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlTooComplex","searchRequested","basicModeCriteriaCountWhenSearching","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.searcherCollection=new JIRA.Issues.SearcherCollection([],{fixedLozenges:a.primaryClauses,queryStateModel:a.queryStateModel,initData:a.initialSearcherCollectionState});this.view=new JIRA.Issues.BasicQueryView({queryStateModel:a.queryStateModel,searcherCollection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this);this.searcherCollection.onSearchRequested(_.bind(function(b){this.triggerBasicModeCriteriaCountWhenSearching({count:this.searcherCollection.getAllSelectedCriteriaCount()});var c=this._attachOrderByClause(b);this.triggerSearchRequested(c)},this));this.searcherCollection.onJqlTooComplex(_.bind(function(b){this.triggerJqlTooComplex(b)},this))},hasErrors:function(){var a=this.searcherCollection.any(function(b){return b.hasErrorInEditHtml()});return a},clear:function(){this.searcherCollection.clear()},queryChanged:function(){this.searcherCollection.restoreFromQuery(this._queryStateModel.getJql())},queryReset:function(a){this.searcherCollection.setInteractive(false);return this.searcherCollection.restoreFromQuery(a,true).always(_.bind(function(){this.searcherCollection.setInteractive(true)},this))},searchersReady:function(){return this.searcherCollection.searchersReady()},createView:function(){return this.view},getSelectedCriteria:function(){return this.searcherCollection.getAllSelectedCriteria()},_attachOrderByClause:function(a){var b=/\bORDER\s+BY\b.*$/i;var c=b.exec(this._queryStateModel.getJql());if(c&&b.exec(a)===null){a=a?a+" "+c[0]:c[0]}return a}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaView.js' */
JIRA.Issues.CriteriaView=JIRA.Issues.Brace.View.extend({tagName:"li",template:JIRA.Templates.IssueNavQueryBasic.criteriaButton,contentTemplate:JIRA.Templates.IssueNavQueryBasic.criteriaButtonContent,events:{click:"hideTipsy","click .criteria-selector":"_onClickCriteriaSelector","click .remove-filter":"_onClickRemoveCriteria","mousedown .remove-filter":"_preventFocusWhileDisabled",keydown:"_onKeydown"},initialize:function(a){this.extended=a.extended;this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this.update,this);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.bind("change:isSelected",this._onCriteriaSelectionChanged,this);JIRA.Issues.SearcherDialog.instance.onHide(_.bind(this._addTooltip,this));JIRA.Issues.SearcherDialog.instance.onShow(_.bind(this._onCriteriaDialogShow,this))},render:function(){this.$el.html(this.template({id:this.model.getId()}));this.$el.attr("data-id",this.model.getId());if(this.extended){this.$el.addClass("extended-searcher")}this.update();this.prepareForDisplay()},prepareForDisplay:function(){this._addTooltip();this.delegateEvents()},hideTipsy:function(){if(this.tipsy){this.tipsy.hide()}},update:function(){var g=this.searcherCollection.length===0;var f=this._getSearcher();var b=this._isValidSearcher();var e=!g&&!f;var a=g||!b;var d=this.$("button");var c=this.$(".remove-filter");this.$el.toggleClass("hidden",e);d.attr("aria-disabled",a?"true":null).html(this.contentTemplate({name:f&&f.getName()||this.model.getName(),viewHtml:f&&f.getViewHtml(),extended:this.extended}));this.$el.toggleClass("invalid-searcher",!b).toggleClass("partial-invalid-searcher",(b&&d.find(".invalid_sel").length!==0));c.toggle(!b||!!this.extended);return this},destroy:function(){this.hideTipsy();this.$el.remove()},_getSearcher:function(){return this.searcherCollection.get(this.model.getId())},_isValidSearcher:function(){var a=this._getSearcher();return !a||!(a.getValidSearcher()===false)},_containsInvalidValue:function(a){return(AJS.$(a.getViewHtml()).find(".invalid_sel").length>0)},_showDialog:function(){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.show(this._getSearcher())}},_removeCriteria:function(b){var a=this.extended||!this._isValidSearcher();if(this.searcherCollection.isInteractive()&&a){this.searcherCollection.triggerBeforeCriteriaRemoved(this.model.getId(),b);_.defer(_.bind(function(){this.searcherCollection.clearClause(this.model.getId())},this))}},_getTooltipText:function(){var b=this.searcherCollection.get(this.model.getId());var a;if(!this._isValidSearcher()){a="This criteria is not valid for the project and/or issue type"}else{if(this._containsInvalidValue(b)){a="This criteria contains invalid value(s)"}else{a=b.getTooltipText()}}return b&&a||""},_addTooltip:function(){this.tipsy=new JIRA.Issues.Tipsy({el:this.$el,showCondition:this.searcherCollection.isInteractive,tipsy:{title:_.bind(this._getTooltipText,this)}})},_handleInteractiveChanged:function(a){this.$("button, .remove-filter").attr("aria-disabled",(a)?null:"true")},_onClickCriteriaSelector:function(a){if(this.searcherCollection.isInteractive()&&this._getSearcher()&&this._isValidSearcher()){JIRA.Issues.SearcherDialog.instance.toggle(this._getSearcher())}a.preventDefault()},_onClickRemoveCriteria:function(a){this._removeCriteria();a.preventDefault()},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog();break;case AJS.$.ui.keyCode.ESCAPE:this.$("button:focus").blur();break;case AJS.$.ui.keyCode.BACKSPACE:this._removeCriteria(-1);break;case AJS.$.ui.keyCode.DELETE:this._removeCriteria(1);break;default:return}a.preventDefault()},_onCriteriaDialogShow:function(){var a=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher();if(a==this._getSearcher()){this.tipsy&&this.tipsy.remove()}},_preventFocusWhileDisabled:function(a){if(jQuery(a.target).closest("[aria-disabled=true]").length>0){a.preventDefault()}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherModel.js' */
JIRA.Issues.SearcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","isShown","viewHtml","editHtml","groupId","groupName","initParams","isSelected","jql","position","serializedParams","validSearcher","key","lastViewed"],namedEvents:["readyForDisplay"],initialize:function(){this._onEditHtmlUpdated();this.bind("change:editHtml",this._onEditHtmlUpdated,this)},parse:function(a){if(a.viewHtml){a.viewHtml=this._cleanViewHtml(a.viewHtml)}return a},_cleanViewHtml:function(b){var a=AJS.$("<div/>").appendCatchExceptions(b);a.find(".fieldLabel").remove();a.find("a").replaceWith(function(){return AJS.$(this).html()});a.find(".searcherValue").slice(0,-1).each(function(){AJS.$(this).after("-")});a.find("*").removeAttr("title");return a.html()},createOrUpdateClauseWithQueryString:function(a){return this.collection.createOrUpdateClauseWithQueryString(this.id,a)},getQueryString:function(){var a={};if(this.collection.QUERY_ID===this.getId()){if(this.getViewHtml()){a[this.collection.QUERY_PARAM]=this.getDisplayText();return AJS.$.param(a)}return null}if((!this.getValidSearcher()||/^\s*$/.test(this.getEditHtml()))&&this.getJql()){a={};a[this.collection.JQL_INVALID_QUERY_PREFIX+this.getId()]=this.getJql();return AJS.$.param(a)}return this.getSerializedParams()},getDisplayText:function(){var a=this.getViewHtml();var c="";if(a){var b=AJS.$("<div>").appendCatchExceptions(a);c=AJS.$.trim(b.text()).replace(/[\n\r\s]+/g," ")}return c},hasClause:function(){if(this.collection.QUERY_ID===this.getId()){return !!this.getViewHtml()}else{if(!this.getValidSearcher()){return !!this.getJql()}else{return !!this.getQueryString()}}},clearSearchState:function(){this.set({viewHtml:null,editHtml:null,jql:null,validSearcher:null,isSelected:false})},_now:Date.now||function(){return new Date().getTime()},select:function(){this.set({isSelected:true,position:this.collection.getNextPosition(),validSearcher:true,lastViewed:this._now()})},retrieveEditHtml:function(){var a=this.collection.createJql();if(this.getEditHtml()){return jQuery.Deferred().resolve(this.getEditHtml())}return JIRA.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/QueryComponentRendererEdit!Default.jspa",success:_.bind(this.setEditHtml,this),dataType:"html",error:JIRA.Issues.displayFailSearchMessage,data:{fieldId:this.getId(),decorator:"none",jqlContext:a}})},hasErrorInEditHtml:function(){var a=jQuery("<div>").htmlCatchExceptions(this.getEditHtml());if(!a){return false}else{return a.find(".error, .has-errors").length>0}},clearEditHtml:function(){this.setEditHtml(null)},_onEditHtmlUpdated:function(){this.setSerializedParams(jQuery("<form/>").appendCatchExceptions(this.getEditHtml()).serialize())},getTooltipText:function(){if(this.getValidSearcher!==false){var a=this.getDisplayText()||"All";return this.getName()+": "+a}else{return "This criteria is not valid for the project and/or issue type"}},searchersReady:function(){return this.collection.searchersReady()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherCollection.js' */
JIRA.Issues.SearcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SearcherModel,namedEvents:["searchRequested","collectionChanged","jqlTooComplex","textFieldChanged","requestUpdateFromView","interactiveChanged","beforeCriteriaRemoved"],QUERY_PARAM:"text",QUERY_ID:"text",JQL_INVALID_QUERY_PREFIX:"__jql_",initialize:function(b,a){if(b&&b.length){this._searcherCache=b}this.fixedLozenges=a&&a.fixedLozenges?a.fixedLozenges:[];this.queryStateModel=a&&a.queryStateModel;this.initData=a&&a.initData;this._interactive=true},_createItemDescriptors:function(a){return _.map(a,function(b){return new AJS.ItemDescriptor({meta:{isShown:b.isShown},label:b.name,title:b.isShown?b.name:b.name+" "+"is not applicable for the current project and/or issue type.",selected:b.isSelected||b.jql,value:b.id})})},getAddMenuGroupDescriptors:function(){this._updateSearcherCache();var d=this.fixedLozengeIds().concat(this.QUERY_ID);var a=_.filter(this._searcherCache,function(e){var g=_.contains(d,e.id);var f=!!e.groupName;return !g&&f});if(a.length){var b=new AJS.GroupDescriptor({label:"All Criteria",items:this._createItemDescriptors(_.sortBy(a,function(e){return e.name.toLowerCase()}))});var c=new AJS.GroupDescriptor({label:"Recent Criteria",items:this._createItemDescriptors(_.first(_.sortBy(_.filter(a,function(e){return e.lastViewed}),function(e){return -e.lastViewed}),AJS.Meta.getNumber("max-recent-searchers")))});return[c,b]}else{return[]}},getSearcher:function(b){var a=this.get(b);if(!a){this.add(this._searcherCache[b]);a=this.get(b)}return a},setJql:function(b,a){this._addOrSet(b,{jql:a})},createJql:function(){var a=this.pluck("jql");return _.filter(a,_.isNotBlank).join(" AND ")||""},isDirty:function(){return this.any(function(a){return a.getJql()!==undefined&&a.getJql()!==""})},clearSearchState:function(){this.each(function(a){a.clearSearchState()});this._querySearchersAndValues("")},clearClause:function(c){var b=this.get(c);var a=b&&b.hasClause();if(b){b.clearSearchState()}this.triggerCollectionChanged();this.triggerRequestUpdateFromView();if(a){this.triggerSearchRequested(this.createJql())}},getTextQuery:function(){var a=this.get(this.QUERY_ID);return a?a.getViewHtml():""},setInteractive:function(a){if(a!==this._interactive){this._interactive=a;this.triggerInteractiveChanged(a)}},isInteractive:function(){return this._interactive},handleBasicViewSubmit:function(){this.triggerRequestUpdateFromView();this.triggerSearchRequested(this.createJql())},updateTextQuery:function(a){if(a){var b=AJS.escapeHtml(a);this._addOrSet(this.QUERY_ID,{viewHtml:b,editHtml:b,jql:JIRA.Issues.TextQueryBuilder.buildJql(a)})}else{this.remove(this.QUERY_ID)}this.triggerTextFieldChanged()},getQueryString:function(){var a=[];this.each(function(c){var b=c.getQueryString();if(b){a.push(b)}});return a.join("&")},_addOrSet:function(e,d,b){var a=this.get(e);if(a){if(b&&b.parse&&a.parse){d=a.parse(d);delete b.parse}if(d.jql){d.isSelected=true}a.set(d,b)}else{var c=_.clone(d);c.id=e;c.isSelected=!!d.jql;this.add(c,b);a=this.get(e)}return a},restoreFromQuery:function(a,d){this.queryStateModel.setJql(a);var c={jql:this.queryStateModel.getJql()||"",decorator:"none"};if(this.initData){if(!this.initData.errorMessages){this._onQuerySearchersAndValues(this.initData);this.initData=null;return jQuery.Deferred().resolve()}else{this._handleSearcherError(c.jql,this.initData);this.initData=null;return jQuery.Deferred().reject()}}else{var b=AJS.$.ajax({url:AJS.contextPath()+"/secure/QueryComponent!Jql.jspa",headers:{"X-SITEMESH-OFF":true},data:c,type:"POST"});b.success(_.bind(function(e){if(d){this.clearExpectingUpdate(d)}this._onQuerySearchersAndValues(e)},this));b.error(_.bind(function(h){if(d){this.clearExpectingUpdate()}try{var f=JSON.parse(h.responseText);if(f){this._handleSearcherError(c.jql,f)}}catch(g){console.log("search response error - not JSON?")}},this));b.always(function(){JIRA.trace("jira.search.searchers.updated")});return b}},clearExpectingUpdate:function(){this.reset();this.updateTextQuery("")},_handleSearcherError:function(a,b){if(_.include(b.errorMessages,"jqlTooComplex")||_.include(b.errorMessages,"jqlInvalid")){window.setTimeout(_.bind(function(){this.triggerJqlTooComplex(a)},this),0)}},searcherAffectsContext:function(a){return"project"===a||"issuetype"===a},createOrUpdateClauseWithQueryString:function(c,b){this.triggerRequestUpdateFromView();var a;if(this.searcherAffectsContext(c)){a=this._querySearchersAndValues(this.getQueryString())}else{a=this._querySearchersByValue(c)}a.done(_.bind(function(){if((this.queryStateModel.getBasicAutoUpdate()||b)&&!this.containsInvalidSearchers()){this.triggerSearchRequested(this.createJql())}},this));return a},containsInvalidSearchers:function(){return this.any(function(a){return a.hasErrorInEditHtml()})},_querySearchersByValue:function(d){var a=this.get(d);var c=AJS.$.param({decorator:"none",jqlContext:this.queryStateModel.getJql()});if(a){var b=a.getQueryString();if(b){c=c+"&"+b}}if(this._activeSearcherReq){this._activeSearcherReq.abort()}return this._activeSearcherReq=JIRA.SmartAjax.makeRequest({type:"POST",data:c,processData:false,url:contextPath+"/secure/QueryComponentRendererValue!Default.jspa",success:_.bind(function(f){var e=this.get(d);if(e){if(f[d]){f[d].groupName=e.getGroupName();f[d].groupId=e.getGroupId()}else{f[d]=_.extend(e.toJSON(),{editHtml:null,jql:null,viewHtml:null})}}this._setSearchersFromData(f,true)},this),dataType:"json",error:function(e){JIRA.Issues.displayFailSearchMessage(e)}}).always(_.bind(function(){this._activeSearcherReq=null},this))},_parseSearcherGroups:function(c){var a={};var b=this.queryStateModel.getWithout();_.each(c.groups,function(d){_.each(d.searchers,function(e){if(!_.contains(b,e.id)){e.groupId=d.type;e.groupName=d.title;a[e.id]=e}})});return a},_querySearchersAndValues:function(b){var a="decorator=none";if(this._activeSearcherReq){if(this._activeSearcherQuery===b){return jQuery.Deferred().reject()}this._activeSearcherReq.abort()}this._activeSearcherQuery=b;if(b){a+="&"+b}this._activeSearcherReq=AJS.$.ajax({url:contextPath+"/secure/QueryComponent!Default.jspa",headers:{"X-SITEMESH-OFF":true},type:"POST",data:a,processData:false});this._activeSearcherReq.done(_.bind(function(c){this._onQuerySearchersAndValues(c)},this));this._activeSearcherReq.fail(_.bind(function(c){JIRA.Issues.displayFailSearchMessage(c)},this));this._activeSearcherReq.always(_.bind(function(){this._activeSearcherReq=null},this));return this._activeSearcherReq},clear:function(){this.reset([],{silent:true});this.updateTextQuery("");this.triggerCollectionChanged()},searchersReady:function(){if(this._activeSearcherReq){return this._activeSearcherReq}else{return jQuery.Deferred().resolve()}},_onQuerySearchersAndValues:function(c){var d=this,a=this._parseSearcherGroups(c.searchers);_.each(c.values,_.bind(function(f,g){var e=a[g];if(!e){a[g]=f}else{_.extend(e,f)}},this));var b=[];this.each(function(f){var e=f.id;if(!_.any(a,function(g){return g.id===e})){if(f.getIsSelected()){f.setValidSearcher(false)}else{b.push(f)}}});if(b.length){this.remove(b)}this._setSearchersFromData(a)},_updateSearcherCache:function(){if(this._searcherCache){this.each(_.bind(function(a){this._searcherCache[a.id]=a.toJSON();this._searcherCache[a.id].id=a.id},this))}},_setSearchersFromData:function(a,b){_.each(a,_.bind(function(c,d){this._addOrSet(d,{groupId:c.groupId,groupName:c.groupName,isShown:c.isShown,name:c.name,viewHtml:c.viewHtml,jql:c.jql,editHtml:c.editHtml,validSearcher:c.validSearcher,key:c.key,lastViewed:c.lastViewed},{parse:true})},this));if(b){this._updateSearcherCache()}else{this._searcherCache=a}this.triggerCollectionChanged();JIRA.trace("jira.search.searchers.updated")},getVariableClauses:function(){var a=[];this.each(_.bind(function(b){if(!this.isFixed(b)&&b.hasClause()){a.push(b)}},this));return a},getSelectedCriteria:function(){var a=this;var b=function(c){return !a.isFixed(c)&&(c.hasClause()||c.getIsSelected())};return this.chain().filter(b).sortBy(function(c){return c.getPosition()}).value()},getAllSelectedCriteriaCount:function(){return this.getAllSelectedCriteria().length},getAllSelectedCriteria:function(){var a=[];this.each(_.bind(function(b){if(b.hasClause()||b.getIsSelected()){a.push(b)}},this));return a},isFixed:function(a){return _.contains(this.fixedLozengeIds(),a.getId())||a.getId()===this.QUERY_ID},fixedLozengeIds:function(){return _.pluck(this.fixedLozenges,"id")},getNextPosition:function(){return this.reduce(function(b,c){var a=Math.max(b,c.getPosition());return isNaN(a)?b:a},-1)+1}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CriteriaModel.js' */
JIRA.Issues.CriteriaModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/CardView.js' */
AJS.namespace("JIRA.Issues.CardView");JIRA.Issues.CardView=JIRA.Issues.Brace.View.extend({namedEvents:["viewChanged"],initialize:function(a){this.views=a.views;if(a.activeView){this.activeView=a.activeView}else{var b=_.keys(this.views);if(b.length>0){this.activeView=b[0]}}},render:function(){this._renderActiveView()},changeToView:function(a){if(a===this.activeView){return}this.activeView=a;if(this.$el){this._renderActiveView(a)}this.triggerViewChanged(a)},_renderActiveView:function(){var a=this.views[this.activeView];a.setElement(this.$el);a.render()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/BasicQueryView.js' */
JIRA.Issues.BasicQueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize","searchRequested"],template:JIRA.Templates.IssueNavQueryBasic.basicQueryView,initialize:function(a){this.searcherCollection=a.searcherCollection;this.queryStateModel=a.queryStateModel;this.textFieldView=new JIRA.Issues.TextFieldView({collection:this.searcherCollection});this.primaryCriteriaContainerView=new JIRA.Issues.PrimaryCriteriaContainerView({collection:this.searcherCollection});this.extendedCriteriaContainerView=new JIRA.Issues.ExtendedCriteriaContainerView({collection:this.searcherCollection}).onVerticalResize(this.triggerVerticalResize,this);if(this.queryStateModel.getBasicOrderBy()){this.basicOrderByView=JIRA.Components.OrderBy.create();this.queryStateModel.on("change:jql",function(){this.basicOrderByView.setJql(this.queryStateModel.getJql())},this);this.basicOrderByView.onSort(this.triggerSearchRequested,this)}this.clauseButtonView=new JIRA.Issues.ClauseButtonView({searcherCollection:this.searcherCollection,queryStateModel:this.queryStateModel});this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged,this);this.searcherCollection.onBeforeCriteriaRemoved(this._handleBeforeCriteriaRemoved,this)},_handleInteractiveChanged:function(a){this.$el.toggleClass("loading",!a)},_handleBeforeCriteriaRemoved:function(b,a){if(a){this._shiftFocus(b,a)}},hasPdl:function(){var a=AJS.Meta.get("version-number");if(a){return parseInt(a.charAt(0),10)>=6}},render:function(){this.$el.html(this.template({hasPdl:this.hasPdl(),hasOrderBy:this.queryStateModel.getBasicOrderBy(),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.primaryCriteriaContainerView.setElement(this.$el.find(".search-criteria .criteria-list"));this.textFieldView.setElement(this.$el.find("input.search-entry"));this.clauseButtonView.setElement(this.$el.find(".criteria-actions"));this.extendedCriteriaContainerView.setElement(this.$el.find(".search-criteria-extended .criteria-list"));if(this.basicOrderByView){this.basicOrderByView.setElement(this.$el.find(".list-ordering")).render();this.basicOrderByView.setJql(this.queryStateModel.getJql())}this.primaryCriteriaContainerView.render();this.$el.find(".text-query").removeClass("hidden");this.textFieldView.render();this.clauseButtonView.render();this.extendedCriteriaContainerView.render();this._handleInteractiveChanged(this.searcherCollection.isInteractive());this.triggerVerticalResize();new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});return this},search:function(){this.searcherCollection.handleBasicViewSubmit()},_shiftFocus:function(b,f){var e=this.primaryCriteriaContainerView.getFocusableForCriteria(b);if(!e.length){e=this.extendedCriteriaContainerView.getFocusableForCriteria(b)}var d=this.primaryCriteriaContainerView.getFocusables().add(this.extendedCriteriaContainerView.getFocusables());var c=d.index(e);var a;if(c===0){a=1}else{if(c===d.length-1){a=d.length-2}else{a=c+f}}d.eq(a).focus()},focus:function(){this.primaryCriteriaContainerView.getFocusables().first().focus()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/TextFieldView.js' */
AJS.namespace("JIRA.Issues.TextFieldView");JIRA.Issues.TextFieldView=JIRA.Issues.Brace.View.extend({namedEvents:["searchRequested"],events:{keypress:"handleKeypress"},initialize:function(){_.bindAll(this,"_updateSearcherCollectionTextField","_handleInteractiveChanged","render");this.collection.on("remove change add",_.bind(function(a){if(a.getId()===this.collection.QUERY_ID){this.render()}},this));this.collection.onTextFieldChanged(this.render);this.collection.onRequestUpdateFromView(this._updateSearcherCollectionTextField);this.collection.onInteractiveChanged(this._handleInteractiveChanged)},handleKeypress:function(a){if(a.keyCode===13){this.collection.handleBasicViewSubmit();a.preventDefault()}},render:function(){var a=this.collection.get(this.collection.QUERY_ID);if(a){var c=a.getEditHtml();var b=AJS.$("<div></div>").html(c||"").text();this.setQuery(b)}else{this.setQuery("")}},setQuery:function(a){this.$el.val(a)},_updateSearcherCollectionTextField:function(){if(this.$el.is("input")){var a=AJS.$.trim(this.$el.val());this.collection.updateTextQuery(a)}},_handleInteractiveChanged:function(a){this.$el.prop("disabled",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/PrimaryCriteriaContainerView.js' */
JIRA.Issues.PrimaryCriteriaContainerView=JIRA.Issues.Brace.View.extend({initialize:function(){this._criteriaViews=_.map(this.collection.fixedLozenges,function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel(a),searcherCollection:this.collection})},this)},render:function(){_.each(this._criteriaViews,function(a){a.render()});this.$el.prepend(_.pluck(this._criteriaViews,"el"))},getCriteriaViews:function(){return this._criteriaViews},getFocusables:function(){return this.$(".criteria-selector, #searcher-query, .add-criteria, .search-button")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ExtendedCriteriaContainerView.js' */
JIRA.Issues.ExtendedCriteriaContainerView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],initialize:function(a){this.collection.on("change:isSelected",this._onCriteriaSelectionChanged,this);this.collection.on("add",this._onCriteriaSelectionChanged,this);this.collection.on("remove",this._removeViewForSearcher,this);this.collection.on("reset",this._onReset,this);this._criteriaViews=_.map(this.collection.getSelectedCriteria(),_.bind(function(b){if(b.getPosition()==null){b.setPosition(this.collection.getNextPosition())}return this._buildCriteriaViewForSearcher(b)},this))},render:function(){_.each(this._criteriaViews,_.bind(function(a){a.render();this.$el.append(a.$el)},this))},getFocusables:function(){return this.$(".criteria-selector")},getFocusableForCriteria:function(a){return this.$('.criteria-selector[data-id="'+a+'"]')},_buildCriteriaViewForSearcher:function(a){return new JIRA.Issues.CriteriaView({model:new JIRA.Issues.CriteriaModel({id:a.get("id"),name:a.get("name")}),searcherCollection:this.collection,extended:true})},_onCriteriaSelectionChanged:function(a){if(a.getIsSelected()&&!this.collection.isFixed(a)){this._addViewForSearcher(a)}else{this._removeViewForSearcher(a)}},_addViewForSearcher:function(b){var a=this._buildCriteriaViewForSearcher(b);a.render();this.$el.append(a.$el);this._criteriaViews.push(a);this.triggerVerticalResize()},_removeViewForSearcher:function(a){this._criteriaViews=_.reject(this._criteriaViews,function(b){if(b.model.getId()===a.getId()){b.destroy();return true}return false});this.triggerVerticalResize()},_onReset:function(){_.each(this._criteriaViews,function(a){a.destroy()});this._criteriaViews=[]}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherGroupListDialogView.js' */
(function(){var a;JIRA.Issues.SearcherGroupListDialogView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.searcherDropdownContent,namedEvents:["searcherSelected","hideRequested"],events:{keydown:"_keyPressed"},initialize:function(b){this.searcherCollection=b.searcherCollection;this.$el.scrollLock(".aui-list-scroll")},render:function(){var f=this.searcherCollection.getAddMenuGroupDescriptors(),e=f.length&&f[0].properties.items.length>JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;var c=jQuery(AJS.Templates.queryableSelect({descriptors:f,id:"criteria"}));this.$el.empty().append(c);var d={element:c,suggestionsHandler:JIRA.Issues.SearcherGroupListDialogView.SuggestHandler,hideFooterButtons:true};var h="...excluding \u003cspan class=hidden-no\u003e\u003c/span\u003e hidden",g="These criteria are hidden because they are not applicable to the current project and/or issue type";if(e){d.maxInlineResultsDisplayed=JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT;h="...excluding \u003cspan class=hidden-no\u003e\u003c/span\u003e hidden. Please enter a keyword to refine.";g="These criteria are hidden because there are either too many to display or they are not applicable to the current project and/or issue type"}var b=new AJS.CheckboxMultiSelect(d);a=jQuery("<div class='more-criteria-footer' />").html(h);this.$el.append(a);new JIRA.Issues.Tipsy({el:a,tipsy:{title:function(){return g},className:"tipsy-front"}});this.$el.unbind("selected").bind("selected",_.bind(this._searcherSelected,this));this.$el.unbind("unselect").bind("unselect",_.bind(this._searcherUnselected,this));return this.$el},_searcherUnselected:function(c,b){this.searcherCollection.clearClause(b.properties.value)},_searcherSelected:function(d,c){var b=this.searcherCollection.getSearcher(c.properties.value);b.select();JIRA.Issues.SearcherDialog.instance.hide();JIRA.Issues.SearcherDialog.instance.show(b)},_keyPressed:function(f){if(f.keyCode===AJS.$.ui.keyCode.TAB){var b=AJS.$(":tabbable",this.$el);var c=(b.length===0);var e=(f.shiftKey&&(document.activeElement===b.first()[0]));var d=(!f.shiftKey&&(document.activeElement===b.last()[0]));if(c||e||d){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);f.preventDefault()}}}},{CRITERIA_DISPLAY_LIMIT:100});JIRA.Issues.SearcherGroupListDialogView.SuggestHandler=AJS.CheckboxMultiSelectSuggestHandler.extend({formatSuggestions:function(b,c){var e=0,d=AJS.SuggestHelper.removeDuplicates(this.model.getDisplayableSelectedDescriptors());b.splice(0,0,new AJS.GroupDescriptor({actionBarHtml:d.length>1?this.createClearAll():null,items:d,styleClass:"selected-group"}));_.each(b,function(g){if(c.length===0){var f=_.filter(g.items(),function(i,h){var j=i.meta();return j&&j.isShown&&h<JIRA.Issues.SearcherGroupListDialogView.CRITERIA_DISPLAY_LIMIT});e+=g.items().length-f.length;g.items(f)}else{_.each(g.items(),function(h){var i=h.meta();h.disabled(!(i&&i.isShown))})}});_.defer(function(){if(a){if(e){a.show().find(".hidden-no").text(e)}else{a.hide()}}});return b}})})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherEditDialogView.js' */
JIRA.Issues.SearcherEditDialogView=JIRA.Issues.Brace.View.extend({namedEvents:["backRequested","hideRequested"],autoUpdate:[".js-default-checkboxmultiselect",".js-default-checkboxmultiselectstatuslozenge",".js-user-checkboxmultiselect",".js-usergroup-checkboxmultiselect",".js-group-checkboxmultiselect",".js-label-checkboxmultiselect"],events:function(){var a={"click .cancel-update":"_onCancelClicked",click:"_stopPropagation",submit:"_onSubmit",keydown:"_keyPressed"};if(this.queryStateModel.getBasicAutoUpdate()){a["selected "+this.autoUpdate.join(",")]="applyChanges";a["unselect "+this.autoUpdate.join(",")]="applyChanges"}return a},template:JIRA.Templates.IssueNavQueryBasic.lozengeDropdownContent,initialize:function(a){this._formData="";this.queryStateModel=a.queryStateModel;this.$el.scrollLock(".aui-list-scroll")},renderDeferred:function(){var a=jQuery.Deferred();this.model.retrieveEditHtml().done(_.bind(function(b){a.resolve(this.render(b))},this));return a.promise()},hasAutoUpdate:function(a){return this.queryStateModel.getBasicAutoUpdate()&&jQuery(a).find(this.autoUpdate.join(",")).length!==0},render:function(b){var a=!(/^\s*$/.test(b));var c;if(a){c=AJS.$(this.template({displayBackButton:this.displayBackButton,displayUpdateCancel:!this.hasAutoUpdate(b)&&!jQuery(b).hasClass("searchfilter-not-found")}))}else{c=AJS.$(JIRA.Templates.IssueNavQueryBasic.lozengeDropdownCannotEdit({fieldName:this.model.getName()}))}this.$el.html(c);this.$el.find(".form-body").appendCatchExceptions(b);this.$el.find("form").addClass(this.model.id+"-criteria");this.$el.find("label:first").remove();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$el,JIRA.CONTENT_ADDED_REASON.criteriaPanelRefreshed]);this._formData=this.$el.find("form").serialize();this.model.setInitParams(this._formData);return this.$el},_stopPropagation:function(a){a.stopPropagation()},_preventDefault:function(a){a.preventDefault()},applyFilter:function(){var b=this.$el.find("form").serialize();var a=(b!==this._formData);this._formData=b;this.model.setSerializedParams(this._formData);return a},applyChanges:function(){if(this.applyFilter()){this.model.createOrUpdateClauseWithQueryString()}},_onCancelClicked:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.cancelClicked)},_onSubmit:function(a){a.preventDefault();this.triggerHideRequested(AJS.HIDE_REASON.submit)},_keyPressed:function(e){if(e.keyCode===AJS.$.ui.keyCode.TAB){var a=AJS.$(":tabbable",this.$el);var b=(a.length===0);var d=(e.shiftKey&&(document.activeElement===a.first()[0]));var c=(!e.shiftKey&&(document.activeElement===a.last()[0]));if(b||d||c){this.triggerHideRequested(AJS.HIDE_REASON.tabbedOut);e.preventDefault()}}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseListDialogView.js' */
AJS.namespace("JIRA.Issues.ClauseListDialogView");JIRA.Issues.ClauseListDialogView=JIRA.Issues.Brace.View.extend({events:{"click .clauses .searcherValue":"_clauseSelected","click .remove-filter":"_removeFilterRequested"},template:JIRA.Templates.IssueNavQueryBasic.enabledClauses,namedEvents:["clauseSelected","hideRequested"],initialize:function(a){this.searcherCollection=a.searcherCollection;this.searcherCollection.onCollectionChanged(this._renderAndCheckForClose,this)},render:function(){this.$el.html(this.template({clauses:this._getClauses()}))},_renderAndCheckForClose:function(){this.render();if(!this._getClauses().length){this.triggerHideRequested()}},_clauseSelected:function(b){b.preventDefault();var a=AJS.$(b.target),c=a.parents("li").first().data("id");this.triggerClauseSelected(c)},_removeFilterRequested:function(b){b.preventDefault();var a=this;_.defer(function(){var c=AJS.$(b.target),e=c.parents("li").first();var d=e.data("id");a.searcherCollection.clearClause(d);e.remove();a.triggerHideRequested()})},_getClauses:function(){var b=this.searcherCollection.getVariableClauses();var a=_.invoke(b,"toJSON");_.each(a,this._formatForTemplate);return a},_formatForTemplate:function(a){if(a.validSearcher){a.invalidMessage=""}else{a.invalidMessage="This criteria is not valid for the project and/or issue type"}}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/ClauseButtonView.js' */
JIRA.Issues.ClauseButtonView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryBasic.clauseButtonView,addCriteriaButton:".add-criteria",events:{"click .add-criteria":"_showDialog","keydown .add-criteria":"_onKeydown"},initialize:function(c){_.bindAll(this,"_handleInteractiveChanged","_showOrHideClauseButtons");var a=this;this.queryStateModel=c.queryStateModel;this.searcherCollection=c.searcherCollection;this.searcherCollection.onCollectionChanged(this._showOrHideClauseButtons);this.searcherCollection.onInteractiveChanged(this._handleInteractiveChanged);var d=this.dialog=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return a.$el.find(a.addCriteriaButton)},content:function(){return b.render()}});d.bind(AJS.InlineLayer.EVENTS.hide,function(h,f,g){if(g===AJS.HIDE_REASON.escPressed||g===AJS.HIDE_REASON.toggle||g==AJS.HIDE_REASON.tabbedOut){a.$(a.addCriteriaButton).focus()}});var b=new JIRA.Issues.SearcherGroupListDialogView({searcherCollection:this.searcherCollection,dialog:d});b.onHideRequested(function(e){d.hide(e)});d.bind(AJS.InlineLayer.EVENTS.show,function(f,e){jQuery("#criteria-input").focus();e.find(".aui-list-scroll").scrollTop(0)})},render:function(){this.$el.html(this.template({isSubtle:this.queryStateModel.hasSubtleMoreCriteria()}));this._showOrHideClauseButtons();this._addToolTip();return this.$el},_addToolTip:function(){new JIRA.Issues.Tipsy({el:this.$el.find(this.addCriteriaButton),showCondition:":not(.active)"})},_showOrHideClauseButtons:function(){var a=this.$(this.addCriteriaButton);if(this.searcherCollection.getAddMenuGroupDescriptors().length>0){a.show()}else{a.hide()}},_showDialog:function(a){if(this.searcherCollection.isInteractive()){this.dialog.toggle()}a.preventDefault()},_handleInteractiveChanged:function(a){this.$(this.addCriteriaButton).attr("aria-disabled",(a)?null:"true")},_onKeydown:function(a){switch(a.which){case AJS.$.ui.keyCode.DOWN:this._showDialog(a);break;case AJS.$.ui.keyCode.ESCAPE:jQuery(a.target).blur();break;case AJS.$.ui.keyCode.BACKSPACE:break;default:return}a.preventDefault()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/basic/SearcherDialog.js' */
JIRA.Issues.SearcherDialog=function(){return{initialize:function(b){if(!this.instance){this.instance=a(b)}}};function a(b){AJS.HIDE_REASON.switchLozenge="switchLozenge";var f=[AJS.HIDE_REASON.escPressed,AJS.HIDE_REASON.toggle,AJS.HIDE_REASON.cancelClicked,AJS.HIDE_REASON.submit,AJS.HIDE_REASON.tabbedOut];function e(i){return i?jQuery(".criteria-selector[data-id='"+i.getId()+"']"):jQuery()}var h;var d;var c;var g=new AJS.InlineLayer({width:"auto",alignment:AJS.LEFT,offsetTarget:function(){return e(d)},content:function(){c=new JIRA.Issues.SearcherEditDialogView({model:d,queryStateModel:b.queryStateModel});c.onHideRequested(function(i){g.hide(i)});return c.renderDeferred()}});g.bind(AJS.InlineLayer.EVENTS.show,function(k,i){var j=i.find(":input:not(submit):visible:first");j.focus();i.find(".aui-list-scroll").scrollTop(0)});g.bind(AJS.InlineLayer.EVENTS.beforeHide,function(l,j,k,m,i){if(k===AJS.HIDE_REASON.clickOutside&&i&&jQuery(i).closest(".calendar").length){l.preventDefault()}});g.bind(AJS.InlineLayer.EVENTS.hide,function(m,j,l){var k=d;if(_.contains(f,l)){e(k).focus()}function i(){h=d.createOrUpdateClauseWithQueryString(l===AJS.HIDE_REASON.submit);h.done(function(){if(k.hasErrorInEditHtml()){if(b.queryStateModel.getSearchMode()==="basic"){JIRA.Issues.SearcherDialog.instance.show(k)}}if(AJS.InlineLayer.current){AJS.InlineLayer.current.setPosition()}});h.always(function(){h=null});k.clearEditHtml()}if(l===AJS.HIDE_REASON.submit){c.applyFilter();i()}else{if(l!==AJS.HIDE_REASON.cancelClicked&&l!==AJS.HIDE_REASON.escPressed&&l!==AJS.HIDE_REASON.tabbedOut){if(c.applyFilter()){i()}}else{JIRA.trace("jira.search.searchers.hiddenWithoutUpdate")}}c.$el.remove();c=null;d=null});b.queryStateModel.on("change:searchMode",function(){g.hide()});return{getCurrentSearcher:function(){return d},toggle:function(i){if(d!=null){if(d!==i){g.hide(AJS.HIDE_REASON.switchLozenge);this.show(i)}else{g.hide(AJS.HIDE_REASON.toggle)}}else{this.show(i)}},_show:function(i){_.defer(function(){d=i;g.show();g.setPosition()})},show:function(k){var j;if(JIRA.Issues.SearcherDialog.waitingToShow){j=true}var i=this;JIRA.Issues.SearcherDialog.waitingToShow=function(){i._show(k);JIRA.Issues.SearcherDialog.waitingToShow=null};if(!j){k.searchersReady().done(function(){if(h){h.done(function(){JIRA.Issues.SearcherDialog.waitingToShow()})}else{JIRA.Issues.SearcherDialog.waitingToShow()}})}},onShow:function(i){g.bind(AJS.InlineLayer.EVENTS.show,i)},hide:function(){g.hide()},onHide:function(i){g.bind(AJS.InlineLayer.EVENTS.hide,i)}}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query-jql.soy' */
// This file was automatically generated from query-jql.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQueryJql == 'undefined') { JIRA.Templates.IssueNavQueryJql = {}; }


JIRA.Templates.IssueNavQueryJql.jqlQueryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-field-container"><div class="atlassian-autocomplete"><label for="advanced-search"><span id="jqlerrormsg" class="icon jqlgood"><span>', soy.$$escapeHtml("parse"), '</span></span> <span class="jql-label">', soy.$$escapeHtml("Query"), ' <span id="jqlcolrowcount">', soy.$$escapeHtml("line"), ':<span id="jqlrownum">0</span>', soy.$$escapeHtml("character"), ':<span id="jqlcolumnnum">0</span></span></span></label><textarea id="advanced-search" class="search-entry advanced-search ajs-dirty-warning-exempt" name="jql" maxlength="2000"></textarea><a class="syntax-help" href="', soy.$$escapeHtml(opt_data.helpUrl), '" title="', soy.$$escapeHtml("Syntax Help"), '" target="_jirahelp" tabindex="-1"><span class="aui-icon aui-icon-small aui-iconfont-help">', soy.$$escapeHtml("Syntax Help"), '</span></a></div></div><div class="search-options-container">', (opt_data.hasSearchButton) ? '<button class="aui-item aui-button aui-button-subtle search-button" type="button" title="' + soy.$$escapeHtml("Search for issues") + '"><span class="aui-icon aui-icon-small aui-iconfont-search">' + soy.$$escapeHtml("Search") + '</span></button>' : '', '<span class="mode-switcher"></span></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlAutoCompleteView.js' */
JIRA.Issues.JQLAutoCompleteView=JIRA.Issues.Brace.View.extend({namedEvents:["jqlValid","jqlInvalid","searchRequested"],events:{focus:"_onFocus"},getJqlAutoCompleteData:function(){var b=jQuery.Deferred();if(this.jqlFieldNames==null||this.jqlFunctionNames==null||this.jqlReservedWords==null){var c=jQuery("#jqlFieldz");var d=jQuery("#jqlFunctionNamez");var a=jQuery("#jqlReservedWordz");if(c.length>0&&d.length>0&&a.length>0){this.jqlFieldNames=JSON.parse(c.text());this.jqlFunctionNames=JSON.parse(d.text());this.jqlReservedWords=JSON.parse(a.text())}else{AJS.$.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/jqlAutoComplete"}).done(_.bind(function(f){var e=JSON.parse(f);this.jqlFieldNames=_.reject(JSON.parse(e.jqlFieldz),_.bind(function(g){return _.contains(this.model.getWithout(),g.value)},this));this.jqlFunctionNames=JSON.parse(e.jqlFunctionNamez);this.jqlReservedWords=JSON.parse(e.jqlReservedWordz);b.resolve()},this));return b.promise()}}return b.resolve().promise()},_initJQLAutoComplete:function(){var d=this.$el;var b=JIRA.JQLAutoComplete({fieldID:d.attr("id"),parser:JIRA.JQLAutoComplete.MyParser(this.jqlReservedWords),queryDelay:0.65,jqlFieldNames:this.jqlFieldNames,jqlFunctionNames:this.jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var a=this;d.keypress(function(e){if(b.dropdownController===null||!b.dropdownController.displayed||b.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){e.preventDefault();b.dropdownController.hideDropdown();a.triggerSearchRequested(d.val())}}});var a=this;var c=b.updateParseIndicator;b.updateParseIndicator=function(e){c.apply(this,arguments);if(!e.getParseError()){a.triggerJqlValid(d.val())}else{a.triggerJqlInvalid(d.val())}};b.buildResponseContainer();b.parse(d.val());b.updateColumnLineCount();d.bind("expandedOnInput",function(){b.positionResponseContainer()}).bind("updateParseIndicator",function(){b.parse(d.val())}).click(function(){b.dropdownController.hideDropdown()})},_onFocus:function(){if(!this.model.getAutocompleteEnabled()||this.$el.data("JQLAutoComplete_init")){return}this.$el.data("JQLAutoComplete_init",true);this.getJqlAutoCompleteData().done(_.bind(this._initJQLAutoComplete,this))}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryModule.js' */
JIRA.Issues.JqlQueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["searchRequested","verticalResize"],initialize:function(a){this._queryStateModel=a.queryStateModel;this.view=new JIRA.Issues.JqlQueryView({queryStateModel:a.queryStateModel}).onVerticalResize(this.triggerVerticalResize,this).onSearchRequested(this.triggerSearchRequested,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,_.bind(function(d,b,c){if(c===JIRA.CONTENT_ADDED_REASON.returnToSearch){this.setQuery()}},this))},search:function(){var a=this.view.readJql();this.triggerSearchRequested(a)},setQuery:function(){this.view.setQuery()},createView:function(){return this.view}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/jql/JqlQueryView.js' */
JIRA.Issues.JqlQueryView=JIRA.Issues.Brace.View.extend({template:JIRA.Templates.IssueNavQueryJql.jqlQueryView,namedEvents:["verticalResize","searchRequested"],events:{expandedOnInput:"_handleExpandOnInput"},initialize:function(a){this.queryStateModel=a.queryStateModel;this.queryStateModel.on("change:jql",this.setQuery,this);AJS.$(document).bind("issueNavWidthChanged",_.bind(this._resizeHeight,this));if(JIRA.Issues.JQLAutoCompleteView){this.JQLAutoCompleteView=new JIRA.Issues.JQLAutoCompleteView({model:this.queryStateModel});this.JQLAutoCompleteView.onJqlValid(function(b){if(this.queryStateModel.getAdvancedAutoUpdate()){this.triggerSearchRequested(b)}},this);this.JQLAutoCompleteView.onSearchRequested(this.triggerSearchRequested,this)}},render:function(){this.$el.html(this.template({helpUrl:AJS.Meta.get("advanced-search-help-url"),helpTitle:AJS.Meta.get("advanced-search-help-title"),hasSearchButton:this.queryStateModel.hasSearchButton()}));this.$el.addClass("loading");if(this.JQLAutoCompleteView){this.JQLAutoCompleteView.setElement(this.$el.find(".advanced-search"));this.JQLAutoCompleteView.getJqlAutoCompleteData()}new JIRA.Issues.Tipsy({el:this.$el.find(".search-button"),tipsy:{trigger:"hover",delayIn:300}});this.setQuery();return this},readJql:function(){var a=this._getInputField();var b=a.val()||"";var c=AJS.$.trim(b);if(b!==c){a.val(c)}this._resizeHeight();return c},_handleExpandOnInput:function(){this.triggerVerticalResize()},_resizeHeight:function(){var a=this._getInputField();if(a.val()){a.height(0).expandOnInput()}else{a.expandOnInput().height(0).trigger("refreshInputHeight")}},setQuery:function(){this.$el.removeClass("loading");this._getInputField().val(this.queryStateModel.getJql());this._getInputField().trigger("updateParseIndicator");this._resizeHeight()},focus:function(){this._getInputField().focus()},_getInputField:function(){return this.$el?this.$el.find("textarea"):AJS.$()}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/templates/query.soy' */
// This file was automatically generated from query.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.IssueNavQuery == 'undefined') { JIRA.Templates.IssueNavQuery = {}; }


JIRA.Templates.IssueNavQuery.searchSwitcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var itemList3 = opt_data.items;
  var itemListLen3 = itemList3.length;
  for (var itemIndex3 = 0; itemIndex3 < itemListLen3; itemIndex3++) {
    var itemData3 = itemList3[itemIndex3];
    JIRA.Templates.IssueNavQuery.searchSwitcherItem({id: itemData3.id, isActive: itemData3.id == opt_data.selectedId}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.searchSwitcherItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="#" class="switcher-item', soy.$$escapeHtml(opt_data.isActive ? ' active' : ''), ' " data-id=\'', soy.$$escapeHtml(opt_data.id), '\' title="', (opt_data.id == 'basic') ? soy.$$escapeHtml("Switch to advanced search using JQL") : soy.$$escapeHtml("Switch to basic search"), '">', (opt_data.id == 'basic') ? soy.$$escapeHtml("Advanced") : soy.$$escapeHtml("Basic"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.IssueNavQuery.queryView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="aui-item search-wrap"><div class="search-container"></div><div class="save-filter-controls"></div></div>', (opt_data.layoutSwitcher) ? '<div class="aui-item view-selector" id="layout-switcher-toggle"></div>' : '', '</div><div class="notifications"></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryModule.js' */
JIRA.Issues.QueryModule=JIRA.Issues.Brace.Evented.extend({namedEvents:["jqlChanged","jqlTooComplex","jqlError","jqlSuccess","searchRequested","queryTooComplexSwitchToAdvanced","changedPreferredSearchMode","basicModeCriteriaCountWhenSearching","verticalResize","initialized"],initialize:function(a){this._queryStateModel=a.queryStateModel;this._queryStateModel.on("change:preferredSearchMode",_.bind(function(){this.triggerChangedPreferredSearchMode(this._queryStateModel.getPreferredSearchMode())},this));JIRA.Issues.SearcherDialog.initialize({queryStateModel:this._queryStateModel});this._jqlQueryModule=new JIRA.Issues.JqlQueryModule({queryStateModel:this._queryStateModel}).onSearchRequested(this.handleAdvancedSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this);this._errors={};this._errors[this._queryStateModel.BASIC_SEARCH]=[];this._errors[this._queryStateModel.ADVANCED_SEARCH]=[];this._queryStateModel.on("change:searchMode",this.showSearchErrors,this);this._basicQueryModule=new JIRA.Issues.BasicQueryModule({queryStateModel:this._queryStateModel,primaryClauses:a.primaryClauses,initialSearcherCollectionState:a.searchers}).onSearchRequested(this.clearSearchErrors,this).onJqlTooComplex(this.handleJqlTooComplex,this).onSearchRequested(this.handleSearchRequested,this).onVerticalResize(this.triggerVerticalResize,this).onBasicModeCriteriaCountWhenSearching(this.triggerBasicModeCriteriaCountWhenSearching,this)},refreshLayout:function(){this._jqlQueryModule.setQuery()},handleAdvancedSearchRequested:function(a){this.handleSearchRequested(a);this._basicQueryModule.queryChanged()},handleSearchRequested:function(a){this._queryStateModel.setJql(a);this.clearSearchErrors()},handleJqlTooComplex:function(a){if(this.getSearchMode()!==this._queryStateModel.ADVANCED_SEARCH){this.triggerQueryTooComplexSwitchToAdvanced()}this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH);this.triggerJqlTooComplex(a);if(this._queryView){this._queryView.switcherViewModel.disableSwitching()}},getJql:function(){return this._queryStateModel.getJql()},getSearcherCollection:function(){return this._basicQueryModule.searcherCollection},isBasicMode:function(){return this._queryStateModel.getSearchMode()===this._queryStateModel.BASIC_SEARCH},resetToQuery:function(a,b){this.clearSearchErrors();return this._basicQueryModule.queryReset(a).always(_.bind(function(){this._queryStateModel.switchToPreferredSearchMode();this._jqlQueryModule.setQuery();if(b&&b.focusQuery===true){this._queryView.getView().focus()}this._basicQueryModule.off("searchRequested",this.publishJqlChanges);this._jqlQueryModule.off("searchRequested",this.publishJqlChanges);this._basicQueryModule.onSearchRequested(this.publishJqlChanges,this);this._jqlQueryModule.onSearchRequested(this.publishJqlChanges,this)},this))},publishJqlChanges:function(a){this.triggerJqlChanged(a)},setVisible:function(a){this._queryView.setVisible(a)},queryChanged:function(){this.clearSearchErrors();this._basicQueryModule.queryChanged()},onSearchSuccess:function(a){if(this._queryView){this._queryView.showWarnings(a)}this.triggerJqlSuccess()},searchersReady:function(){return this._basicQueryModule.searchersReady()},onSearchError:function(b){this._errors.renderFunction="showErrors";var c=(b.errorMessages)?b.errorMessages.concat():[];var a=[];_.each(b.errors,function(e,d){if(d==="jql"){a.push(e)}else{c.push(e)}});if(this.getSearchMode()===this._queryStateModel.BASIC_SEARCH&&!this._basicQueryModule.hasErrors()&&a.length>0){this.setSearchMode(this._queryStateModel.ADVANCED_SEARCH)}this._errors[this._queryStateModel.BASIC_SEARCH]=c;this._errors[this._queryStateModel.ADVANCED_SEARCH]=a.concat(c);this.showSearchErrors();this.triggerJqlError()},showSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();var a=this._errors.renderFunction||"showErrors";this._queryView[a](this._errors[this.getSearchMode()])}},clearSearchErrors:function(){if(this._queryView){this._queryView.clearNotifications();this._queryView.switcherViewModel.enableSwitching()}this._errors[this._queryStateModel.BASIC_SEARCH].length=0;this._errors[this._queryStateModel.ADVANCED_SEARCH].length=0},getSearchMode:function(){return this._queryStateModel.getSearchMode()},getActiveBasicModeSearchers:function(){return this._basicQueryModule.getSelectedCriteria()},setSearchMode:function(a){if(this.getSearchMode()!==a){this._queryStateModel.switchToSearchMode(a);return true}return false},createAndRenderView:function(a){this._queryView=new JIRA.Issues.QueryView({el:a,queryStateModel:this._queryStateModel,basicQueryModule:this._basicQueryModule,jqlQueryModule:this._jqlQueryModule}).onVerticalResize(this.triggerVerticalResize,this);this._queryView.render()},isQueryValid:function(){return(this._errors&&this._errors[this._queryStateModel.BASIC_SEARCH].length===0&&this._errors[this._queryStateModel.ADVANCED_SEARCH].length===0)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryStateModel.js' */
JIRA.Issues.QueryStateModel=JIRA.Issues.Brace.Model.extend({BASIC_SEARCH:"basic",ADVANCED_SEARCH:"advanced",namedAttributes:["style","searchMode","preferredSearchMode","jql","without","layoutSwitcher","autocompleteEnabled","advancedAutoUpdate","basicAutoUpdate","basicOrderBy"],defaults:{searchMode:"basic",preferredSearchMode:"basic"},switchToSearchMode:function(a){this.setSearchMode(a)},switchPreferredSearchMode:function(a){this.switchToSearchMode(a);this.setPreferredSearchMode(a);this._savePreferredSearchMode()},switchToPreferredSearchMode:function(){this.switchToSearchMode(this.getPreferredSearchMode())},hasSearchButton:function(){return this.getStyle()!=="field"},hasSubtleMoreCriteria:function(){return this.getStyle()!=="field"},_savePreferredSearchMode:function(){jQuery.ajax({url:AJS.contextPath()+"/rest/querycomponent/latest/userSearchMode",type:"POST",headers:{"X-Atlassian-Token":"nocheck"},data:{searchMode:this.getPreferredSearchMode()},error:_.bind(function(a){if(JIRA.Issues.displayFailSearchMessage){JIRA.Issues.displayFailSearchMessage(a)}},this),success:function(){JIRA.trace("jira.search.mode.changed")}})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherModel.js' */
JIRA.Issues.SwitcherModel=JIRA.Issues.Brace.Model.extend({namedAttributes:["id","name","view","text"]});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherCollection.js' */
JIRA.Issues.SwitcherCollection=JIRA.Issues.Brace.Collection.extend({model:JIRA.Issues.SwitcherModel});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QuerySwitcherViewModel.js' */
JIRA.Issues.QuerySwitcherViewModel=JIRA.Issues.Brace.Model.extend({mixins:[JIRA.Issues.Mixin.SingleSelect],namedAttributes:["disabled"],namedEvents:["selectionChanged"],initialize:function(a,b){this.queryStateModel=b.queryStateModel;this.queryStateModel.on("change:searchMode",_.bind(function(){this.triggerSelectionChanged.apply(this,arguments)},this))},getSelected:function(){var a=this.queryStateModel.getSearchMode();return a?this.getCollection().get(a):null},setSelected:function(a){this.queryStateModel.switchPreferredSearchMode(a?a.id:null)},enableSwitching:function(){this.setDisabled(false)},disableSwitching:function(){this.setDisabled(true)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/QueryView.js' */
JIRA.Issues.QueryView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],template:JIRA.Templates.IssueNavQuery.queryView,events:{"click .search-button":"search",submit:"preventDefault"},initialize:function(a){this.queryStateModel=a.queryStateModel;var b=new JIRA.Issues.SwitcherCollection([{id:this.queryStateModel.BASIC_SEARCH,name:"Basic",view:a.basicQueryModule.createView()},{id:this.queryStateModel.ADVANCED_SEARCH,name:"Advanced",view:a.jqlQueryModule.createView()}]);this.jqlQueryModule=a.jqlQueryModule;this.switcherViewModel=new JIRA.Issues.QuerySwitcherViewModel({collection:b},{queryStateModel:this.queryStateModel});this.switcherView=new JIRA.Issues.SwitcherView({template:JIRA.Templates.IssueNavQuery.searchSwitcher,model:this.switcherViewModel,containerClass:".search-container"}).onVerticalResize(this.triggerVerticalResize,this)},render:function(){this.$el.html(this.template(this.queryStateModel.toJSON()));this.switcherView.setElement(this.$el).render();return this},preventDefault:function(a){a.preventDefault()},clearNotifications:function(){this.$(".notifications").empty()},search:function(){if(this.queryStateModel.ADVANCED_SEARCH===this.switcherViewModel.getSelected().getId()){this.jqlQueryModule.search()}else{this.getView().search()}},getView:function(){return this.switcherViewModel.getSelected().getView()},showErrors:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.errorMessage({messages:a}))},showWarnings:function(a){this.$(".notifications").append(JIRA.Templates.Issues.ComponentUtil.warningMessage({messages:a}))},setVisible:function(a){this.$(".search-container").toggle(a);this.switcherView.setVisible(a)}});jQuery(function(){if(jQuery.browser.msie&&jQuery.browser.version<=8){JIRA.bind(AJS.InlineLayer.EVENTS.hide,function(){jQuery(".text-query-container").parent().append(jQuery(".text-query-container").detach())})}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/SwitcherView.js' */
JIRA.Issues.SwitcherView=JIRA.Issues.Brace.View.extend({namedEvents:["verticalResize"],tagName:"div",events:{"click .switcher-item":"_onSwitcherClick"},initialize:function(a){this.containerClass=a.containerClass;this.model=a.model;this.template=a.template;this.model.onSelectionChanged(this._onSelect,this);this.switchEl=AJS.$();this.model.on("change:disabled",_.bind(this._setSwitching,this))},render:function(){this._onSelect();this._render()},_render:function(){var a=this.model.getSelected();this.switchEl=this.$el.find(".mode-switcher");this.switchEl.html(this.template({items:this.model.getCollection().toJSON(),selectedId:a&&a.id}));new JIRA.Issues.Tipsy({el:this.$el.find(".switcher-item.active")})},getSwitcherTrigger:function(){return this.switchEl.find(".switcher-item.active")},_onSelect:function(){var a=this.$el.find(this.containerClass).empty(),b=this.model.getSelected();if(b){a.attr("data-mode",b.id);b.getView().setElement(a).render()}this._render();this.triggerVerticalResize()},_onSwitcherClick:function(b){b.preventDefault();if(!this.model.getDisabled()){this.model.next();var a=this.model.getSelected().getView();a.focus&&a.focus()}},_setSwitching:function(){if(this.model.getDisabled()){this.disableSwitching()}else{this.enableSwitching()}},disableSwitching:function(){this.switchEl.addClass("disabled");this.getSwitcherTrigger().attr("original-title","This query is too complex to display in Simple mode.")},enableSwitching:function(){this.switchEl.removeClass("disabled");var a=this.model.getSelected();if(a&&a.id==="advanced"){this.getSwitcherTrigger().attr("original-title","Switch to basic search")}},setVisible:function(a){this.switchEl.toggleClass("hidden",!a)}});
/* module-key = 'com.atlassian.jira.jira-issue-nav-components:query', location = 'query/Query.js' */
JIRA.Components.Query=function(){var a={project:"Project",issuetype:"Type",status:"Status",assignee:"Assignee",reporter:"Reporter",labels:"Labels",resolution:"Resolution",created:"Created Date",updated:"Updated Date",resolutiondate:"Resolution Date",description:"Description",duedate:"Due Date",comment:"Comment",fixfor:"Fix Version",version:"Affects Version",component:"Component"};return{DEFAULT_CLAUSES:["project","issuetype","status","assignee"],create:function(c){c=_.defaults(c,{primaryClauses:this.DEFAULT_CLAUSES,without:[],style:"generic",layoutSwitcher:true,autocompleteEnabled:true,advancedAutoUpdate:false,basicOrderBy:false,basicAutoUpdate:true,preferredSearchMode:"basic"});c.primaryClauses=_.reject(c.primaryClauses,function(d){return _.contains(c.without,d.id)});_.each(c.primaryClauses,function(e,d){if(typeof e==="string"){if(a[e]){c.primaryClauses[d]={id:e,name:a[e]}}else{console.error("JIRA.Components.Query: You have specified clause ["+e+"]. But we do not have the i18n string for it, probably a custom field. Instead use {id:"+e+", name: '[NAME_HERE]'}")}}});var b=new JIRA.Issues.QueryModule({queryStateModel:new JIRA.Issues.QueryStateModel({jql:c.jql,without:c.without,style:c.style,layoutSwitcher:c.layoutSwitcher,autocompleteEnabled:c.autocompleteEnabled,advancedAutoUpdate:c.advancedAutoUpdate,basicAutoUpdate:c.basicAutoUpdate,preferredSearchMode:c.preferredSearchMode,basicOrderBy:c.basicOrderBy}),primaryClauses:c.primaryClauses,searchers:c.searchers});jQuery(c.el).addClass("query-component "+c.style+"-styled");b.createAndRenderView(c.el);if(c.jql||c.jql===""){b.resetToQuery(c.jql).always(function(){jQuery(c.el).addClass("ready");b.triggerInitialized(c.jql)})}return b}}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-query', location = 'content/js/search/query/SearchShifter.js' */
JIRA.Issues.SearchShifter=function(d){var b,c,a,e;b=function(){var f=d.searcherCollection.chain().filter(a).map(e).value();return function(){return jQuery.Deferred().resolve(f).promise()}};c=function(h){var f=JIRA.Issues.SearcherDialog.instance.getCurrentSearcher(),g=d.searcherCollection.get(h);if(!g.getIsSelected()){g.select()}if(!f||f.getId()!==g.getId()){JIRA.Issues.SearcherDialog.instance.toggle(g)}};a=function(f){return f.getIsShown()};e=function(f){return{label:f.getName(),value:f.getId()}};return function(){if(!d.isBasicMode()||d.isFullScreenIssue()){return null}return{getSuggestions:b(),name:"Search Criteria",onSelection:c,weight:150}}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/LayoutPreferenceManager.js' */
JIRA.Issues.LayoutPreferenceManager={PREFERRED_LAYOUT_KEY:"jira.issues.preferred.layout.key",getPreferredLayoutKey:function(){return AJS.Meta.get(this.PREFERRED_LAYOUT_KEY)},setPreferredLayoutKey:function(b,a){a=_.defaults({},a,{ajax:true});AJS.Meta.set(this.PREFERRED_LAYOUT_KEY,b);a.ajax&&AJS.$.ajax({data:{layoutKey:b},type:"POST",headers:JIRA.Issues.XsrfTokenHeader,url:AJS.contextPath()+"/rest/issueNav/latest/preferredSearchLayout"})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/templates/splitview.soy' */
// This file was automatically generated from splitview.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.SplitView == 'undefined') { JIRA.Templates.SplitView = {}; }


JIRA.Templates.SplitView.fullSplitView = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group split-view"><div class="aui-item list-results-panel"><div class="list-panel"><div class="list-ordering"></div><div class="list-content">');
  if (opt_data.issuePanelData) {
    JIRA.Templates.SplitView.issueList(opt_data.issuePanelData, output);
  }
  output.append('</div></div><div class="end-of-stable-message-container"></div><div class="aui-group pagination-view count-pagination"><div class="refresh-container aui-item">');
  JIRA.Templates.IssueNav.refreshResults(null, output);
  output.append('</div><div class="pagination-container aui-item">');
  if (opt_data.pagination) {
    JIRA.Templates.IssueNavTable.pagination(opt_data.pagination, output);
  }
  output.append('</div></div></div><div class="aui-item detail-panel navigator-issue-only"><div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.structure = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.SplitView.fullSplitView({issuePanelData: null, pagination: null}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="issue-list">');
  var iLimit20 = opt_data.issues.length;
  for (var i20 = 0; i20 < iLimit20; i20++) {
    var issue__soy21 = opt_data.issues[i20];
    var issueID__soy22 = opt_data.issueIDs[i20];
    var isHighlighted__soy23 = issueID__soy22 == opt_data.highlightedID;
    if (issue__soy21) {
      output.append('<li ', (isHighlighted__soy23) ? 'class="focused"' : '', ' data-id="', soy.$$escapeHtml(issueID__soy22), '" data-key="', soy.$$escapeHtml(issue__soy21.key), '" title="', soy.$$escapeHtml(issue__soy21.summary), '">');
      JIRA.Templates.SplitView.issueRow(issue__soy21, output);
      output.append('</li>');
    } else {
      JIRA.Templates.SplitView.inaccessibleIssueRow({isHighlighted: isHighlighted__soy23, issueID: issueID__soy22}, output);
    }
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="splitview-issue-link" data-issue-key="', soy.$$escapeHtml(opt_data.key), '" href="', soy.$$escapeHtml(""), '/browse/', soy.$$escapeHtml(opt_data.key), '">');
  if (opt_data.type) {
    JIRA.Templates.SplitView.issueIcon(opt_data.type, output);
    output.append('&nbsp;');
  }
  output.append('<span class="issue-link-key">', soy.$$escapeHtml(opt_data.key), '</span><br/><span class="issue-link-summary">', soy.$$escapeHtml(opt_data.summary), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img height="16" width="16" alt="', soy.$$escapeHtml(opt_data.name), '" title="', soy.$$escapeHtml(opt_data.name), ' - ', soy.$$escapeHtml(opt_data.description), '" src="', soy.$$escapeHtml(opt_data.iconUrl), '" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.inaccessibleIssueRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="inaccessible-issue ', (opt_data.isHighlighted) ? 'focused' : '', '" data-id="', soy.$$escapeHtml(opt_data.issueID), '">', soy.$$escapeHtml("This issue can no longer be opened"), '</li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.SplitView.issueDetailsNoSelection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div></div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenDetailView.js' */
Backbone.define("JIRA.Issues.SplitScreenDetailView",JIRA.Issues.BaseView.extend({events:{"focus #addcomment textarea":"scrollToBottom"},issueDetailsNoSelectionTemplate:JIRA.Templates.SplitView.issueDetailsNoSelection,initialize:function(a){_.bindAll(this,"adjustHeight","_renderIssue");this.issueCacheManager=a.issueCacheManager;this.search=a.search;this.searchResults=a.search.getResults();JIRA.Issues.Application.on("issueEditor:fieldSubmitted",this.focus,this);JIRA.Issues.Application.on("issueEditor:replacedFocusedPanel",this.focus,this);this.adjustHeight=_.debounce(this.adjustHeight,a.easeOff)},adjustHeight:function(){_.defer(_.bind(function(){var b=this.getIssueContainer(),a;if(b.length){a=b.length&&b.offset().top;b.css("height",window.innerHeight-a)}},this))},getIssueContainer:function(){return this.$el.find(".issue-container")},scrollToTop:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(0)}},scrollToBottom:function(){var a=this.getIssueContainer();if(a.size()){a.scrollTop(a.prop("scrollHeight"))}},activate:function(){if(this.isActive){return this}var a=this;this.$el.focusin(function(){a.focused=true});this.$el.focusout(function(){a.focused=false});this.addListener(this.searchResults,"selectedIssueChange",this.render,this);this.addListener(this.searchResults,"issueUpdated",this.onIssueUpdated,this);this.addListener(this.searchResults,"issueDoesNotExist",this._onIssueDoesNotExist,this);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.onVerticalResize(this.adjustHeight);JIRA.Issues.Application.on("issueEditor:loadComplete",this.adjustHeight,this);this.isActive=true;return this},deactivate:function(){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.offVerticalResize(this.adjustHeight);JIRA.Issues.Application.off("issueEditor:loadComplete",this.adjustHeight);JIRA.unbind(JIRA.Events.NEW_CONTENT_ADDED,this.fixMentionsDropdownInMentionableFields);JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);this.isActive=false},fixMentionsDropdownInMentionableFields:function(b,a,c){if(c===JIRA.CONTENT_ADDED_REASON.panelRefreshed||c===JIRA.CONTENT_ADDED_REASON.inlineEditStarted){a.find(".mentionable:not([data-follow-scroll])").attr("follow-scroll",".split-view .issue-container");a.find(".mentionable:not([data-push-scroll])").attr("push-scroll",".issue-body-content")}},onIssueUpdated:function(c,a,b){if(b.action!==JIRA.Issues.Actions.INLINE_EDIT&&b.action!==JIRA.Issues.Actions.ROW_UPDATE){return JIRA.Issues.Application.request("issueEditor:refreshIssue",b)}else{return jQuery.Deferred().resolve()}},render:function(b,a){a=a||{};if(this.searchResults.hasIssues()&&!this.search.isStandAloneIssue()&&a.reason!=="issueLoaded"){if(this.searchResults.hasSelectedIssue()){JIRA.Issues.Application.execute("issueEditor:abortPending");JIRA.Issues.Utils.debounce(this,"_renderIssue",this.searchResults.getSelectedIssue())}else{this._renderNoIssue()}}this.adjustHeight();return this},_renderIssue:function(a){JIRA.Issues.Application.request("issueEditor:loadIssue",{id:a.get("id"),key:a.get("key"),detailView:true}).always(_.bind(function(){JIRA.Issues.Application.execute("pager:update",_.extend({},this.searchResults.getPager(),{isSplitView:true}));if(this.searchResults.isFirstIssueSelected()&&this.searchResults.getDisplayableTotal()>1){this.issueCacheManager.scheduleIssueToBePrefetched(this.searchResults.getNextIssueForSelectedIssue())}this.issueCacheManager.prefetchIssues();this.$el.addClass("active");this.scrollToTop()},this))},focus:function(){if(!this.hasFocus()){this.getIssueContainer().focus()}},blur:function(){this.getIssueContainer().blur()},_onIssueDoesNotExist:function(){this._renderNoIssue();JIRA.Issues.Application.execute("issueEditor:setContainer",this.$el);this.render()},_renderNoIssue:function(){this.$el.html(this.issueDetailsNoSelectionTemplate())},hasFocus:function(){return this.focused===true}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenListView.js' */
Backbone.define("JIRA.Issues.SplitScreenListView",JIRA.Issues.BaseView.extend({inaccessibleIssueRowTemplate:JIRA.Templates.SplitView.inaccessibleIssueRow,template:JIRA.Templates.SplitView.issueList,events:{"simpleClick .issue-list li":"_onClickIssue"},initialize:function(a){_.bindAll(this,"_onSearchDone","_onSearchFail");this.search=a.search;this.searchContainer=a.searchContainer;this.searchPromise=this._createSearchPromise({done:this._onSearchDone,fail:this._onSearchFail});this.searchResults=a.search.getResults();this.serverRendered=!!a.serverRendered&&this._issuesRendered(a);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"issueUpdated",this._onIssueUpdated,this);this.addListener(this.searchResults,"startIndexChange",this.render,this)},_issuesRendered:function(a){return !!a.searchContainer.find(".issue-list").length},scrollToFocused:function(){var b=this.searchContainer.find(".list-panel");var a=this.$el.find(".focused");if(b.size()&&a.size()){b.scrollTop(a.position().top)}},deactivate:function(){this.searchPromise.reset();JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments)},_onClickIssue:function(c){var b=AJS.$(c.target).closest("[data-id]").data("id"),a=this.searchResults.getSelectedIssue().getId()==b;c.preventDefault();if(!a){this.searchResults.selectIssueById(b,{replace:true});JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:b,absolutePosition:this.searchResults.getPositionOfIssueInSearchResults(b)+1,relativePosition:this.searchResults.getPositionOfIssueInPage(b)+1})}},_createSearchPromise:function(a){var b=jQuery.RecurringPromise();a=a||{};a.done&&b.done(_.bind(a.done,this));a.fail&&b.fail(_.bind(a.fail,this));return b},getIssueById:function(a){return this.$el.find("[data-id="+a+"]")},_highlightIssue:function(a){this.$el.find(".focused").removeClass("focused");a&&this.getIssueById(a.getId()).addClass("focused").scrollIntoView()},markIssueInaccessible:function(a){this.getIssueById(a).replaceWith(this.inaccessibleIssueRowTemplate({isHighlighted:this.searchResults.getHighlightedIssue().getId()===a,issueID:a}))},_onHighlightedIssueChange:function(){this._highlightIssue(this.searchResults.getHighlightedIssue())},_onIssueUpdated:function(b,a){if(a.table[0]===null){this.markIssueInaccessible(b)}else{this.getIssueById(b).html(JIRA.Templates.SplitView.issueRow(a.table[0]))}},_onSearchDone:function(a){if(a instanceof Array){if(this.searchResults.hasIssues()){this.$el.html(this.template({highlightedID:this.searchResults.getHighlightedIssue().getId(),issueIDs:this.searchResults.getPageIssueIds(),issues:a}))}_.defer(_.bind(this.scrollToFocused,this))}},_onSearchFail:function(){var a=this.searchContainer.find(".navigator-content");a.html(JIRA.Templates.Issues.ComponentUtil.errorMessage({msg:"Error occurred communicating with the server. Please reload the page and try again."}))},render:function(){var a=this.serverRendered;this.serverRendered=false;if(this.searchResults.hasIssues()){if(!this.searchResults.hasHighlightedIssue()&&!this.searchResults.hasSelectedIssue()){this.searchResults.highlightFirstInPage();return}return this.searchPromise.add(this.searchResults.getResultsForPage({jql:this.search.getEffectiveJql()}).then(function(b){return _.extend(b,{serverRendered:a})}))}else{return jQuery.Deferred().resolve()}}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/splitview/SplitScreenLayout.js' */
(function(a){Backbone.define("JIRA.Issues.SplitScreenLayout",JIRA.Issues.BaseView.extend({initialize:function(b){_.bindAll(this,"_adjustHeight","_adjustNoResultsMessageHeight","_updateSidebarPosition","applyResponsiveDesign");if(b.easeOff){this.applyResponsiveDesign=a.noop;_.debounce(this._adjustHeight,b.easeOff)}b=_.extend(b,{serverRendered:this._consumeServerRenderedSplitView(b)});this.search=b.search;this.fullScreenIssue=b.fullScreenIssue;this.navigatorContent=b.searchContainer.find(".navigator-content");this.searchResults=b.search.getResults();this.emptyResultsView=new JIRA.Issues.EmptyResultsView({searchResults:this.searchResults,el:this.navigatorContent});this.detailsView=new JIRA.Issues.SplitScreenDetailView(b);this.listView=new JIRA.Issues.SplitScreenListView(b);this.orderBy=JIRA.Components.OrderBy.create();this.orderBy.onSort(this._handleSort,this);JIRA.Issues.onVerticalResize(this._adjustHeight);JIRA.Issues.onVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.onHorizontalResize(this._updateSidebarPosition);JIRA.Issues.onVerticalResize(this._updateSidebarPosition);this.addListener(b.search,"beforeSearch",this._showPending,this);this.addListener(this.searchResults,"issueDeleted",this._onIssueDeleted,this);this.addListener(this.searchResults,"newPayload",this._hidePending,this);this.addListener(this.searchResults,"newPayload",this._updateSortBy,this);this.addListener(this.searchResults,"newPayload",this.render,this);this.addListener(this.searchResults,"startIndexChange",this._onStartIndexChange,this);this.addListener(this.searchResults,"highlightedIssueChange",this._onHighlightedIssueChange,this);this.addListener(this.searchResults,"selectedIssueChange",this._onSelectedIssueChange,this);this.addListener(this.searchResults,"startIndexChange",this._renderEverythingExceptListView,this);this.search.onSearchError(this._onSearchFail,this);JIRA.Issues.Application.on("issueEditor:loadError",this._onIssueLoadError,this);this.listView.searchPromise.done(_.bind(function(){this._makeVisible()},this));this.fullScreenIssue.hide();JIRA.Issues.overrideScrollIntoViewForSplit();this.setElement(this.navigatorContent);if(b.serverRendered){this._activateSubviews()}this._scrollLayoutOnZoom=this._initScrollLayoutOnZoom();if(this._scrollLayoutOnZoom){a(window).on("resize",this._scrollLayoutOnZoom)}this._updateSortBy()},_updateSortBy:function(){this.orderBy.setJql(this.search.getEffectiveJql())},_handleSort:function(b){this.search.doSort(b)},_adjustHeight:function(){var b=this.$el.find(".list-panel");var d=0,c=this.listView.$el.offset().top+b.scrollTop(),f=this.$el.find(".pagination-container").outerHeight(),e=window.innerHeight;if(this.endOfStableSearchView&&this.endOfStableSearchView.$el){d=this.endOfStableSearchView.$el.outerHeight()}b.css("height",e-c-d-f)},_adjustNoResultsMessageHeight:function(){var b;if(this.searchResults.hasIssues()){this.navigatorContent.css("height","")}else{b=this.navigatorContent.offset().top;this.navigatorContent.css("height",window.innerHeight-b)}},_initScrollLayoutOnZoom:function(){if(a.browser.msie){this.cachedDPI=screen.deviceXDPI;return _.bind(function(){if(this.cachedDPI!==screen.deviceXDPI){a("body, html").scrollTop(0)}this.cachedDPI=screen.deviceXDPI},this)}return null},_consumeServerRenderedSplitView:function(c){var d=!!AJS.Meta.get("consumed-server-rendered-split-view"),b=!!c.searchContainer.find(".split-view").length;AJS.Meta.set("consumed-server-rendered-split-view",true);return !d&&b},close:function(){JIRA.Issues.offVerticalResize(this._adjustHeight);JIRA.Issues.offVerticalResize(this._adjustNoResultsMessageHeight);JIRA.Issues.offHorizontalResize(this._updateSidebarPosition);JIRA.Issues.restoreScrollIntoViewForNormal();a("body").removeClass("page-type-split");JIRA.Issues.Application.off("issueEditor:loadError",this._onIssueLoadError,this);this.navigatorContent.addClass("pending").css("height","");this.orderBy.offSort(this._handleSort,this);this.search.offSearchError(this._onSearchFail,this);if(this._isIOS()){this._deactivateIOSSpecificBehaviour()}this.detailsView.deactivate();this.listView.deactivate();a(window).off("resize",this.applyResponsiveDesign);if(this._scrollLayoutOnZoom){a(window).off("resize",this._scrollLayoutOnZoom);delete this._scrollLayoutOnZoom}JIRA.Issues.BaseView.prototype.deactivate.apply(this,arguments);if(!this.searchResults.hasIssue(this.searchResults.getSelectedIssue().getId())){this.searchResults.selectFirstInPage()}},_handleInitialIssueSelection:function(){if(!this.searchResults.hasSelectedIssue()){if(this.searchResults.hasHighlightedIssue()){this.searchResults.selectIssueById(this.searchResults.getHighlightedIssue().getId(),{replace:true})}else{this.searchResults.selectFirstInPage({replace:true})}}},_hidePending:function(){this.navigatorContent.removeClass("pending")},_isInitialRender:function(){return !this.navigatorContent.find(".split-view").length},_applyWidthClass:function(){var b=this.detailsView.$el.width();this.$el.toggleClass("skinny",b<900);this.$el.toggleClass("very-skinny",b<600)},_makeVisible:function(){this.navigatorContent.removeClass("pending");if(this._isInitialRender()){this.navigatorContent.html(this.$el)}this.$el.find(".list-results-panel").sidebar({id:"splitview",minWidth:function(b){return 250},maxWidth:_.bind(function(){return this.$el[0].clientWidth-500},this),resize:this.applyResponsiveDesign});a(window).on("resize",this.applyResponsiveDesign);this._applyWidthClass();JIRA.trigger(JIRA.Events.LAYOUT_RENDERED);this.applyResponsiveDesign()},_updateSidebarPosition:function(){var b=this.$el.find(".list-results-panel");b.sidebar("updatePosition")},applyResponsiveDesign:function(){if(this.reapplyResponsive){clearTimeout(this.reapplyResponsive)}this.reapplyResponsive=setTimeout(_.bind(function(){this._applyWidthClass();clearTimeout(this.reapplyResponsive);delete this.reapplyResponsive},this),0)},_onHighlightedIssueChange:function(c,b){b=_.defaults({},b,{replace:true});var d=this.searchResults.getHighlightedIssue().getId();this.searchResults.selectIssueById(d,b)},_onIssueDeleted:function(b){this.listView.getIssueById(b.id).hide();this._showPending();if(this.searchResults.hasIssues()){this.listView.render();this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults()}else{this._renderEmptyResults()}},_onIssueLoadError:function(b){if(b.response.status===404){this.listView.markIssueInaccessible(b.issueId)}},_onSearchFail:function(){this._renderEmptyResults();this._hidePending()},_onSelectedIssueChange:function(){this._setIssueModuleContainer()},_onStartIndexChange:function(){if(this.searchResults.hasIssues()){this._showPending()}},nextIssue:function(){this.searchResults.selectNextIssue({replace:true})},prevIssue:function(){this.searchResults.selectPrevIssue({replace:true})},goToPage:function(b){this.searchResults.goToPage(b)},refreshSearch:function(){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){JIRA.Issues.Application.execute("analytics:trigger","kickass.issueTableRefresh");JIRA.Issues.Application.execute("issueNav:refreshSearch")}},render:function(){var c=this.searchResults.hasIssues(),b=this._isInitialRender();a("body").addClass("page-type-split");if(this._isIOS()){this._activateIOSSpecificBehaviour()}if(c){this._handleInitialIssueSelection();this.navigatorContent.removeClass("empty-results");if(b){this.$el.children().detach();this.$el.html(JIRA.Templates.SplitView.structure())}this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults();this._activateSubviews();this.detailsView.render();this.listView.render()}else{this._hidePending();this._renderEmptyResults()}this._adjustHeight();this._adjustNoResultsMessageHeight();this.orderBy.render();return this},_renderPagination:function(){if(this.paginationView){this.paginationView.close()}this.paginationView=new JIRA.Components.IssueNavigator.Views.Pagination({startIndex:this.searchResults.getStartIndex(),pageSize:this.searchResults.getPageSize(),total:this.searchResults.getTotal(),currentSearch:JIRA.Issues.Application.request("issueNav:currentSearchRequest")});this.listenTo(this.paginationView,"goToPage",this.goToPage);this.paginationView.render();this.$(".pagination-container").empty().append(this.paginationView.$el)},_renderEndOfStableSearch:function(){if(this.endOfStableSearchView){this.endOfStableSearchView.close()}this.endOfStableSearchView=new JIRA.Components.IssueNavigator.Views.EndOfStableMessage({total:this.searchResults.getTotal(),displayableTotal:this.searchResults.getDisplayableTotal(),pageNumber:this.searchResults.getPageNumber(),numberOfPages:this.searchResults.getNumberOfPages()});this.endOfStableSearchView.render();this.$(".end-of-stable-message-container").empty().append(this.endOfStableSearchView.$el)},_renderRefreshResults:function(){if(this.refreshResultsView){this.refreshResultsView.close()}this.refreshResultsView=new JIRA.Components.IssueNavigator.Views.RefreshResults();this.listenTo(this.refreshResultsView,"refresh",this.refreshSearch);this.refreshResultsView.render();this.$(".refresh-container").empty().append(this.refreshResultsView.$el)},_renderEverythingExceptListView:function(){var b=this.searchResults.hasIssues();if(b){this._renderPagination();this._renderEndOfStableSearch();this._renderRefreshResults();this._adjustHeight();this._adjustNoResultsMessageHeight()}},_renderEmptyResults:function(){this.emptyResultsView.render()},_setIssueModuleContainer:function(){JIRA.Issues.Application.execute("issueEditor:setContainer",this.$(".split-view .detail-panel > div"))},_showPending:function(){this.navigatorContent.addClass("pending")},_activateSubviews:function(){this.detailsView.setElement(this.$(".detail-panel")).activate();this.orderBy.setElement(this.$(".list-ordering"));this.listView.setElement(this.$(".list-content"));this._setIssueModuleContainer()},handleLeft:function(){this.detailsView.blur()},handleRight:function(){this.detailsView.focus()},isIssueViewActive:function(){return this.detailsView.hasFocus()},_isIOS:function(){var b=navigator.platform;return b==="iPod"||b==="iPhone"||b==="iPad"},_activateIOSSpecificBehaviour:function(){a(document).on("touchmove.iOSSpecific",function(b){b.preventDefault()});a("body").on("touchstart.iOSSpecific",".issue-container, .list-panel",function(b){if(b.currentTarget.scrollTop===0){b.currentTarget.scrollTop=1}else{if(b.currentTarget.scrollHeight===b.currentTarget.scrollTop+b.currentTarget.offsetHeight){b.currentTarget.scrollTop-=1}}});a("body").on("touchmove.iOSSpecific",".issue-container, .list-panel",function(b){b.stopPropagation()})},_deactivateIOSSpecificBehaviour:function(){a(document).off("touchmove.iOSSpecific");a("body").off("touchstart.iOSSpecific");a("body").off("touchmove.iOSSpecific")}}))})(jQuery);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/FullScreenLayout.js' */
(function(e,b,a,d,c){AJS.namespace("JIRA.Issues.FullScreenLayout");JIRA.Issues.FullScreenLayout=e.Controller.extend({initialize:function(f){this.searchService=new b({searchModule:f.search,searchResults:f.search.getResults(),columnConfig:f.columnConfig});this.$navigatorContent=f.searchContainer.find(".navigator-content");this.issueTable=new a({searchService:this.searchService,el:this.$navigatorContent,columnConfig:f.columnConfig});this.listenTo(this.issueTable,{highlightIssue:function(g){this.searchService.highlightIssue(g)},render:function(){if(!this.searchService.hasSelectedIssue()){this.fullScreenIssue.hide()}this.fullScreenIssue.bindSearchService(this.searchService);this.trigger("render")}});this.fullScreenIssue=f.fullScreenIssue;this.listenTo(this.fullScreenIssue,{issueHidden:function(){this.issueTable.highlightIssue(this.searchService.getHighlightedIssue())}});d.on("issueEditor:loadError",this.onLoadError,this)},onLoadError:function(f){if(!this.fullScreenIssue.isVisible()){this.searchService.unselectIssue();c.showErrorMsg(AJS.format("{0} can not be opened. The issue may have been deleted or you might not have permission to see the issue.",f.issueKey),{closeable:true})}},render:function(){this.issueTable.show()},onClose:function(){this.fullScreenIssue.deactivate();this.issueTable.close();this.searchService.close();d.off("issueEditor:loadError",this.onLoadError,this);delete this.fullScreenIssue;delete this.issueTable;delete this.searchService},nextIssue:function(){this.searchService.selectNextIssue()},prevIssue:function(){this.searchService.selectPreviousIssue()},returnToSearch:function(){this.searchService.unselectIssue()},handleLeft:function(){},handleRight:function(){},isIssueViewActive:function(){return this.fullScreenIssue.isVisible()}})})(JIRA.Marionette,JIRA.Components.SearchService,JIRA.Components.IssueTable,JIRA.Issues.Application,JIRA.Messages);
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-common', location = 'content/js/search/EmptyResultsView.js' */
Backbone.define("JIRA.Issues.EmptyResultsView",JIRA.Issues.BaseView.extend({initialize:function(a){this.searchResults=a.searchResults},render:function(){var d;var e;var b;var a;var c=JIRA.Issues.UserParms.get().createIssue;if(!JIRA.Issues.LoginUtils.isLoggedIn()){d="No issues were found to match your search";e="Try \u003ca\u003elogging in\u003c/a\u003e to see more results";b="not-logged-in-message";a="login"}else{if(this.searchResults.getJiraHasIssues()===false){d="No issues have been created (yet)";e=c?"Be the first to \u003ca\u003ecreate an issue\u003c/a\u003e":null;b="empty-results-message";a="create"}else{d="No issues were found to match your search";e=c?"Try modifying your search criteria or \u003ca\u003ecreating a new issue\u003c/a\u003e":"Try modifying your search criteria";b="no-results-message";a="create"}}this.$el.addClass("empty-results");this.$el.html(JIRA.Templates.IssueNavTable.noResults({message:d,hint:e,cssClass:b}));var f=this.$(".no-results-hint a");switch(a){case"create":f.addClass("create-issue").attr("href",AJS.contextPath()+"/secure/CreateIssue!default.jspa");break;case"login":f.attr("href",JIRA.Issues.LoginUtils.redirectUrlToCurrent()).addClass("login-link");break}_.defer(jQuery.event.trigger,"updateOffsets.popout");_.defer(JIRA.trace,"jira.search.finished")}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/DialogCleanup.js' */
JIRA.Issues.dialogCleaner=function(a){a.on("navigate",function(){if(JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(AJS.HelpTip&&AJS.HelpTip.Manager){AJS.HelpTip.Manager.hideSequences();AJS.HelpTip.Manager.clearSequences()}})};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/OverrideIssueDialogUtil.js' */
JIRA.Dialogs.getDefaultAjaxOptions=function(){var a=this.options.url||this.getRequestUrlFromTrigger();this.issueId=JIRA.Issues.Api.getSelectedIssueId();this.issueKey=JIRA.Issues.Api.getSelectedIssueKey();if(/id=\{0\}/.test(a)){if(!this.issueId){return false}else{a=a.replace(/(id=\{0\})/,"id="+this.issueId)}}return{data:{decorator:"dialog",inline:"true"},url:a}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/util/OverrideIssueDialogs.js' */
(function(){var e,f,b;JIRA.Issues.overrideIssueDialogs=function(g){g=_.defaults({},g,{isNavigator:false});e=g.getIssueId;f=!!g.isNavigator;b=g.updateIssue;if(f){JIRA.LabelsDialog.prototype._handleSubmitResponse=JIRA.FormDialog.prototype._handleSubmitResponse}AJS.$(function(){var h=JIRA.IssueNavigator.Shortcuts;JIRA.unbind("QuickEdit.sessionComplete",h._quickEditSessionCompleteHandler);JIRA.bind("QuickEdit.sessionComplete",function(){b(JIRA.Dialog.current)});JIRA.unbind("QuickCreateSubtask.sessionComplete",h._quickCreateSubtaskSessionCompleteHandler);JIRA.bind("QuickCreateSubtask.sessionComplete",function(){b(JIRA.Dialog.current)})});JIRA.bind("Dialog.show",function(j,i,h){if(h){h.issueId=e(JIRA.Dialog.current)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,h){h.find(".issueaction-workflow-transition").each(function(){var k=AJS.$(this);var j=k.attr("href");j=j.replace(/atl_token=[^&]*/,"atl_token="+atl_token());k.attr("href",j)})});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(l,j){var k=AJS.$("#ops-login-lnk");if(k.length==0){return}var h=window.location;var i=parseUri(k.attr("href"));i.queryKey.os_destination=h.pathname.slice(contextPath.length)+h.search;k.attr("href",i.path+"?"+AJS.$.param(i.queryKey))})};var d=JIRA.FormDialog.prototype._getDefaultOptions;JIRA.FormDialog.prototype._getDefaultOptions=function(){var g=d.call(this),h=g.onDialogFinished;g.onDialogFinished=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{h.apply(this,arguments)}};return g};var a=JIRA.FormDialog.prototype._performRedirect;JIRA.FormDialog.prototype._performRedirect=function(){if(this.isIssueDialog()){c.apply(this,arguments)}else{a.apply(this,arguments)}};function c(){if(this.options.id==="clone-issue-dialog"){a.apply(this,arguments)}else{if(this.options.id==="delete-issue-dialog"){if(f){this.hide();b(this)}else{var h=this._getTargetUrlValue();if(h&&h!==""){AJS.reloadViaWindowLocation(h)}else{if(AJS.$(".page-navigation #next-issue").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #next-issue").attr("href"))}else{if(AJS.$(".page-navigation #return-to-search").length>0){AJS.reloadViaWindowLocation(AJS.$(".page-navigation #return-to-search").attr("href"))}else{AJS.reloadViaWindowLocation(AJS.$("#find_link").attr("href"))}}}}}else{var g=this;this.showFooterLoadingIndicator();b(this).always(function(){JIRA.trace("jira.issue.update");g.hideFooterLoadingIndicator();g.hide()})}}}})();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav-page-changes', location = 'content/js/search/enhanceIssueLinks.js' */
JIRA.Issues.enhanceLinks={withPushState:function(a){a=_.defaults(a,{selector:".push-state"});AJS.$(document).delegate(a.selector,"simpleClick",function(d){if(this.href){d.preventDefault();var b=parseUri(this.href);var c=b.path;if(b.query){c+="?"+b.query}c=c.replace(Backbone.history.options.root,"");if(Backbone.history.fragment==c||Backbone.history.fragment==decodeURIComponent(c)){Backbone.history.loadUrl(c)}else{a.router.navigate(c,{trigger:true})}}})},toIssueNav:function(a){var c="a.filter-link[data-filter-id], a.filter-link[data-jql]",b="#issues_new_search_link_lnk";AJS.$(document).on("simpleClick",c,function(h){h.preventDefault();var g=AJS.$(h.target).closest("a"),f=g.data("filter-id"),d=g.data("jql");a.searchPageModule.reset({filter:f,jql:d})});AJS.$(document).on("simpleClick",b,function(d){d.preventDefault();a.searchPageModule.resetToBlank()})},isIssueTableDropdown:function(a){if(AJS.InlineLayer.current){var b=jQuery(AJS.InlineLayer.current.offsetTarget());if(b.closest(".list-view table#issuetable").size()){return true}}},toIssue:function(b){AJS.$(document).on("simpleClick",["#attachment-sorting-options a","#attachment-sorting-order-options a","#subtasks-show-all","#subtasks-show-open"].join(","),function(g){if(this.href){g.preventDefault();g.stopPropagation();var f=parseUri(this.href);if(f.queryKey){JIRA.Issues.Application.execute("issueEditor:updateIssueWithQuery",f.queryKey);AJS.$(this).parents("ul").find("a.aui-checked").removeClass("aui-checked");AJS.$(this).addClass("aui-checked")}}});var d="a.issue-link[data-issue-key]",c=".parentIssue",a=".list-view table#issuetable a.issue-link[data-issue-key]";AJS.$(document).on("simpleClick",d,function(k){k.preventDefault();k.stopPropagation();var i=b.searchPageModule.searchResults;var f=AJS.$(k.target).closest("a").data("issue-key");var g=i._getIssueIdForKey(f);var l=parseInt(g,10);var j=AJS.$(k.target).is(a);var m=AJS.$(k.target).is(c);var h=JIRA.Issues.enhanceLinks.isIssueTableDropdown(a);if((j&&!m)||h){JIRA.Issues.Application.execute("analytics:trigger","kickass.openIssueFromTable",{issueId:g,absolutePosition:i.getPositionOfIssueInSearchResults(l)+1,relativePosition:i.getPositionOfIssueInPage(l)+1});b.searchPageModule.update({selectedIssueKey:f})}else{b.searchPageModule.reset({selectedIssueKey:f})}})},transformToAjax:function(){AJS.$(document).on("simpleClick",".subtask-reorder a",function(a){if(this.href){a.preventDefault();a.stopPropagation();AJS.$.ajax({type:"GET",data:{disableRedirect:true},url:this.href}).done(function(){JIRA.Issues.Api.refreshSelectedIssue({reason:JIRA.Issues.Actions.UPDATE})}).fail(function(b){JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(b),{closeable:true})})}})}};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/Notifications.js' */
JIRA.Issues.showNotification=function(){var a={thanks_issue_updated:"{0} has been updated.",thanks_issue_transitioned:"{0} has been updated.",thanks_issue_assigned:"{0} has been assigned.",thanks_issue_commented:"{0} has been updated with your comment.",thanks_issue_worklogged:"Work has been logged on {0}.",thanks_issue_voted:"Your vote on {0} has been updated.",thanks_issue_watched:"Your watcher status on {0} has been updated.",thanks_issue_moved:"{0} has been moved.",thanks_issue_linked:"The links on {0} have been updated.",thanks_issue_cloned:"{0} has been cloned.",thanks_issue_labelled:"The labels on {0} have been updated.",thanks_issue_deleted:"{0} has been deleted.",thanks_issue_attached:"The file(s) have been attached to {0}."};return function(c,b){var d;if(!c){c="thanks_issue_updated"}d=a[c];if(d&&b){d=AJS.format(d,b)}JIRA.Messages.showSuccessMsg(d||c,{closeable:true})}}();
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavRouter.js' */
Backbone.define("JIRA.Issues.IssueNavRouter",JIRA.Issues.BaseRouter.extend({initialize:function(a){_.extend(this,a);_.bindAll(this,"_restoreSessionSearch","_route");this.route(/^(.*?)([\?]{1}.*)?$/,this._route);this.route(/^(issues\/)?$/,this._restoreSessionSearch);delete Backbone.Router.arrayValueSplit},navigate:function(){this.searchPageModule.removeOpenTipsies();this.trigger("navigate");JIRA.Issues.BaseRouter.prototype.navigate.apply(this,arguments)},pushState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false})},replaceState:function(a){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{trigger:false,replace:true})},_restoreSessionSearch:function(){var b=this.initialSessionSearchState,a=JIRA.Issues.URLSerializer.getURLFromState(b||this.searchPageModule.getState());this.navigate(a,{replace:true,trigger:true})},_route:function(d,c){var a=this.toFragment(d,c);if(JIRA.Issues.ignorePopState){return}var b=JIRA.Issues.URLSerializer.getStateFromURL(a);if(!this._navigateToLoginIfNeeded(b)){this._navigateUsingState(b)}},_navigateToLoginIfNeeded:function(c,d){if(!JIRA.Issues.IssueNavRouter.usePushState(d)&&c.selectedIssueKey&&!JIRA.Issues.LoginUtils.isLoggedIn()){var a=this;var b={};if(c.filter!=null){b.filterId=c.filter}jQuery.ajax({url:AJS.contextPath()+"/rest/issueNav/1/issueNav/anonymousAccess/"+c.selectedIssueKey,headers:{"X-SITEMESH-OFF":true},data:b,success:function(){a._navigateUsingState(c)},error:function(e){if(e.status===401){a._redirectToLogin(c)}else{a._navigateUsingState(c)}}});return true}return false},_navigateUsingState:function(a){if(JIRA.Issues.Application.request("issueEditor:canDismissComment")){this._setStatePermalink(a);this.navigate(JIRA.Issues.URLSerializer.getURLFromState(a),{replace:true,trigger:false});this.searchPageModule.updateFromRouter(a)}},_redirectToLogin:function(b){var a=AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(JIRA.Issues.URLSerializer.getURLFromState(b));window.location.replace(a)},_setStatePermalink:function(d){var b=_.pick(d,"selectedIssueKey");var c=AJS.Meta.get("jira-base-url");if(!_.isEmpty(b)){AJS.Meta.set("viewissue-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(b))}var a=_.omit(d,"selectedIssueKey");if(!_.isEmpty(a)){AJS.Meta.set("issuenav-permlink",c+"/"+JIRA.Issues.URLSerializer.getURLFromState(a))}}},{getBackboneRoot:function(a){return AJS.contextPath()+(this.usePushState(a)?"/":"/i")},usePushState:function(c){var a=(c=c||window.history)&&c.pushState,b=AJS.DarkFeatures.isEnabled("ka.I_ROOT");return a&&!b}}));
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/util/HandlePushStateInIE.js' */
JIRA.Issues.hashTheUrl=function(b){var d=parseUri(b);var a={changed:false,uri:d};if(d.anchor===""&&d.query!==""){var c=d.protocol+"://"+d.authority+d.path;a.uri=c+"#?"+d.query;a.changed=true}return a};
/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:issuenav', location = 'content/js/search/IssueNavCreator.js' */
(function(c,b){JIRA.Events.LAYOUT_RENDERED="layoutRendered";AJS.namespace("JIRA.Issues.IssueNavCreator");JIRA.Issues.IssueNavCreator.create=function(p,q){var f=this.searchPageModule=new JIRA.Issues.SearchPageModule({},{initialIssueTableState:q.initialIssueTableState});f.registerViewContainers({issueContainer:c(".issue-container"),searchContainer:c(".navigator-container")});var j=this.searchHeaderModule=new JIRA.Issues.SearchHeaderModule({searchPageModule:f});var g=new JIRA.Issues.FilterModule({searchPageModule:f,systemFilters:f.addOwnerToSystemFilters(q.systemFilters)});var l=JIRA.Components.Query.create({el:p.find("form.navigator-search"),searchers:q.initialSearcherCollectionState,preferredSearchMode:AJS.Meta.get("user.search.mode"),layoutSwitcher:true,autocompleteEnabled:AJS.params.autocompleteEnabled,basicAutoUpdate:AJS.Meta.getBoolean("hasCriteriaAutoUpdate")});JIRA.bind(JIRA.Events.ISSUE_TABLE_REORDER,function(r){if(!JIRA.Issues.Application.request("issueEditor:canDismissComment")){r.preventDefault()}});this.layoutSwitcherView=new JIRA.Issues.LayoutSwitcherView({searchPageModule:f});this.layoutSwitcherView.setElement(p.find("#layout-switcher-toggle")).render();var k=JIRA.Issues.Application.request("issueEditor");JIRA.Issues.Application.on("issueEditor:render",function(r){JIRA.Issues.Application.execute("pager:render",r.pager)});JIRA.Issues.Application.commands.setHandler("returnToSearch",function(){JIRA.Issues.Application.execute("issueEditor:close")});JIRA.Issues.Application.on("issueEditor:saveSuccess",function(r){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])});JIRA.Issues.Application.on("issueEditor:saveError",function(r){if(!r.deferred){JIRA.trigger(JIRA.Events.ISSUE_REFRESHED,[r.issueId])}});JIRA.Issues.FocusShifter.init();var o=k.viewIssueData;var n=new JIRA.Issues.IssueSearchManager({initialIssueTableState:q.initialIssueTableState,initialIssueIds:q.initialIssueIds});var h=new JIRA.Issues.SearchModule({searchPageModule:f,queryModule:l,issueSearchManager:n,initialSelectedIssue:q.initialSelectedIssue});var d=new JIRA.Issues.Cache.IssueCacheManager({searchResults:h.getResults(),viewIssueData:o});var e=p.find(".saved-search-selector");var i=new JIRA.Issues.FullScreenIssue({issueContainer:f.issueContainer,searchContainer:f.searchContainer,issueCacheManager:d});f.registerSearch(h);f.registerSearchHeaderModule(j);f.registerFilterModule(g);f.registerQueryModule(l);f.registerFullScreenIssue(i);f.registerIssueSearchManager(n);f.registerIssueCacheManager(d);f.registerLayoutSwitcher(this.layoutSwitcherView);j.registerSearch(h);j.createToolsView(e);var m=this.issueNavRouter=new JIRA.Issues.IssueNavRouter({searchPageModule:f,initialSessionSearchState:q.initialSessionSearchState});f.registerIssueNavRouter(m);JIRA.Issues.enhanceLinks.toIssueNav({searchPageModule:f});JIRA.Issues.enhanceLinks.withPushState({router:m});JIRA.Issues.enhanceLinks.toIssue({searchPageModule:f});JIRA.Issues.enhanceLinks.transformToAjax();JIRA.Issues.dialogCleaner(m);JIRA.Issues.Api.initialize({searchPageModule:f});JIRA.Issues.IssueAPI.override({searchPageModule:f});JIRA.Issues.IssueNavigatorAPI.override({searchPageModule:f});JIRA.Dialogs.BeforeShowIssueDialogHandler.add(JIRA.Issues.Api.waitForSavesToComplete);JIRA.Issues.overrideIssueDialogs({getIssueId:b.bind(f.getEffectiveIssueId,f),isNavigator:true,updateIssue:function(r){var s=JIRA.Issues.Utils.getUpdateCommandForDialog(r);return f.updateIssue(s)}});c(document).keydown(function(t){var v=c("div.aui-blanket").length>0,r=(t.which===c.ui.keyCode.ENTER||t.which===c.ui.keyCode.LEFT||t.which===c.ui.keyCode.UP||t.which===c.ui.keyCode.RIGHT||t.which===c.ui.keyCode.DOWN);if(!v&&r){var s=c(t.target),u=s.is(":not(:input)");if(s==undefined||u){if(t.which===c.ui.keyCode.ENTER){if(s==undefined||s.is(":not(a)")){JIRA.Issues.Api.viewSelectedIssue()}}else{if(t.which===c.ui.keyCode.LEFT){f.handleLeft()}else{if(t.which===c.ui.keyCode.RIGHT){f.handleRight()}else{if(t.which===c.ui.keyCode.UP){if(f.handleUp()){t.preventDefault()}}else{if(t.which===c.ui.keyCode.DOWN){if(f.handleDown()){t.preventDefault()}}}}}}}}});this.searchResults=h.getResults();this.searchPageModule.on("change",a);this.searchResults.on("change",a);this.searchResults.getSelectedIssue().on("change",a);return this};function a(){var d=JIRA.Issues.LoginUtils.redirectUrlToCurrent();c(".login-link").attr("href",d)}AJS.namespace("JIRA.Issues.GlobalIssueNavCreator");JIRA.Issues.GlobalIssueNavCreator.create=function(g,f){var k=g.find(".navigator-sidebar");var d=g.find("#search-header-view");var j=JIRA.Issues.IssueNavCreator.create(g,f);var h=j.searchPageModule.filterModule;h.createView({$filterPanelEl:k});h.filtersComponent.showFilterHeader({el:d,model:j.searchPageModule.getFilter(),isDirty:j.searchPageModule.isDirty()});var e=c("#quicksearch-message");if(e.length){var i=JIRA.Messages.showWarningMsg(e.find("p").html(),{closeable:true});c("a",i).click(function(){i.remove()})}return j}})(AJS.$,_);
/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/popupuserprefstore.js' */
/**
 * @fileoverview Implements the gadgets.UserPrefStore interface storing data in a javascript store.
 */
AJS.namespace("jira.plugin.chartingstore");

jira.plugin.chartingstore = function() {
    var userPrefMap = {};
    return {
        get: function (gadgetId) {
            var userPrefs = userPrefMap[gadgetId];
            if(!userPrefs) {
                return {};
            }
            return userPrefs;
        },
        set: function (gadgetId, name, value) {
            var prefs = this.get(gadgetId);
            prefs[name] = value;
            userPrefMap[gadgetId] = prefs;
        },
        clear: function() {
            userPrefMap = {};
        }
    };
}();

gadgets.IfrGadgetService.prototype.setUserPref = function(editToken, name, value) {
    var gadgetId = this.f;
    if(gadgetId) {
        gadgetId = gadgetId.substr("gadget-".length);
    }
    jira.plugin.chartingstore.set(gadgetId, name, value);
};

/* module-key = 'com.atlassian.jira.gadgets:searchrequestview-charts', location = 'script/chartpopup/chartdialog.js' */
/**
 * @module jira.plugin.charting
 * @author Scott Harwood
 * @since 4.0
 * @requires jQuery > v1.6, jQuery.aop
 */

 /*JSLINT options*/
 /*jslint white: true, browser: true, onevar: true, plusplus: true, regexp: true, eqeqeq: true */
 /*global window, document, jQuery, dhtmlHistory, jira*/

AJS.namespace("jira.plugin.charting");

// singleton
jira.plugin.charting = function () {
    var dialog, /* {Object} jquery object */
    DIALOG_ID = "charts-dialog",
    CHARTS_CATEGORY = "Charts",
    CHART_HEIGHT = 522,
    saveFormLoaded = false,
    idToUriMap = {},
    dialogThrobber = AJS.$('<span class="icon throbber"></span>'),

    getPostData = function(formData) {
        var postData = {};
        jQuery.each(formData, function(i, field) {
            postData[field.name] = field.value;
        });
        var filterId = getFilterId();
        if(filterId) {
            postData.filterId = filterId;
        } else {
            postData.jql = getFilterJql() || "";
        }
        var chartPanelId = dialog.getPage(0).curtab;
        postData.gadgetUri = idToUriMap[chartPanelId];
        var userPrefs = jira.plugin.chartingstore.get(chartPanelId);
        if(userPrefs) {
            var prefsMap = {};
            for (var key in userPrefs) {
                prefsMap[key] = userPrefs[key];
            }
            postData.userPrefs = prefsMap;
        }

        return postData;
    },

    loadSaveToDashboardForm = function() {
        if(!saveFormLoaded) {
            var saveFormUrl = contextPath + "/rest/gadget/1.0/chart/add";
            var filterId = getFilterId();
            if(filterId) {
                saveFormUrl = saveFormUrl + "?filterId=" + encodeURIComponent(filterId);
            } else {
                saveFormUrl = saveFormUrl + "?jql=" + encodeURIComponent(getFilterJql());
            }

            var saveFormPanel = jQuery("#saveToDashboardPanel");
            saveFormPanel.empty();
            jQuery.ajax({
                url: saveFormUrl,
                success: function(data) {
                    saveFormPanel.html(data);
                    saveFormLoaded = true;
                    var chartForm = saveFormPanel.find("form#savetodashboardform");
                    var saveButton = saveFormPanel.find("#save-btn1");
                    chartForm.submit(function(e) {
                        e.preventDefault();
                        chartForm.find(".error").remove();
                        chartForm.find(".form-errors p").remove();
                        chartForm.find(".form-errors").hide();
                        saveButton.attr("disabled", "true");

                        var postData = getPostData(chartForm.serializeArray());
                        jQuery.ajax({
                            url: chartForm.attr("action"),
                            contentType:'application/json',
                            dataType: "text",
                            data: JSON.stringify(postData),
                            type:'POST',
                            success: function (data) {
                                chartForm.trigger("fakesubmit");
                                saveButton.removeAttr("disabled", "false");
                                window.location = data;
                            },
                            error: function(XMLHttpRequest, textStatus, errorThrown) {
                                saveButton.removeAttr("disabled", "false");
                                if(XMLHttpRequest.status === 400) {
                                    var errorCollection = eval("(" + XMLHttpRequest.responseText + ")");
                                    if(errorCollection.generic.length > 0) {
                                        jQuery(errorCollection.generic).each(function(i, item) {
                                        chartForm.find(".form-errors").append("<p>" + item + "</p>");
                                        });
                                        chartForm.find(".form-errors").show();
                                    }
                                    if(errorCollection.fields.length > 0) {
                                        jQuery(errorCollection.fields).each(function(i, item) {
                                            chartForm.find("#" + item.field).after("<div class=\"error\">" + item.error + "</div>");
                                        });
                                    }
                                }
                            }
                        });

                    });
                    saveFormPanel.find("#cancel-btn1").click(function(e) {
                        dialog.prevPage();
                        saveButton.removeAttr("disabled", "false");
                        chartForm.find(".form-errors").hide();
                        chartForm.find(".error").remove();
                        e.preventDefault();
                    });
                }
            });
        }
    },

    /**
     * Appends loading indicator (throbber) to all ajax requests. Indicator, controlled via css, appears in the top
     * right corner of the dialog.
     *
     * @method addThrobber
     * @private
     */
    addThrobber = function () {
        dialog.popup.element.find(".dialog-button-panel").prepend(dialogThrobber);
        jQuery().ajaxSend(function(a,xhr) {
            if (dialog.popup.element.is(":visible")) {
                jQuery(xhr).throbber({target: dialogThrobber});
            }
        });
    },

    /**
     * Handles failed ajax requests. Will subsitute the page body with the 500 error that occured.
     *
     * @method addErrorHandler
     * @private
     */
    addErrorHandler = function () {
        jQuery().ajaxError(function(e,XMLHttpRequest,ajaxOptions){
            if (XMLHttpRequest.status == 500) {
                dialog.hide();
                jQuery("body").html(XMLHttpRequest.responseText);
            }
        });
    },

    /**
     * ESC hides the dialog
     */
    keypressListener = function(e) {       
        if (e.keyCode === 27) {
            dialog.hide();
        }
    },

    /**
     * Creates dialog box. Adds global functionality including error handling and ajax throbber indicator.
     *
     * @method createDialog
     * @private
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     */
    createDialog = function (width, height, data) {
        dialog = new AJS.Dialog(width, height, DIALOG_ID);
        dialog.addHeader("Gadgets");
        resetPanels(data);
        dialog.addButton("Save to Dashboard",
                function(dialog) {
                    loadSaveToDashboardForm();
                    dialog.nextPage();
                },
                "save-to-dashboard");
        dialog.addCancel("Cancel", function(dialog) {
            dialog.hide();
        });
        dialog.addPage();
        dialog.page[1].addPanel("saveToDashBoard", "<div id=\"saveToDashboardPanel\"</div>");
        dialog.page[1].addHeader("Save gadget to a Dashboard");
        addThrobber();
        addErrorHandler();
        AJS.$(document).keydown(keypressListener);
    },

    /**
     * Resets the dialog to the original state when it pops up.
     *
     * @method resetDialog
     * @param {Number} initialPanel - the panel index to go to after resetting the dialog
     * @private
     */
    resetDialog = function(initialPanel) {
        if(dialog) {
            saveFormLoaded = false;
            jQuery("form[name=chartpopup]").show();
            jQuery("input[name=filterName]").val("");
            dialog.gotoPage(0);
            for(var i = 0; dialog.getPanel(i); i++) {
                var panel = dialog.getPanel(i);
                panel.loaded = false;
            }
            dialog.gotoPanel(initialPanel);
        }
    },

    /**
     * Given a directory JSON object this method figures out all the chart gadgets to display in the popup.
     *
     * @method createDialog
     * @private
     * @param {json} data -
     */
    loadChartGadgets = function(data) {
        // Fill items on the right
        var chartGadgets = [], filterResultsGadget, uri = parseUri(window.location);
        var baseUrl = uri.protocol + "://" + uri.authority;
        jQuery(data.gadgets).each(function(i, gadget) {
            //JRADEV-4419: Only add gadgets that are hosted locally to the dialog!
            if(gadget.gadgetSpecUri.indexOf("http") !== 0 || gadget.gadgetSpecUri.indexOf(baseUrl) === 0) {
                jQuery([gadget.categories]).each(function(i, catKey) {
                    var g = {title:gadget.title, specUri:gadget.gadgetSpecUri};
                    // we want to stick the Filter Results gadget at the front of the list of gadgets, so keep a reference to it
                    if (g.specUri.indexOf("filter-results") > -1) {
                        filterResultsGadget = g;
                    }
                    if(catKey.constructor==Array) { // if there are multiple categories for this gadget, loop through all of them
                        for(var j=0; j<catKey.length; ++j) {
                            // don't add the Filter Results gadget to the array - we'll do it later
                            if(catKey[j] === CHARTS_CATEGORY && filterResultsGadget != g) {
                                chartGadgets.push(g);
                            }
                        }
                    }
                    else {
                        // don't add the Filter Results gadget to the array - we'll do it later
                        if(catKey === CHARTS_CATEGORY && filterResultsGadget != g) {
                            chartGadgets.push(g);
                        }
                    }
                });
            }
        });

        chartGadgets.sort(function(one, two) { return (one.title > two.title ? 1 : -1); });
        // add the Filter Results gadget to the start
        if (filterResultsGadget) {
            chartGadgets.unshift(filterResultsGadget);
        }
        return chartGadgets;
    },

    /**
     * Renders the contents of a particular panel for a particular chart.
     *
     * @method renderPanelContents
     * @private
     * @param {Object} panel - the panel to render
     * @param {Object} data - json object with the directory contents
     */
    renderPanelContents = function(panel, data) {
        panel.body.html(data);
        panel.loaded = true;
    },

    /**
     * Sets up all the panels when the dialog loads
     *
     * @method resetPanels
     * @private
     * @param {Object} data - json object of the directory contents
     */
    resetPanels = function(data) {
        var chartGadgets = loadChartGadgets(data);
        dialog.gotoPage(0);
        jQuery(chartGadgets).each(function(i, gadget) {
            dialog.page[0].addPanel(gadget.title, "<div class=\"loadingPanel\">&nbsp;</div>");
            var panel = dialog.getPanel(i);
            if(panel) {
                panel.loaded = false;
                idToUriMap[i] = gadget.specUri;
                panel.body.show = function (panel, show) {
                    return function() {
                        if(!panel.loaded) {
                            var rendererUrl = contextPath + "/rest/gadget/1.0/chart/render?id=" + i + "&gadgetUri=" + encodeURIComponent(gadget.specUri);
                            var filterId = getFilterId();
                            if(filterId) {
                                rendererUrl = rendererUrl + "&filterId=" + encodeURIComponent(filterId);
                            } else {
                                rendererUrl = rendererUrl + "&jql=" + encodeURIComponent(getFilterJql());
                            }

                            jQuery.ajax({
                                url: rendererUrl,
                                success: function(data) {
                                    renderPanelContents(panel, data);
                                }
                            });
                        }
                        show.call(panel.body);
                    };
                }(panel, panel.body.show);
            }
        });
    },

    /**
     * Creates a new dialog (if necessary and displays it)
     *
     * @method launchDialog
     * @private
     * @param {String} url - the url to get the direcotry JSON object from
     * @param {String, Number} width - width of dialog box
     * @param {String, Number} height - height of dialog box
     * @param {String, Number} initialPanel - the first panel to load
     */
    launchDialog = function (url, width, height, initialPanel) {
        if(dialog) {
            //this ensures that all the panels will get loaded from the server again.
            resetDialog(initialPanel);
            dialog.show();
        } else {
            jQuery(jQuery.ajax({
                url: url,
                dataType: 'json',
                success: function (data) {
                    if (!dialog) {
                        createDialog(width, height, data);
                    }
                    dialog.show();
                    dialog.gotoPage(0);
                    dialog.gotoPanel(initialPanel);
                }
            })).throbber({target: jQuery("#throbber-space")});
        }
    },

    getFilterId = function()
    {
        var filterId = AJS.Meta.get('filter-id');

        if (filterId && filterId >= 0) {
            return filterId;
        }

        return null;
    },

    getFilterJql = function()
    {
        return AJS.Meta.get('filter-jql');
    };

    return function () {
        // if they clicked on Charts we default to the first chart i.e. Panel 1
        jQuery("body").delegate("#charts", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 1);
            e.preventDefault();
        });
        // if they clicked on On Dashboard we default to the Filter Results gadget i.e. Panel 0
        jQuery("body").delegate("#onDashboard", "click", function(e) {
            AJS.populateParameters();
            launchDialog(contextPath + "/rest/config/1.0/directory.json", 800, CHART_HEIGHT, 0);
            e.preventDefault();
        });
    };
}();

// wait for page to fully load to make sure we have all the elements we need
jQuery(document).ready(jira.plugin.charting);


/* module-key = 'com.atlassian.jira.jira-issue-nav-plugin:standalone-issue-nav', location = 'content/js/search/IssueNavInit.js' */
(function(){if(history&&history.pushState===undefined){var a=JIRA.Issues.hashTheUrl(window.location);if(a.changed){window.location=a.uri}}jQuery("html").addClass("hide-until-domready");jQuery(function(){jQuery("html").removeClass("hide-until-domready")});jQuery(document).on("keydown",function(b){if(b.which===27){b.preventDefault()}})})();AJS.$(function(){var f=AJS.$(".navigator-content");var i=f.data("issue-table-model-state");if(i&&!i.table){var a=AJS.$("<div></div>").append(f.children().clone());i.issueTable.table=a.html()}var e=AJS.$("#stableSearchIds").data("ids");var g=f.data("selected-issue");var c=jQuery.parseJSON(jQuery("#criteriaJson").text());var d=f.data("session-search-state");var h=jQuery.parseJSON(jQuery("#systemFiltersJson").text());JIRA.Issues.Application.start({showReturnToSearchOnError:function(){return JIRA.Issues.LayoutPreferenceManager.getPreferredLayoutKey()!=="split-view"},useLog:AJS.Meta.get("dev-mode")===true});JIRA.Issues.AnalyticsLoader();var b=JIRA.Issues.GlobalIssueNavCreator.create(AJS.$(document),{initialIssueTableState:i,initialSearcherCollectionState:c,initialSessionSearchState:d,initialSelectedIssue:g,initialIssueIds:e,systemFilters:h});Backbone.history.start({pushState:!AJS.DarkFeatures.isEnabled("ka.I_ROOT"),root:JIRA.Issues.IssueNavRouter.getBackboneRoot()});if(jQuery.browser.webkit){JIRA.Issues.ignorePopState=true;window.addEventListener("load",function(){setTimeout(function(){JIRA.Issues.ignorePopState=false},0)})}AJS.KeyboardShortcut.addIgnoreCondition(function(m,l,k){return k==="issueaction"&&JIRA.Issues.Api.isCurrentlyLoadingIssue()});var j=parseInt(jQuery("body").css("minWidth"),10);jQuery(document).bind("resultsWidthChanged",function(){var k=jQuery(".contained-content");var n=k.parent();if(k.length>0){var m=k.offset().left;var o=Math.max(window.innerWidth,j)-m;var l=o/n.width()*100;if(l<100){k.css("width",l+"%")}else{k.css("width","")}jQuery(document).trigger("issueNavWidthChanged")}});AJS.$(document).trigger("resultsWidthChanged");JIRA.Issues.onVerticalResize(function(){jQuery.event.trigger("updateOffsets.popout")});JIRA.bind(JIRA.Events.LAYOUT_RENDERED,function(){_.defer(function(){jQuery.event.trigger("updateOffsets.popout")})})});JIRA.Issues.displayFailSearchMessage=function(a){if(a&&a.statusText!=="abort"){return JIRA.Messages.showErrorMsg(JIRA.SmartAjax.buildSimpleErrorContent(a),{closeable:true})}};
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    output.append('<div class="aui-nav-heading sidebar-section-header">', soy.$$escapeHtml(opt_data.title), '</div><ul class="aui-nav nav-links">');
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      navlinks.templates.appswitcher.applicationsItem(linkData8, output);
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">', soy.$$escapeHtml("Application Links"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">', soy.$$escapeHtml("Shortcuts"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div></nav></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-title">');
  aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}, output);
  output.append('<div class="sidebar-project-name">', soy.$$escapeHtml(opt_data.name), '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var dropdownList__soy74 = new soy.StringBuilder();
  navlinks.templates.appswitcher.dropdownList({list: opt_data.links}, dropdownList__soy74);
  dropdownList__soy74 = dropdownList__soy74.toString();
  aui.dropdown2.dropdown2({menu: {'id': opt_data.id, 'content': dropdownList__soy74, 'extraClasses': 'aui-style-default sidebar-customize-section'}, trigger: {'showIcon': false, 'content': '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', 'container': '#app-switcher'}}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="sidebar-admin-links">');
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(linkData82.href), '" title="', soy.$$escapeHtml(linkData82.title), '"><span class="nav-link-label">', soy.$$escapeHtml(linkData82.label), '</span></a></li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = new soy.StringBuilder();
      navlinks.templates.appswitcher.sidebarContents(null, sidebarContents__soy97);
      sidebarContents__soy97 = sidebarContents__soy97.toString();
      var triggerContent__soy99 = new soy.StringBuilder();
      navlinks.templates.appswitcher.trigger(null, triggerContent__soy99);
      triggerContent__soy99 = triggerContent__soy99.toString();
      navlinks.templates.appswitcher.sidebar({sidebar: {'id': 'app-switcher', 'content': sidebarContents__soy97}, trigger: {'showIcon': false, 'content': triggerContent__soy99}}, output);
      output.append('<script>\n                (function (NL) {\n                    var initialise = function () {\n                        new NL.SideBar({\n                            sidebarContents: \'#app-switcher\'\n                        });\n                    };\n                    if (NL.SideBar) {\n                        initialise();\n                    } else {\n                        NL.onInit = initialise;\n                    }\n                }(window.NL = (window.NL || {})));\n                window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
    } else {
      navlinks.templates.appswitcher_old.switcher(null, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="sidebar-trigger app-switcher-trigger" aria-owns="', soy.$$escapeHtml(opt_data.sidebar.id), '" aria-haspopup="true">', opt_data.trigger.content, '</a><div id=', soy.$$escapeHtml(opt_data.sidebar.id), ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">', opt_data.sidebar.content, '</div>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(c,a){a.SideBar=function(d){var e=this;this.$sidebar=null;d=c.extend({sidebarContents:null},d);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(g,f){e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:f,name:g}))};this.getProjectData=function(){var f=c(".project-shortcut-dialog-trigger"),g=f.data("key"),h=f.data("entity-type");if(f.size()==0||!g||!h){c(".app-switcher-shortcuts").remove();return}var j,i;i=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+g,cache:false,data:{entityType:h},dataType:"json"});j=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+g,cache:false,data:{entityType:h},dataType:"json"});c.when(i,j).then(function(l,k){e.updateProjectShortcuts(l,k,{key:g,entityType:h,name:f.data("name"),avatarUrl:f.find("img").prop("src")})},e.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=c(d.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){c(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(f,h){var g=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+f,label:"Customize shortcuts",title:""}];if(e.entityMappings[h]){g.push({href:e.generateEntityLinksUrl(f,e.entityMappings[h]),label:"Manage product links",title:""})}e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:g}))};this.updateAppLinks=function(f){c(function(){e.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:f}));if(a.isUserAdmin){e.addApplicationsCog()}e.bindAnalyticsHandlers(e.getSidebar(),f)})};this.updateProjectShortcuts=function(i,g,h){var j=i[0].shortcuts,f=g[0].shortcuts;e.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:j.concat(f)}));if(a.isUserAdmin){e.addProjectShortcutsCog(h.key,h.entityType)}e.populateProjectHeader(h.name,h.avatarUrl);e.bindAnalyticsHandlers(e.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(f,g){if(g===e.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+g+"&key="+f}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+g+"/"+f}};this.showAppSwitcherError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.showProjectShortcutsError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();f&&f.stopPropagation()};this.trackEvent=function(h,f,g){try{a.trackEvent("appswitcher-new",h,f,g)}catch(i){AJS.log("failed to track analytics event, category: appswitcher, action: "+h+", label: "+f+", value: "+g)}};this.bindAnalyticsHandlers=function(f,g){};this.getLinks();c(this.getProjectData);this.toggleSidebar=function(h){var i=e.getSidebar(),g=c("body"),f=c(window.document);if(!g.hasClass("app-switcher-open")){var k=c("#header");i.css("left",-i.width());i.parent("body").length||i.appendTo("body");b({data:i});i.animate({left:0},300);function j(l){var n=l.target&&c(l.target),m=l.keyCode;if(l.originalEvent===h.originalEvent){return}if(n&&!m&&!(n.closest(i).length||n.closest(k).length)&&h.which==1&&!(l.shiftKey||l.ctrlKey||l.metaKey)){e.toggleSidebar()}else{if(m===27){e.toggleSidebar()}}}f.on("click.appSwitcher",j);f.on("keydown.appSwitcher",j);f.on("scroll.appSwitcher",i,b)}else{f.off(".appSwitcher")}g.toggleClass("app-switcher-open")};c("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(f){var d=c(document).scrollTop(),g=c("#header"),e=(g.height()+g.offset().top)-d;if(e>=0){f.data.css({top:e,position:"fixed"})}else{f.data.css({top:0,left:0,position:"fixed"})}}if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
(function(b,a){a.AppSwitcher=function(c){var d=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var e=this;this.$dropdown=null;c=b.extend({dropdownContents:null},c);this.getLinks=function(){return b.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=b(c.dropdownContents)}return this.$dropdown};this.updateDropdown=function(f){b(function(){e.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:f,showAdminLink:a.isUserAdmin,adminLink:d}));e.bindAnalyticsHandlers(e.getDropdown(),f)})};this.showError=function(){b(function(){e.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",b.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();f&&f.stopPropagation()};this.trackEvent=function(h,f,g){try{a.trackEvent("appswitcher-new",h,f,g)}catch(i){AJS.log("failed to track analytics event, category: appswitcher, action: "+h+", label: "+f+", value: "+g)}};this.bindAnalyticsHandlers=function(i,h){function g(){var l=0;for(var j in h){var k=h[j];if(k.custom){l+=1}}return l}var f=g();i.on({"aui-dropdown2-show":function(j){e.trackEvent("show",a.getCurrentApplication(),h.length)},"aui-dropdown2-hide":function(j){e.trackEvent("hide",a.getCurrentApplication(),h.length)}});i.off(".analytics").on("click.analytics","a",function(j){e.trackEvent("appSelected",b(this).attr("href"),h.length)})};this.getLinks()};if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}, output);
  if (opt_data.custom) {
    navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}, output);
  }
  if (opt_data.showAdminLink) {
    navlinks.templates.appswitcher_old.adminSection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    var param19 = new soy.StringBuilder('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentData(linkData27, {showDescription: opt_data.showDescription}), param19);
    }
    param19.append('</ul>');
    aui.dropdown2.section({content: param19.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link', (opt_data.self) ? ' nav-link-local' : '', '"><a href="', soy.$$escapeHtml(opt_data.link), '" class="aui-dropdown2-radio interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + "Configure\x26hellip;" + '</span></a></li></ul>'}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-loading">', "Loading\x26hellip;", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    var loadingContent__soy81 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.loading(null, loadingContent__soy81);
    loadingContent__soy81 = loadingContent__soy81.toString();
    var triggerContent__soy83 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.trigger(null, triggerContent__soy83);
    triggerContent__soy83 = triggerContent__soy83.toString();
    aui.dropdown2.dropdown2({menu: {'id': 'app-switcher', 'content': loadingContent__soy81, 'extraClasses': 'aui-style-default'}, trigger: {'showIcon': false, 'content': triggerContent__soy83, 'extraClasses': 'app-switcher-trigger'}}, output);
    output.append('<script>\n            (function (NL) {\n                var initialise = function () {\n                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.\n                    window.atlassian = window.atlassian || window.aui;\n                    new NL.AppSwitcher({\n                        dropdownContents: \'#app-switcher\'\n                    });\n                };\n                if (NL.AppSwitcher) {\n                    initialise();\n                } else {\n                    NL.onInit = initialise;\n                }\n            }(window.NL = (window.NL || {})));\n            window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
  }
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'soy/headerDropdown.soy' */
// This file was automatically generated from headerDropdown.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Menu == 'undefined') { JIRA.Templates.Menu = {}; }
if (typeof JIRA.Templates.Menu.Dropdowns == 'undefined') { JIRA.Templates.Menu.Dropdowns = {}; }


JIRA.Templates.Menu.Dropdowns.dropdown2Fragment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var sectionList3 = opt_data.sections;
  var sectionListLen3 = sectionList3.length;
  for (var sectionIndex3 = 0; sectionIndex3 < sectionListLen3; sectionIndex3++) {
    var sectionData3 = sectionList3[sectionIndex3];
    var hasItems__soy4 = sectionData3.items && sectionData3.items.length > 0;
    output.append('<div class="aui-dropdown2-section">', (hasItems__soy4 && sectionData3.label) ? '<strong>' + soy.$$escapeHtml(sectionData3.label) + '</strong>' : '', '<ul class=\'aui-list-truncate\'', (sectionData3.id) ? ' id="' + soy.$$escapeHtml(sectionData3.id) + '"' : '', (sectionData3.style) ? ' class="' + soy.$$escapeHtml(sectionData3.style) + '"' : '', '>');
    if (hasItems__soy4) {
      var itemList25 = sectionData3.items;
      var itemListLen25 = itemList25.length;
      for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
        var itemData25 = itemList25[itemIndex25];
        JIRA.Templates.Menu.Dropdowns.dropdown2Item(itemData25, output);
      }
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Menu.Dropdowns.dropdown2Item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.style) ? ' class="' + soy.$$escapeHtml(opt_data.style) + '"' : '', '><a href="', soy.$$escapeHtml(opt_data.url), '"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '_lnk"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', ' class="', (opt_data.iconUrl) ? 'aui-icon-container' : '', (opt_data.parameters && opt_data.parameters['class']) ? ' ' + soy.$$escapeHtml(opt_data.parameters['class']) : '', '"');
  if (opt_data.parameters) {
    var keyList66 = soy.$$getMapKeys(opt_data.parameters);
    var keyListLen66 = keyList66.length;
    for (var keyIndex66 = 0; keyIndex66 < keyListLen66; keyIndex66++) {
      var keyData66 = keyList66[keyIndex66];
      output.append((keyData66 != 'class') ? ' ' + soy.$$escapeHtml(keyData66) + '="' + soy.$$escapeHtml(opt_data.parameters[keyData66]) + '"' : '');
    }
  }
  output.append('>', (opt_data.iconUrl) ? '<img class="icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '" />' : '', soy.$$escapeHtml(opt_data.label), '</a></li>');
  return opt_sb ? '' : output.toString();
};

/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'js/init-dropdown2.js' */
;(function() {
    var SmartAjax = require('jira/ajs/ajax/smart-ajax');
    var Events = require('jira/util/events');
    var $ = require('jquery');

    /**
     * Binds analytics events to capture opening / closing of any dropdown menus, and clicking of any menu items therein.
     * Passes the id of the link element as a parameter
     */
    function bindHeaderDropdown2Analytics() {
        $("nav.aui-header a.aui-dropdown2-trigger").each(function() {
            var $ddtrigger = $(this);
            var id = $ddtrigger.attr("id");
            if (id) {
                var $dd = $("#" + $ddtrigger.attr("aria-owns"));
                $dd.on("aui-dropdown2-show", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.opened",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("aui-dropdown2-hide", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.closed",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("click", "a", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.item.clicked",
                        data: {
                            id: this.id,
                            menu_id: id
                        }
                    });
                });
            }
        });
    }

    /**
     * Binds all the header implementations of Dropdown2. Including global nav and user profile.
     */
    function bindHeaderDropdown2() {
        $(".jira-ajax-menu").each(function () {
            var $ddtrigger = $(this);
            var $dd = $("#" + $ddtrigger.attr("aria-owns"));
            var $ajaxkey = $dd.data("aui-dropdown2-ajax-key");

            if ($ajaxkey) {
                $dd.bind("aui-dropdown2-show", function (event, options) {
                    Events.trigger('aui-dropdown2-show-before', event.target.id);
                    $dd.empty();
                    $dd.addClass("aui-dropdown2-loading");
                    SmartAjax.makeRequest({
                        url: contextPath + "/rest/api/1.0/menus/" + $ajaxkey,
                        data: {
                            inAdminMode: AJS.Meta.getBoolean("in-admin-mode")
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            $dd.removeClass("aui-dropdown2-loading");
                            $dd.html(JIRA.Templates.Menu.Dropdowns.dropdown2Fragment(data));

                            if (options && options.selectFirst) {
                                $dd.find("a:not(.disabled)").filter(":first").addClass("active")
                            }
                            Events.trigger('aui-dropdown2-show-after', event.target.id);
                        }
                    });
                });
            }
        });
    }

    $(function () {
        bindHeaderDropdown2();
        bindHeaderDropdown2Analytics();
    });

    AJS.namespace('JIRA.Dropdowns.bindHeaderDropdown2', null, bindHeaderDropdown2);
})();

/* module-key = 'net.customware.plugins.connector.atlassian.jira-connector-plugin:jquery-autocomplete', location = 'js/jquery.autocomplete.js' */
jQuery.fn.connectorautocomplete=function(d,c,a,b){return this.each(function(){var e=AJS.$(this);var k=AJS.$(this).next();k.after('<ul class="autocomplete"></ul>');var i=k.next().css({width:e.width()+4});var l="";var j;var m=0;var f=0;c=jQuery.extend({minChars:1,timeout:1000,after:null,before:null,validSelection:true,parameters:{inputName:k.attr("name"),inputId:e.attr("id")}},c);function g(n){window.clearInterval(j);if(n!=l&&(c.minChars!=null&&n.length>=c.minChars)){h();if(c.before=="function"){c.before(e,n)}e.addClass("autocomplete-loading");c.parameters.text=n;AJS.$.ajax({type:"POST",url:d,dataType:"json",contentType:"application/json; charset=utf-8",data:'{"system":"'+a+'", "objectType":"'+b+'", "searchTerm":"'+n+'"}',error:function(){var o="<li>Error: Please check the configuration of this Custom Field.</li>";i.html(o);i.show().children().click(function(){h()})},success:function(q){var o="";if(q){m=q.results.length;if(m>0){AJS.$.each(q.results,function(s,t){var u=AJS.escapeHTML(t.id);var r=AJS.escapeHTML(t.name);o+='<li title="'+u+'">'+r.replace(new RegExp("("+AJS.$.trim(n)+")","i"),"<strong>$1</strong>")+"</li>"});i.html(o);i.show().children().hover(function(){AJS.$(this).addClass("selected").siblings().removeClass("selected")},function(){AJS.$(this).removeClass("selected")}).click(function(){k.val(AJS.$(this).attr("title"));e.val(AJS.$(this).text());h()});if(c.after=="function"){c.after(e,n)}}else{var p=AJS.escapeHTML(n);o+="<li>"+p+" <i>returned 0 results.</i></li>";i.html(o);i.show().children().click(function(){h()})}}e.removeClass("autocomplete-loading")}});l=n}}function h(){i.hide();m=0;f=0}e.keydown(function(n){window.clearInterval(j);if(n.which==27){h()}else{if(n.which==46||n.which==8){h();if(c.validSelection){k.val("")}}else{if(n.which==13){if(i.css("display")=="none"){g(e.val())}else{h()}n.preventDefault();return false}else{if(n.which==40||n.which==9||n.which==38){switch(n.which){case 40:case 9:f=f>=m-1?0:f+1;break;case 38:f=f<=0?m-1:f-1;break;default:break}e.val(i.children().removeClass("selected").eq(f).addClass("selected").text());k.val(i.children().eq(f).attr("title"))}else{if(c.validSelection){k.val("")}j=window.setTimeout(function(){g(e.val())},c.timeout)}}}}})})};
/* module-key = 'net.customware.plugins.connector.atlassian.jira-connector-plugin:connector-linkfield-autocomplete', location = 'net/customware/plugins/connector/jira/action/customfield/remotefield-autocomplete.js' */
AJS.$(document).ready(function(){var b=function(f){var d=AJS.$(this).attr("remotesystem");var e=AJS.$(this).attr("remoteobjecttype");if(d!=null&&d!=""&&e!=null&&e!=""){AJS.$(this).connectorautocomplete(contextPath+"/rest/customware/connector/1.0/search/basic.json",{minChars:3,timeout:500,validSelection:true,parameters:{system:d,objectType:e},before:function(g,h){},after:function(g,h){}},d,e)}};var a=function(d){AJS.$(this).click(function(e){AJS.$(this).parent().remove();return false})};var c=function(d){AJS.$(this).click(function(h){var e=AJS.$(this).attr("customfield");var f=AJS.$("#new-connector-autocomplete-container-"+e);var i="";i+='<div class="connector-autocomplete-container">';i+=f.html();i+='<a class="connector-field-remove" href="#"><img src="'+contextPath+'/images/icons/subtract_10.gif"></a>';i+="</div>";AJS.$(this).before(i);var g=AJS.$(this).prev();g.children(".connector-field-autocomplete").each(b);g.children(".connector-field-remove").each(a);return false})};AJS.$(".connector-field-autocomplete").each(b);AJS.$(".connector-field-remove").each(a);AJS.$(".connector-field-add").each(c);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(f,d){AJS.$(".connector-field-autocomplete").unbind("click");AJS.$(".connector-field-autocomplete").each(b);AJS.$(".connector-field-remove").unbind("click");AJS.$(".connector-field-remove").each(a);AJS.$(".connector-field-add").unbind("click");AJS.$(".connector-field-add").each(c)})});
